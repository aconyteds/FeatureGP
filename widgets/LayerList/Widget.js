//>>built
require({cache:{"widgets/LayerList/LayerListView":function(){define("dijit/_WidgetBase dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-geometry dojo/on dojo/aspect dojo/query jimu/dijit/CheckBox ./PopupMenu dijit/_TemplatedMixin dojo/text!./LayerListView.html esri/dijit/Legend ./NlsStrings dojo/dom-attr dojo/dom-class dojo/dom-style".split(" "),function(v,s,q,h,d,e,u,k,p,c,r,l,f,a,t,B,x,w){return s([v,l],{templateString:f,_currentSelectedLayerRowNode:null,postCreate:function(){h.forEach(this.operLayerInfos.finalLayerInfos,
function(a){this.drawListNode(a,0,this.layerListTable,!0)},this)},drawListNode:function(a,c,d){0===a.newSubLayers.length?(a.layerNode=this.addLayerNode(a,c,d),this.config.showLegend?this.addLegendNode(a,c,a.layerNode.subNode):w.set(p(".showLegend-image",a.layerNode.currentNode)[0],"display","none")):(a.layerNode=this.addLayerNode(a,c,d),h.forEach(a.newSubLayers,q.hitch(this,function(c,d){this.drawListNode(d,c+1,a.layerNode.subNode)},c)))},addLayerNode:function(a,e,f){var h=d.create("tr",{"class":"jimu-widget-row layer-row ",
layerTrNodeId:a.id},f),l,p,k,t,x,s;l=d.create("td",{"class":"col col1"},h);for(k=0;k<e;k++)d.create("div",{"class":"begin-blank-div",innerHTML:""},l);s=d.create("div",{"class":"showLegend-div"},l);t=d.create("img",{"class":"showLegend-image",src:this.layerListWidget.folderUrl+"images/v_right.png",alt:"l"},s);p=d.create("div",{"class":"div-select"},l);k=new c({checked:a.isVisible()});d.place(k.domNode,p);x=d.create("div",{"class":"noLegend-div"},l);d.create("img",{"class":"noLegend-image",src:this.layerListWidget.folderUrl+
"images/noLegend.png",alt:"l"},x);a.noLegend?(w.set(s,"display","none"),w.set(p,"display","none")):w.set(x,"display","none");w.set(l,"width",12*e+35+"px");l=d.create("td",{"class":"col col2"},h);d.create("div",{innerHTML:a.title,"class":"div-content"},l);l=d.create("td",{"class":"col col3"},h);e=d.create("div",{"class":"layers-list-popupMenu-div"},l);l=(new r({items:a.popupMenuInfo.menuItems,box:this.layerListWidget.domNode.parentNode})).placeAt(e);this.own(u(l,"onMenuClick",q.hitch(this,this._onPopupMenuItemClick,
a,l)));f=d.create("tr",{"class":"",layerContentTrNodeId:a.id},f);f=d.create("td",{"class":"",colspan:"3"},f);f=d.create("table",{"class":"layer-sub-node"},f);this.own(u(h,"click",q.hitch(this,this._onRowTrClick,a,t,h)));this.own(u(h,"mouseover",q.hitch(this,this._onLayerNodeMouseover,h,l)));this.own(u(h,"mouseout",q.hitch(this,this._onLayerNodeMouseout,h,l)));this.own(u(k.domNode,"click",q.hitch(this,this._onCkSelectNodeClick,a,k)));this.own(u(e,"click",q.hitch(this,this._onPopupMenuClick,a,l,h)));
return{currentNode:h,subNode:f}},addLegendNode:function(a,c,e){e=d.create("tr",{"class":"legend-node-tr"},e);e=d.create("td",{"class":"legend-node-td"},e);try{var f=a.obtainLegendsNode();a.legendsNode=f;w.set(f,"marginLeft",12*(c+1)+"px");d.place(f,e)}catch(l){console.error(l)}},_fold:function(a,c){"none"===w.get(a.layerNode.subNode,"display")?(w.set(a.layerNode.subNode,"display","table"),B.set(c,"src",this.layerListWidget.folderUrl+"images/v.png")):(w.set(a.layerNode.subNode,"display","none"),B.set(c,
"src",this.layerListWidget.folderUrl+"images/v_right.png"))},_onImageShowLegendClick:function(a,c,d){this._fold(a,c);d&&d.stopPropagation()},_onCkSelectNodeClick:function(a,c,d){c.checked?a.setTopLayerVisible(!0):a.setTopLayerVisible(!1);d.stopPropagation()},_onPopupMenuClick:function(a,c,d,e){this._changeSelectedLayerRow(d);c&&"opened"===c.state?c.closeDropMenu():(this._hideCurrentPopupMenu(),c&&(a=a.getDeniedItems(),c.openDropMenu(a),this.currentPopupMenu=c));e.stopPropagation()},_hideCurrentPopupMenu:function(){this.currentPopupMenu&&
"opened"===this.currentPopupMenu.state&&this.currentPopupMenu.closeDropMenu()},_onLayerNodeMouseover:function(a,c){x.add(a,"layer-row-mouseover");c&&x.add(c.btnNode,"jimu-icon-btn-selected")},_onLayerNodeMouseout:function(a,c){x.remove(a,"layer-row-mouseover");c&&x.remove(c.btnNode,"jimu-icon-btn-selected")},_onPopupMenuHide:function(){console.log("aaa")},_onLayerListWidgetPaneClick:function(a){a&&a.closeDropMenu()},_onRowTrClick:function(a,c,d){this._changeSelectedLayerRow(d);this._onImageShowLegendClick(a,
c);a.loadLegends(this.layerListWidget.appConfig.portalUrl)},_changeSelectedLayerRow:function(a){this._currentSelectedLayerRowNode&&this._currentSelectedLayerRowNode===a||(this._currentSelectedLayerRowNode&&x.remove(this._currentSelectedLayerRowNode,"jimu-widget-row-selected"),x.add(a,"jimu-widget-row-selected"),this._currentSelectedLayerRowNode=a)},_onPopupMenuItemClick:function(a,c,d,e){e={itemKey:d.key,data:e,layerListWidget:this.layerListWidget,layerListView:this};"transparency"===d.key?"none"===
w.get(c.transparencyDiv,"display")?c.showTransNode(a.getOpacity()):c.hideTransNode():(a=a.onPopupMenuClick(e),a.closeMenu&&c.closeDropMenu())},_exchangeLayerTrNode:function(a,c){var d=p("tr[layerTrNodeId\x3d'"+a+"']",this.layerListTable)[0],e=p("tr[layerTrNodeId\x3d'"+c+"']",this.layerListTable)[0],f=p("tr[layerContentTrNodeId\x3d'"+c+"']",this.layerListTable)[0];this.layerListTable.removeChild(e);this.layerListTable.insertBefore(e,d);this.layerListTable.removeChild(f);this.layerListTable.insertBefore(f,
d)},moveUpLayer:function(a){var c=this.operLayerInfos.moveUpLayer(a);c&&this._exchangeLayerTrNode(c,a)},moveDownLayer:function(a){var c=this.operLayerInfos.moveDownLayer(a);c&&this._exchangeLayerTrNode(a,c)}})})},"widgets/LayerList/PopupMenu":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/html dojo/_base/lang dojo/query dojo/on jimu/dijit/DropMenu dijit/_TemplatedMixin dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dojo/text!./PopupMenu.html dojo/dom-style ./NlsStrings".split(" "),
function(v,s,q,h,d,e,u,k,p,c,r,l,f){return v([u,k],{templateString:r,_deniedItems:null,constructor:function(){this.nls=f.value;this._deniedItems=[]},_getDropMenuPosition:function(){return{top:"15px",left:12-q.getStyle(this.dropMenuNode,"width")+"px"}},_getTransNodePosition:function(){return{top:"15px",left:-174-q.getStyle(this.dropMenuNode,"width")+"px"}},_onBtnClick:function(){this.dropMenuNode||(this._createDropMenuNode(),this.own(e(this.dropMenuNode,"click",h.hitch(this,function(a){a.stopPropagation()}))))},
_refresh:function(){this._denyItems()},_denyItems:function(){var a=d("div[class~\x3d'menu-item']",this.dropMenuNode).forEach(function(a){q.removeClass(a,"menu-item-dissable")});s.forEach(this._deniedItems,function(c){a.forEach(function(a){q.getAttr(a,"itemId")===c&&(q.addClass(a,"menu-item-dissable"),("description"===c||"download"===c)&&d(".menu-item-description",a).forEach(function(a){q.setAttr(a,"href","#");q.removeAttr(a,"target")}))})},this)},selectItem:function(a){-1===this._deniedItems.indexOf(a.key)&&
this.emit("onMenuClick",a)},openDropMenu:function(a){a.then(h.hitch(this,function(a){this._deniedItems=a;this._refresh()}));this.inherited(arguments)},closeDropMenu:function(){this.inherited(arguments);this.hideTransNode()},_onTransparencyDivClick:function(a){a.stopPropagation()},showTransNode:function(a){this.transHorizSlider||(this._createTransparencyWidget(),this.transHorizSlider.set("value",1-a));l.set(this.transparencyDiv,"top",this._getTransNodePosition().top);l.set(this.transparencyDiv,"left",
this._getTransNodePosition().left);l.set(this.transparencyDiv,"display","block")},hideTransNode:function(){l.set(this.transparencyDiv,"display","none")},_createTransparencyWidget:function(){this.transHorizSlider=new p({minimum:0,maximum:1,intermediateChanges:!0},this.transparencyBody);this.own(this.transHorizSlider.on("change",h.hitch(this,function(a){this.emit("onMenuClick",{key:"transparencyChanged"},{newTransValue:a})})));new c({container:"bottomDecoration"},this.transparencyRule)}})})},"jimu/dijit/DropMenu":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented ../utils".split(" "),
function(v,s,q,h,d,e,u,k){return v([s,u],{"class":"jimu-dropmenu",constructor:function(){this.state="closed"},postCreate:function(){this.btnNode=d.create("div",{"class":"jimu-icon-btn"},this.domNode);this.own(e(this.btnNode,"click",q.hitch(this,this._onBtnClick)));this.box||(this.box=this.domNode.parentNode);this.own(e(this.box,"click",q.hitch(this,function(){this.dropMenuNode&&this.closeDropMenu()})))},_onBtnClick:function(d){d.stopPropagation();this.dropMenuNode||this._createDropMenuNode();"closed"===
this.state?this.openDropMenu():this.closeDropMenu()},_createDropMenuNode:function(){this.dropMenuNode=d.create("div",{"class":"drop-menu",style:{display:"none"}},this.domNode);this.items||(this.items=[]);h.forEach(this.items,function(h){var c;h.key?(c=d.create("div",{"class":"menu-item",itemId:h.key,innerHTML:h.label},this.dropMenuNode),this.own(e(c,"click",q.hitch(this,function(){this.selectItem(h)})))):d.create("hr",{"class":"menu-item-line"},this.dropMenuNode)},this)},_getDropMenuPosition:function(){var e=
d.getContentBox(this.box),c=d.getMarginBox(this.domNode),h=d.getMarginBox(this.btnNode),l=d.getMarginBox(this.dropMenuNode),f={},a,k;f.l=c.l;f.t=c.t+h.h;f.t+l.h>e.h&&(k=c.t,a=e.h-c.t-h.h,a=Math.max(k,a),a===k&&(f.t=0-l.h));f.l+l.w>e.w&&(l=c.l,e=e.w-c.l-h.w,a=Math.max(l,e),a===l&&(f.l="",f.r=0));f.left=f.l;f.top=f.t;f.right=f.r;return f},selectItem:function(d){this.closeDropMenu();this.emit("onMenuClick",d)},openDropMenu:function(){this.state="opened";d.setStyle(this.dropMenuNode,"display","");d.setStyle(this.dropMenuNode,
k.getPositionStyle(this._getDropMenuPosition()));this.emit("onOpenMenu")},closeDropMenu:function(){this.state="closed";d.setStyle(this.dropMenuNode,"display","none");this.emit("onCloseMenu")}})})},"widgets/LayerList/NlsStrings":function(){define([],function(){return{value:null}})},"esri/dijit/Legend":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/json dojo/_base/Color dojo/has dojo/sniff dojo/DeferredList dojo/json dojo/number dojo/dom dojo/dom-construct dojo/dom-style dijit/_Widget dojox/gfx dojox/gfx/matrix dojox/html/entities ../kernel ../config ../request ../lang ../renderers/SimpleRenderer ../renderers/UniqueValueRenderer ../renderers/ClassBreaksRenderer ../renderers/ScaleDependentRenderer ../renderers/DotDensityRenderer ../renderers/TemporalRenderer ../symbols/SimpleMarkerSymbol ../symbols/PictureFillSymbol ../symbols/jsonUtils ./_EventedWidget dojo/i18n!../nls/jsapi dojo/i18n!dojo/cldr/nls/number".split(" "),
function(v,s,q,h,d,e,u,k,p,c,r,l,f,a,t,B,x,w,F,S,G,H,A,D,I,J,K,L,M,N,O,E,P,Q,R){var C=s([P,B],{declaredClass:"esri.dijit.Legend",widgetsInTemplate:!1,layers:null,alignRight:!1,hoverLabelShowing:!1,dotDensitySwatchSize:26,dotCoverage:75,reZeros:RegExp("\\"+R.decimal+"0+$","g"),reZerosFractional:RegExp("(\\d)0*$","g"),_ieTimer:100,_isRightToLeft:!1,_align:null,_legendAlign:null,constructor:function(b,m){q.mixin(this,Q.widgets.legend);b=b||{};b.map?m?(this.map=b.map,this.layerInfos=b.layerInfos,this._respectCurrentMapScale=
!1===b.respectCurrentMapScale?!1:!0,this.arrangement=b.arrangement===C.ALIGN_RIGHT?C.ALIGN_RIGHT:C.ALIGN_LEFT,this.arrangement===C.ALIGN_RIGHT&&(this.alignRight=!0),this.autoUpdate=!1===b.autoUpdate?!1:!0,this._surfaceItems=[]):console.error("esri.dijit.Legend: must specify a container for the legend"):console.error("esri.dijit.Legend: unable to find the 'map' property in parameters")},postMixInProperties:function(){this.inherited(arguments);var b=["ar","he"],m,g;for(m=0;m<b.length;m+=1)g=b[m],v.locale&&
-1!==v.locale.indexOf(g)&&(-1!==v.locale.indexOf("-")?-1!==v.locale.indexOf(g+"-")&&(this._isRightToLeft=!0):this._isRightToLeft=!0);this._isRightToLeft?(this._align=this.alignRight?"left":"right",this._legendAlign=this.alignRight?"esriLegendLeft":"esriLegendRight"):(this._align=this.alignRight?"right":"left",this._legendAlign=this.alignRight?"esriLegendRight":"esriLegendLeft")},startup:function(){this.inherited(arguments);this._initialize();9>k("ie")&&(this._repaintItems=q.hitch(this,this._repaintItems),
setTimeout(this._repaintItems,this._ieTimer))},destroy:function(){this._deactivate();this._removeHoverHandlers();this.inherited(arguments)},refresh:function(b){if(this.domNode){b?(this.layerInfos=b,this.layers=[],h.forEach(this.layerInfos,function(b){this._isSupportedLayerType(b.layer)&&(b.title&&(b.layer._titleForLegend=b.title),b.layer._hideDefaultSymbol=!1===b.defaultSymbol?!0:!1,b.hideLayers?(b.layer._hideLayersInLegend=b.hideLayers,this._addSubLayersToHide(b)):b.layer._hideLayersInLegend=[],
b.hoverLabel&&(b.layer._hoverLabel=b.hoverLabel),b.hoverLabels&&(b.layer._hoverLabels=b.hoverLabels),this.layers.push(b.layer))},this)):this.useAllMapLayers&&(this.layers=this.layerInfos=null);for(b=this.domNode.children.length-1;0<=b;b--)a.destroy(this.domNode.children[b]);this._removeHoverHandlers();this.startup()}},_legendUrl:"http://utility.arcgis.com/sharing/tools/legend",_initialize:function(){this.layerInfos&&(this.layers=[],h.forEach(this.layerInfos,function(b){this._isSupportedLayerType(b.layer)&&
(b.title&&(b.layer._titleForLegend=b.title),b.layer._hideDefaultSymbol=!1===b.defaultSymbol?!0:!1,b.hideLayers?(b.layer._hideLayersInLegend=b.hideLayers,this._addSubLayersToHide(b)):b.layer._hideLayersInLegend=[],b.hoverLabel&&(b.layer._hoverLabel=b.hoverLabel),b.hoverLabels&&(b.layer._hoverLabels=b.hoverLabels),this.layers.push(b.layer))},this));this.useAllMapLayers=!1;if(!this.layers){this.useAllMapLayers=!0;this.layers=[];var b=[],m=[];h.forEach(this.map.layerIds,function(a){a=this.map.getLayer(a);
var y;this._isSupportedLayerType(a)&&(a.arcgisProps&&a.arcgisProps.title&&(a._titleForLegend=a.arcgisProps.title),this.layers.push(a));"esri.layers.KMLLayer"==a.declaredClass&&(y=a.getLayers(),h.forEach(y,function(m){b.push(m.id)},this));"esri.layers.GeoRSSLayer"==a.declaredClass&&(y=a.getFeatureLayers(),h.forEach(y,function(b){m.push(b.id)},this))},this);h.forEach(this.map.graphicsLayerIds,function(a){var y=this.map.getLayer(a);-1==h.indexOf(b,a)&&-1==h.indexOf(m,a)&&(this._isSupportedLayerType(y)&&
y._params&&y._params.drawMode)&&(y.arcgisProps&&y.arcgisProps.title&&(y._titleForLegend=y.arcgisProps.title),this.layers.push(y))},this)}this._createLegend()},_activate:function(){this._deactivate();this.autoUpdate&&(this._respectCurrentMapScale&&(this._ozeConnect=d.connect(this.map,"onZoomEnd",this,"_refreshLayers")),this.useAllMapLayers&&(this._olaConnect=d.connect(this.map,"onLayerAdd",this,"_updateAllMapLayers"),this._olrConnect=d.connect(this.map,"onLayerRemove",this,"_updateAllMapLayers"),this._olroConnect=
d.connect(this.map,"onLayersReordered",this,"_updateAllMapLayers")),h.forEach(this.layers,function(b){b.ovcConnect=d.connect(b,"onVisibilityChange",this,"_refreshLayers");b.oscConnect=d.connect(b,"onScaleRangeChange",this,"_refreshLayers");"esri.layers.ArcGISDynamicMapServiceLayer"===b.declaredClass&&b.supportsDynamicLayers&&(b.odcConnect=d.connect(b,"_onDynamicLayersChange",q.hitch(this,"_updateDynamicLayers",b)));"esri.layers.ArcGISImageServiceLayer"===b.declaredClass&&(b.oirConnect=d.connect(b,
"onRenderingChange",q.partial(this._updateImageServiceLayers,this,b)))},this))},_deactivate:function(){this._ozeConnect&&d.disconnect(this._ozeConnect);this._olaConnect&&d.disconnect(this._olaConnect);this._olroConnect&&d.disconnect(this._olroConnect);this._olrConnect&&d.disconnect(this._olrConnect);h.forEach(this.layers,function(b){b.ovcConnect&&d.disconnect(b.ovcConnect);b.oscConnect&&d.disconnect(b.oscConnect);b.odcConnect&&d.disconnect(b.odcConnect);b.oirConnect&&d.disconnect(b.oirConnect)},this)},
_updateDynamicLayers:function(b){delete b.legendResponse;this._refreshLayers()},_updateImageServiceLayers:function(b,a){delete a.legendResponse;b._refreshLayers()},_refreshLayers:function(){this.refresh()},_updateAllMapLayers:function(){this.layers=[];h.forEach(this.map.layerIds,function(b){b=this.map.getLayer(b);this._isSupportedLayerType(b)&&this.layers.push(b)},this);h.forEach(this.map.graphicsLayerIds,function(b){b=this.map.getLayer(b);this._isSupportedLayerType(b)&&(b._params&&b._params.drawMode)&&
this.layers.push(b)},this);this.refresh()},_createLegend:function(){var b=!1;t.set(this.domNode,"position","relative");a.create("div",{id:this.id+"_msg",className:"esriLegendMsg",innerHTML:this.NLS_creatingLegend+"..."},this.domNode);var m=[];h.forEach(this.layers,function(g){if("esri.layers.KMLLayer"==g.declaredClass||"esri.layers.GeoRSSLayer"==g.declaredClass){var c;g.loaded?("esri.layers.KMLLayer"==g.declaredClass?c=g.getLayers():"esri.layers.GeoRSSLayer"==g.declaredClass&&(c=g.getFeatureLayers(),
g._hideLayersInLegend&&(c=h.filter(c,function(b){return-1==h.indexOf(g._hideLayersInLegend,b.id)}))),h.forEach(c,function(b){"esri.layers.FeatureLayer"==b.declaredClass&&g._titleForLegend&&(b._titleForLegend=g._titleForLegend+" - ","esriGeometryPoint"==b.geometryType?b._titleForLegend+=this.NLS_points:"esriGeometryPolyline"==b.geometryType?b._titleForLegend+=this.NLS_lines:"esriGeometryPolygon"==b.geometryType&&(b._titleForLegend+=this.NLS_polygons),m.push(b))},this)):d.connect(g,"onLoad",q.hitch(this,
function(){this.refresh(this.layerInfos)}))}else if("esri.layers.WMSLayer"===g.declaredClass)if(g.loaded){if(g.visible&&0<g.layerInfos.length&&h.some(g.layerInfos,function(b){return b.legendURL})){var e=!1;h.forEach(g.layerInfos,function(m){m.legendURL&&-1<h.indexOf(g.visibleLayers,m.name)&&(e||(a.create("div",{innerHTML:"\x3cspan class\x3d'esriLegendServiceLabel'\x3e"+(g._titleForLegend||g.name||g.id)+"\x3c/span\x3e"},this.domNode),e=!0),a.create("div",{innerHTML:"\x3cimg src\x3d'"+m.legendURL+"'/\x3e"},
this.domNode),b=!0)},this)}}else d.connect(g,"onLoad",q.hitch(this,function(){this.refresh(this.layerInfos)}));else m.push(g)},this);var g=[];h.forEach(m,function(b){if(b.loaded){if(!0===b.visible&&(b.layerInfos||b.renderer||"esri.layers.ArcGISImageServiceLayer"==b.declaredClass)){var m=a.create("div",{id:this.id+"_"+b.id,style:{display:"none"},"class":"esriLegendService"});a.create("span",{innerHTML:this._getServiceTitle(b),"class":"esriLegendServiceLabel"},a.create("td",{align:this._align},a.create("tr",
{},a.create("tbody",{},a.create("table",{width:"95%"},m)))));a.place(m,this.id,"first");b.legendResponse||b.renderer?this._createLegendForLayer(b):g.push(this._legendRequest(b))}}else var c=d.connect(b,"onLoad",this,function(b){d.disconnect(c);c=null;this.refresh()})},this);0===g.length&&!b?(f.byId(this.id+"_msg").innerHTML=this.NLS_noLegend,this._activate()):(new c(g)).addCallback(q.hitch(this,function(m){b?f.byId(this.id+"_msg").innerHTML="":f.byId(this.id+"_msg").innerHTML=this.NLS_noLegend;this._activate()}))},
_createLegendForLayer:function(b){if(b.legendResponse||b.renderer){var m=!1;if(b.legendResponse){var a=b.dynamicLayerInfos||b.layerInfos;a&&a.length?h.forEach(a,function(a,g){if(!b._hideLayersInLegend||-1==h.indexOf(b._hideLayersInLegend,a.id)){var c=this._buildLegendItems(b,a,g);m=m||c}},this):"esri.layers.ArcGISImageServiceLayer"==b.declaredClass&&(m=this._buildLegendItems(b,{id:0,name:null,title:b.name,subLayerIds:null,parentLayerId:-1},0))}else b.renderer&&(a=b.url?b.url.substring(b.url.lastIndexOf("/")+
1,b.url.length):"fc_"+b.id,m=this._buildLegendItems(b,{id:a,name:null,subLayerIds:null,parentLayerId:-1},0));m&&(t.set(f.byId(this.id+"_"+b.id),"display","block"),t.set(f.byId(this.id+"_msg"),"display","none"))}},_legendRequest:function(b){if(b.loaded)return 10.01<=b.version?this._legendRequestServer(b):this._legendRequestTools(b);d.connect(b,"onLoad",q.hitch(this,"_legendRequest"))},_legendRequestServer:function(b){var a=b.url,g=a.indexOf("?"),a=-1<g?a.substring(0,g)+"/legend"+a.substring(g):a+"/legend";
(g=b._getToken())&&(a+="?token\x3d"+g);var c=q.hitch(this,"_processLegendResponse"),g={f:"json"};b._params.dynamicLayers&&(g.dynamicLayers=r.stringify(this._createDynamicLayers(b)),"[{}]"===g.dynamicLayers&&(g.dynamicLayers="[]"));b._params.bandIds&&(g.bandIds=b._params.bandIds);b._params.renderingRule&&(g.renderingRule=b._params.renderingRule);return H({url:a,content:g,callbackParamName:"callback",load:function(a,m){c(b,a,m)},error:G.defaults.io.errorHandler})},_legendRequestTools:function(b){var a=
b.url.toLowerCase().indexOf("/rest/"),a=b.url.substring(0,a)+b.url.substring(a+5,b.url.length),a=this._legendUrl+"?soapUrl\x3d"+window.escape(a);if(!k("ie")||8<k("ie"))a+="\x26returnbytes\x3dtrue";var g=q.hitch(this,"_processLegendResponse");return H({url:a,content:{f:"json"},callbackParamName:"callback",load:function(a,m){g(b,a,m)},error:G.defaults.io.errorHandler})},_processLegendResponse:function(b,m){m&&m.layers?(b.legendResponse=m,f.byId(this.id+"_"+b.id)&&a.empty(f.byId(this.id+"_"+b.id)),a.create("span",
{innerHTML:this._getServiceTitle(b),"class":"esriLegendServiceLabel"},a.create("td",{align:this._align},a.create("tr",{},a.create("tbody",{},a.create("table",{width:"95%"},f.byId(this.id+"_"+b.id)))))),this._createLegendForLayer(b)):console.log("Legend could not get generated for "+b.url+": "+e.toJson(m))},_buildLegendItems:function(b,m,g){var c=!1,d=f.byId(this.id+"_"+b.id),e=m.parentLayerId;if(m.subLayerIds)b=a.create("div",{id:this.id+"_"+b.id+"_"+m.id+"_group",style:{display:"none"},"class":-1==
e?0<g?"esriLegendGroupLayer":"":this._legendAlign},-1==e?d:f.byId(this.id+"_"+b.id+"_"+e+"_group")),a.create("td",{innerHTML:m.name,align:this._align},a.create("tr",{},a.create("tbody",{},a.create("table",{width:"95%","class":"esriLegendLayerLabel"},b))));else{if(b.visibleLayers&&-1==(","+b.visibleLayers+",").indexOf(","+m.id+","))return c;g=a.create("div",{id:this.id+"_"+b.id+"_"+m.id,style:{display:"none"},"class":-1<e?this._legendAlign:""},-1==e?d:f.byId(this.id+"_"+b.id+"_"+e+"_group"));a.create("td",
{innerHTML:m.name||"",align:this._align},a.create("tr",{},a.create("tbody",{},a.create("table",{width:"95%","class":"esriLegendLayerLabel"},g))));b.legendResponse?c=c||this._buildLegendItems_Tools(b,m,g):b.renderer&&(c=c||this._buildLegendItems_Renderer(b,m,g))}return c},_buildLegendItems_Tools:function(b,m,g){var c=m.parentLayerId,d=this.map.getScale(),e=!1,z=function(b,a){var m,g;for(m=0;m<b.length;m++)if(a.dynamicLayerInfos)for(g=0;g<a.dynamicLayerInfos[g].length;g++){if(a.dynamicLayerInfos[g].mapLayerId==
b[m].layerId)return b[m]}else if(a.id==b[m].layerId)return b[m];return{}};if(!this._respectCurrentMapScale||this._respectCurrentMapScale&&this._isLayerInScale(b,m,d)){var l=!0;if("esri.layers.ArcGISDynamicMapServiceLayer"===b.declaredClass||"esri.layers.ArcGISMapServiceLayer"===b.declaredClass){var n=this._getEffectiveScale(b,m);if(n.minScale&&n.minScale<d||n.maxScale&&n.maxScale>d)l=!1}if(l){var d=z(b.legendResponse.layers,m),k=d.legendType,r=d.legend;if(r){g=a.create("table",{cellpadding:0,cellspacing:0,
width:"95%","class":"esriLegendLayer"},g);var q=a.create("tbody",{},g);(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(g,b,m);h.forEach(r,function(a){if(!(10.1<=b.version&&!a.values&&1<r.length&&(b._hideDefaultSymbol||"\x3call other values\x3e"===a.label||!a.label&&!("esri.layers.ArcGISImageServiceLayer"===b.declaredClass&&10.3<=b.version))))if(a.url&&0===a.url.indexOf("http")||a.imageData&&0<a.imageData.length)e=!0,this._buildRow_Tools(a,q,b,m.id,k)},this)}}}e&&(t.set(f.byId(this.id+"_"+
b.id+"_"+m.id),"display","block"),-1<c&&(t.set(f.byId(this.id+"_"+b.id+"_"+c+"_group"),"display","block"),this._findParentGroup(b.id,b,c)));return e},_buildRow_Tools:function(b,m,g,c,d){var e=a.create("tr",{},m),f;this.alignRight?(m=a.create("td",{align:this._isRightToLeft?"left":"right"},e),f=a.create("td",{align:this._isRightToLeft?"left":"right",width:35},e)):(f=a.create("td",{width:35},e),m=a.create("td",{},e));e=b.url;(!k("ie")||9<=k("ie")||9>k("ie")&&"esri.layers.ArcGISImageServiceLayer"===
g.declaredClass)&&b.imageData&&0<b.imageData.length?e="data:image/png;base64,"+b.imageData:0!==b.url.indexOf("http")&&(e=g.url+"/"+c+"/images/"+b.url,(c=g._getToken())&&(e+="?token\x3d"+c));c=a.create("img",{src:e,border:0,style:"opacity:"+g.opacity},f);b=a.create("td",{innerHTML:b.label,align:this._align},a.create("tr",{},a.create("tbody",{},a.create("table",{width:"95%",dir:"ltr"},m))));d&&("Stretched"===d&&10.3<=g.version&&"esri.layers.ArcGISImageServiceLayer"===g.declaredClass)&&(b.style.verticalAlign=
"top",b.style.lineHeight="1",c.style.marginBottom="-1px",c.style.display="block",m.style.verticalAlign="top");9>k("ie")&&(c.style.filter="alpha(opacity\x3d"+100*g.opacity+")")},_buildLegendItems_Renderer:function(b,m,g){var c=m.parentLayerId,d=this.map,e=d.getScale(),z=!1;if(!this._respectCurrentMapScale||this._isLayerInScale(b,m,e)){var l,n=b.renderer,k,r,u,p,s;if(n instanceof K&&(n=(n="zoom"===n.rangeType?n.getRendererInfoByZoom(d.getZoom()):n.getRendererInfoByScale(e))&&n.renderer,!n))return!1;
n.colorInfo?(k=this._getMedianColor(n),u=q.isFunction(n.colorInfo.field)?null:b._getField(n.colorInfo.field,!0)):n.opacityInfo&&(s=q.isFunction(n.opacityInfo.field)?null:b._getField(n.opacityInfo.field,!0));n.proportionalSymbolInfo&&(p=q.isFunction(n.proportionalSymbolInfo.field)?null:b._getField(n.proportionalSymbolInfo.field,!0));if(n instanceof L)z=!0,this._showDotDensityLegend(b,m,n,g);else if(n instanceof M)z=!0,d=a.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},
g),l=a.create("tbody",{},d),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(d,b,m),n.latestObservationRenderer&&n.latestObservationRenderer instanceof D&&this._buildRow_Renderer(b,n.latestObservationRenderer.symbol,k,n.latestObservationRenderer.label||this.NLS_currentObservations,null,l),n.observationRenderer&&n.observationRenderer instanceof D&&this._buildRow_Renderer(b,n.observationRenderer.symbol,k,n.observationRenderer.label||this.NLS_previousObservations,null,l);else if(n instanceof
I){if(n.infos&&0<n.infos.length){z=!0;d=a.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},g);l=a.create("tbody",{},d);(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(d,b,m);var A=[];h.forEach(n.infos,function(a){var m=null;b._editable&&b.types&&(m=this._getTemplateFromTypes(b.types,a.value));var g=a.label;null==g&&(g=a.value);-1===h.indexOf(A,g)&&(A.push(g),this._buildRow_Renderer(b,a.symbol,k,g,m,l))},this)}}else n instanceof J?n.infos&&0<n.infos.length&&
(z=!0,d=a.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},g),l=a.create("tbody",{},d),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(d,b,m),h.forEach(n.infos,function(a){var m=a.label;null==m&&(m=a.minValue+" - "+a.maxValue);this._buildRow_Renderer(b,a.symbol,k,m,null,l)},this)):n instanceof D&&(z=!0,d=a.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},g),l=a.create("tbody",{},d),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(d,
b,m),r=null,b._editable&&(b.templates&&0<b.templates.length)&&(r=b.templates[0]),d=(u||s)&&p?null:u||s||p,this._buildRow_Renderer(b,n.symbol,k,d?d.alias||d.name:n.label,r,l),r=n.symbol&&n.symbol.color,d&&(u=s=p=null));z&&(n.colorInfo?this._showColorRamp(b,m,n,null,g,n.colorInfo,u):n.opacityInfo&&r&&this._showColorRamp(b,m,n,r,g,n.opacityInfo,s),n.proportionalSymbolInfo&&this._showProportionalLegend(b,m,n,k,g,p));!b._hideDefaultSymbol&&n.defaultSymbol&&(z=!0,this._buildRow_Renderer(b,n.defaultSymbol,
null,n.defaultLabel||"others",null,l))}z&&(t.set(f.byId(this.id+"_"+b.id+"_"+m.id),"display","block"),-1<c&&(t.set(f.byId(this.id+"_"+b.id+"_"+c+"_group"),"display","block"),this._findParentGroup(b.id,c)));return z},_showColorRamp:function(b,m,g,c,d,e,l){var f;f=a.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},d);d=a.create("tbody",{},f);(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(f,b,m);l&&this._addSubHeader(d,l.alias||l.name);m=this._getRampStops(g,
e,c);m.length&&this._drawColorRamp(d,m,b)},_getMedianColor:function(b){var a=b.colorInfo,g,c;a.colors?(g=a.minDataValue,c=a.maxDataValue):a.stops&&(g=a.stops[0].value,c=a.stops[a.stops.length-1].value);return b.getColor(g+(c-g)/2)},_getRampStops:function(b,a,g){var c,d,e;a.colors||a.opacityValues?(d=a.maxDataValue-a.minDataValue,c=h.map([0,0.25,0.5,0.75,1],function(b){e=a.minDataValue+b*d;return Number(e.toFixed(6))}),this._checkPrecision(0,4,c)):a.stops&&(c=h.map(a.stops,function(b){return b.value}));
var f=c[0],k,n;d=c[c.length-1]-f;return h.map(c,function(a){g?(k=new u(g.toRgba()),n=b.getOpacity(a),null!=n&&(k.a=n)):k=b.getColor(a);return{value:a,color:k,offset:1-(a-f)/d,label:l.format(a,{places:20,round:-1}).replace(this.reZerosFractional,"$1").replace(this.reZeros,"")}},this).reverse()},_checkPrecision:function(b,a,g){var c=b+(a-b)/2,d=g[b],e=g[c],f=g[a],l=Math.floor(d),n=Math.floor(e),h=Math.floor(f);l===d&&(h===f&&n!==e&&l!==n&&h!==n)&&(g[c]=n);b+1!==c&&this._checkPrecision(b,c,g);c+1!==
a&&this._checkPrecision(c,a,g)},_drawColorRamp:function(b,m,g){var c=a.create("tr",{},b),d,e,f,l,n,r,q;this.alignRight?(b=a.create("td",{align:this._isRightToLeft?"left":"right"},c),d=a.create("td",{align:this._isRightToLeft?"left":"right",width:34},c)):(d=a.create("td",{width:34,align:"center"},c),b=a.create("td",{},c));e=a.create("div",{style:"position: relative; width:34px;"},d);f=a.create("div",{"class":"esriLegendColorRamp"},e);c=t.get(f,"width");d=t.get(f,"height");t.set(e,"height",d+"px");
f=x.createSurface(f,c,d);9>k("ie")&&(n=f.getEventSource(),t.set(n,"position","relative"),t.set(n.parentNode,"position","relative"));try{r=f.createRect({width:c,height:d}),r.setFill({type:"linear",x1:0,y1:0,x2:0,y2:d,colors:m}).setStroke(null),f.createRect({width:c,height:d}).setFill(new u([255,255,255,1-g.opacity])).setStroke(null),this._surfaceItems.push(f)}catch(p){f.clear(),f.destroy()}l=a.create("div",{"class":"esriLegendColorRampLabels"},b);h.forEach(m,function(b,g){q="top:"+100*b.offset+"%;";
a.create("div",{"class":"esriLegendColorRampTick"+(g===m.length-1?" esriLegendColorRampTickLast":""),innerHTML:"\x26nbsp;",style:q},e);a.create("div",{"class":"esriLegendColorRampLabel",innerHTML:b.label,style:q},l)})},_showDotDensityLegend:function(b,m,g,c){var d=g.legendOptions,e,f,l,n,k,r,u,p=this.dotDensitySwatchSize,t=Math.round(p/2);d&&(f=d.backgroundColor,l=d.outline,n=d.valueUnit,k=d.dotCoverage);k=(k||this.dotCoverage)/100;u=Math.round(p*p/Math.pow(g.dotSize,2)*k);c=a.create("table",{cellpadding:0,
cellspacing:0,width:"95%","class":"esriLegendLayer"},c);r=a.create("tbody",{},c);(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(c,b,m);this._addSubHeader(r,A.substitute({value:g.dotValue,unit:n||""},this.NLS_dotValue));h.forEach(g.fields,function(a){a=q.mixin({},a);a.numPoints=u;e=new O(g._generateImageSrc(p,p,[a],{x:0,y:0},{x:p,y:p},f),l||g.outline,p,p);a=b._getField(a.name,!0)||a;this._buildRow_Renderer(b,e,null,a.alias||a.name,null,r,{type:"path",path:"M "+-t+","+-t+" L "+t+","+-t+" L "+
t+","+t+" L "+-t+","+t+" L "+-t+","+-t+" E"})},this)},_showProportionalLegend:function(b,c,g,d,e,f){var k=g.proportionalSymbolInfo,r=k.legendOptions,r=r&&r.customValues,n,q=k.minDataValue,u=k.maxDataValue,p=this._getProportionalSymbol(g,d);"unknown"!==k.valueUnit||(!p||!r&&(null==q||null==u))||(d=a.create("table",{cellpadding:0,cellspacing:0,width:"95%","class":"esriLegendLayer"},e),n=a.create("tbody",{},d),(b._hoverLabel||b._hoverLabels)&&this._createHoverAction(d,b,c),f&&this._addSubHeader(n,f.alias||
f.name),c=r||this._getDataValues(q,u),h.forEach(c,function(a){p=E.fromJson(p.toJson());this._applySize(p,g,a);a=l.format(a,{places:20,round:-1}).replace(this.reZerosFractional,"$1").replace(this.reZeros,"");this._buildRow_Renderer(b,p,null,a,null,n)},this))},_getProportionalSymbol:function(b,a){var c,d;if(b instanceof D)d=!0,c=b.symbol;else if(b instanceof I||b instanceof J)c=b.infos[0].symbol;if(c=-1!==c.type.indexOf("fillsymbol")?null:c)!d&&"picturemarkersymbol"===c.type?(c=new N,c.setStyle("square"),
c.outline.setWidth(1)):c=E.fromJson(c.toJson()),a?c.setColor(new u(a.toRgba())):d||c.setColor(new u([127,127,127]));return c},_applySize:function(b,a,c){var d=b.type;a=a.getSize(c,-1!==d.indexOf("markersymbol")?{shape:b.style}:null);switch(d){case "simplemarkersymbol":b.setSize(a);break;case "picturemarkersymbol":b.setWidth(a);b.setHeight(a);break;case "simplelinesymbol":case "cartographiclinesymbol":b.setWidth(a)}},_getDataValues:function(b,a){var c=[b,a],d=Math.LN10,e=Math.log(b),f=Math.log(a),
l,k,n,r,p;h.forEach([1,2.5,5],function(b){r=Math.log(b);l=Math.ceil((e-r)/d);k=Math.floor((f-r)/d);if(!(Infinity===Math.abs(l)||Infinity===Math.abs(k)))for(n=l;n<k+1;n++)p=b*Math.pow(10,n),-1===h.indexOf(c,p)&&c.push(p)});c.sort(this._sorter);return c.reverse()},_sorter:function(b,a){return b-a},_buildRow_Renderer:function(b,c,g,d,e,f,l){var k=a.create("tr",{},f),n;this.alignRight?(f=a.create("td",{align:this._isRightToLeft?"left":"right"},k),n=a.create("td",{align:this._isRightToLeft?"left":"right",
width:35},k)):(n=a.create("td",{width:35,align:"center"},k),f=a.create("td",{},k));var r=k=30;"simplemarkersymbol"==c.type?(k=Math.min(Math.max(k,c.size+12),125),r=Math.min(Math.max(r,c.size+12),125)):"picturemarkersymbol"==c.type&&(k=Math.min(Math.max(k,c.width),125),r=Math.min(c.height||r,125));n=a.create("div",{style:"width:"+k+"px;height:"+r+"px;"},n);A.isDefined(d)&&"number"===typeof d&&(d=""+d);a.create("td",{innerHTML:d||"",align:this._align},a.create("tr",{},a.create("tbody",{},a.create("table",
{width:"95%"},f))));b=this._drawSymbol(n,c,g,k,r,e,b,l);this._surfaceItems.push(b)},_addSubHeader:function(b,c){var d=a.create("tr",{},b),d=a.create("td",{align:this._align,colspan:2},d);a.create("td",{innerHTML:c||"",align:this._align},a.create("tr",{},a.create("tbody",{},a.create("table",{width:"95%"},d))))},_drawSymbol:function(b,a,c,d,e,f,l,r){a=E.fromJson(a.toJson());var n=l.opacity;c&&a.setColor(new u(c.toRgba()));if("simplelinesymbol"===a.type||"cartographiclinesymbol"===a.type||"textsymbol"===
a.type){if(!a.color)return;c=a.color.toRgba();c[3]*=n;a.color.setColor(c)}else if("simplemarkersymbol"===a.type||"simplefillsymbol"===a.type){if(!a.color)return;c=a.color.toRgba();c[3]*=n;a.color.setColor(c);a.outline&&a.outline.color&&(c=a.outline.color.toRgba(),c[3]*=n,a.outline.color.setColor(c))}else"picturemarkersymbol"===a.type&&(b.style.opacity=n,b.style.filter="alpha(opacity\x3d("+100*n+"))");b=x.createSurface(b,d,e);9>k("ie")&&(c=b.getEventSource(),t.set(c,"position","relative"),t.set(c.parentNode,
"position","relative"));f=this._getDrawingToolShape(a,f)||E.getShapeDescriptors(a);var h;try{h=b.createShape(r||f.defaultShape).setFill(f.fill).setStroke(f.stroke)}catch(p){b.clear();b.destroy();return}var s=h.getBoundingBox();r=s.width;f=s.height;var n=-(s.x+r/2),A=-(s.y+f/2);c=b.getDimensions();n={dx:n+c.width/2,dy:A+c.height/2};if("simplemarkersymbol"===a.type&&"path"===a.style)d=l._getScaleMatrix(s,a.size),h.applyTransform(w.scaleAt(d.xx,d.yy,{x:c.width/2,y:c.height/2}));else if(r>d||f>e)l=r/
d>f/e,d=((l?d:e)-5)/(l?r:f),q.mixin(n,{xx:d,yy:d});h.applyTransform(n);return b},_getDrawingToolShape:function(b,a){var c;switch(a?a.drawingTool||null:null){case "esriFeatureEditToolArrow":c={type:"path",path:"M 10,1 L 3,8 L 3,5 L -15,5 L -15,-2 L 3,-2 L 3,-5 L 10,1 E"};break;case "esriFeatureEditToolTriangle":c={type:"path",path:"M -10,14 L 2,-10 L 14,14 L -10,14 E"};break;case "esriFeatureEditToolRectangle":c={type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 E"};break;case "esriFeatureEditToolCircle":c=
{type:"circle",cx:0,cy:0,r:10};break;case "esriFeatureEditToolEllipse":c={type:"ellipse",cx:0,cy:0,rx:10,ry:5};break;default:return null}return{defaultShape:c,fill:b.getFill(),stroke:b.getStroke()}},_repaintItems:function(){h.forEach(this._surfaceItems,function(b){this._repaint(b)},this)},_repaint:function(b){if(b){b.getStroke&&b.setStroke&&b.setStroke(b.getStroke());try{b.getFill&&b.setFill&&b.setFill(b.getFill())}catch(a){}b.children&&q.isArray(b.children)&&h.forEach(b.children,this._repaint,this)}},
_createHoverAction:function(b,c,g){var e=c._hoverLabel||c._hoverLabels[g.id];e&&(c.mouseMoveHandler=c.mouseMoveHandler||{},c.mouseMoveHandler[g.id]=d.connect(b,"onmousemove",q.hitch(this,function(b,c){this.mouseX=c.clientX;this.mouseY=c.clientY;this.hoverLabelShowing&&(this.hoverLabelShowing=!1,t.set(f.byId(this.id+"_hoverLabel"),"display","none"));setTimeout(q.hitch(this,function(b,c,d){if(b==this.mouseX&&c==this.mouseY&&!this.hoverLabelShowing)if(this.hoverLabelShowing=!0,f.byId(this.id+"_hoverLabel")){var g=
f.byId(this.id+"_hoverLabel");g.innerHTML="\x3cspan\x3e"+d+"\x3c/span\x3e";t.set(g,"top",c+"px");t.set(g,"left",b+15+"px");t.set(g,"display","")}else a.create("div",{innerHTML:"\x3cspan\x3e"+d+"\x3c/span\x3e",id:this.id+"_hoverLabel","class":"esriLegendHoverLabel",style:{top:c+"px",left:b+15+"px"}},document.body)},c.clientX,c.clientY,b),500)},e)),c.mouseOutHandler=c.mouseOutHandler||{},c.mouseOutHandler[g.id]=d.connect(b,"onmouseout",q.hitch(this,function(b){this.mouseY=this.mouseX=-1;this.hoverLabelShowing&&
(this.hoverLabelShowing=!1,t.set(f.byId(this.id+"_hoverLabel"),"display","none"))})))},_removeHoverHandlers:function(){var b;h.forEach(this.layers,function(a){if(a.mouseMoveHandler)for(b in a.mouseMoveHandler)d.disconnect(a.mouseMoveHandler[b]);if(a.mouseOutHandler)for(b in a.mouseOutHandler)d.disconnect(a.mouseOutHandler[b])})},_createDynamicLayers:function(b){var a=[],c;h.forEach(b.dynamicLayerInfos||b.layerInfos,function(d){c={id:d.id};c.source=d.source&&d.source.toJson();var e;b.layerDefinitions&&
b.layerDefinitions[d.id]&&(e=b.layerDefinitions[d.id]);e&&(c.definitionExpression=e);var f;b.layerDrawingOptions&&b.layerDrawingOptions[d.id]&&(f=b.layerDrawingOptions[d.id]);f&&(c.drawingInfo=f.toJson());c.minScale=d.minScale||0;c.maxScale=d.maxScale||0;a.push(c)});return a},_getTemplateFromTypes:function(b,a){var c;for(c=0;c<b.length;c++)if(b[c].id==a&&b[c].templates&&0<b[c].templates.length)return b[c].templates[0];return null},_findParentGroup:function(b,a,c){var d,e=a.dynamicLayerInfos||a.layerInfos;
for(d=0;d<e.length;d++)if(c==e[d].id){-1<e[d].parentLayerId&&(t.set(f.byId(this.id+"_"+b+"_"+e[d].parentLayerId+"_group"),"display","block"),this._findParentGroup(b,a,e[d].parentLayerId));break}},_addSubLayersToHide:function(b){function a(c,d){var e=b.layer.dynamicLayerInfos||b.layer.layerInfos,f,l;for(f=0;f<e.length;f++)if(e[f].id===c&&e[f].subLayerIds)for(l=0;l<e[f].subLayerIds.length;l++){var k=e[f].subLayerIds[l];-1===h.indexOf(d,k)&&(d.push(k),a(k,d))}}b.layer.layerInfos&&h.forEach(b.layer._hideLayersInLegend,
function(c){a(c,b.layer._hideLayersInLegend)})},_isLayerInScale:function(b,a,c){var d,e=!0;if(b.legendResponse&&b.legendResponse.layers)for(d=0;d<b.legendResponse.layers.length;d++){var f=b.legendResponse.layers[d];if(a.id==f.layerId){var l,k;!b.minScale&&0!==b.minScale||!b.maxScale&&0!==b.maxScale?(0==f.minScale&&b.tileInfo&&(l=b.tileInfo.lods[0].scale),0==f.maxScale&&b.tileInfo&&(k=b.tileInfo.lods[b.tileInfo.lods.length-1].scale)):(l=Math.min(b.minScale,f.minScale)||b.minScale||f.minScale,k=Math.max(b.maxScale,
f.maxScale));if(0<l&&l<c||k>c)e=!1;break}}else if(b.minScale||b.maxScale)if(b.minScale&&b.minScale<c||b.maxScale&&b.maxScale>c)e=!1;return e},_getServiceTitle:function(b){var a=b._titleForLegend;a||((a=b.url)?-1<b.url.indexOf("/MapServer")?(a=b.url.substring(0,b.url.indexOf("/MapServer")),a=a.substring(a.lastIndexOf("/")+1,a.length)):-1<b.url.indexOf("/ImageServer")?(a=b.url.substring(0,b.url.indexOf("/ImageServer")),a=a.substring(a.lastIndexOf("/")+1,a.length)):-1<b.url.indexOf("/FeatureServer")&&
(a=b.url.substring(0,b.url.indexOf("/FeatureServer")),a=a.substring(a.lastIndexOf("/")+1,a.length)):a="",b.name&&(a=0<a.length?a+(" - "+b.name):b.name));return F.encode(a)},_getEffectiveScale:function(b,a){var c=a.minScale,d=a.maxScale;if(A.isDefined(a.parentLayerId)){var e=b.layerInfos,f=a.parentLayerId,l;for(l=e.length-1;0<=l;l--)if(e[l].id==f)if(0==c&&0<e[l].minScale?c=e[l].minScale:0<c&&0==e[l].minScale||0<c&&0<e[l].minScale&&(c=Math.min(c,e[l].minScale)),d=Math.max(d||0,e[l].maxScale||0),-1<
e[l].parentLayerId)f=e[l].parentLayerId;else break}return{minScale:c,maxScale:d}},_isSupportedLayerType:function(b){return b&&("esri.layers.ArcGISDynamicMapServiceLayer"===b.declaredClass||"esri.layers.ArcGISImageServiceLayer"===b.declaredClass&&10.2<=b.version||"esri.layers.ArcGISTiledMapServiceLayer"===b.declaredClass||"esri.layers.FeatureLayer"===b.declaredClass||"esri.layers.StreamLayer"===b.declaredClass||"esri.layers.KMLLayer"===b.declaredClass||"esri.layers.GeoRSSLayer"===b.declaredClass||
"esri.layers.WMSLayer"===b.declaredClass||"esri.layers.CSVLayer"===b.declaredClass)?!0:!1}});q.mixin(C,{ALIGN_LEFT:0,ALIGN_RIGHT:1});return C})},"dojox/html/entities":function(){define(["dojo/_base/lang"],function(v){var s=v.getObject("dojox.html.entities",!0),q=function(d,e){var h,k;if(e._encCache&&e._encCache.regexp&&e._encCache.mapper&&e.length==e._encCache.length)h=e._encCache.mapper,k=e._encCache.regexp;else{h={};k=["["];var p;for(p=0;p<e.length;p++)h[e[p][0]]="\x26"+e[p][1]+";",k.push(e[p][0]);
k.push("]");k=RegExp(k.join(""),"g");e._encCache={mapper:h,regexp:k,length:e.length}}return d=d.replace(k,function(c){return h[c]})},h=function(d,e){var h,k;if(e._decCache&&e._decCache.regexp&&e._decCache.mapper&&e.length==e._decCache.length)h=e._decCache.mapper,k=e._decCache.regexp;else{h={};k=["("];var p;for(p=0;p<e.length;p++){var c="\x26"+e[p][1]+";";p&&k.push("|");h[c]=e[p][0];k.push(c)}k.push(")");k=RegExp(k.join(""),"g");e._decCache={mapper:h,regexp:k,length:e.length}}return d=d.replace(k,
function(c){return h[c]})};s.html=[["\x26","amp"],['"',"quot"],["\x3c","lt"],["\x3e","gt"],["\u00a0","nbsp"]];s.latin=[["\u00a1","iexcl"],["\u00a2","cent"],["\u00a3","pound"],["\u20ac","euro"],["\u00a4","curren"],["\u00a5","yen"],["\u00a6","brvbar"],["\u00a7","sect"],["\u00a8","uml"],["\u00a9","copy"],["\u00aa","ordf"],["\u00ab","laquo"],["\u00ac","not"],["\u00ad","shy"],["\u00ae","reg"],["\u00af","macr"],["\u00b0","deg"],["\u00b1","plusmn"],["\u00b2","sup2"],["\u00b3","sup3"],["\u00b4","acute"],
["\u00b5","micro"],["\u00b6","para"],["\u00b7","middot"],["\u00b8","cedil"],["\u00b9","sup1"],["\u00ba","ordm"],["\u00bb","raquo"],["\u00bc","frac14"],["\u00bd","frac12"],["\u00be","frac34"],["\u00bf","iquest"],["\u00c0","Agrave"],["\u00c1","Aacute"],["\u00c2","Acirc"],["\u00c3","Atilde"],["\u00c4","Auml"],["\u00c5","Aring"],["\u00c6","AElig"],["\u00c7","Ccedil"],["\u00c8","Egrave"],["\u00c9","Eacute"],["\u00ca","Ecirc"],["\u00cb","Euml"],["\u00cc","Igrave"],["\u00cd","Iacute"],["\u00ce","Icirc"],
["\u00cf","Iuml"],["\u00d0","ETH"],["\u00d1","Ntilde"],["\u00d2","Ograve"],["\u00d3","Oacute"],["\u00d4","Ocirc"],["\u00d5","Otilde"],["\u00d6","Ouml"],["\u00d7","times"],["\u00d8","Oslash"],["\u00d9","Ugrave"],["\u00da","Uacute"],["\u00db","Ucirc"],["\u00dc","Uuml"],["\u00dd","Yacute"],["\u00de","THORN"],["\u00df","szlig"],["\u00e0","agrave"],["\u00e1","aacute"],["\u00e2","acirc"],["\u00e3","atilde"],["\u00e4","auml"],["\u00e5","aring"],["\u00e6","aelig"],["\u00e7","ccedil"],["\u00e8","egrave"],
["\u00e9","eacute"],["\u00ea","ecirc"],["\u00eb","euml"],["\u00ec","igrave"],["\u00ed","iacute"],["\u00ee","icirc"],["\u00ef","iuml"],["\u00f0","eth"],["\u00f1","ntilde"],["\u00f2","ograve"],["\u00f3","oacute"],["\u00f4","ocirc"],["\u00f5","otilde"],["\u00f6","ouml"],["\u00f7","divide"],["\u00f8","oslash"],["\u00f9","ugrave"],["\u00fa","uacute"],["\u00fb","ucirc"],["\u00fc","uuml"],["\u00fd","yacute"],["\u00fe","thorn"],["\u00ff","yuml"],["\u0192","fnof"],["\u0391","Alpha"],["\u0392","Beta"],["\u0393",
"Gamma"],["\u0394","Delta"],["\u0395","Epsilon"],["\u0396","Zeta"],["\u0397","Eta"],["\u0398","Theta"],["\u0399","Iota"],["\u039a","Kappa"],["\u039b","Lambda"],["\u039c","Mu"],["\u039d","Nu"],["\u039e","Xi"],["\u039f","Omicron"],["\u03a0","Pi"],["\u03a1","Rho"],["\u03a3","Sigma"],["\u03a4","Tau"],["\u03a5","Upsilon"],["\u03a6","Phi"],["\u03a7","Chi"],["\u03a8","Psi"],["\u03a9","Omega"],["\u03b1","alpha"],["\u03b2","beta"],["\u03b3","gamma"],["\u03b4","delta"],["\u03b5","epsilon"],["\u03b6","zeta"],
["\u03b7","eta"],["\u03b8","theta"],["\u03b9","iota"],["\u03ba","kappa"],["\u03bb","lambda"],["\u03bc","mu"],["\u03bd","nu"],["\u03be","xi"],["\u03bf","omicron"],["\u03c0","pi"],["\u03c1","rho"],["\u03c2","sigmaf"],["\u03c3","sigma"],["\u03c4","tau"],["\u03c5","upsilon"],["\u03c6","phi"],["\u03c7","chi"],["\u03c8","psi"],["\u03c9","omega"],["\u03d1","thetasym"],["\u03d2","upsih"],["\u03d6","piv"],["\u2022","bull"],["\u2026","hellip"],["\u2032","prime"],["\u2033","Prime"],["\u203e","oline"],["\u2044",
"frasl"],["\u2118","weierp"],["\u2111","image"],["\u211c","real"],["\u2122","trade"],["\u2135","alefsym"],["\u2190","larr"],["\u2191","uarr"],["\u2192","rarr"],["\u2193","darr"],["\u2194","harr"],["\u21b5","crarr"],["\u21d0","lArr"],["\u21d1","uArr"],["\u21d2","rArr"],["\u21d3","dArr"],["\u21d4","hArr"],["\u2200","forall"],["\u2202","part"],["\u2203","exist"],["\u2205","empty"],["\u2207","nabla"],["\u2208","isin"],["\u2209","notin"],["\u220b","ni"],["\u220f","prod"],["\u2211","sum"],["\u2212","minus"],
["\u2217","lowast"],["\u221a","radic"],["\u221d","prop"],["\u221e","infin"],["\u2220","ang"],["\u2227","and"],["\u2228","or"],["\u2229","cap"],["\u222a","cup"],["\u222b","int"],["\u2234","there4"],["\u223c","sim"],["\u2245","cong"],["\u2248","asymp"],["\u2260","ne"],["\u2261","equiv"],["\u2264","le"],["\u2265","ge"],["\u2282","sub"],["\u2283","sup"],["\u2284","nsub"],["\u2286","sube"],["\u2287","supe"],["\u2295","oplus"],["\u2297","otimes"],["\u22a5","perp"],["\u22c5","sdot"],["\u2308","lceil"],["\u2309",
"rceil"],["\u230a","lfloor"],["\u230b","rfloor"],["\u2329","lang"],["\u232a","rang"],["\u25ca","loz"],["\u2660","spades"],["\u2663","clubs"],["\u2665","hearts"],["\u2666","diams"],["\u0152","OElig"],["\u0153","oelig"],["\u0160","Scaron"],["\u0161","scaron"],["\u0178","Yuml"],["\u02c6","circ"],["\u02dc","tilde"],["\u2002","ensp"],["\u2003","emsp"],["\u2009","thinsp"],["\u200c","zwnj"],["\u200d","zwj"],["\u200e","lrm"],["\u200f","rlm"],["\u2013","ndash"],["\u2014","mdash"],["\u2018","lsquo"],["\u2019",
"rsquo"],["\u201a","sbquo"],["\u201c","ldquo"],["\u201d","rdquo"],["\u201e","bdquo"],["\u2020","dagger"],["\u2021","Dagger"],["\u2030","permil"],["\u2039","lsaquo"],["\u203a","rsaquo"]];s.encode=function(d,e){d&&(e?d=q(d,e):(d=q(d,s.html),d=q(d,s.latin)));return d};s.decode=function(d,e){d&&(e?d=h(d,e):(d=h(d,s.html),d=h(d,s.latin)));return d};return s})},"esri/renderers/ScaleDependentRenderer":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./Renderer"],function(v,
s,q,h,d){return v(d,{declaredClass:"esri.renderer.ScaleDependentRenderer",constructor:function(d){this.setRendererInfos(d&&d.rendererInfos||[])},setRendererInfos:function(d){this.rendererInfos=d;this._setRangeType();return this},getSymbol:function(d){var h=this.getRendererInfo(d);return h&&h.renderer.getSymbol(d)},getRendererInfo:function(d){d=d.getLayer().getMap();return"zoom"===this.rangeType?this.getRendererInfoByZoom(d.getZoom()):this.getRendererInfoByScale(d.getScale())},getRendererInfoByZoom:function(d){var h,
k=this.rendererInfos,p,c=0;do h=k[c],d>=h.minZoom&&d<=h.maxZoom&&(p=h),c++;while(!p&&c<k.length);return p},getRendererInfoByScale:function(d){var h,k=this.rendererInfos,p,c=0,r,l,f,a;do h=k[c],r=h.minScale,l=h.maxScale,f=!r,a=!l,!f&&d<=r&&(f=!0),!a&&d>=l&&(a=!0),f&&a&&(p=h),c++;while(!p&&c<k.length);return p},addRendererInfo:function(d){var h,k=0,p,c=this.rendererInfos,r=d.hasOwnProperty("minZoom")?"minZoom":"minScale",l=c.length;do{p=c[k];if(l===k||d[r]<p[r])c.splice(k,0,d),this._setRangeType(),
h=!0;k++}while(!h&&k<l);return this},_setRangeType:function(){var d=this.rendererInfos;if(d=d&&d[0])this.rangeType=d.hasOwnProperty("minZoom")?"zoom":d.hasOwnProperty("minScale")?"scale":""},toJson:function(){}})})},"esri/renderers/DotDensityRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/has ../kernel ./Renderer ../symbols/PictureFillSymbol ../geometry/ScreenPoint ../geometry/Point".split(" "),function(v,s,q,h,d,e,u,k,p){return v(e,{declaredClass:"esri.renderer.DotDensityRenderer",
constructor:function(c){this.dotSize=c.dotSize||3;this.dotValue=c.dotValue;this.fields=c.fields;this.outline=c.outline;this.backgroundColor=c.backgroundColor;this.exactCount=c.exactCount||!0;this.dotShape=c.dotShape||"square";this.legendOptions=c.legendOptions;this._exactCountMinArea=1E4;this._currentMapScale=this._map=this._canvas=null;this._symbolMap={};this._currentGraphic=this._currentResolution=this._objectIdField=null;this._supportsCanvas=window.CanvasRenderingContext2D?!0:!1;window.CanvasRenderingContext2D||
console.log("The DotDensityRenderer requires a Canvas enabled Browser.  IE8 and less does not support Canvas.")},getSymbol:function(c){var d,e;this._currentGraphic=c;if(!this._supportsCanvas)return null;this._map||(this._map=c.getLayer()._map,this._objectIdField=c.getLayer().objectIdField,this._currentMapScale=this._map.getScale(),this._currentResolution=this._map.extent.getWidth()/this._map.width,this._map.on("zoom-end",s.hitch(this,function(c){this._currentMapScale=this._map.getScale();this._currentResolution=
c.extent.getWidth()/this._map.width;this._symbolMap[this._currentMapScale]={}})));if(this._symbolMap[this._currentMapScale]&&this._symbolMap[this._currentMapScale][c.attributes[this._objectIdField]])return d=this._symbolMap[this._currentMapScale][c.attributes[this._objectIdField]],e=this._getShapeProperties(c),d.setOffset(e.dx,e.dy),d;d=this._generateFieldsCount(this.fields,c.attributes,this.dotValue);e=this._getShapeProperties(c);d=new u(this._generateImageSrc(e.width,e.height,d,e.minXY,e.maxXY),
this.outline,e.width,e.height);d.setOffset(e.dx,e.dy);this._symbolMap[this._currentMapScale]||(this._symbolMap[this._currentMapScale]={});return this._symbolMap[this._currentMapScale][c.attributes[this._objectIdField]]=d},_generateFieldsCount:function(c,d,e){var f,a;for(a=c.length-1;0<=a;a--)f=d[c[a].name]/e,c[a].numPoints=Math.round(f);return c},_getShapeProperties:function(c){var d,e,f,a;d=c.geometry.getExtent();d.contains(this._map.extent)&&(d=this._map.extent);f=Math.ceil(d.getWidth()/this._currentResolution);
a=Math.ceil(d.getHeight()/this._currentResolution);e=this._map.toScreen(new p(d.xmin,d.ymin,d.spatialReference));d=this._map.toScreen(new p(d.xmax,d.ymax,d.spatialReference));c=c.getLayer().getNode().getCTM();return{minXY:e,maxXY:d,dx:(e.x-c.e)%f,dy:(d.y-c.f)%a,width:f,height:a}},_generateImageSrc:function(c,d,e,f,a,h){var k=this.dotSize,p,q,s;this._canvas?(this._canvas.width=c,this._canvas.height=d):this._canvas=this._initCanvas(c,d);p=this._canvas.getContext("2d");if(h=h||this.backgroundColor)p.fillStyle=
h.toCss(!0),p.fillRect(0,0,c,d),p.fill();for(h=e.length-1;0<=h;h--){p.fillStyle=e[h].color.toCss(!0);for(q=e[h].numPoints-1;0<=q;q--)s=this._getRandomPoint(c,d,f,a),"square"===this.dotShape?p.fillRect(s.x,s.y,k,k):"circle"===this.dotShape&&(p.beginPath(),p.arc(s.x,s.y,k/2,0,2*Math.PI,!0)),p.fill()}return this._canvas.toDataURL()},_initCanvas:function(c,d){var e=q.create("canvas",{id:"canvas",width:c+"px",height:d+"px",style:"position: absolute; left: -10000px; top: 0px;"},null);document.body.appendChild(e);
return e},_getRandomInt:function(c,d){return Math.floor(Math.random()*(d-c+1)+c)},_getRandomPoint:function(c,d,e,f){var a={},h=this.outline&&this.outline.width?this.outline.width:0;if(!0===this.exactCount&&c*d>this._exactCountMinArea){do a.x=this._getRandomInt(e.x,f.x),a.y=this._getRandomInt(f.y,e.y),c=new k(a.x,a.y),c=this._checkPointShapeBounds(c,this.dotSize+h,this._currentGraphic.geometry),!0===c&&(a.x-=e.x,a.y-=f.y);while(!1===c)}else a.x=this._getRandomInt(0,c),a.y=this._getRandomInt(0,d);return a},
_checkPointShapeBounds:function(c,d,e){var f=null,f=!1,a=!0,h=0;do{switch(h){case 1:c.x+=d;break;case 2:c.y+=d;break;case 3:c.x-=d}f=this._map.toMap(c);f=e.contains(f);!1===f&&(a=!1);h+=1}while(3>=h&&!0===a);return f},setDotSize:function(c){0<c&&(this.dotSize=c)},setDotValue:function(c){0<c&&(this.dotValue=c)},setOutline:function(c){this.outline=c},setBackgroundColor:function(c){this.backgroundColor=c},toJson:function(){}})})},"widgets/LayerList/_build-generate_module":function(){define(["dojo/text!./Widget.html",
"dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:widgets/LayerList/PopupMenu.html":'\x3cdiv\x3e\n  \x3cdiv class\x3d"popup-menu-transparency-body" data-dojo-attach-point\x3d"transparencyDiv" data-dojo-attach-event\x3d"onclick:_onTransparencyDivClick" \x3e\n    \x3cdiv class\x3d"label"\x3e\n      \x3cdiv class\x3d"label-left"\x3e${nls.itemOpaque}\x3c/div\x3e\n      \x3cdiv class\x3d"label-right"\x3e${nls.itemTransparent}\x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"transparencyBody"\x3e \n      \x3col data-dojo-attach-point\x3d"transparencyRule" class\x3d"transparency-rule"\x3e \x3c/ol\x3e\n    \x3c/div\x3e\n  \x3c/div\x3e\n\x3cdiv\x3e\n',
"url:widgets/LayerList/LayerListView.html":'\n\n\x3ctable class\x3d"layer-list-table"\x3e\n  \x3ctbody class\x3d"layers-list-body" data-dojo-attach-point\x3d"layerListTable"\x3e\x3c/tbody\x3e      \n\x3c/table\x3e\n',"url:widgets/LayerList/Widget.html":'\x3cdiv\x3e\n  \x3cdiv class\x3d"layers-section" data-dojo-attach-point\x3d"layersSection"\x3e\n    \x3cdiv class\x3d" layer-list-title"\x3e${nls.titleLayers}\x3c/div\x3e\n    \x3cdiv class\x3d"layer-list-body" data-dojo-attach-point\x3d"layerListBody"\x3e\n    \x3c/div\x3e\n  \x3c/div\x3e\n\x3c/div\x3e\n',
"url:widgets/LayerList/css/style.css":".jimu-widget-layerList{position: relative;}.jimu-widget-layerList .jimu-hr{margin-top: 15px;}.jimu-widget-layerList .layers-section{margin-top: 0px;}.jimu-widget-layerList .layers-section .layers-list{width: 100%;}.jimu-widget-layerList .layers-section .layer-list-title{height: 16px; font-size: 14px; color: #86909c; margin-top: 14px;}.jimu-widget-layerList .layer-list-body {}.jimu-widget-layerList .layer-list-table{width: 100%; border-spacing: 0px;}.jimu-widget-layerList .layers-list-body{border: 0px solid #999;}.jimu-widget-layerList .jimu-widget-row{}.jimu-widget-layerList .layer-row{background-color: #ffffff; height: 40px; cursor: pointer;}.jimu-widget-layerList .layer-row-mouseover{background-color: #e3ecf2;}.jimu-widget-layerList .jimu-widget-row-selected{background-color: #d9dde0;;}.jimu-widget-layerList .jimu-widget-row-active{background-color: #009cff;}.jimu-widget-layerList .jimu-widget-row-selected .col-layer-label{color: #333;}.jimu-widget-layerList .jimu-widget-row-active .col-layer-label{color: #fff;}.jimu-widget-layerList .col{border: 0px solid #ffffff; border-bottom: 0px solid #ffffff;}.jimu-widget-layerList .col1{}.jimu-widget-layerList .col2{width: auto; word-break: break-word;}.jimu-widget-layerList .col3{width: 21px;}.jimu-widget-layerList .begin-blank-div{float: left; width: 12px; height: 2px;}.jimu-widget-layerList .col-showLegend{width: 17px; text-align: center;}.jimu-widget-layerList .showLegend-div{width: 13px; height: 13px; cursor: pointer; float: left; margin-right: 2px;}.jimu-widget-layerList .showLegend-image{position: relative; top: -1px; left: 3px;}.jimu-widget-layerList .layers-list-imageShowLegend-down{-moz-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -webkit-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -o-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); -ms-transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg); transform: scale(1) rotate(270deg) translateX(0px) translateY(0px) skewX(0deg) skewY(0deg);}.jimu-widget-layerList .layers-list-imageShowLegend-down-div{background-color: #d9dde0;}.jimu-widget-layerList .noLegend-div{float: left; width: 33px; text-align: right;}.jimu-widget-layerList .noLegend-image{}.jimu-widget-layerList .col-blank{width:17px;}.jimu-widget-layerList .col-select{width: 17px;}.jimu-widget-layerList .col-reserve-blank{width: 25px;}.jimu-widget-layerList .col-content{color: #686868; font-size: 12px;}.jimu-widget-layerList .div-select{float: left; position: relative;}.jimu-widget-layerList .div-content{float: left; position: relative; margin-left: 5px; color: #686868; font-size: 12px; border: 0px solid;}.jimu-widget-layerList .col-popupMenu{width: 17px; text-align: center;}.jimu-widget-layerList .col-select .jimu-selection-box{margin-top: 5px;}.jimu-widget-layerList .layers-list-body .col-layer-label{color: #686868;}.jimu-widget-layerList .layer-sub-node{display: none; width:100%; border-spacing: 0px;}.jimu-widget-layerList .legend-node-td{}.jimu-widget-layerList .legend-div{overflow: hidden;}.jimu-widget-layerList .legend-symbol{float: left;}.jimu-widget-layerList .legend-label{float: left; margin-top: 17px; color: #686868; font-size: 11px;}.jimu-widget-layerList .layers-list-popupMenu-div{position: relative; width: 13px; height: 13px; background-color: #d9dde0; cursor: pointer; border-radius: 2px; float: right; margin-right: 4px;}.jimu-widget-layerList .layers-list-popupMenu-div-selected{width: 13px; height: 13px; background-color: #ffffff; border-radius: 2px;}.jimu-widget-layerList .layers-list-popupMenu-image{position: absolute; top: 5px; left: 3px;}.jimu-widget-layerList .popup-menu-transparency-body {position: absolute; background-color: #d9dde0; outline-color:#ffffff; outline-style:solid; outline-width:1px; width:184px; height:50px; padding-left: 2%; padding-right: 2%; color: #686868; z-index: 2; font-size: 12px; display: none;}.jimu-widget-layerList .popup-menu-transparency-body .transparency-rule{}.jimu-widget-layerList .popup-menu-transparency-body .label {overflow: hidden; margin-top: 2px; margin-bottom: 1px;}.jimu-widget-layerList .popup-menu-transparency-body .label .label-left{float: left;}.jimu-widget-layerList .popup-menu-transparency-body .label .label-right{float: right;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn{width: 13px; height: 13px; min-height: 13px; min-width: 13px; border-radius: 2px;}.jimu-widget-layerList .jimu-dropmenu .jimu-icon-btn-selected{background-color: #ffffff; border: 1px solid #ffffff;}.jimu-widget-layerList .jimu-dropmenu .drop-menu{outline-color:#ffffff; outline-style:solid; outline-width:1px; overflow:auto; color: #686868; font-size: 12px; z-index: 2; min-width: 119px;}.jimu-widget-layerList .jimu-dropmenu .menu-item{line-height: 25px; white-space: nowrap;}.jimu-widget-layerList .jimu-dropmenu .menu-item-dissable{color:#c1c1c1;}.jimu-widget-layerList .legends-loading-img{width: 30px; height: 30px;}.jimu-widget-layerList .jimu-dropmenu .menu-item .menu-item-description{text-decoration: none; color: inherit; display: block;}",
"url:widgets/LayerList/config.json":'{\n  "showLegend": true\n}\n',"*now":function(v){v(['dojo/i18n!*preload*widgets/LayerList/nls/Widget*["ar","cs","da","de","en","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","ROOT"]'])}}});
define("jimu/BaseWidget dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-geometry dojo/dom dojo/on dojo/_base/unload dojo/aspect dojo/query jimu/dijit/Selectionbox ./LayerListView ./PopupMenu dojo/dom-style ./NlsStrings jimu/LayerInfos/LayerInfoFactory jimu/LayerInfos/LayerInfos dojo/promise/all".split(" "),function(v,s,q,h,d,e,u,k,p,c,r,l,f,a,t,B,x,w,F){return s([v],{baseClass:"jimu-widget-layerList",name:"layerList",layerListView:null,operLayerInfos:null,startup:function(){B.value=
this.nls;if(this.map.itemId)w.getInstance(this.map,this.map.itemInfo).then(q.hitch(this,function(a){this.operLayerInfos=a;this.showLayers();this.own(k(this.operLayerInfos,"layerInfosChanged",q.hitch(this,this._onLayerInfosChanged)));u.setSelectable(this.layersSection,!1)}));else{var a=this._obtainMapLayers();w.getInstance(this.map,a).then(q.hitch(this,function(a){this.operLayerInfos=a;this.showLayers();this.own(k(this.operLayerInfos,"layerInfosChanged",q.hitch(this,this._onLayerInfosChanged)));u.setSelectable(this.layersSection,
!1)}))}},destroy:function(){this._clearLayers();this.inherited(arguments)},_obtainMapLayers:function(){var a=[],c=[],d={itemData:{baseMap:{baseMapLayers:[]},operationalLayers:[]}};h.forEach(this.map.graphicsLayerIds,function(a){a=this.map.getLayer(a);a.isOperationalLayer&&c.push({layerObject:a,title:a.label||a.title||a.name||a.id||" ",id:a.id||" "})},this);h.forEach(this.map.layerIds,function(d){d=this.map.getLayer(d);d.isOperationalLayer?c.push({layerObject:d,title:d.label||d.title||d.name||d.id||
" ",id:d.id||" "}):a.push({layerObject:d,id:d.id||" "})},this);d.itemData.baseMap.baseMapLayers=a;d.itemData.operationalLayers=c;return d},_layerFilter:function(a,c,d){a=this.map.getLayer(a);a.isOperationalLayer?d.push({layerObject:a,title:a.label||a.title||a.name||a.id||" ",id:a.id||" "}):c.push({layerObject:a,id:a.id||" "})},showLayers:function(){this.layerListView=(new f({operLayerInfos:this.operLayerInfos,layerListWidget:this,config:this.config})).placeAt(this.layerListBody)},_createPopupMenu:function(){this.popupMenu=
new a({layerListWidget:this});d.place(this.popupMenu.domNode,this.domNode)},_clearLayers:function(){this.layerListView&&this.layerListView.destroyRecursive&&this.layerListView.destroyRecursive()},flag:!0,bindEvents:function(){var a;this.own(k(this.map,"layer-add-result",q.hitch(this,this._onLayersChange)));a=k(this.map,"layer-remove",q.hitch(this,this._onLayersChange));this.own(a);p.addOnUnload(function(){a.remove();(void 0).remove()})},_onLayersChange:function(a){"esri.layers.GraphicsLayer"!==a.layer.declaredClass&&
(this.operLayerInfos.update(),this._clearLayers(),this.showLayers())},_onLayerInfosChanged:function(a,c){this._clearLayers();this.showLayers()}})});