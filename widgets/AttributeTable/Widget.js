//>>built
require({cache:{"dijit/layout/TabContainer":function(){define(["dojo/_base/lang","dojo/_base/declare","./_TabContainerBase","./TabController","./ScrollingTabController"],function(h,k,p,n,g){return k("dijit.layout.TabContainer",p,{useMenu:!0,useSlider:!0,controllerWidget:"",_makeController:function(g){var k=this.baseClass+"-tabs"+(this.doLayout?"":" dijitTabNoLayout");return new ("string"==typeof this.controllerWidget?h.getObject(this.controllerWidget):this.controllerWidget)({id:this.id+"_tablist",
ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,tabPosition:this.tabPosition,doLayout:this.doLayout,containerId:this.id,"class":k,nested:this.nested,useMenu:this.useMenu,useSlider:this.useSlider,tabStripClass:this.tabStrip?this.baseClass+(this.tabStrip?"":"No")+"Strip":null},g)},postMixInProperties:function(){this.inherited(arguments);this.controllerWidget||(this.controllerWidget=("top"==this.tabPosition||"bottom"==this.tabPosition)&&!this.nested?g:n)}})})},"dijit/layout/_TabContainerBase":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style ./StackContainer ./utils ../registry ../_TemplatedMixin dojo/text!./templates/TabContainer.html".split(" "),
function(h,k,p,n,g,r,u,f,q){return h("dijit.layout._TabContainerBase",[g,f],{tabPosition:"top",baseClass:"dijitTabContainer",tabStrip:!1,nested:!1,templateString:q,postMixInProperties:function(){this.baseClass+=this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"");this.srcNodeRef&&n.set(this.srcNodeRef,"visibility","hidden");this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.tablist=this._makeController(this.tablistNode);this.doLayout||
k.add(this.domNode,"dijitTabContainerNoLayout");this.nested?(k.add(this.domNode,"dijitTabContainerNested"),k.add(this.tablist.containerNode,"dijitTabContainerTabListNested"),k.add(this.tablistSpacer,"dijitTabContainerSpacerNested"),k.add(this.containerNode,"dijitTabPaneWrapperNested")):k.add(this.domNode,"tabStrip-"+(this.tabStrip?"enabled":"disabled"))},_setupChild:function(e){k.add(e.domNode,"dijitTabPane");this.inherited(arguments)},startup:function(){this._started||(this.tablist.startup(),this.inherited(arguments))},
layout:function(){if(this._contentBox&&"undefined"!=typeof this._contentBox.l){var e=this.selectedChildWidget;if(this.doLayout){var f=this.tabPosition.replace(/-h/,"");this.tablist.region=f;f=[this.tablist,{domNode:this.tablistSpacer,region:f},{domNode:this.containerNode,region:"center"}];r.layoutChildren(this.domNode,this._contentBox,f);this._containerContentBox=r.marginBox2contentBox(this.containerNode,f[2]);e&&e.resize&&e.resize(this._containerContentBox)}else{if(this.tablist.resize){f=this.tablist.domNode.style;
f.width="0";var d=p.getContentBox(this.domNode).w;f.width="";this.tablist.resize({w:d})}e&&e.resize&&e.resize()}}},destroy:function(e){this.tablist&&this.tablist.destroy(e);this.inherited(arguments)},selectChild:function(e,f){this._focused&&(e=u.byId(e),this.tablist.pane2button(e.id).focus());return this.inherited(arguments)}})})},"dijit/layout/StackContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/ready dojo/topic dojo/when ../registry ../_WidgetBase ./_LayoutWidget".split(" "),
function(h,k,p,n,g,r,u,f,q,e,v,d,t,c){r("dijit-legacy-requires")&&q(0,function(){require(["dijit/layout/StackController"])});p=p("dijit.layout.StackContainer",c,{doLayout:!0,persist:!1,baseClass:"dijitStackContainer",buildRendering:function(){this.inherited(arguments);n.add(this.domNode,"dijitLayoutContainer")},postCreate:function(){this.inherited(arguments);this.own(f(this.domNode,"keydown",u.hitch(this,"_onKeyDown")))},startup:function(){if(!this._started){var a=this.getChildren();h.forEach(a,this._setupChild,
this);this.persist?this.selectedChildWidget=d.byId(k(this.id+"_selectedChild")):h.some(a,function(a){a.selected&&(this.selectedChildWidget=a);return a.selected},this);var b=this.selectedChildWidget;!b&&a[0]&&(b=this.selectedChildWidget=a[0],b.selected=!0);e.publish(this.id+"-startup",{children:a,selected:b,textDir:this.textDir});this.inherited(arguments)}},resize:function(){if(!this._hasBeenShown){this._hasBeenShown=!0;var a=this.selectedChildWidget;a&&this._showChild(a)}this.inherited(arguments)},
_setupChild:function(a){var b=a.domNode,l=g.place("\x3cdiv role\x3d'tabpanel' class\x3d'"+this.baseClass+"ChildWrapper dijitHidden'\x3e",a.domNode,"replace"),c=a["aria-label"]||a.title||a.label;c&&l.setAttribute("aria-label",c);g.place(b,l);a._wrapper=l;this.inherited(arguments);"none"==b.style.display&&(b.style.display="block");a.domNode.removeAttribute("title")},addChild:function(a,b){this.inherited(arguments);this._started&&(e.publish(this.id+"-addChild",a,b),this.layout(),this.selectedChildWidget||
this.selectChild(a))},removeChild:function(a){var b=h.indexOf(this.getChildren(),a);this.inherited(arguments);g.destroy(a._wrapper);delete a._wrapper;this._started&&e.publish(this.id+"-removeChild",a);if(!this._descendantsBeingDestroyed){if(this.selectedChildWidget===a&&(this.selectedChildWidget=void 0,this._started)){var l=this.getChildren();l.length&&this.selectChild(l[Math.max(b-1,0)])}this._started&&this.layout()}},selectChild:function(a,b){var l;a=d.byId(a);this.selectedChildWidget!=a&&(l=this._transition(a,
this.selectedChildWidget,b),this._set("selectedChildWidget",a),e.publish(this.id+"-selectChild",a),this.persist&&k(this.id+"_selectedChild",this.selectedChildWidget.id));return v(l||!0)},_transition:function(a,b){b&&this._hideChild(b);var l=this._showChild(a);a.resize&&(this.doLayout?a.resize(this._containerContentBox||this._contentBox):a.resize());return l},_adjacent:function(a){var b=this.getChildren(),l=h.indexOf(b,this.selectedChildWidget),l=l+(a?1:b.length-1);return b[l%b.length]},forward:function(){return this.selectChild(this._adjacent(!0),
!0)},back:function(){return this.selectChild(this._adjacent(!1),!0)},_onKeyDown:function(a){e.publish(this.id+"-containerKeyDown",{e:a,page:this})},layout:function(){var a=this.selectedChildWidget;a&&a.resize&&(this.doLayout?a.resize(this._containerContentBox||this._contentBox):a.resize())},_showChild:function(a){var b=this.getChildren();a.isFirstChild=a==b[0];a.isLastChild=a==b[b.length-1];a._set("selected",!0);a._wrapper&&n.replace(a._wrapper,"dijitVisible","dijitHidden");return a._onShow&&a._onShow()||
!0},_hideChild:function(a){a._set("selected",!1);a._wrapper&&n.replace(a._wrapper,"dijitHidden","dijitVisible");a.onHide&&a.onHide()},closeChild:function(a){a.onClose&&a.onClose(this,a)&&(this.removeChild(a),a.destroyRecursive())},destroyDescendants:function(a){this._descendantsBeingDestroyed=!0;this.selectedChildWidget=void 0;h.forEach(this.getChildren(),function(b){a||this.removeChild(b);b.destroyRecursive(a)},this);this._descendantsBeingDestroyed=!1}});p.ChildWidgetProperties={selected:!1,disabled:!1,
closable:!1,iconClass:"dijitNoIcon",showTitle:!0};u.extend(t,p.ChildWidgetProperties);return p})},"dijit/layout/TabController":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/has dojo/i18n dojo/_base/lang ./StackController ../registry ../Menu ../MenuItem dojo/text!./templates/_TabButton.html dojo/i18n!../nls/common".split(" "),function(h,k,p,n,g,r,u,f,q,e,v,d){d=h("dijit.layout._TabButton"+(g("dojo-bidi")?"_NoBidi":""),f.StackButton,{baseClass:"dijitTab",cssStateNodes:{closeNode:"dijitTabCloseButton"},
templateString:d,_setNameAttr:"focusNode",scrollOnFocus:!1,buildRendering:function(){this.inherited(arguments);k.setSelectable(this.containerNode,!1)},startup:function(){this.inherited(arguments);var d=this.domNode;this.defer(function(){d.className=d.className},1)},_setCloseButtonAttr:function(d){this._set("closeButton",d);n.toggle(this.domNode,"dijitClosable",d);this.closeNode.style.display=d?"":"none";d&&(d=r.getLocalization("dijit","common"),this.closeNode&&p.set(this.closeNode,"title",d.itemClose))},
_setDisabledAttr:function(d){this.inherited(arguments);if(this.closeNode)if(d)p.remove(this.closeNode,"title");else{var c=r.getLocalization("dijit","common");p.set(this.closeNode,"title",c.itemClose)}},_setLabelAttr:function(d){this.inherited(arguments);!this.showLabel&&!this.params.title&&(this.iconNode.alt=u.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});g("dojo-bidi")&&(d=h("dijit.layout._TabButton",d,{_setLabelAttr:function(d){this.inherited(arguments);this.applyTextDir(this.iconNode,
this.iconNode.alt)}}));h=h("dijit.layout.TabController",f,{baseClass:"dijitTabController",templateString:"\x3cdiv role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown:onkeydown'\x3e\x3c/div\x3e",tabPosition:"top",buttonWidget:d,buttonWidgetCloseClass:"dijitTabCloseButton",postCreate:function(){this.inherited(arguments);var d=new e({id:this.id+"_Menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,targetNodeIds:[this.domNode],selector:function(a){return n.contains(a,
"dijitClosable")&&!n.contains(a,"dijitTabDisabled")}});this.own(d);var c=r.getLocalization("dijit","common"),a=this;d.addChild(new v({label:c.itemClose,ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,onClick:function(b){b=q.byNode(this.getParent().currentTarget);a.onCloseButtonClick(b.page)}}))}});h.TabButton=d;return h})},"dijit/layout/StackController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/topic ../focus ../registry ../_Widget ../_TemplatedMixin ../_Container ../form/ToggleButton dojo/touch".split(" "),
function(h,k,p,n,g,r,u,f,q,e,v,d,t,c){n=k("dijit.layout._StackButton",c,{tabIndex:"-1",closeButton:!1,_aria_attr:"aria-selected",buildRendering:function(a){this.inherited(arguments);(this.focusNode||this.domNode).setAttribute("role","tab")}});k=k("dijit.layout.StackController",[v,d,t],{baseClass:"dijitStackController",templateString:"\x3cspan role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown'\x3e\x3c/span\x3e",containerId:"",buttonWidget:n,buttonWidgetCloseClass:"dijitStackCloseButton",pane2button:function(a){return e.byId(this.id+
"_"+a)},postCreate:function(){this.inherited(arguments);this.own(f.subscribe(this.containerId+"-startup",r.hitch(this,"onStartup")),f.subscribe(this.containerId+"-addChild",r.hitch(this,"onAddChild")),f.subscribe(this.containerId+"-removeChild",r.hitch(this,"onRemoveChild")),f.subscribe(this.containerId+"-selectChild",r.hitch(this,"onSelectChild")),f.subscribe(this.containerId+"-containerKeyDown",r.hitch(this,"onContainerKeyDown")));this.containerNode.dojoClick=!0;this.own(u(this.containerNode,"click",
r.hitch(this,function(a){var b=e.getEnclosingWidget(a.target);if(b!=this.containerNode&&!b.disabled&&b.page)for(a=a.target;a!==this.containerNode;a=a.parentNode)if(p.contains(a,this.buttonWidgetCloseClass)){this.onCloseButtonClick(b.page);break}else if(a==b.domNode){this.onButtonClick(b.page);break}})))},onStartup:function(a){this.textDir=a.textDir;h.forEach(a.children,this.onAddChild,this);if(a.selected)this.onSelectChild(a.selected);var b=e.byId(this.containerId).containerNode,l=r.hitch(this,"pane2button");
a={title:"label",showtitle:"showLabel",iconclass:"iconClass",closable:"closeButton",tooltip:"title",disabled:"disabled",textdir:"textdir"};var c=function(a,c){return u(b,"attrmodified-"+a,function(a){var b=l(a.detail&&a.detail.widget&&a.detail.widget.id);b&&b.set(c,a.detail.newValue)})},d;for(d in a)this.own(c(d,a[d]))},destroy:function(a){this.destroyDescendants(a);this.inherited(arguments)},onAddChild:function(a,b){var l=new (r.isString(this.buttonWidget)?r.getObject(this.buttonWidget):this.buttonWidget)({id:this.id+
"_"+a.id,name:this.id+"_"+a.id,label:a.title,disabled:a.disabled,ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||this.textDir,showLabel:a.showTitle,iconClass:a.iconClass,closeButton:a.closable,title:a.tooltip,page:a});this.addChild(l,b);a.controlButton=l;if(!this._currentChild)this.onSelectChild(a);l=a._wrapper.getAttribute("aria-labelledby")?a._wrapper.getAttribute("aria-labelledby")+" "+l.id:l.id;a._wrapper.removeAttribute("aria-label");a._wrapper.setAttribute("aria-labelledby",
l)},onRemoveChild:function(a){this._currentChild===a&&(this._currentChild=null);var b=this.pane2button(a.id);b&&(this.removeChild(b),b.destroy());delete a.controlButton},onSelectChild:function(a){if(a){if(this._currentChild){var b=this.pane2button(this._currentChild.id);b.set("checked",!1);b.focusNode.setAttribute("tabIndex","-1")}b=this.pane2button(a.id);b.set("checked",!0);this._currentChild=a;b.focusNode.setAttribute("tabIndex","0");e.byId(this.containerId)}},onButtonClick:function(a){var b=this.pane2button(a.id);
q.focus(b.focusNode);this._currentChild&&this._currentChild.id===a.id&&b.set("checked",!0);e.byId(this.containerId).selectChild(a)},onCloseButtonClick:function(a){e.byId(this.containerId).closeChild(a);this._currentChild&&(a=this.pane2button(this._currentChild.id))&&q.focus(a.focusNode||a.domNode)},adjacent:function(a){if(!this.isLeftToRight()&&(!this.tabPosition||/top|bottom/.test(this.tabPosition)))a=!a;var b=this.getChildren(),l=h.indexOf(b,this.pane2button(this._currentChild.id)),c=b[l],d;do l=
(l+(a?1:b.length-1))%b.length,d=b[l];while(d.disabled&&d!=c);return d},onkeydown:function(a,b){if(!this.disabled&&!a.altKey){var c=null;if(a.ctrlKey||!a._djpage){switch(a.keyCode){case g.LEFT_ARROW:case g.UP_ARROW:a._djpage||(c=!1);break;case g.PAGE_UP:a.ctrlKey&&(c=!1);break;case g.RIGHT_ARROW:case g.DOWN_ARROW:a._djpage||(c=!0);break;case g.PAGE_DOWN:a.ctrlKey&&(c=!0);break;case g.HOME:for(var d=this.getChildren(),e=0;e<d.length;e++){var t=d[e];if(!t.disabled){this.onButtonClick(t.page);break}}a.stopPropagation();
a.preventDefault();break;case g.END:d=this.getChildren();for(e=d.length-1;0<=e;e--)if(t=d[e],!t.disabled){this.onButtonClick(t.page);break}a.stopPropagation();a.preventDefault();break;case g.DELETE:case 87:if(this._currentChild.closable&&(a.keyCode==g.DELETE||a.ctrlKey))this.onCloseButtonClick(this._currentChild),a.stopPropagation(),a.preventDefault();break;case g.TAB:a.ctrlKey&&(this.onButtonClick(this.adjacent(!a.shiftKey).page),a.stopPropagation(),a.preventDefault())}null!==c&&(this.onButtonClick(this.adjacent(c).page),
a.stopPropagation(),a.preventDefault())}}},onContainerKeyDown:function(a){a.e._djpage=a.page;this.onkeydown(a.e)}});k.StackButton=n;return k})},"dijit/layout/ScrollingTabController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/_base/lang dojo/on dojo/query dojo/sniff ../registry dojo/text!./templates/ScrollingTabController.html dojo/text!./templates/_ScrollingTabControllerButton.html ./TabController ./utils ../_WidgetsInTemplateMixin ../Menu ../MenuItem ../form/Button ../_HasDropDown dojo/NodeList-dom ../a11yclick".split(" "),
function(h,k,p,n,g,r,u,f,q,e,v,d,t,c,a,b,l,K,w,s){d=k("dijit.layout.ScrollingTabController",[c,b],{baseClass:"dijitTabController dijitScrollingTabController",templateString:d,useMenu:!0,useSlider:!0,tabStripClass:"",_minScroll:5,_setClassAttr:{node:"containerNode",type:"class"},buildRendering:function(){this.inherited(arguments);var a=this.domNode;this.scrollNode=this.tablistWrapper;this._initButtons();this.tabStripClass||(this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+
this.tabPosition.substr(1).replace(/-.*/,"")+"None",p.add(a,"tabStrip-disabled"));p.add(this.tablistWrapper,this.tabStripClass)},onStartup:function(){this.inherited(arguments);g.set(this.domNode,"visibility","");this._postStartup=!0;this.own(f(this.containerNode,"attrmodified-label, attrmodified-iconclass",u.hitch(this,function(a){this._dim&&this.resize(this._dim)})))},onAddChild:function(a,b){this.inherited(arguments);g.set(this.containerNode,"width",g.get(this.containerNode,"width")+200+"px")},
onRemoveChild:function(a,b){var c=this.pane2button(a.id);this._selectedTab===c.domNode&&(this._selectedTab=null);this.inherited(arguments)},_initButtons:function(){this._btnWidth=0;this._buttons=q("\x3e .tabStripButton",this.domNode).filter(function(a){if(this.useMenu&&a==this._menuBtn.domNode||this.useSlider&&(a==this._rightBtn.domNode||a==this._leftBtn.domNode))return this._btnWidth+=n.getMarginSize(a).w,!0;g.set(a,"display","none");return!1},this)},_getTabsWidth:function(){var a=this.getChildren();
if(a.length){var b=a[this.isLeftToRight()?0:a.length-1].domNode,a=a[this.isLeftToRight()?a.length-1:0].domNode;return a.offsetLeft+a.offsetWidth-b.offsetLeft}return 0},_enableBtn:function(a){var b=this._getTabsWidth();a=a||g.get(this.scrollNode,"width");return 0<b&&a<b},resize:function(b){this._dim=b;this.scrollNode.style.height="auto";var c=this._contentBox=a.marginBox2contentBox(this.domNode,{h:0,w:b.w});c.h=this.scrollNode.offsetHeight;n.setContentSize(this.domNode,c);c=this._enableBtn(this._contentBox.w);
this._buttons.style("display",c?"":"none");this._leftBtn.region="left";this._rightBtn.region="right";this._menuBtn.region=this.isLeftToRight()?"right":"left";a.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,region:"center"}]);this._selectedTab&&(this._anim&&"playing"==this._anim.status()&&this._anim.stop(),this.scrollNode.scrollLeft=this._convertToScrollLeft(this._getScrollForSelectedTab()));this._setButtonClass(this._getScroll());
this._postResize=!0;return{h:this._contentBox.h,w:b.w}},_getScroll:function(){return this.isLeftToRight()||8>e("ie")||e("ie")&&e("quirks")||e("webkit")?this.scrollNode.scrollLeft:g.get(this.containerNode,"width")-g.get(this.scrollNode,"width")+(8<=e("ie")?-1:1)*this.scrollNode.scrollLeft},_convertToScrollLeft:function(a){if(this.isLeftToRight()||8>e("ie")||e("ie")&&e("quirks")||e("webkit"))return a;var b=g.get(this.containerNode,"width")-g.get(this.scrollNode,"width");return(8<=e("ie")?-1:1)*(a-b)},
onSelectChild:function(a){var b=this.pane2button(a.id);if(b){b=b.domNode;if(b!=this._selectedTab&&(this._selectedTab=b,this._postResize)){var c=this._getScroll();(c>b.offsetLeft||c+g.get(this.scrollNode,"width")<b.offsetLeft+g.get(b,"width"))&&this.createSmoothScroll().play()}this.inherited(arguments)}},_getScrollBounds:function(){var a=this.getChildren(),b=g.get(this.scrollNode,"width"),c=g.get(this.containerNode,"width")-b,d=this._getTabsWidth();if(a.length&&d>b)return{min:this.isLeftToRight()?
0:a[a.length-1].domNode.offsetLeft,max:this.isLeftToRight()?a[a.length-1].domNode.offsetLeft+a[a.length-1].domNode.offsetWidth-b:c};a=this.isLeftToRight()?0:c;return{min:a,max:a}},_getScrollForSelectedTab:function(){var a=this._selectedTab,b=g.get(this.scrollNode,"width"),c=this._getScrollBounds(),a=a.offsetLeft+g.get(a,"width")/2-b/2;return a=Math.min(Math.max(a,c.min),c.max)},createSmoothScroll:function(a){if(0<arguments.length){var b=this._getScrollBounds();a=Math.min(Math.max(a,b.min),b.max)}else a=
this._getScrollForSelectedTab();this._anim&&"playing"==this._anim.status()&&this._anim.stop();var c=this,d=this.scrollNode,l=new r.Animation({beforeBegin:function(){this.curve&&delete this.curve;var b=d.scrollLeft,e=c._convertToScrollLeft(a);l.curve=new r._Line(b,e)},onAnimate:function(a){d.scrollLeft=a}});this._anim=l;this._setButtonClass(a);return l},_getBtnNode:function(a){for(a=a.target;a&&!p.contains(a,"tabStripButton");)a=a.parentNode;return a},doSlideRight:function(a){this.doSlide(1,this._getBtnNode(a))},
doSlideLeft:function(a){this.doSlide(-1,this._getBtnNode(a))},doSlide:function(a,b){if(!b||!p.contains(b,"dijitTabDisabled")){var c=0.75*g.get(this.scrollNode,"width")*a,c=this._getScroll()+c;this._setButtonClass(c);this.createSmoothScroll(c).play()}},_setButtonClass:function(a){var b=this._getScrollBounds();this._leftBtn.set("disabled",a<=b.min);this._rightBtn.set("disabled",a>=b.max)}});t=k("dijit.layout._ScrollingTabControllerButtonMixin",null,{baseClass:"dijitTab tabStripButton",templateString:t,
tabIndex:"",isFocusable:function(){return!1}});k("dijit.layout._ScrollingTabControllerButton",[w,t]);k("dijit.layout._ScrollingTabControllerMenuButton",[w,s,t],{containerId:"",tabIndex:"-1",isLoaded:function(){return!1},loadDropDown:function(a){this.dropDown=new l({id:this.containerId+"_menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir});var b=v.byId(this.containerId);h.forEach(b.getChildren(),function(a){var c=new K({id:a.id+"_stcMi",label:a.title,iconClass:a.iconClass,
disabled:a.disabled,ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||b.textDir,onClick:function(){b.selectChild(a)}});this.dropDown.addChild(c)},this);a()},closeDropDown:function(a){this.inherited(arguments);this.dropDown&&(this._popupStateNode.removeAttribute("aria-owns"),this.dropDown.destroyRecursive(),delete this.dropDown)}});return d})},"dgrid/extensions/Pagination":function(){define("../_StoreMixin dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/_base/Deferred dojo/on dojo/query dojo/string dojo/has put-selector/put dojo/i18n!./nls/pagination dojo/_base/sniff xstyle/css!../css/extensions/Pagination.css".split(" "),
function(h,k,p,n,g,r,u,f,q,e,v){function d(c){c.noDataNode?(e(c.noDataNode,"!"),delete c.noDataNode):c.cleanup();c.contentNode.innerHTML=""}function t(c){if(c.loadingNode)e(c.loadingNode,"!"),delete c.loadingNode;else if(c._oldPageNodes){for(var a in c._oldPageNodes)c.removeRow(c._oldPageNodes[a]);delete c._oldPageNodes;c._oldPageObserver&&(c._oldPageObserver.cancel(),c._numObservers--,delete c._oldPageObserver)}delete c._isLoading}return k("dgrid.extensions.Pagination",h,{rowsPerPage:10,pagingTextBox:!1,
previousNextArrows:!0,firstLastArrows:!1,pagingLinks:2,pageSizeOptions:null,showLoadingMessage:!0,i18nPagination:v,showFooter:!0,_currentPage:1,_total:0,buildRendering:function(){this.inherited(arguments);var c=this,a=this.paginationNode=e(this.footerNode,"div.dgrid-pagination"),b=this.paginationStatusNode=e(a,"div.dgrid-status"),d=this.i18nPagination;b.tabIndex=0;this._updatePaginationSizeSelect();this._updateRowsPerPageOption();b.innerHTML=f.substitute(d.status,{start:1,end:1,total:0});a=this.paginationNavigationNode=
e(a,"div.dgrid-navigation");this.firstLastArrows&&(b=this.paginationFirstNode=e(a,"span.dgrid-first.dgrid-page-link","\u00ab"),b.setAttribute("aria-label",d.gotoFirst),b.tabIndex=0);this.previousNextArrows&&(b=this.paginationPreviousNode=e(a,"span.dgrid-previous.dgrid-page-link","\u2039"),b.setAttribute("aria-label",d.gotoPrev),b.tabIndex=0);this.paginationLinksNode=e(a,"span.dgrid-pagination-links");this.previousNextArrows&&(b=this.paginationNextNode=e(a,"span.dgrid-next.dgrid-page-link","\u203a"),
b.setAttribute("aria-label",d.gotoNext),b.tabIndex=0);this.firstLastArrows&&(b=this.paginationLastNode=e(a,"span.dgrid-last.dgrid-page-link","\u00bb"),b.setAttribute("aria-label",d.gotoLast),b.tabIndex=0);this._listeners.push(r(a,".dgrid-page-link:click,.dgrid-page-link:keydown",function(a){if(!("keydown"===a.type&&13!==a.keyCode)){a=this.className;var b,d;c._isLoading||-1<a.indexOf("dgrid-page-disabled")||(b=c._currentPage,d=Math.ceil(c._total/c.rowsPerPage),this===c.paginationPreviousNode?c.gotoPage(b-
1):this===c.paginationNextNode?c.gotoPage(b+1):this===c.paginationFirstNode?c.gotoPage(1):this===c.paginationLastNode?c.gotoPage(d):"dgrid-page-link"===a&&c.gotoPage(+this.innerHTML,!0))}}))},destroy:function(){this.inherited(arguments);this._pagingTextBoxHandle&&this._pagingTextBoxHandle.remove()},_updatePaginationSizeSelect:function(){var c=this.pageSizeOptions,a=this.paginationSizeSelect,b;if(c&&c.length){a||(a=this.paginationSizeSelect=e(this.paginationNode,"select.dgrid-page-size"),b=this._paginationSizeChangeHandle=
r(a,"change",n.hitch(this,function(){this.set("rowsPerPage",+this.paginationSizeSelect.value)})),this._listeners.push(b));for(i=a.options.length=0;i<c.length;i++)e(a,"option",c[i],{value:c[i],selected:this.rowsPerPage===c[i]});this._updateRowsPerPageOption()}else if((!c||!c.length)&&a)e(a,"!"),this.paginationSizeSelect=null,this._paginationSizeChangeHandle.remove()},_setPageSizeOptions:function(c){this.pageSizeOptions=c&&c.sort(function(a,b){return a-b});this._updatePaginationSizeSelect()},_updateRowsPerPageOption:function(){var c=
this.rowsPerPage,a=this.pageSizeOptions,b=this.paginationSizeSelect;b&&(0>p.indexOf(a,c)?this._setPageSizeOptions(a.concat([c])):b.value=""+c)},_setRowsPerPage:function(c){this.rowsPerPage=c;this._updateRowsPerPageOption();this.gotoPage(1)},_updateNavigation:function(c){function a(a,g){var s;b.pagingTextBox&&a==f&&1<k?(s=e(t,"input.dgrid-page-input[type\x3dtext][value\x3d$]",f),s.setAttribute("aria-label",d.jumpPage),b._pagingTextBoxHandle=r(s,"change",function(){var a=+this.value;!isNaN(a)&&(0<a&&
a<=k)&&b.gotoPage(+this.value,!0)})):(s=e(t,"span"+(a==f?".dgrid-page-disabled":"")+".dgrid-page-link",a+(g?" ":"")),s.setAttribute("aria-label",d.gotoPage),s.tabIndex=0);a==f&&c&&s.focus()}var b=this,d=this.i18nPagination,t=this.paginationLinksNode,f=this._currentPage,s=this.pagingLinks,g=this.paginationNavigationNode,k=Math.ceil(this._total/this.rowsPerPage),h=this._pagingTextBoxHandle;h&&h.remove();t.innerHTML="";u(".dgrid-first, .dgrid-previous",g).forEach(function(a){e(a,(1==f?".":"!")+"dgrid-page-disabled")});
u(".dgrid-last, .dgrid-next",g).forEach(function(a){e(a,(f>=k?".":"!")+"dgrid-page-disabled")});if(s&&0<k){a(1,!0);g=f-s;for(2<g?e(t,"span.dgrid-page-skip","..."):g=2;g<Math.min(f+s+1,k);g++)a(g,!0);f+s+1<k&&e(t,"span.dgrid-page-skip","...");1<k&&a(k)}else b.pagingTextBox&&a(f)},refresh:function(){var c=this;this.inherited(arguments);if(this.store)return this.gotoPage(1).then(function(a){setTimeout(function(){r.emit(c.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:c,results:a})},
0);return a});console.warn("Pagination requires a store to operate.")},_onNotification:function(c){c.length!==this._rowsOnPage&&this.gotoPage(this._currentPage)},renderArray:function(c,a){var b=this,d=this.inherited(arguments);this._lastCollection=null;a||(this._topLevelRequest&&this._topLevelRequest!==c&&(this._topLevelRequest.cancel(),delete this._topLevelRequest),"function"===typeof c.cancel&&(this._topLevelRequest=c),g.when(c,function(){b._topLevelRequest&&delete b._topLevelRequest}));return d},
insertRow:function(){var c=this._oldPageNodes,a=this.inherited(arguments);c&&a===c[a.id]&&delete c[a.id];return a},gotoPage:function(c,a){var b=this,l=new g;this._trackError(function(){var k=b.rowsPerPage,w=(c-1)*k,s=n.mixin(b.get("queryOptions"),{start:w,count:k}),h,p=b.contentNode,v,r,u;if(b.showLoadingMessage)d(b),v=b.loadingNode=e(p,"div.dgrid-loading"),v.innerHTML=b.loadingMessage;else{b._oldPageNodes=v={};p=p.children;r=0;for(u=p.length;r<u;r++)v[p[r].id]=p[r];b._oldPageObserver=b.observers.pop()}b._isLoading=
!0;h=b.store.query(b.query,s);g.when(b.renderArray(h,null,s),function(d){t(b);b.scrollTo({y:0});g.when(h.total,function(l){l||(b.noDataNode&&(e(b.noDataNode,"!"),delete b.noDataNode),b.noDataNode=e(b.contentNode,"div.dgrid-no-data"),b.noDataNode.innerHTML=b.noDataMessage);b.paginationStatusNode.innerHTML=f.substitute(b.i18nPagination.status,{start:Math.min(w+1,l),end:Math.min(l,w+k),total:l});b._total=l;b._currentPage=c;b._rowsOnPage=d.length;b._updateNavigation(a)});(7>q("ie")||q("ie")&&q("quirks"))&&
b.resize();l.resolve(h)},function(a){t(b);l.reject(a)});return l.promise})||l.reject();return l.promise}})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/on dojo/query dojo/dnd/Source put-selector/put xstyle/css!../css/extensions/ColumnReorder.css".split(" "),function(h,k,p,n,g,r,u){function f(d,e){var c=e[2],a=d[c?"columnSets":"subRows"][e[1]];return c?a[e[2]]:a}function q(d,e,c){e[2]?d.columnSets[e[1]][e[2]]=c:d.subRows[e[1]]=c}function e(d,
e){return e.slice(("dgrid-"+d+"-").length)}var v=/(\d+)(?:-(\d+))?$/;h=k(r,{copyState:function(){return!1},checkAcceptance:function(d,e){return d==this},_legalMouseDown:function(d){return-1<d.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(d){var t=this.grid,c=v.exec(e(t.id,d[0].getAttribute("dndType"))),a=c[2]?"columnSets":"subRows",b=f(t,c),l=t.columns;this.inherited(arguments);c&&setTimeout(function(){var e=p.map(d[0].parentNode.childNodes,
function(a){return l[a.columnId]});q(t,c,e);e={grid:t,subRow:e,column:l[d[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};e[a]=t[a];n.emit(t.domNode,"dgrid-columnreorder",e)?t.set(a,t[a]):(q(t,c,b),t.renderHeader(),this._sort&&this._sort.length&&this.updateSortArrow(this._sort))},0)}});k=k("dgrid.extensions.ColumnReorder",null,{columnDndConstructor:h,_initSubRowDnd:function(d,e){var c,a,b,l;a=0;for(b=d.length;a<b;a++)l=d[a],!1!==l.reorderable&&(l=l.headerNode,"TH"!=l.tagName&&(l=l.parentNode),
u(l,".dojoDndItem[dndType\x3d"+e+"]"),c||(c=l.parentNode));c&&this._columnDndSources.push(new this.columnDndConstructor(c,{horizontal:!0,grid:this}))},renderHeader:function(){var d="dgrid-"+this.id+"-",e,c;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets){c=0;for(e=this.columnSets.length;c<e;c++)p.forEach(this.columnSets[c],function(a,b){this._initSubRowDnd(a,d+c+"-"+b)},this)}else p.forEach(this.subRows,function(a,b){this._initSubRowDnd(a,d+b)},this)},_destroyColumns:function(){this._columnDndSources&&
p.forEach(this._columnDndSources,function(d){d.destroy()});this.inherited(arguments)}});k.ColumnDndSource=h;return k})},"dgrid/extensions/ColumnHider":function(){define("dojo/_base/declare dojo/has dojo/on ../util/misc put-selector/put dojo/i18n!./nls/columnHider xstyle/css!../css/extensions/ColumnHider.css".split(" "),function(h,k,p,n,g,r){var u,f,q=k("ie"),e=q&&k("quirks"),v=8>q||e?"htmlFor":"for";return h("dgrid.extensions.ColumnHider",null,{hiderMenuNode:null,hiderToggleNode:null,i18nColumnHider:r,
_hiderMenuOpened:!1,_columnHiderRules:null,_columnHiderCheckboxes:null,_renderHiderMenuEntries:function(){var d=this.subRows,e=!0,c,a,b,l;delete this._columnHiderFirstCheckbox;b=0;for(c=d.length;b<c;b++){l=0;for(a=d[b].length;l<a;l++)this._renderHiderMenuEntry(d[b][l]),e&&(e=!1,this._columnHiderFirstCheckbox=this._columnHiderCheckboxes[d[b][l].id])}},_renderHiderMenuEntry:function(d){var e=d.id,c=n.escapeCssIdentifier(e,"-"),a,b;d.hidden&&(d.hidden=!1,this._hideColumn(e),d.hidden=!0);d.unhidable||
(a=g("div.dgrid-hider-menu-row"),b=this.domNode.id+"-hider-menu-check-"+c,e=this._columnHiderCheckboxes[e]=g(a,"input.dgrid-hider-menu-check.hider-menu-check-"+c+"[type\x3dcheckbox]"),e.id=b,g(a,"label.dgrid-hider-menu-label.hider-menu-label-"+c+"["+v+"\x3d"+b+"]",d.label||d.field||""),g(this.hiderMenuNode,a),d.hidden||(e.checked=!0))},renderHeader:function(){function d(a){a.stopPropagation()}var k=this,c=this.hiderMenuNode,a=this.hiderToggleNode,b;this.inherited(arguments);if(c){for(b in this._columnHiderRules)this._columnHiderRules[b].remove();
c.innerHTML=""}else a=this.hiderToggleNode=g(this.domNode,"button.ui-icon.dgrid-hider-toggle[type\x3dbutton]"),this._listeners.push(p(a,"click",function(a){k._toggleColumnHiderMenu(a)})),c=this.hiderMenuNode=g("div.dgrid-hider-menu[role\x3ddialog][aria-label\x3d"+this.i18nColumnHider.popupLabel+"]"),c.id=this.id+"-hider-menu",this._listeners.push(p(c,"keyup",function(b){if(27===(b.charCode||b.keyCode))k._toggleColumnHiderMenu(b),a.focus()})),c.style.display="none",g(this.domNode,c),this._listeners.push(p(c,
".dgrid-hider-menu-check:"+(9>q||e?"click":"change"),function(a){k._updateColumnHiddenState(a.target.id.substr(k.id.length+18),!a.target.checked)})),this._listeners.push(p(c,"mousedown",d),p(a,"mousedown",d)),f||(f=p.pausable(document,"mousedown",function(a){u&&u._toggleColumnHiderMenu(a)}),f.pause());this._columnHiderCheckboxes={};this._columnHiderRules={};this._renderHiderMenuEntries()},destroy:function(){this.inherited(arguments);for(var d in this._columnHiderRules)this._columnHiderRules[d].remove()},
left:function(d,e){return this.right(d,-e)},right:function(d,e){d.element||(d=this.cell(d));for(var c=this.inherited(arguments),a=d;c.column.hidden;){c=this.inherited(arguments,[c,0<e?1:-1]);if(a.element===c.element)return d;a=c}return c},isColumnHidden:function(d){return!!this._columnHiderRules[d]},_toggleColumnHiderMenu:function(){var d=this._hiderMenuOpened,e=this.hiderMenuNode,c=this.domNode,a;e.style.display=d?"none":"";d?e.style.height="":(e.offsetHeight>c.offsetHeight-12&&(e.style.height=c.offsetHeight-
12+"px"),(a=this._columnHiderFirstCheckbox)&&a.focus());f[d?"pause":"resume"]();u=d?null:this;this._hiderMenuOpened=!d},_hideColumn:function(d){var e=this,c="#"+n.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-",a;if(!this._columnHiderRules[d]&&(this._columnHiderRules[d]=n.addCssRule(c+n.escapeCssIdentifier(d,"-"),"display: none;"),(8===k("ie")||10===k("ie"))&&!k("quirks")))a=n.addCssRule(".dgrid-row-table","display: inline-table;"),window.setTimeout(function(){a.remove();e.resize()},0)},_showColumn:function(d){this._columnHiderRules[d]&&
(this._columnHiderRules[d].remove(),delete this._columnHiderRules[d])},_updateColumnHiddenState:function(d,e){this[e?"_hideColumn":"_showColumn"](d);this.columns[d].hidden=e;p.emit(this.domNode,"dgrid-columnstatechange",{grid:this,column:this.columns[d],hidden:e,bubbles:!0});this.resize()},toggleColumnHiddenState:function(d,e){"undefined"===typeof e&&(e=!this._columnHiderRules[d]);this._updateColumnHiddenState(d,e);this._columnHiderCheckboxes[d].checked=!e}})})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-geometry dojo/has ../util/misc put-selector/put dojo/_base/html xstyle/css!../css/extensions/ColumnResizer.css".split(" "),
function(h,k,p,n,g,r,u,f,q){function e(a){for(var b=a.length,c=b,d=a[0].length,e=Array(b);b--;)e[b]=Array(d);for(var f={},b=0;b<c;b++)for(var k=e[b],g=a[b],h=0,p=0;h<d;h++){var q=g[p],v;if("undefined"==typeof k[h]){k[h]=q.id;if(q.rowSpan&&1<q.rowSpan){v=e;for(var n=q.rowSpan,t=b,r=h,u=q.id,C=1;C<n;C++)v[t+C][r]=u}if(0<b&&q.colSpan&&1<q.colSpan)for(v=1;v<q.colSpan;v++)if(k[++h]=q.id,q.rowSpan&&1<q.rowSpan)for(var n=e,t=q.rowSpan,r=b,u=h,C=q.id,F=1;F<t;F++)n[r+F][u]=C;f[q.id]=a[0][h].id;p++}}return f}
function v(a,b,c,d,e){if(!(0>=c)){var g=a.columns[b],h;if(g&&(h={grid:a,columnId:b,width:c,bubbles:!0,cancelable:!0},d&&(h.parentType=d),!a._resizedColumns||k.emit(a.headerNode,"dgrid-columnresize",h)))return"auto"===c?delete g.width:(g.width=c,c+="px"),(d=a._columnSizes[b])?d.set("width",c):d=f.addCssRule("#"+f.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+f.escapeCssIdentifier(b,"-"),"width: "+c+";"),a._columnSizes[b]=d,!1!==e&&a.resize(),!0}}var d,t=0,c={create:function(){d=q("div.dgrid-column-resizer")},
destroy:function(){q(d,"!");d=null},show:function(a){a=r.position(a.domNode,!0);d.style.top=a.y+"px";d.style.height=a.h+"px";q(document.body,d)},move:function(a){d.style.left=a+"px"},hide:function(){d.parentNode.removeChild(d)}};return h("dgrid.extensions.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);t++||c.create()},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();
--t||c.destroy()},resizeColumnWidth:function(a,b){return v(this,a,b)},configStructure:function(){var a=this._oldColumnSizes=n.mixin({},this._columnSizes),b;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);for(b in a)b in this._columnSizes||a[b].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var b=a.id,c;"width"in a&&((c=this._oldColumnSizes[b])?c.set("width",a.width+"px"):c=f.addCssRule("#"+f.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+
f.escapeCssIdentifier(b,"-"),"width: "+a.width+"px;"),this._columnSizes[b]=c)},renderHeader:function(){this.inherited(arguments);var a=this,b;if(this.columnSets&&this.columnSets.length)for(var c=this.columnSets.length;c--;)b=n.mixin(b||{},e(this.columnSets[c]));else this.subRows&&1<this.subRows.length&&(b=e(this.subRows));for(var c=p(".dgrid-cell",a.headerNode),d=c.length;d--;){var g=c[d],h=g.columnId,v=a.columns[h],t=g.childNodes;if(v&&!1!==v.resizable){v=q("div.dgrid-resize-header-container");for(g.contents=
v;0<t.length;)q(v,t[0]);g=q(g,v,"div.dgrid-resize-handle.resizeNode-"+f.escapeCssIdentifier(h,"-"));g.columnId=b&&b[h]||h}}a.mouseMoveListen||(k(a.headerNode,".dgrid-resize-handle:mousedown"+(u("touch")?",.dgrid-resize-handle:touchstart":""),function(b){a._resizeMouseDown(b,this);a.mouseMoveListen.resume();a.mouseUpListen.resume()}),a._listeners.push(a.mouseMoveListen=k.pausable(document,"mousemove"+(u("touch")?",touchmove":""),f.throttleDelayed(function(b){a._updateResizerPosition(b)}))),a._listeners.push(a.mouseUpListen=
k.pausable(document,"mouseup"+(u("touch")?",touchend":""),function(b){a._resizeMouseUp(b);a.mouseMoveListen.pause();a.mouseUpListen.pause()})),a.mouseMoveListen.pause(),a.mouseUpListen.pause())},_resizeMouseDown:function(a,b){a.preventDefault();g.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=p(".dgrid-column-"+f.escapeCssIdentifier(b.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);c.show(this)},_resizeMouseUp:function(a){var b=this._columnSizes,
d,e,h;this.adjustLastColumn&&(h=this.headerNode.clientWidth-1);this._resizedColumns||(d=p(".dgrid-cell",this.headerNode),this.columnSets&&this.columnSets.length?d=d.filter(function(a){return"0"==a.columnId.split("-")[0]&&!(a.columnId in b)}):this.subRows&&1<this.subRows.length&&(d=d.filter(function(a){return"0"==a.columnId.charAt(0)&&!(a.columnId in b)})),e=d.map(function(a){return a.offsetWidth}),d.forEach(function(a,b){v(this,a.columnId,e[b],null,!1)},this),this._resizedColumns=!0);g.setSelectable(this.domNode,
!0);d=this._targetCell;var k=this._getResizeMouseLocation(a)-this._startX,q=d.offsetWidth+k,n=this._getResizedColumnWidths(),t=n.totalWidth,n=n.lastColId,r=p(".dgrid-column-"+f.escapeCssIdentifier(n,"-"),this.headerNode)[0].offsetWidth;q<this.minWidth&&(q=this.minWidth);v(this,d.columnId,q,a.type)&&d.columnId!=n&&this.adjustLastColumn&&(t+k<h?v(this,n,"auto",a.type):r-k<=this.minWidth&&v(this,n,this.minWidth,a.type));c.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=
this._getResizeMouseLocation(a);var b=this._targetCell.offsetWidth,d=a;b+(a-this._startX)<this.minWidth&&(d=this._startX-(b-this.minWidth));c.move(d)}},_getResizeMouseLocation:function(a){var b=0;a.pageX?b=a.pageX:a.clientX&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return b},_getResizedColumnWidths:function(){var a=0,b=p(".dgrid-cell",this.headerNode);this.columnSets&&this.columnSets.length?b=b.filter(function(a){return"0"==a.columnId.split("-")[1]}):this.subRows&&
1<this.subRows.length&&(b=b.filter(function(a){return"0"==a.columnId.charAt(0)}));var c=b.length;if(!c)return{};for(var d=b[c-1].columnId;c--;)a+=b[c].offsetWidth;return{totalWidth:a,lastColId:d}}})})},"dgrid/extensions/DnD":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/on dojo/topic dojo/has dojo/dnd/Source dojo/dnd/Manager dojo/_base/NodeList put-selector/put ../Selection dojo/has!touch?../util/touch dojo/has!touch?./_DnD-touch-autoscroll xstyle/css!dojo/resources/dnd.css".split(" "),
function(h,k,p,n,g,r,u,f,q,e,v,d,t,c){var a=h(q,{grid:null,getObject:function(a){var c=this.grid;return c.store.get(a.id.slice(c.id.length+5))},_legalMouseDown:function(a){return this.inherited(arguments)&&a.target!=this.grid.bodyNode},onDrop:function(a,c,d){var e=this,f=this._targetAnchor=this.targetAnchor,h=this.grid,g=h.store;!this.before&&f&&(f=f.nextSibling);f=f&&h.row(f);n.when(f&&g.get(f.id),function(f){if(e!=a)e.onDropExternal(a,c,d,f);else e.onDropInternal(c,d,f)})},onDropInternal:function(a,
c,d){var e=this.grid.store,f=this,h=this.grid,g=f._targetAnchor,k;g&&(k=this.before?g.previousSibling:g.nextSibling);(c||!(k===a[0]||!d&&a[0].parentNode&&g&&h.down(h.row(a[0])).element==a[0]))&&a.forEach(function(a){n.when(f.getObject(a),function(a){e[c&&e.copy?"copy":"put"](a,{before:d})})})},onDropExternal:function(a,c,d,e){var f=this.grid.store,g=a.grid;c.forEach(function(c,h){n.when(a.getObject(c),function(k){d||(g?n.when(g.store.getIdentity(k),function(d){!h&&a.selectNone();a.delItem(c.id);g.store.remove(d)}):
a.deleteSelectedNodes());f[f.copy?"copy":"put"](k,{before:e})})})},onDndStart:function(a,c,d){this.inherited(arguments);a==this&&(this.grid.cancelTouchScroll&&this.grid.cancelTouchScroll(),e.manager().avatar.node.style.width=this.grid.domNode.offsetWidth/2+"px")},onMouseDown:function(a){f("touch")&&this.isDragging&&1<c.countCurrentTouches(a,this.grid.touchNode)?(u.publish("/dnd/cancel"),e.manager().stopDrag()):this.inherited(arguments)},onMouseMove:function(a){(!f("touch")||1>=c.countCurrentTouches(a,
this.grid.touchNode))&&this.inherited(arguments)},checkAcceptance:function(a,c){return a.getObject&&q.prototype.checkAcceptance.apply(this,arguments)},getSelectedNodes:function(){if(!this.grid.selection)return this.inherited(arguments);var a=new v,c;for(c in this.grid.selection)a.push(this._selectedNodes[c]);return a}});h=h("dgrid.extensions.DnD",t,{dndSourceType:"dgrid-row",dndParams:null,dndConstructor:a,postMixInProperties:function(){this.inherited(arguments);this.dndParams=k.mixin({accept:[this.dndSourceType]},
this.dndParams)},postCreate:function(){function b(a){e[a.id]=a.element}function c(a){delete e[a.id];d(a.element,"!dojoDndItemSelected!dojoDndItemAnchor")}this.inherited(arguments);this.dndSource=new (this.dndConstructor||a)(this.bodyNode,k.mixin(this.dndParams,{grid:this,dropParent:this.contentNode}));var e=this.dndSource._selectedNodes={};this.on("dgrid-select",function(a){p.forEach(a.rows,b)});this.on("dgrid-deselect",function(a){p.forEach(a.rows,c)});g.after(this,"destroy",function(){delete this.dndSource._selectedNodes;
e=null;this.dndSource.destroy()},!0)},insertRow:function(a){var c=this.inherited(arguments),e="function"==typeof this.getObjectDndType?this.getObjectDndType(a):[this.dndSourceType];d(c,".dojoDndItem");this.dndSource.setItem(c.id,{data:a,type:e instanceof Array?e:[e]});return c},removeRow:function(a){this.dndSource.delItem(this.row(a));this.inherited(arguments)}});h.GridSource=a;return h})},"esri/tasks/RelationParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),
function(h,k,p,n,g,r,u){h=h(null,{declaredClass:"esri.tasks.RelationParameters",geometries1:null,geometries2:null,relation:null,relationParam:null,toJson:function(){var f=p.map(this.geometries1,function(d){return d.toJson()}),g=p.map(this.geometries2,function(d){return d.toJson()}),e={},h=this.geometries1;h&&0<h.length&&(e.geometries1=n.toJson({geometryType:u.getJsonType(h[0]),geometries:f}),f=this.geometries1[0].spatialReference,e.sr=f.wkid?f.wkid:n.toJson(f.toJson()));if((f=this.geometries2)&&0<
f.length)e.geometries2=n.toJson({geometryType:u.getJsonType(f[0]),geometries:g});this.relation&&(e.relation=this.relation);this.relationParam&&(e.relationParam=n.toJson(this.relationParam));return e}});k.mixin(h,{SPATIAL_REL_CROSS:"esriGeometryRelationCross",SPATIAL_REL_DISJOINT:"esriGeometryRelationDisjoint",SPATIAL_REL_IN:"esriGeometryRelationIn",SPATIAL_REL_INTERIORINTERSECTION:"esriGeometryRelationInteriorIntersection",SPATIAL_REL_INTERSECTION:"esriGeometryRelationIntersection",SPATIAL_REL_COINCIDENCE:"esriGeometryRelationLineCoincidence",
SPATIAL_REL_LINETOUCH:"esriGeometryRelationLineTouch",SPATIAL_REL_OVERLAP:"esriGeometryRelationOverlap",SPATIAL_REL_POINTTOUCH:"esriGeometryRelationPointTouch",SPATIAL_REL_TOUCH:"esriGeometryRelationTouch",SPATIAL_REL_WITHIN:"esriGeometryRelationWithin",SPATIAL_REL_RELATION:"esriGeometryRelationRelation"});return h})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(h,k,p,n,g,r,u,f){p("dijit-legacy-requires")&&
g(0,function(){h(["dijit/ToolbarSeparator"])});return k("dijit.Toolbar",[r,f,u],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"widgets/AttributeTable/utils":function(){define(["dojo/_base/lang","dojo/_base/array","jimu/LayerInfos/LayerInfos","dojo/Deferred","dojo/promise/all"],function(h,
k,p,n,g){function r(f){var g=[],e=[];k.forEach(f,function(f){0>g.indexOf(f.name)?g.push(f.name):e.push(f)});k.forEach(e,function(e){e.name=e.name+"-"+e.id})}var u={readLayerInfosObj:function(f){return p.getInstance(f,f.itemInfo)},readLayerInfosFromMap:function(f){var g=new n;p.getInstance(f,f.itemInfo).then(h.hitch(this,function(e){var f=[];e.traversal(h.hitch(this,function(d){f.push(d)}));g.resolve(f)}),h.hitch(this,function(e){console.error(e);g.reject(e)}));return g},readLayerObjectsFromMap:function(f){var q=
new n,e=[];this.readLayerInfosFromMap(f).then(h.hitch(this,function(f){k.forEach(f,h.hitch(this,function(d){e.push(d.getLayerObject())}));g(e).then(h.hitch(this,function(d){q.resolve(d)}),h.hitch(this,function(d){q.reject(d);console.error(d)}))}),h.hitch(this,function(e){q.reject(e)}));return q},readConfigLayerInfosFromMap:function(f){var q=new n,e=[];this.readLayerInfosFromMap(f).then(h.hitch(this,function(f){var d=[];k.forEach(f,function(d){e.push(d.getLayerType())});g(e).then(h.hitch(this,function(e){k.forEach(e,
h.hitch(this,function(c,a){"FeatureLayer"===c&&(f[a].name=f[a].title,d.push(f[a]))}));r(d);q.resolve(d)}),h.hitch(this,function(d){q.reject(d)}))}),h.hitch(this,function(e){q.reject(e)}));return q},getConfigInfosFromLayerInfos:function(f){return k.map(f,function(f){return u.getConfigInfoFromLayerInfo(f)})},getConfigInfoFromLayerInfo:function(f){var g={};g.name=f.name;g.id=f.id;g.show=f.isShowInMap();g.layer={url:f.getUrl()};if((f=f.getPopupInfo())&&!f.description)g.layer.fields=k.map(f.fieldInfos,
function(e){return{name:e.fieldName,alias:e.label.toLowerCase(),show:e.visible}});return g}};return u})},"widgets/AttributeTable/_build-generate_module":function(){define(["dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:dijit/layout/templates/TabContainer.html":'\x3cdiv class\x3d"dijitTabContainer"\x3e\n\t\x3cdiv class\x3d"dijitTabListWrapper" data-dojo-attach-point\x3d"tablistNode"\x3e\x3c/div\x3e\n\t\x3cdiv data-dojo-attach-point\x3d"tablistSpacer" class\x3d"dijitTabSpacer ${baseClass}-spacer"\x3e\x3c/div\x3e\n\t\x3cdiv class\x3d"dijitTabPaneWrapper ${baseClass}-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\n\x3c/div\x3e\n',
"url:dijit/layout/templates/_TabButton.html":'\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"titleNode,innerDiv,tabContent" class\x3d"dijitTabInner dijitTabContent"\x3e\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTabButtonIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\x3cspan data-dojo-attach-point\x3d\'containerNode,focusNode\' class\x3d\'tabLabel\'\x3e\x3c/span\x3e\n\t\x3cspan class\x3d"dijitInline dijitTabCloseButton dijitTabCloseIcon" data-dojo-attach-point\x3d\'closeNode\'\n\t\t  role\x3d"presentation"\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d\'closeText\' class\x3d\'dijitTabCloseText\'\x3e[x]\x3c/span\n\t\t\t\t\x3e\x3c/span\x3e\n\x3c/div\x3e\n',
"url:dijit/layout/templates/ScrollingTabController.html":'\x3cdiv class\x3d"dijitTabListContainer-${tabPosition}" style\x3d"visibility:hidden"\x3e\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerMenuButton"\n\t\t class\x3d"tabStripButton-${tabPosition}"\n\t\t id\x3d"${id}_menuBtn"\n\t\t data-dojo-props\x3d"containerId: \'${containerId}\', iconClass: \'dijitTabStripMenuIcon\',\n\t\t\t\t\tdropDownPosition: [\'below-alt\', \'above-alt\']"\n\t\t data-dojo-attach-point\x3d"_menuBtn" showLabel\x3d"false" title\x3d""\x3e\x26#9660;\x3c/div\x3e\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\n\t\t class\x3d"tabStripButton-${tabPosition}"\n\t\t id\x3d"${id}_leftBtn"\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideLeftIcon\', showLabel:false, title:\'\'"\n\t\t data-dojo-attach-point\x3d"_leftBtn" data-dojo-attach-event\x3d"onClick: doSlideLeft"\x3e\x26#9664;\x3c/div\x3e\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\n\t\t class\x3d"tabStripButton-${tabPosition}"\n\t\t id\x3d"${id}_rightBtn"\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideRightIcon\', showLabel:false, title:\'\'"\n\t\t data-dojo-attach-point\x3d"_rightBtn" data-dojo-attach-event\x3d"onClick: doSlideRight"\x3e\x26#9654;\x3c/div\x3e\n\t\x3cdiv class\x3d\'dijitTabListWrapper\' data-dojo-attach-point\x3d\'tablistWrapper\'\x3e\n\t\t\x3cdiv role\x3d\'tablist\' data-dojo-attach-event\x3d\'onkeydown:onkeydown\'\n\t\t\t data-dojo-attach-point\x3d\'containerNode\' class\x3d\'nowrapTabStrip\'\x3e\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e',
"url:dijit/layout/templates/_ScrollingTabControllerButton.html":'\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onClick" class\x3d"dijitTabInnerDiv dijitTabContent dijitButtonContents"  data-dojo-attach-point\x3d"focusNode" role\x3d"button"\x3e\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitTabStripIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\x3cspan data-dojo-attach-point\x3d"containerNode,titleNode" class\x3d"dijitButtonText"\x3e\x3c/span\x3e\n\x3c/div\x3e',"url:widgets/AttributeTable/css/style.css":'.jimu-widget-attributetable{z-index: 40;}.jimu-widget-attributetable-main .tabStripButton{height: 24px !important;}.jimu-widget-attributetable, .jimu-widget-attributetable-main{width: 100%; height: 100%; left: 0px; bottom: 0px; background-color: #efefef;}.jimu-widget-attributetable-move{width: 100%; height: 5px; top: 0px;}.jimu-widget-attributetable-move:hover{cursor: n-resize;}.jimu-widget-attributetable-indicate-vertical{width: 2px; height: 100%; background-color: black; position: absolute; z-index: 1; opacity: 0;}.jimu-widget-attributetable-indicate-horizontal{width: 100%; height: 2px; background-color: black; position: absolute; z-index: 1; opacity: 0;}.jimu-widget-attributetable-bar{width: 63px; height: 17px; left: 49%; top: -19px; position: absolute; background-color: #efefef; cursor: pointer; border: 1px solid #fff; border-radius: 2px; background-position: center; background-repeat: no-repeat;}.jimu-widget-attributetable-bar:hover{background-color: #bfbfbf;}.jimu-widget-attributetable-bar.open{background-image: url(images/arrow_down.png); border: none; top: -17px; border-bottom-left-radius: 0; border-bottom-right-radius: 0;}.jimu-widget-attributetable-bar.close{background-image: url(images/arrow_up.png)}.jimu-widget-attributetable-arrowImage{width: 30px; height: 30px; left: 48%; top: -30px; position: absolute; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; background-position: center center; background-repeat: no-repeat; cursor: ns-resize; background-color: rgba(0, 0, 0, 0.8);}.dijitTabPaneWrapper .dijitTabContainerTop-container .dijitAlignCenter{height: 100%;}.jimu-widget-attributetable .esriAttributeTable{width: 100%; height: 100%; position: relative;}.jimu-widget-attributetable .esriAttributeTableToolbar{width: 100%; height: 30px; left: 0px; top: 0px; z-index: 100; position: relative;}.jimu-widget-attributetable .dgrid-sortable {font-weight: bold;}.jimu-widget-attributetable .dgrid-cell {border-right: solid 1px #ccc; width: 100px;}.jimu-widget-attributetable .dgrid-header {overflow: hidden; background-color: #eee; height: 20px;}.jimu-widget-attributetable .dgrid-scroller {margin-top: 22px !important;}.jimu-widget-attributetable .dgrid-cell a{color: #21759B; text-decoration: none;}.jimu-widget-attributetable .dgrid-cell a:hover, a:active{text-decoration: underline;}.esriAttributeTableExportImage{background-image: url("../images/export.png"); width: 13px; height: 13px;}.esriAttributeTableZoomImage{background-image: url("../images/zoom.png"); width: 13px; height: 13px;}.esriAttributeTableSelectAllImage{background-image: url("../images/select.png"); width: 13px; height: 13px;}.esriAttributeTableSelectPageImage{background-image: url("../images/page.png"); width: 13px; height: 13px;}.esriAttributeTableClearImage{background-image: url("../images/clear.png"); width: 13px; height: 13px;}.esriAttributeTableOptionsImage{background-image: url("../images/more.png"); width: 13px; height: 13px;}.esriAttributeTableRefreshImage{background-image: url("../images/refresh.png"); width: 13px; height: 13px;}.esriAttributeTableSymbolImage{background-image: url("../images/symbol.png"); width: 13px; height: 13px;}.esriAttributeTableCloseImage{background-image: url("../images/close.png"); width: 13px; height: 13px;}.esriAttributeTableColumnsImage{background-image: url("../images/columns.png"); width: 13px; height: 13px;}',
"url:widgets/AttributeTable/config.json":'{\n  "layerInfos": [],\n  "table": {\n    "pageSizeOptions": [25, 50, 100, 1000]\n  },\n  "hideExportButton": false\n}',"*now":function(h){h(['dojo/i18n!*preload*widgets/AttributeTable/nls/Widget*["ar","cs","da","de","en","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/html dojo/query dijit/_WidgetsInTemplateMixin jimu/BaseWidget dijit/layout/TabContainer dijit/layout/ContentPane jimu/utils jimu/dijit/Popup jimu/dijit/Message dgrid/OnDemandGrid dgrid/Selection dojo/store/Memory dgrid/extensions/Pagination dgrid/extensions/ColumnReorder dgrid/extensions/ColumnHider dgrid/extensions/ColumnResizer dgrid/extensions/DnD dojo/dom-construct dojo/dom-style dojo/dom-attr dojo/dom-class dojo/Deferred dojo/promise/all esri/config esri/tasks/RelationParameters esri/layers/ArcGISDynamicMapServiceLayer esri/layers/GraphicsLayer esri/renderers/SimpleRenderer esri/layers/FeatureLayer esri/symbols/jsonUtils esri/tasks/QueryTask esri/tasks/query esri/tasks/GeometryService esri/tasks/ProjectParameters esri/graphic esri/geometry/Point esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/Polygon esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/Color dojo/_base/lang dojo/on dojo/topic dojo/aspect dojo/_base/array dojo/has dojo/query dojo/_base/fx dojo/_base/window dijit/Toolbar dijit/form/Button dijit/DropDownMenu dijit/MenuItem jimu/dijit/CheckBox dijit/CheckedMenuItem dijit/form/DropDownButton jimu/dijit/LoadingIndicator ./utils".split(" "),function(h,
k,p,n,g,r,u,f,q,e,v,d,t,c,a,b,l,K,w,s,O,z,P,ka,L,Q,la,R,ma,E,C,F,D,na,Y,Z,$,S,aa,ba,oa,T,U,V,m,x,ca,da,B,W,M,X,ea,fa,H,ga,I,pa,ha,ia,ja,G){n=h([g,n],{name:"AttributeTable",baseClass:"jimu-widget-attributetable",normalHeight:0,startup:function(){this.inherited(arguments);f.loadStyleLink("dgrid",apiUrl+"dgrid/css/dgrid.css");this.AttributeTableDiv=null;this.layers=[];this.configLayerInfos=[];this._delayedLayerInfos=[];this._allLayerInfos=[];this.grids=[];this.selectedRowsLabelDivs=[];this.tabContainer=
null;this.tabPages=[];this.moveMaskDiv=this.refreshButton=this.selectionMenu=this.exportButton=this.zoomButton=this.tableDiv=null;this.moveMode=!1;this.isIndicate=!0;this.noGridHeight=this.previousGridHeight=this.previousDomHeight=this.moveY=0;this.matchingCheckBox=null;this.layersIndex=-1;this.matchingMap=!1;this.showing=!0;this.graphicsLayers=[];this.isFirst=!0;this.currentHeight=0;this.setInitialPosition();this.openHeight=this.normalHeight;G.readLayerInfosObj(this.map).then(m.hitch(this,function(a){this.own(x(a,
"layerInfosIsShowInMapChanged",m.hitch(this,this.onLayerInfosIsShowInMapChanged)));this.own(a.on("layerInfosChanged",m.hitch(this,this.onLayerInfosChanged)));this._createBar();this._closeTable()}))},_createBar:function(){this.arrowDiv=w.create("div");z.add(this.arrowDiv,"jimu-widget-attributetable-move");this.bar=w.create("div");z.add(this.bar,"jimu-widget-attributetable-bar");w.place(this.bar,this.domNode);w.place(this.arrowDiv,this.domNode);this.moveMaskDiv=w.create("div",{style:"opacity:0; width:100%; height:100%;position:absolute; z-index:999; display:none;cursor: ns-resize",
"class":"jimu-widget-attributetable-mask"});w.place(this.moveMaskDiv,ea.body(),"first");this.own(x(this.arrowDiv,"mousedown",m.hitch(this,this.onMouseEvent)));this.own(x(this.bar,"click",m.hitch(this,this._switchTable)))},_switchTable:function(){0===this.currentHeight?this._openTable():this._closeTable()},_openTable:function(){var a=new P;this.isFirst?(this.currentHeight=this.normalHeight,this.isFirst=!1,this.loading||(this.loading=new ja),this.loading.placeAt(this.domNode),this.loading.show(),G.readConfigLayerInfosFromMap(this.map).then(m.hitch(this,
function(b){if(0===this.config.layerInfos.length){var c=G.getConfigInfosFromLayerInfos(b);this.config.layerInfos=B.filter(c,function(a){return a.show})}else this.config.layerInfos=B.filter(m.clone(this.config.layerInfos),function(a){return a.show});this._allLayerInfos=b;this._processDelayedLayerInfos();this._init();this.loading.hide();a.resolve()}),m.hitch(this,function(a){console.error(a)}))):a.resolve();z.remove(this.bar,"close");z.add(this.bar,"open");this._changeHeight(this.openHeight);O.set(this.bar,
"title",this.nls.closeTableTip);return a},_closeTable:function(){z.remove(this.bar,"open");z.add(this.bar,"close");this._changeHeight(0);O.set(this.bar,"title",this.nls.openTableTip)},_init:function(){this.initConfigLayerInfos();this.initDiv();this.resize();this.own(x(this.map,"extent-change",m.hitch(this,this.onExtentChange)));this.own(x(this.map,"layer-remove",m.hitch(this,this.onRemoveLayer)));this.own(x(this.map,"resize",m.hitch(this,this.onMapResize)));this.own(x(window.document,"mouseup",m.hitch(this,
this.onMouseEvent)));this.own(x(window.document,"mousemove",m.hitch(this,this.onMouseEvent)));this.indicateHorDiv=w.create("div");z.add(this.indicateHorDiv,"jimu-widget-attributetable-indicate-horizontal");this.indicateVelDiv=w.create("div");z.add(this.indicateVelDiv,"jimu-widget-attributetable-indicate-vertical");w.place(this.indicateHorDiv,this.map.root,"first");w.place(this.indicateVelDiv,this.map.root,"first")},_processDelayedLayerInfos:function(){0<this._delayedLayerInfos.length&&(B.forEach(this._delayedLayerInfos,
m.hitch(this,function(a){this._getLayerInfoById(a.id)||this._allLayerInfos.push(a)})),this._delayedLayerInfos=[])},onLayerInfosIsShowInMapChanged:function(){this.checkMapInteractiveFeature()},onLayerInfosChanged:function(a,b,c){"added"===b&&c&&c.getLayerType().then(m.hitch(this,function(a){"FeatureLayer"===a&&(0===this._allLayerInfos.length?this._delayedLayerInfos.push(c):0<this._allLayerInfos.length&&!this._getLayerInfoById(c.id)&&(this._allLayerInfos.push(c),this.initConfigLayerInfos(),this.isExistTabPage(c.id)&&
(this._startQueryOnTab(c.id),this.onMapResize(),this.resetButtonStatus())))}))},indicatePoint:function(a){if(this.isIndicate){var b=this.getSelectedRows();b&&1<b.length||(a=this.map.toScreen(a),s.set(this.indicateHorDiv,"display",""),s.set(this.indicateVelDiv,"display",""),s.set(this.indicateHorDiv,"top",a.y-1+"px"),s.set(this.indicateVelDiv,"left",a.x-1+"px"),X.fadeOut({node:this.indicateHorDiv,beforeBegin:m.hitch(this,function(){s.set(this.indicateHorDiv,"opacity",1)}),onEnd:m.hitch(this,function(){s.set(this.indicateHorDiv,
"opacity",0);s.set(this.indicateHorDiv,"display","none")})}).play(),X.fadeOut({node:this.indicateVelDiv,beforeBegin:m.hitch(this,function(){s.set(this.indicateVelDiv,"opacity",1)}),onEnd:m.hitch(this,function(){s.set(this.indicateVelDiv,"opacity",0);s.set(this.indicateVelDiv,"display","none")})}).play())}},destroy:function(){var a,b;a=this.tabPages.length;for(b=0;b<a;b++)this.tabPages[b].destroy();this.tabPages=null;this.tabContainer&&this.tabContainer.destroy();this.configLayerInfos=this._allLayerInfos=
this.selectedRowsLabelDivs=this.grids=this.layers=null;this.layersIndex=-1;this.exportButton=this.zoomButton=this.tableDiv=null;this.moveMaskDiv&&(w.destroy(this.moveMaskDiv),this.moveMaskDiv=null);this.selectionMenu&&this.selectionMenu.destroy();this.refreshButton=this.selectionMenu=null;this.AttributeTableDiv&&(w.empty(this.AttributeTableDiv),this.AttributeTableDiv=null);a=this.graphicsLayers.length;for(b=0;b<a;b++)this.graphicsLayers[b]&&this.map.removeLayer(this.graphicsLayers[b]);this.inherited(arguments)},
onOpen:function(){if(this.config.layerInfos.length)s.set(this.domNode,"display",""),this.showing=!0,this.onMapResize();else this.onClose()},onClose:function(){},_changeHeight:function(a){s.set(this.domNode,"height",a+"px");for(var b=this.grids.length,c=0;c<b;c++)this.grids[c]&&0<=a-this.noGridHeight&&s.set(this.grids[c].domNode,"height",a-this.noGridHeight+"px");this.refreshGridHeight();"browser"===this.positionRelativeTo&&ca.publish("changeMapPosition",{bottom:a});this.currentHeight=a;0!==a&&(this.openHeight=
a)},onMapResize:function(){if(-1<this.layersIndex){var a=s.get(this.domNode,"width"),b=M(".dijitTabPaneWrapper");b&&b[0]&&(b[0].style.width=a-5+"px");for(var b=M(".dgrid-content"),c=this.tabPages.length,d=0;d<c;d++)s.set(this.tabPages[d].domNode,"width",a-18+"px"),this.grids[d]&&s.set(this.grids[d].domNode,"width",a-18+"px"),b&&b[d]&&(b[d].style.width=a-33+"px");this.grids[this.layersIndex]&&this.grids[this.layersIndex].resize()}},onPositionChange:function(){this.setInitialPosition();var a=s.get(this.domNode,
"height");if(-1<this.layersIndex)for(var b=this.grids.length,c=0;c<b;c++)s.set(this.grids[c].domNode,"height",a-this.noGridHeight+"px");this.refreshGridHeight()},onRemoveLayer:function(a){for(var b=this.layers.length,c=0;c<b;c++)if(this.getLayerInfoId(this.configLayerInfos[c])===this.getLayerInfoId(a.layer)){this.tabPageClose(this.tabPages[c].id,!0);break}},initConfigLayerInfos:function(){var a=this.config.layerInfos.length;this.configLayerInfos=[];if(0<a)for(var b=0;b<a;b++){var c=this._getLayerInfoById(this.config.layerInfos[b].id);
this.configLayerInfos[b]=c}},initSelectedLayer:function(a){this.layers[this.layersIndex]||(this.layers[this.layersIndex]=a,this.graphicsLayers[this.layersIndex]=new R,this.map.addLayer(this.graphicsLayers[this.layersIndex]),console.log(this.config.layerInfos[this.layersIndex].name),this.own(x(a,"click",m.hitch(this,this.onGraphicClick,this.layersIndex))))},_getLayerInfoByName:function(a){for(var b=0;b<this._allLayerInfos.length;b++)if(this._allLayerInfos[b].name===a)return this._allLayerInfos[b]},
_getLayerInfoById:function(a){for(var b=0,c=this._allLayerInfos.length;b<c;b++)if(this._allLayerInfos[b].id===a)return this._allLayerInfos[b]},onGraphicClick:function(a,b){this.showing&&a===this.layersIndex&&(this.highlightRow(b.graphic.attributes[this.layers[this.layersIndex].objectIdField]+""),this.selectFeatures("mapclick",[b.graphic]))},highlightRow:function(a){if(this.showing){var b=this.grids[this.layersIndex].store,c=-1,d;for(d in b.index)if(d===a){c=b.index[d];break}-1<c&&(b=this.grids[this.layersIndex].get("rowsPerPage"),
c=parseInt(c/b,10),c++,this.grids[this.layersIndex].gotoPage(c),this.grids[this.layersIndex].clearSelection(),this.grids[this.layersIndex].select(a),this.resetButtonStatus())}},_startQueryOnTab:function(a){for(var b=0,c=this.config.layerInfos.length,b=0;b<c;b++)if(this.configLayerInfos[b]&&this.getLayerInfoId(this.configLayerInfos[b])===a){this.layersIndex=b;break}-1<this.layersIndex&&this.configLayerInfos[this.layersIndex]&&this.configLayerInfos[this.layersIndex].getLayerObject().then(m.hitch(this,
function(a){this.initSelectedLayer(a);this.checkMapInteractiveFeature();this.config.layerInfos[this.layersIndex].opened?this.matchingMap&&this.startQuery(this.layersIndex,this.map.extent):this.matchingMap?this.startQuery(this.layersIndex,this.map.extent):(this.config.layerInfos[this.layersIndex].opened=!0,this.startQuery(this.layersIndex))}),m.hitch(this,function(a){new e({message:a.message||a})}))},tabChanged:function(){if(this.tabContainer&&this.tabContainer.selectedChildWidget){var a=this.tabContainer.selectedChildWidget.params.id;
console.log(a);this._startQueryOnTab(a);this.onMapResize()}this.resetButtonStatus()},checkMapInteractiveFeature:function(){var a=this.configLayerInfos[this.layersIndex];if(a){a.isShowInMap()?k.setStyle(this.zoomButton.domNode,"display","inline-block"):k.setStyle(this.zoomButton.domNode,"display","none");for(var a=0,b=this.configLayerInfos.length;a<b;a++)this.graphicsLayers[a]&&this.configLayerInfos[a].isShowInMap()?this.graphicsLayers[a].show():this.graphicsLayers[a]&&this.graphicsLayers[a].hide()}},
resetButtonStatus:function(){var a=this.getSelectedRows();a&&a.length?(this.zoomButton.set("disabled",!1),this.exportButton&&this.exportButton.set("disabled",!1)):(this.zoomButton.set("disabled",!0),this.exportButton&&this.exportButton.set("disabled",!0));this.config.layerInfos&&0===this.config.layerInfos.length?(this.selectionMenu.set("disabled",!0),this.refreshButton.set("disabled",!0),this.matchingCheckBox.set("disabled",!0)):(this.selectionMenu.set("disabled",!1),this.refreshButton.set("disabled",
!1),this.matchingCheckBox.set("disabled",!1));this.setSelectedNumber()},createTable:function(a,e,y){e=new t({data:e,idProperty:this.layers[y].objectIdField});if(this.grids[y])this.grids[y].set("store",e),this.grids[y].refresh();else{this.config.layerInfos[y].loaded=!0;var A={};this.config.table&&this.config.table.pageSizeOptions&&(A.pageSizeOptions=this.config.table.pageSizeOptions,A.rowsPerPage=A.pageSizeOptions[0]);A.bufferRows=Infinity;A.columns=a;A.store=e;A.pagingTextBox=!0;A.firstLastArrows=
!0;a=new (h([v,d,c,b,l,K]))(A,w.create("div"));w.place(a.domNode,this.tabPages[y].content);a.startup();this.grids[y]=a;this.own(x(a,"click",m.hitch(this,this.onRowClick)));this.own(x(a,"dblclick",m.hitch(this,function(){if(this.configLayerInfos[this.layersIndex].isShowInMap())this.onZoomButton()})));a=p(".dgrid-footer .dgrid-status",this.grids[y].domNode)[0];this.selectedRowsLabelDivs[y]=k.create("div",{"class":"dgrid-status"},a,"after");a=s.get(this.domNode,"height");s.set(this.grids[y].domNode,
"height",a-this.noGridHeight+"px");this.refreshGridHeight();if(1===this.grids.length)this.onMapResize()}this.showRefreshing(!1)},showRefreshing:function(a){-1<this.layersIndex&&(a?(this.loading.placeAt(this.tabPages[this.layersIndex].domNode.parentNode.parentNode),this.loading.show()):this.loading.hide())},startQuery:function(a,b){if(this.config.layerInfos&&0!==this.config.layerInfos.length){this.showRefreshing(!0);var c=this.getSelectedRows(),d=this.layers[a].objectIdField;if(this.layers[a].url&&
this.config.layerInfos[a].layer.url){var e=new F(this.config.layerInfos[a].layer.url),f=new D;f.where=this.layers[a].getDefinitionExpression()||"1 \x3d 1";var g=this.config.layerInfos[a].layer.fields,h=[],k=[];g?(B.forEach(g,m.hitch(this,function(a){void 0===a.show&&(a.show=!0);a.name===d&&(a._pk=!0);if(a.show||a._pk)h.push(a),k.push(a.name)})),f.outFields=k):f.outFields=["*"];b&&(f.geometry=b,f.spatialRelationship=D.SPATIAL_REL_INTERSECTS,this.config.layerInfos[a].opened=!1);f.outSpatialReference=
{wkid:this.map.spatialReference.wkid};this.config.layerInfos[a].extent=b;f.returnGeometry=!1;e.execute(f,m.hitch(this,this.queryExecute,c,a,h),m.hitch(this,this.errorQueryTask))}else{e={};e.features=this.layers[a].graphics;var l=this.layers[a].fields,f=this.config.layerInfos[a].layer.fields;e.fields=f?B.filter(f,m.hitch(this,function(a){void 0===a.show&&(a.show=!0);a.name===d&&(a._pk=!0);for(var b=0,c=l.length;b<c;b++)l[b].name===a.name&&(a.type=l[b].type);return a.show||a._pk})):B.filter(l,m.hitch(this,
function(a){void 0===a.show&&(a.show=!0);a.name===d&&(a._pk=!0);return a.show||a._pk}));e.selectionRows=c;if(b&&L.defaults.geometryService){for(var f=[],g=e.features.length,n=0;n<g;n++)f.push(e.features[n].geometry);g=new Q;g.geometries1=f;g.geometries2=[b];g.relation=Q.SPATIAL_REL_INTERSECTION;L.defaults.geometryService.relation(g,m.hitch(this,function(b,d){for(var e=d.length,f=[],N=0;N<e;N++)f.push(b.features[d[N].geometry1Index]);b.features=f;this.queryExecute(c,a,b.fields,b)},e),m.hitch(this,
this.errorGeometryServices))}else this.queryExecute(c,a,e.fields,e)}}},errorGeometryServices:function(a){console.log(a);this.popupMessage(a.message)},errorQueryTask:function(a){console.log(a);this.popupMessage(a.message)},onExtentChange:function(a){console.log(a.extent);this.matchingMap&&this.startQuery(this.layersIndex,a.extent)},_processExecuteFields:function(a,b){if(a&&0<a.length){var c=[];if(!b.length)return a;for(var d=0,e=b.length;d<e;d++)for(var f=0;f<a.length;f++)b[d].name===a[f].name&&(a[f]=
m.mixin(a[f],b[d]),c.push(a[f]));return c}return b},queryExecute:function(a,b,c,d){var e=[],f={};if(this.domNode){this.showRefreshing(!0);d.fields=this._processExecuteFields(d.fields,c);B.map(d.features,m.hitch(this,function(a,c){var d="",J;for(J in c.attributes)d=c.attributes[J],J===this.layers[b].typeIdField&&this.layers[b].types&&(d=this.getTypeName(d,this.layers[b].types),c.attributes[J]=d);e.push(c.attributes)},d.fields));if(!this.config.layerInfos[b].loaded&&d.fields){c=d.fields.length;for(var g=
0;g<c;g++){var h="field"+g;f[h]={label:d.fields[g].alias||d.fields[g].name,className:h,hidden:!d.fields[g].show&&void 0!==d.fields[g].show,unhidable:!d.fields[g].show&&void 0!==d.fields[g].show&&d.fields[g]._pk,field:d.fields[g].name};if("esriFieldTypeString"===d.fields[g].type)f[h].formatter=m.hitch(this,this.urlFormatter);else if("esriFieldTypeDate"===d.fields[g].type)f[h].formatter=m.hitch(this,this.dateFormatter);else if("esriFieldTypeDouble"===d.fields[g].type||"esriFieldTypeSingle"===d.fields[g].type||
"esriFieldTypeInteger"===d.fields[g].type||"esriFieldTypeSmallInteger"===d.fields[g].type)f[h].formatter=m.hitch(this,this.numberFormatter)}}this.createTable(f,e,b);if(a&&a.length){for(var k in a)this.grids[b].select(a[k]);this.resetButtonStatus()}}},urlFormatter:function(a){if(a){var b=a.indexOf("http:");-1===b&&(b=a.indexOf("https:"));if(-1<b&&-1===a.indexOf("href\x3d")){var c=a.indexOf(" ",b);-1===c&&(c=a.length);var d=a.substring(b,c);a=a.substring(0,b)+'\x3cA href\x3d"'+d+'" target\x3d"_blank"\x3e'+
d+"\x3c/A\x3e"+a.substring(c,a.length)}}return a||""},dateFormatter:function(a){a&&(a=f.localizeDate(new Date(a),{fullYear:!0}));return a||""},numberFormatter:function(a){if("number"===typeof a){var b=(a.toString().split(".")[1]||"").length;a=f.localizeNumber(a,{places:b})}return a||""},getTypeName:function(a,b){for(var c=b.length,d=0;d<c;d++)if(a===b[d].id)return b[d].name;return""},getFieldType:function(a,b){if(b&&0<b.length)for(var c=b.length,d=0;d<c;d++)if(a===b[d].name)return b[d].type;return""},
onRowClick:function(a){var b=[],c=this.grids[this.layersIndex].selection,d;for(d in c)c[d]&&b.push(d);b.length?(this.zoomButton.set("disabled",!1),this.exportButton&&this.exportButton.set("disabled",!1),this.layers[this.layersIndex].url?(a=new D,a.objectIds=b,this.layers[this.layersIndex].selectFeatures(a,E.SELECTION_NEW,m.hitch(this,this.selectFeatures,"rowclick"),m.hitch(this,this.errorSelectFeatures))):a&&!a.type&&a.length?this.selectFeatures("zoom",this.getGraphicsFromLocalFeatureLayer(this.layersIndex,
b)):this.selectFeatures("rowclick",this.getGraphicsFromLocalFeatureLayer(this.layersIndex,b))):(this.zoomButton.set("disabled",!0),this.exportButton&&this.exportButton.set("disabled",!1),this.graphicsLayers[this.layersIndex].clear())},errorSelectFeatures:function(a){console.log(a);this.popupMessage(a.message)},getGraphicsFromLocalFeatureLayer:function(a,b){for(var c=[],d,e=b.length,f=this.layers[a].graphics.length,g=this.layers[a].objectIdField,h=0;h<e;h++)for(var k=0;k<f;k++)if(d=this.layers[a].graphics[k].attributes[g]+
"",d===b[h]){c.push(this.layers[a].graphics[k]);break}return c},getExtent:function(a){var b=new P,c,d,e=a.length;if(1===e&&a[0].geometry&&"point"===a[0].geometry.type)c=a[0].geometry;else{if(1===e&&!a[0].geometry)return b.reject(Error("AttributeTable.getExtent:: extent was not projected.")),b;for(var f=0;f<e;f++)a[f].geometry?"point"===a[f].geometry.type?(d||(d=new S(a[f].geometry.spatialReference)),d.addPoint(a[f].geometry),f===e-1&&(c=d.getExtent())):c=c?c.union(a[f].geometry.getExtent()):a[f].geometry.getExtent():
console.error("unable to get geometry of the reocord: ",a[f])}if(!c||!c.spatialReference)return b.reject(Error("AttributeTable.getExtent:: extent was not projected.")),b;a=this.map.spatialReference;c.spatialReference.wkid===a.wkid?b.resolve(c):(d=new Y,d.geometries=[c],d.outSR=a,L.defaults.geometryService.project(d,m.hitch(this,function(a){a&&a.length?b.resolve(a[0]):b.reject(Error("AttributeTable.getExtent:: extent was not projected."))}),m.hitch(this,function(a){a||(a=Error("AttributeTable.getExtent:: extent was not projected."));
b.reject(a)})));return b},addGraphics:function(a,b){var c,d,e=a.length;this.graphicsLayers[this.layersIndex].clear();for(var f=new T(T.STYLE_SOLID,new V([0,255,255]),2),g=0;g<e;g++)d=null,a[g].geometry?(a[g].geometry.spatialReference.wkid!==this.map.spatialReference.wkid&&console.warn("unable to draw graphic result in different wkid from map"),"point"===a[g].geometry.type?(d=new $(a[g].geometry.toJson()),c=m.clone(this.map.infoWindow.markerSymbol),b||this.indicatePoint(d)):"multipoint"===a[g].geometry.type?
(d=new S(a[g].geometry.toJson()),c=m.clone(this.map.infoWindow.markerSymbol),b||this.indicatePoint(d.getExtent().getCenter())):"polyline"===a[g].geometry.type?(d=new aa(a[g].geometry.toJson()),c=f,b||this.indicatePoint(d.getExtent().getCenter())):"polygon"===a[g].geometry.type&&(d=new ba(a[g].geometry.toJson()),c=new U(U.STYLE_SOLID,f,new V([255,255,255,0.25])),b||this.indicatePoint(d.getExtent().getCenter())),d=new Z(d,c,a[g].attributes,a[g].infoTemplate),this.graphicsLayers[this.layersIndex].add(d)):
console.error("unable to get geometry of the reocord: ",a[g])},setSelectedNumber:function(){if(this.selectedRowsLabelDivs&&this.selectedRowsLabelDivs[this.layersIndex]&&this.layersIndex<this.grids.length&&this.grids[this.layersIndex]){var a=this.grids[this.layersIndex].selection,b=[];if(a)for(var c in a)a[c]&&b.push(c);this.selectedRowsLabelDivs[this.layersIndex].innerHTML=", "+b.length+" "+this.nls.selected}},selectFeatures:function(a,b){if(b&&0<b.length)"mapclick"===a?(this.addGraphics(b,!0),this.config.layerInfos[this.layersIndex].isDynamicLayer&&
this.highlightRow(b[0].attributes[this.grids[this.layersIndex].store.idProperty]+"")):"rowclick"===a||"selectall"===a?this.addGraphics(b,!0):"zoom"===a&&this.getExtent(b).then(m.hitch(this,function(a){a&&("point"===a.type?this.map.centerAndZoom(a,15):this.map.setExtent(a.expand(1.1)))}),m.hitch(this,function(a){console.error(a)})),this.setSelectedNumber();else var c=new e({message:this.nls.dataNotAvailable,buttons:[{label:this.nls.ok,onClick:m.hitch(this,function(){c.close()})}]})},onMouseEvent:function(a){switch(a.type){case "mousedown":this.moveMode=
!0;this.moveY=a.clientY;this.previousDomHeight=s.get(this.domNode,"height");this.previousArrowTop=s.get(this.arrowDiv,"top");this.grids.length&&(this.previousGridHeight=s.get(this.grids[0].domNode,"height"));s.set(this.arrowDiv,"background-color","gray");s.set(this.moveMaskDiv,"display","");break;case "mouseup":this.moveMode=!1;s.set(this.arrowDiv,"background-color","");s.set(this.moveMaskDiv,"display","none");break;case "mousemove":this.moveMode&&this._changeHeight(this.moveY-a.clientY+this.previousDomHeight)}},
refreshGridHeight:function(){var a=M(".dijitTabPaneWrapper");a&&a.length&&s.set(a[0],"height","100%")},setInitialPosition:function(){var a;this.position.height?a=this.position.height:(a=document.body.clientHeight,a/=3);this.normalHeight=a;s.set(this.domNode,"top","auto");s.set(this.domNode,"left","0px");s.set(this.domNode,"right","0px");s.set(this.domNode,"bottom","0px");s.set(this.domNode,"position","absolute")},initDiv:function(){this.AttributeTableDiv=w.create("div",{},this.domNode);z.add(this.AttributeTableDiv,
"jimu-widget-attributetable-main");var a=w.create("div"),b=new fa({},w.create("div")),c=new ga,d=new I({label:this.nls.selectPage,iconClass:"esriAttributeTableSelectPageImage",onClick:m.hitch(this,this.selectPage)});c.addChild(d);d=new I({label:this.nls.selectAll,iconClass:"esriAttributeTableSelectAllImage",onClick:m.hitch(this,this.selectAll,!0)});c.addChild(d);this.matchingCheckBox=new ha({checked:!1,label:this.nls.filterByExtent,onChange:m.hitch(this,function(a){(this.matchingMap=a)?this.startQuery(this.layersIndex,
this.map.extent):this.startQuery(this.layersIndex)})});c.addChild(this.matchingCheckBox);d=new I({label:this.nls.columns,iconClass:"esriAttributeTableColumnsImage",onClick:m.hitch(this,this.toggleColumns)});c.addChild(d);this.config.hideExportButton||(this.exportButton=new I({label:this.nls.exportFiles,showLabel:!0,iconClass:"esriAttributeTableExportImage",onClick:m.hitch(this,this.onExportButton)}),c.addChild(this.exportButton));this.selectionMenu=new ia({label:this.nls.options,iconClass:"esriAttributeTableOptionsImage",
dropDown:c});b.addChild(this.selectionMenu);this.zoomButton=new H({label:this.nls.zoomto,iconClass:"esriAttributeTableZoomImage",onClick:m.hitch(this,this.onZoomButton)});b.addChild(this.zoomButton);c=new H({label:this.nls.clearSelection,iconClass:"esriAttributeTableClearImage",onClick:m.hitch(this,this.selectAll,!1)});b.addChild(c);this.refreshButton=new H({label:this.nls.refresh,showLabel:!0,iconClass:"esriAttributeTableRefreshImage",onClick:m.hitch(this,this.onRefreshButton)});b.addChild(this.refreshButton);
this.closeButton=new H({title:this.nls.closeMessage,style:"float: right;",iconClass:"esriAttributeTableCloseImage",onClick:m.hitch(this,this._closeTable)});b.addChild(this.closeButton);w.place(b.domNode,a);b=w.create("div");this.tableDiv=w.create("div");w.place(this.tableDiv,b);w.place(a,this.AttributeTableDiv);w.place(b,this.AttributeTableDiv);this.noGridHeight=40+s.get(a,"height");this.tabContainer=new r({style:"height: 100%; width: 100%;"},b);a=this.config.layerInfos.length;for(b=0;b<a;b++)this.config.layerInfos[b].show&&
(c=m.clone(this.config.layerInfos[b]),d=w.create("div"),c.id=c.id,c.title=c.name,c.content=d,c.style="height: 100%; width: 100%; overflow: visible;",c=new u(c),this.tabPages[b]=c,this.tabContainer.addChild(c));this.tabContainer.startup();f.setVerticalCenter(this.tabContainer.domNode);this.tabChanged();this.own(da.after(this.tabContainer,"selectChild",m.hitch(this,this.tabChanged)))},getLayerInfoLabel:function(a){return a.name||a.title},getLayerInfoId:function(a){return a&&a.id||""},toggleColumns:function(){-1<
this.layersIndex&&this.grids[this.layersIndex]&&this.grids[this.layersIndex]._toggleColumnHiderMenu()},onRefreshButton:function(){-1<this.layersIndex&&(this.grids[this.layersIndex]&&this.grids[this.layersIndex].clearSelection(),this.graphicsLayers[this.layersIndex]&&this.graphicsLayers[this.layersIndex].clear(),this.setSelectedNumber(),this.config.layerInfos[this.layersIndex]&&(this.config.layerInfos[this.layersIndex].loaded=!1,this.startQuery(this.layersIndex,this.config.layerInfos[this.layersIndex].extent)))},
addNewTab:function(a){a=this._getLayerInfoById(a.layer.id)||this._getLayerInfoByName(a.layer.name);var b=this.getLayerInfoId(a);if(b=this.isExistTabPage(b))this.onOpen(),this.tabContainer.selectChild(b),this.tabChanged();else{b=G.getConfigInfoFromLayerInfo(a);this.config.layerInfos.push({name:b.name,layer:{url:b.layer.url,fields:b.layer.fields}});this.configLayerInfos.push(a);b=new R;this.graphicsLayers.push(b);this.map.addLayer(b);this.onOpen();var c=w.create("div"),b={};b.name=this.getLayerInfoLabel(a);
b.id=this.getLayerInfoId(a);b.content=c;b.closable=!0;b.style="height: 100%; width: 100%; overflow: visible";a=new u(b);this.tabPages.push(a);a.set("title",b.name);this.own(x(a,"close",m.hitch(this,this.tabPageClose,b.id)));this.tabContainer.addChild(a);this.tabContainer.selectChild(a)}},onReceiveData:function(a,b,c){c&&"AttributeTable"===c.target&&(0===this.currentHeight?this._openTable().then(m.hitch(this,this._addLayerToTable,c)):G.readConfigLayerInfosFromMap(this.map).then(m.hitch(this,function(a){this._allLayerInfos=
a;this._processDelayedLayerInfos();this._addLayerToTable(c)})))},_addLayerToTable:function(a){var b=null;a.layer.getLayerObject().then(m.hitch(this,function(c){c?(c.id=a.layer.id,c.loaded?this.addNewTab({layer:c}):this.own(x(c,"load",m.hitch(this,this.addNewTab)))):a.url&&(b=new E(a.url),this.own(x(b,"load",m.hitch(this,this.addNewTab))))}),m.hitch(this,function(a){new e({message:a.message||a})}))},isExistTabPage:function(a){for(var b=this.tabPages.length,c=0;c<b;c++)if(this.tabPages[c].get("id")===
a)return this.tabPages[c];return null},tabPageClose:function(a,b){for(var c=this.tabPages.length,d=0;d<c;d++)if(this.tabPages[d].id===a){this.loading.placeAt(this.domNode);!0===b&&this.tabContainer.removeChild(this.tabPages[d]);this.grids&&this.grids[d]&&(this.grids[d].destroy(),this.grids.splice(d,1));this.tabPages&&this.tabPages[d]&&(this.tabPages[d].destroyDescendants(),this.tabPages.splice(d,1));this.config&&(this.config.layerInfos&&this.config.layerInfos[d])&&(this.config.layerInfos.splice(d,
1),this.configLayerInfos.splice(d,1));this.layers&&this.layers[d]&&(this.layers.splice(d,1),this._allLayerInfos.splice(d,1));this.graphicsLayers&&this.graphicsLayers[d]&&(this.map.removeLayer(this.graphicsLayers[d]),this.graphicsLayers.splice(d,1));this.selectedRowsLabelDivs&&this.selectedRowsLabelDivs[d]&&this.selectedRowsLabelDivs.splice(d,1);if(1===c){this.layersIndex=-1;this.onClose();return}d<this.layersIndex?this.layersIndex--:d===this.layersIndex&&(1<c?(this.layersIndex=c-2,this.tabContainer.selectChild(this.tabPages[this.layersIndex]),
this.tabChanged()):this.layersIndex=0);break}setTimeout(m.hitch(this,function(){this.refreshGridHeight()}),10)},selectAll:function(a){if(this.config.layerInfos&&0!==this.config.layerInfos.length){if(a){a=[];var b=this.grids[this.layersIndex].store.index,c;for(c in b)a.push(c),this.grids[this.layersIndex].select(c);a.length&&(this.layers[this.layersIndex].url?(c=new D,c.objectIds=a,this.layers[this.layersIndex].selectFeatures(c,E.SELECTION_NEW,m.hitch(this,this.selectFeatures,"selectall"),m.hitch(this,
this.errorSelectFeatures))):this.selectFeatures("selectall",this.layers[this.layersIndex].graphics))}else this.grids[this.layersIndex].gotoPage(this.grids[this.layersIndex]._currentPage),this.grids[this.layersIndex].clearSelection(),this.graphicsLayers[this.layersIndex].clear();this.resetButtonStatus()}},selectPage:function(){if(this.config.layerInfos&&0!==this.config.layerInfos.length){this.grids[this.layersIndex].clearSelection();this.graphicsLayers[this.layersIndex].clear();var a=this.grids[this.layersIndex]._currentPage,
b=this.grids[this.layersIndex].rowsPerPage,c=this.grids[this.layersIndex].store.index,d=[],e;for(e in c){var f=c[e];f>=(a-1)*b&&f<b*a&&(d.push(e),this.grids[this.layersIndex].select(e))}this.layers[this.layersIndex].url?(a=new D,a.objectIds=d,this.layers[this.layersIndex].selectFeatures(a,E.SELECTION_NEW,m.hitch(this,this.selectFeatures,"selectall"),m.hitch(this,this.errorSelectFeatures))):this.selectFeatures("selectall",this.getGraphicsFromLocalFeatureLayer(this.layersIndex,d));this.resetButtonStatus()}},
exportToCSV:function(){if(this.config.layerInfos&&0!==this.config.layerInfos.length){var a="",b=0,c=0,d="",e="",f=[],b=this.grids[this.layersIndex].columns,g=this.getSelectedRowsData(),h;for(h in b)a=a+d+b[h].field,d=",",f.push(b[h].field);a+="\r\n";b=g.length;c=f.length;for(h=0;h<b;h++){for(var d="",k=0;k<c;k++)e=g[h][f[k]],!e&&"number"!==typeof e&&(e=""),a=a+d+e,d=",";a+="\r\n"}this.download(this.config.layerInfos[this.layersIndex].name+".csv",a)}},getSelectedRowsData:function(){if(!this.grids.length||
!this.grids[this.layersIndex])return null;var a=this.grids[this.layersIndex].store.data,b=this.grids[this.layersIndex].store.idProperty,c=a.length,d=[],e=this.grids[this.layersIndex].selection,f;for(f in e)for(e=0;e<c;e++)f===String(a[e][b])&&d.push(a[e]);return d},getSelectedRows:function(){var a=[];if(!this.grids.length||!this.grids[this.layersIndex])return a;var b=this.grids[this.layersIndex].selection,c;for(c in b)b[c]&&a.push(c);return a},_isIE11:function(){var a=0,b=/MSIE (\d+\.\d+);/.test(navigator.userAgent),
c=!!navigator.userAgent.match(/Trident\/7.0/),d=navigator.userAgent.indexOf("rv:11.0");b&&(a=Number(RegExp.$1));-1!==navigator.appVersion.indexOf("MSIE 10")&&(a=10);c&&-1!==d&&(a=11);return 11===a},download:function(a,b){if(W("ie")||this._isIE11()){var c=window.top.open("about:blank","_blank");c.document.write(b);c.document.close();c.document.execCommand("SaveAs",!0,a);c.close()}else{c=w.create("a",{href:"data:attachment/csv;charset\x3dutf-8,"+encodeURIComponent(b),target:"_blank",download:a},this.domNode);
if(W("safari")){var d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0);c.dispatchEvent(d)}else c.click();w.destroy(c)}},onExportButton:function(){if(this.config.layerInfos&&0!==this.config.layerInfos.length)var a=new e({message:this.nls.exportMessage,titleLabel:this.nls.exportFiles,autoHeight:!0,buttons:[{label:this.nls.ok,onClick:m.hitch(this,function(){this.exportToCSV();a.close()})},{label:this.nls.cancel,onClick:m.hitch(this,function(){a.close()})}]})},onZoomButton:function(){if(this.config.layerInfos&&
0!==this.config.layerInfos.length){var a=[],b=this.grids[this.layersIndex].selection,c;for(c in b)b[c]&&a.push(c);if(0!==a.length)if(this.layers[this.layersIndex].url)b=new D,b.objectIds=a,this.layers[this.layersIndex].selectFeatures(b,E.SELECTION_NEW,m.hitch(this,this.selectFeatures,"zoom"),m.hitch(this,this.errorSelectFeatures));else this.onRowClick(a)}},popupMessage:function(a){var b=new e({message:a,buttons:[{label:this.nls.ok,onClick:m.hitch(this,function(){b.close()})}]});this.showRefreshing(!1)}});
n.inPanel=!1;n.hasUIFile=!1;return n});