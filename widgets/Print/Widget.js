//>>built
require({cache:{"widgets/Print/Print":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/Form dijit/form/Select dijit/form/ValidationTextBox dijit/form/NumberTextBox dijit/form/Button dijit/form/CheckBox dijit/ProgressBar dijit/form/DropDownButton dijit/TooltipDialog dijit/form/RadioButton esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/request esri/IdentityManager dojo/store/Memory dojo/_base/lang dojo/_base/array dojo/dom-style dojo/dom-construct dojo/dom-class dojo/json jimu/portalUrlUtils dojo/text!./templates/Print.html dojo/text!./templates/PrintResult.html dojo/aspect jimu/dijit/LoadingShelter jimu/dijit/Message".split(" "),
function(f,k,n,s,q,h,e,b,d,c,l,a,m,g,z,B,u,r,A,v,x,C,y,I,K,L,M,N,F,D,J,G){q=f([k,n,s],{widgetsInTemplate:!0,templateString:N,map:null,count:1,results:[],authorText:null,copyrightText:null,defaultTitle:null,defaultFormat:null,defaultLayout:null,baseClass:"gis_PrintDijit",pdfIcon:require.toUrl("./widgets/Print/images/pdf.png"),imageIcon:require.toUrl("./widgets/Print/images/image.png"),printTaskURL:null,printTask:null,async:!1,postCreate:function(){this.inherited(arguments);this.printTask=new z(this.printTaskURL,
{async:this.async});this.printparams=new B;this.printparams.map=this.map;this.printparams.outSpatialReference=this.map.spatialReference;this.shelter=new J({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();this._getPrintTaskInfo("text");this.printTask._getPrintDefinition&&D.after(this.printTask,"_getPrintDefinition",x.hitch(this,"printDefInspector"),!1);this.printTask._createOperationalLayers&&D.after(this.printTask,"_createOperationalLayers",x.hitch(this,"_preventGraphicsLegend"))},
_getPrintTaskInfo:function(t){r({url:this.printTaskURL,content:{f:"json"},callbackParamName:"callback",handleAs:t||"json"}).then(x.hitch(this,"_handlePrintInfo"),x.hitch(this,"_handleError")).always(x.hitch(this,function(){this.shelter.hide()}))},_preventGraphicsLegend:function(t){if(this.printTask.allLayerslegend){for(var w=this.printTask.allLayerslegend,E=[],a=0;a<w.length;a++){var c=this.map.getLayer(w[a].id);c&&(c.declaredClass&&"esri.layers.GraphicsLayer"!==c.declaredClass)&&E.push(w[a])}this.printTask.allLayerslegend=
E}return t},printDefInspector:function(t){"force"===this.preserve.preserveScale&&(t.mapOptions.scale=this.preserve.forcedScale);return t},_handleError:function(t){console.log("print widget load error: ",t);new G({message:t.message||t})},_handlePrintInfo:function(t){var w=null;try{if(w="string"===typeof t?L.parse(t):t,w.error&&w.error.code){this._getPrintTaskInfo("json");return}}catch(E){w=M.setHttpProtocol(this.printTaskURL);t=M.getNewPrintUrl(this.appConfig.portalUrl);w===t||/sharing\/tools\/newPrint$/.test(w)?
(y.set(this.layoutDijit.domNode.parentNode.parentNode,"display","none"),y.set(this.formatDijit.domNode.parentNode.parentNode,"display","none"),y.set(this.advancedButtonDijit.domNode,"display","none")):this._handleError(E);return}y.set(this.layoutDijit.domNode.parentNode.parentNode,"display","");y.set(this.formatDijit.domNode.parentNode.parentNode,"display","");y.set(this.advancedButtonDijit.domNode,"display","");t=C.filter(w.parameters,function(t){return"Layout_Template"===t.name});if(0===t.length)console.log('print service parameters name for templates must be "Layout_Template"');
else{var a=C.map(t[0].choiceList,function(t){return{label:t,value:t}});a.sort(function(t,w){return t.label>w.label?1:w.label>t.label?-1:0});this.layoutDijit.addOption(a);this.defaultLayout?this.layoutDijit.set("value",this.defaultLayout):this.layoutDijit.set("value",t[0].defaultValue);w=C.filter(w.parameters,function(t){return"Format"===t.name});0===w.length?console.log('print service parameters name for format must be "Format"'):(t=C.map(w[0].choiceList,function(t){return{label:t,value:t}}),t.sort(function(t,
w){return t.label>w.label?1:w.label>t.label?-1:0}),this.formatDijit.addOption(t),this.defaultFormat?this.formatDijit.set("value",this.defaultFormat):this.formatDijit.set("value",w[0].defaultValue))}},print:function(){if(this.printSettingsFormDijit.isValid()){var t=this.printSettingsFormDijit.get("value");x.mixin(t,this.layoutMetadataDijit.get("value"));this.preserve=this.preserveFormDijit.get("value");x.mixin(t,this.preserve);this.layoutForm=this.layoutFormDijit.get("value");var w=this.mapQualityFormDijit.get("value"),
E=this.mapOnlyFormDijit.get("value");x.mixin(E,w);w=new u;w.format=t.format;w.layout=t.layout;w.preserveScale="true"===t.preserveScale||"force"===t.preserveScale;w.label=t.title;w.exportOptions=E;w.layoutOptions={authorText:t.author,copyrightText:t.copyright,legendLayers:0<this.layoutForm.legend.length&&this.layoutForm.legend[0]?null:[],titleText:t.title};this.printparams.template=w;this.printparams.extraParameters={printFlag:!0};E=this.printTask.execute(this.printparams);(new H({count:this.count.toString(),
icon:"PDF"===t.format?this.pdfIcon:this.imageIcon,docName:t.title,title:t.format+", "+t.layout,fileHandle:E,nls:this.nls})).placeAt(this.printResultsNode,"last").startup();y.set(this.clearActionBarNode,"display","block");this.count++}else this.printSettingsFormDijit.validate()},clearResults:function(){I.empty(this.printResultsNode);y.set(this.clearActionBarNode,"display","none");this.count=1},updateAuthor:function(t){(t=t||"")&&this.authorTB.set("value",t)},getCurrentMapScale:function(){this.forceScaleNTB.set("value",
this.map.getScale())}});var H=f([k,n,s],{widgetsInTemplate:!0,templateString:F,url:null,postCreate:function(){this.inherited(arguments);this.fileHandle.then(x.hitch(this,"_onPrintComplete"),x.hitch(this,"_onPrintError"))},_onPrintComplete:function(t){t.url?(this.url=t.url,this.nameNode.innerHTML='\x3cspan class\x3d"bold"\x3e'+this.docName+"\x3c/span\x3e",K.add(this.resultNode,"printResultHover")):this._onPrintError(this.nls.printError)},_onPrintError:function(t){console.log(t);this.nameNode.innerHTML=
'\x3cspan class\x3d"bold"\x3e'+this.nls.printError+"\x3c/span\x3e";K.add(this.resultNode,"printResultError")},_openPrint:function(){null!==this.url&&window.open(this.url)}});return q})},"dijit/form/Form":function(){define("dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/sniff ../_Widget ../_TemplatedMixin ./_FormMixin ../layout/_ContentPaneResizeMixin".split(" "),function(f,k,n,s,q,h,e,b){return f("dijit.form.Form",[q,h,e,b],{name:"",action:"",method:"",encType:"","accept-charset":"",accept:"",
target:"",templateString:"\x3cform data-dojo-attach-point\x3d'containerNode' data-dojo-attach-event\x3d'onreset:_onReset,onsubmit:_onSubmit' ${!nameAttrSetting}\x3e\x3c/form\x3e",postMixInProperties:function(){this.nameAttrSetting=this.name?"name\x3d'"+this.name+"'":"";this.inherited(arguments)},execute:function(){},onExecute:function(){},_setEncTypeAttr:function(d){k.set(this.domNode,"encType",d);s("ie")&&(this.domNode.encoding=d);this._set("encType",d)},reset:function(d){var c={returnValue:!0,preventDefault:function(){this.returnValue=
!1},stopPropagation:function(){},currentTarget:d?d.target:this.domNode,target:d?d.target:this.domNode};!1!==this.onReset(c)&&c.returnValue&&this.inherited(arguments,[])},onReset:function(){return!0},_onReset:function(d){this.reset(d);d.stopPropagation();d.preventDefault();return!1},_onSubmit:function(d){var c=this.constructor.prototype;if(this.execute!=c.execute||this.onExecute!=c.onExecute)n.deprecated("dijit.form.Form:execute()/onExecute() are deprecated. Use onSubmit() instead.","","2.0"),this.onExecute(),
this.execute(this.getValues());!1===this.onSubmit(d)&&(d.stopPropagation(),d.preventDefault())},onSubmit:function(){return this.isValid()},submit:function(){!1!==this.onSubmit()&&this.containerNode.submit()}})})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),function(f,k,n,s,q,h,e,b){return k("dijit.ProgressBar",[h,e],{progress:"0",value:"",maximum:100,places:0,
indeterminate:!1,label:"",name:"",templateString:b,_indeterminateHighContrastImagePath:f.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update()},_setDirAttr:function(d){n.toggle(this.domNode,
"dijitProgressBarRtl","rtl"==d);n.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&"rtl"==d);this.inherited(arguments)},update:function(d){s.mixin(this,d||{});d=this.internalProgress;var c=this.domNode,b=1;this.indeterminate?c.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(b=Math.min(parseFloat(this.progress)/100,1),this.progress=b*this.maximum):(this.progress=Math.min(this.progress,this.maximum),b=this.maximum?this.progress/this.maximum:0),c.setAttribute("aria-valuenow",
this.progress));c.setAttribute("aria-labelledby",this.labelNode.id);c.setAttribute("aria-valuemin",0);c.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(b);n.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);n.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());d.style.width=100*b+"%";this.onChange()},_setValueAttr:function(d){this._set("value",d);Infinity==d?this.update({indeterminate:!0}):this.update({indeterminate:!1,
progress:d})},_setLabelAttr:function(d){this._set("label",d);this.update()},_setIndeterminateAttr:function(d){this._set("indeterminate",d);this.update()},report:function(d){return this.label?this.label:this.indeterminate?"\x26#160;":q.format(d,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"dijit/form/RadioButton":function(){define(["dojo/_base/declare","./CheckBox","./_RadioButtonMixin"],function(f,k,n){return f("dijit.form.RadioButton",[k,n],{baseClass:"dijitRadio"})})},
"dijit/form/_RadioButtonMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/lang dojo/query!css2 ../registry".split(" "),function(f,k,n,s,q,h){return k("dijit.form._RadioButtonMixin",null,{type:"radio",_getRelatedWidgets:function(){var e=[];q("input[type\x3dradio]",this.focusNode.form||this.ownerDocument).forEach(s.hitch(this,function(b){b.name==this.name&&b.form==this.focusNode.form&&(b=h.getEnclosingWidget(b))&&e.push(b)}));return e},_setCheckedAttr:function(e){this.inherited(arguments);
this._created&&e&&f.forEach(this._getRelatedWidgets(),s.hitch(this,function(b){b!=this&&b.checked&&b.set("checked",!1)}))},_getSubmitValue:function(e){return null==e?"on":e},_onClick:function(e){return this.checked||this.disabled?(e.stopPropagation(),e.preventDefault(),!1):this.readOnly?(e.stopPropagation(),e.preventDefault(),f.forEach(this._getRelatedWidgets(),s.hitch(this,function(b){n.set(this.focusNode||this.domNode,"checked",b.checked)})),!1):this.inherited(arguments)}})})},"esri/tasks/PrintTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../lang ../layerUtils ../deferredUtils ./Task ../geometry/Polygon ../renderers/SimpleRenderer ../geometry/scaleUtils ./Geoprocessor ./PrintTemplate dojo/dom-construct dojox/gfx/_base dojox/gfx/canvas dojox/json/query require require".split(" "),
function(f,k,n,s,q,h,e,b,d,c,l,a,m,g,z,B,u,r,A,v){return f(l,{declaredClass:"esri.tasks.PrintTask",constructor:function(a,c){this.url=a;this.printGp=new z(this.url);this._handler=k.hitch(this,this._handler);c&&c.async&&(this.async=c.async);this._colorEvaluator=v("$..color")},_handler:function(a,c,d,b,m){try{var e;this.async?"esriJobSucceeded"===a.jobStatus&&this.printGp.getResultData(a.jobId,"Output_File",k.hitch(this,function(a){e=a.value;this._successHandler([e],"onComplete",d,m)})):(e=a[0].value,
this._successHandler([e],"onComplete",d,m))}catch(g){this._errorHandler(g,b,m)}},execute:function(a,d,m){var e=this._handler,g=this._errorHandler,h=a.template||new B,l=h.exportOptions,f;l&&(f={outputSize:[l.width,l.height],dpi:l.dpi});this._outScale=h.outScale;this._preserveScale=!1!==h.preserveScale;var l=h.layoutOptions,r,z=[];if(l){this.legendAll=!1;l.legendLayers?n.forEach(l.legendLayers,function(t){var w={};w.id=t.layerId;t.subLayerIds&&(w.subLayerIds=t.subLayerIds);z.push(w)}):this.legendAll=
!0;var u,G;if("Miles"===l.scalebarUnit||"Kilometers"===l.scalebarUnit)u="esriKilometers",G="esriMiles";else if("Meters"===l.scalebarUnit||"Feet"===l.scalebarUnit)u="esriMeters",G="esriFeet";r={esriMiles:"mi",esriKilometers:"km",esriFeet:"ft",esriMeters:"m"};r={titleText:l.titleText,authorText:l.authorText,copyrightText:l.copyrightText,customTextElements:l.customTextElements,scaleBarOptions:{metricUnit:u,metricLabel:r[u],nonMetricUnit:G,nonMetricLabel:r[G]},legendOptions:{operationalLayers:z}}}u=this._getPrintDefinition(a.map);
a.outSpatialReference&&(u.mapOptions.spatialReference=a.outSpatialReference.toJson());a.template&&b.isDefined(a.template.showAttribution)&&(u.mapOptions.showAttribution=a.template.showAttribution);k.mixin(u,{exportOptions:f,layoutOptions:r});this.allLayerslegend&&k.mixin(u.layoutOptions,{legendOptions:{operationalLayers:this.allLayerslegend}});h={Web_Map_as_JSON:s.toJson(b.fixJson(u)),Format:h.format,Layout_Template:h.layout};a.extraParameters&&(h=k.mixin(h,a.extraParameters));var v=new q(c._dfdCanceller);
a=function(t,w){e(t,w,d,m,v)};f=function(t){g(t,m,v)};v._pendingDfd=this.async?this.printGp.submitJob(h,a,null,f):this.printGp.execute(h,a,f);return v},onComplete:function(){},_createMultipointLayer:function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}},_createPolygonLayer:function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",drawingInfo:{renderer:null}},
featureSet:{geometryType:"esriGeometryPolygon",features:[]}}},_createPointLayer:function(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}},_createPolylineLayer:function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}},_convertSvgSymbol:function(a){if(!(8>=h("ie"))&&
a.path){this._canvasHolder||(this._canvasHolder=u.create("div"),this._canSurface=A.createSurface(this._canvasHolder,200,200));var c=this._canSurface.createObject(A.Path,a.path).setFill(a.color).setStroke(a.outline);"pendingRender"in this._canSurface&&this._canSurface._render(!0);var d=this._canSurface.rawNode.getContext("2d"),b=Math.ceil(c.getBoundingBox().width+c.getBoundingBox().x),m=Math.ceil(c.getBoundingBox().height+c.getBoundingBox().y),e=d.getImageData(c.getBoundingBox().x,c.getBoundingBox().y,
b,m);d.canvas.width=b;d.canvas.height=m;d.putImageData(e,0,0);d=d.canvas.toDataURL("image/png");return{type:"esriPMS",imageData:d.substr(22,d.length),angle:-a.angle,contentType:"image/png",height:a.size?a.size:m-c.getBoundingBox().y,width:a.size?a.size:b-c.getBoundingBox().x,xoffset:a.xoffset,yoffset:a.yoffset}}},_convertSvgRenderer:function(a){"simple"===a.type&&a.symbol&&a.symbol.path?a.symbol=this._convertSvgSymbol(a.symbol):"uniqueValue"===a.type?(a.defaultSymbol&&a.defaultSymbol.path&&(a.defaultSymbol=
this._convertSvgSymbol(a.defaultSymbol)),a.uniqueValueInfos&&n.forEach(a.uniqueValueInfos,function(a){a.symbol.path&&(a.symbol=this._convertSvgSymbol(a.symbol))},this)):"classBreaks"===a.type&&(a.defaultSymbol&&a.defaultSymbol.path&&(a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol)),a.classBreakInfos&&n.forEach(a.classBreakInfos,function(a){a.symbol.path&&(a.symbol=this._convertSvgSymbol(a.symbol))},this))},_createFeatureCollection:function(c,d){var b=this._createPolygonLayer(),m=this._createPolylineLayer(),
e=this._createPointLayer(),h=this._createMultipointLayer(),l=this._createPointLayer();l.layerDefinition.name="textLayer";delete l.layerDefinition.drawingInfo;"esri.layers.FeatureLayer"===c.declaredClass&&(b.layerDefinition.name=m.layerDefinition.name=e.layerDefinition.name=h.layerDefinition.name=c.name||c.id);c.renderer&&!k.isFunction(c.renderer.attributeField)?(b.layerDefinition.drawingInfo.renderer=c.renderer.toJson(),m.layerDefinition.drawingInfo.renderer=c.renderer.toJson(),e.layerDefinition.drawingInfo.renderer=
c.renderer.toJson(),h.layerDefinition.drawingInfo.renderer=c.renderer.toJson()):(delete b.layerDefinition.drawingInfo,delete m.layerDefinition.drawingInfo,delete e.layerDefinition.drawingInfo,delete h.layerDefinition.drawingInfo);var g=c.fields;!g&&(c.renderer&&!k.isFunction(c.renderer.attributeField))&&("esri.renderer.ClassBreaksRenderer"===c.renderer.declaredClass?(g=[{name:c.renderer.attributeField,type:"esriFieldTypeDouble"}],c.renderer.normalizationField&&g.push({name:c.renderer.normalizationField,
type:"esriFieldTypeDouble"})):"esri.renderer.UniqueValueRenderer"===c.renderer.declaredClass&&(g=[{name:c.renderer.attributeField,type:"esriFieldTypeString"}],c.renderer.attributeField2&&g.push({name:c.renderer.attributeField2,type:"esriFieldTypeString"}),c.renderer.attributeField3&&g.push({name:c.renderer.attributeField3,type:"esriFieldTypeString"})));g&&(b.layerDefinition.fields=g,m.layerDefinition.fields=g,e.layerDefinition.fields=g,h.layerDefinition.fields=g);var f;for(f=0;f<c.graphics.length;f++){var q=
c.graphics[f];if(!1!==q.visible&&q.geometry&&(g=q.toJson(),!g.symbol||!(g.symbol.outline&&"esriCLS"===g.symbol.outline.type))){g.symbol&&(g.symbol.outline&&g.symbol.outline.color&&g.symbol.outline.color[3])&&(g.symbol.outline.color[3]=255);if(c.renderer&&!g.symbol&&(k.isFunction(c.renderer.attributeField)||c.renderer.proportionalSymbolInfo||"esri.renderer.DotDensityRenderer"===c.renderer.declaredClass||d))if(d=d||c.renderer,g.symbol=d.getSymbol(q)?d.getSymbol(q).toJson():g.symbol,d.proportionalSymbolInfo)if(d.getSize(q))"point"===
q.geometry.type||"multipoint"===q.geometry.type||"polygon"===q.geometry.type?g.symbol.size=r.px2pt(d.getSize(q)):"polyline"===q.geometry.type&&(g.symbol.width=r.px2pt(d.getSize(q)));else continue;g.symbol&&(g.symbol.path?g.symbol=this._convertSvgSymbol(g.symbol):g.symbol.text&&delete g.attributes);switch(q.geometry.type){case "polygon":b.featureSet.features.push(g);break;case "polyline":m.featureSet.features.push(g);break;case "point":g.symbol&&g.symbol.text?l.featureSet.features.push(g):e.featureSet.features.push(g);
break;case "multipoint":h.featureSet.features.push(g);break;case "extent":g.geometry=a.fromExtent(q.geometry).toJson(),b.featureSet.features.push(g)}}}g=[];0<b.featureSet.features.length&&g.push(b);0<m.featureSet.features.length&&g.push(m);0<h.featureSet.features.length&&g.push(h);0<e.featureSet.features.length&&g.push(e);0<l.featureSet.features.length&&g.push(l);n.forEach(g,function(a){a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&this._convertSvgRenderer(a.layerDefinition.drawingInfo.renderer)},
this);return{id:c.id,opacity:c.opacity,minScale:c.minScale||0,maxScale:c.maxScale||0,featureCollection:{layers:g}}},_getPrintDefinition:function(a){var c={operationalLayers:this._createOperationalLayers(a)},d=a.extent,b=a.spatialReference;a.spatialReference._isWrappable()&&(d=d._normalize(!0),b=d.spatialReference);d={mapOptions:{showAttribution:a.showAttribution,extent:d.toJson(),spatialReference:b.toJson()}};this._preserveScale&&k.mixin(d.mapOptions,{scale:this._outScale||g.getScale(a)});a.timeExtent&&
k.mixin(d.mapOptions,{time:[a.timeExtent.startTime.getTime(),a.timeExtent.endTime.getTime()]});a={};k.mixin(a,d,c);return a},_createOperationalLayers:function(a){var c,b,g,e,h=[],l=[];this.allLayerslegend=this.legendAll?[]:null;for(c=0;c<a.layerIds.length;c++)if(b=a.getLayer(a.layerIds[c]),b.loaded&&b.visible&&-1===n.indexOf(h,b.id))switch(g=b.declaredClass,e={id:b.id,title:b.id,opacity:b.opacity,minScale:b.minScale||0,maxScale:b.maxScale||0},e=k.mixin(e,this._getUrlAndToken(b)),g){case "esri.layers.ArcGISDynamicMapServiceLayer":var f=
[];g=!!b._params.layers;if(b._params.dynamicLayers)g=s.fromJson(b._params.dynamicLayers),n.forEach(g,function(a){f.push({id:a.id,name:a.name,layerDefinition:a});delete a.id;delete a.name;delete a.maxScale;delete a.minScale});else if(b.supportsDynamicLayers){if(g||b.layerDefinitions||b.layerTimeOptions){var q=b.createDynamicLayerInfosFromLayerInfos(),r=null;g&&(r=b.visibleLayers);var r=d._getVisibleLayers(q,r),z=d._getLayersForScale(this._outScale||a.getScale(),q);n.forEach(q,function(a){if(!a.subLayerIds){var c=
a.id;-1<n.indexOf(r,c)&&-1<n.indexOf(z,c)&&(a={source:a.source.toJson()},b.layerDefinitions&&b.layerDefinitions[c]&&(a.definitionExpression=b.layerDefinitions[c]),b.layerTimeOptions&&b.layerTimeOptions[c]&&(a.layerTimeOptions=b.layerTimeOptions[c].toJson()),f.push({id:c,layerDefinition:a}))}});0===f.length&&(e.visibleLayers=[-1])}}else n.forEach(b.layerInfos,function(a){var c={id:a.id,layerDefinition:{}};b.layerDefinitions&&b.layerDefinitions[a.id]&&(c.layerDefinition.definitionExpression=b.layerDefinitions[a.id]);
b.layerTimeOptions&&b.layerTimeOptions[a.id]&&(c.layerDefinition.layerTimeOptions=b.layerTimeOptions[a.id].toJson());(c.layerDefinition.definitionExpression||c.layerDefinition.layerTimeOptions)&&f.push(c)}),g&&(e.visibleLayers=b.visibleLayers);f.length&&(e.layers=f);l.push(e);this.allLayerslegend&&this.allLayerslegend.push({id:b.id,subLayerIds:b.visibleLayers});break;case "esri.layers.ArcGISImageServiceLayer":e=k.mixin(e,{url:b.url,bandIds:b.bandIds,compressionQuality:b.compressionQuality,format:b.format,
interpolation:b.interpolation});b.mosaicRule&&k.mixin(e,{mosaicRule:b.mosaicRule.toJson()});b.renderingRule&&k.mixin(e,{renderingRule:b.renderingRule.toJson()});l.push(e);this.allLayerslegend&&this.allLayerslegend.push({id:b.id});break;case "esri.layers.WMSLayer":e=k.mixin(e,{url:b.url,title:b.title,type:"wms",version:b.version,transparentBackground:b.imageTransparency,visibleLayers:b.visibleLayers});l.push(e);this.allLayerslegend&&this.allLayerslegend.push({id:b.id,subLayerIds:b.visibleLayers});
break;case "esri.virtualearth.VETiledLayer":g=b.mapStyle;"aerialWithLabels"===g&&(g="Hybrid");e=k.mixin(e,{visibility:b.visible,type:"BingMaps"+g,culture:b.culture,key:b.bingMapsKey});l.push(e);break;case "esri.layers.OpenStreetMapLayer":e=k.mixin(e,{type:"OpenStreetMap",url:b.tileServers[0]});l.push(e);break;case "esri.layers.WMTSLayer":e=k.mixin(e,{url:b.url,type:"wmts",layer:b._identifier,style:b._style,format:b.format,tileMatrixSet:b._tileMatrixSetId});l.push(e);break;case "esri.layers.MapImageLayer":g=
b.getImages();n.forEach(g,function(a,c){a.href&&(e={id:b.id+"_image"+c,type:"image",title:b.id,minScale:b.minScale||0,maxScale:b.maxScale||0,opacity:b.opacity,extent:a.extent.toJson(),url:a.href},l.push(e))});break;case "esri.layers.WebTiledLayer":g=b.url.replace(/\$\{/g,"{");e=k.mixin(e,{type:"WebTiledLayer",urlTemplate:g,credits:b.copyright});b.subDomains&&0<b.subDomains.length&&(e.subDomains=b.subDomains);l.push(e);break;default:if(b.getTileUrl||b.getImageUrl)e=k.mixin(e,{url:b.url}),l.push(e)}for(c=
0;c<a.graphicsLayerIds.length;c++)if(b=a.getLayer(a.graphicsLayerIds[c]),b.loaded&&b.visible&&-1===n.indexOf(h,b.id))switch(g=b.declaredClass,g){case "esri.layers.FeatureLayer":case "esri.layers.LabelLayer":case "esri.layers.CSVLayer":g=null;b.url&&b.renderer&&("esri.renderer.ScaleDependentRenderer"===b.renderer.declaredClass?"scale"===b.renderer.rangeType?g=b.renderer.getRendererInfoByScale(a.getScale())&&b.renderer.getRendererInfoByScale(a.getScale()).renderer:"zoom"===b.renderer.rangeType&&(g=
b.renderer.getRendererInfoByZoom(a.getZoom())&&b.renderer.getRendererInfoByZoom(a.getZoom()).renderer):g=b.renderer);if(g&&("esri.renderer.SimpleRenderer"===g.declaredClass||"esri.renderer.TemporalRenderer"===g.declaredClass||k.isString(g.attributeField)&&b._getField(g.attributeField,!0))&&!g.proportionalSymbolInfo&&"esri.renderer.DotDensityRenderer"!==g.declaredClass&&"esri.layers.CSVLayer"!==b.declaredClass)if(e={id:b.id,title:b.id,opacity:b.opacity,minScale:b.minScale||0,maxScale:b.maxScale||0,
layerDefinition:{drawingInfo:{renderer:g.toJson()}}},e=k.mixin(e,this._getUrlAndToken(b)),"esri.renderer.TemporalRenderer"===g.declaredClass&&(q=e.layerDefinition.drawingInfo,q.latestObservationRenderer=q.renderer.latestObservationRenderer,q.trackLinesRenderer=q.renderer.trackRenderer,q.observationAger=q.renderer.observationAger,q.renderer=q.renderer.observationRenderer,b._trackIdField&&(e.layerDefinition.timeInfo={trackIdField:b._trackIdField})),this._convertSvgRenderer(e.layerDefinition.drawingInfo.renderer),
1>b.opacity||"esri.renderer.TemporalRenderer"===g.declaredClass||this._updateLayerOpacity(e))if(b._params.source&&(g=b._params.source.toJson(),k.mixin(e.layerDefinition,{source:g})),b.getDefinitionExpression()&&k.mixin(e.layerDefinition,{definitionExpression:b.getDefinitionExpression()}),2!==b.mode)0<b.getSelectedFeatures().length&&(g=n.map(b.getSelectedFeatures(),function(a){return a.attributes[b.objectIdField]}),0<g.length&&b.getSelectionSymbol()&&k.mixin(e,{selectionObjectIds:g,selectionSymbol:b.getSelectionSymbol().toJson()}));
else{g=n.map(b.getSelectedFeatures(),function(a){return a.attributes[b.objectIdField]});if(0===g.length||!b._params.drawMode)break;k.mixin(e.layerDefinition,{objectIds:g});g=null;b.getSelectionSymbol()&&(g=new m(b.getSelectionSymbol()));k.mixin(e.layerDefinition.drawingInfo,{renderer:g&&g.toJson()})}else e=this._createFeatureCollection(b);else e=g&&(g.proportionalSymbolInfo||"esri.renderer.DotDensityRenderer"===g.declaredClass)?this._createFeatureCollection(b,g):this._createFeatureCollection(b);l.push(e);
this.allLayerslegend&&this.allLayerslegend.push({id:b.id});break;case "esri.layers.GraphicsLayer":e=this._createFeatureCollection(b),l.push(e),this.allLayerslegend&&this.allLayerslegend.push({id:b.id})}a.graphics&&0<a.graphics.graphics.length&&(e=this._createFeatureCollection(a.graphics),l.push(e));a._labels&&(e=this._createFeatureCollection(a._labels),l.push(e));return l},_getUrlAndToken:function(a){return{token:a._getToken(),url:a._url?a._url.path:null}},_updateLayerOpacity:function(a){var b=this._colorEvaluator(a),
b=n.filter(b,function(a){return k.isArray(a)&&4===a.length}),c=!0;if(b.length){var d=b[0][3],g;for(g=1;g<b.length;g++)if(d!==b[g][3]){c=!1;break}if(c){a.opacity=d/255;for(g=0;g<b.length;g++)b[g][3]=255}}return c}})})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),
function(f,k,n,s,q,h,e,b,d,c,l,a,m,g,z,B,u,r,A,v,x,C,y){f=f(a,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(a){this._jobUpdateHandler=k.hitch(this,this._jobUpdateHandler);this._getJobStatus=k.hitch(this,this._getJobStatus);this._getResultDataHandler=
k.hitch(this,this._getResultDataHandler);this._getResultImageHandler=k.hitch(this,this._getResultImageHandler);this._executeHandler=k.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(a){this.updateDelay=a},setProcessSpatialReference:function(a){this.processSpatialReference=a},setOutputSpatialReference:function(a){this._setOutSR(a)},setOutSpatialReference:function(a){this._setOutSR(a)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(a){this.outSpatialReference=this.outputSpatialReference=a},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(a,b,c){for(var d in a){var g=a[d];k.isArray(g)?a[d]=q.toJson(n.map(g,function(a){return this._gpEncode({item:a},!0).item},this)):g instanceof Date&&(a[d]=g.getTime())}return this._encode(a,b,c)},_decode:function(a){var b=a.dataType,
c=new v(a);if(-1!==n.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],b))return c;if("GPLinearUnit"===b)c.value=new B(c.value);else if("GPFeatureRecordSetLayer"===b||"GPRecordSet"===b)c.value=new m(c.value);else if("GPDataFile"===b)c.value=new u(c.value);else if("GPDate"===b)a=c.value,k.isString(a)?c.value=new A({date:a}):c.value=new Date(a);else if("GPRasterData"===b||"GPRasterDataLayer"===b)a=a.value.mapImage,c.value=a?new y(a):new r(c.value);else if(-1!==b.indexOf("GPMultiValue:")){var d=b.split(":")[1];
a=c.value;c.value=n.map(a,function(a){return this._decode({paramName:"_name",dataType:d,value:a}).value},this)}else console.log(this.declaredClass+" : GP Data type not handled. : "+c.dataType),c=null;return c},submitJob:function(a,b,c,g,e){var m=this._getOutSR(),l=e.assembly;a=this._gpEncode(k.mixin({},this._url.query,{f:"json","env:outSR":m?m.wkid||q.toJson(m.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||q.toJson(this.processSpatialReference.toJson()):
null},a),null,l&&l[0]);var h=this._jobUpdateHandler,f=this._errorHandler;return d({url:this._url.path+"/submitJob",content:a,callbackParamName:"callback",load:function(a,t){h(a,t,!1,b,c,e.dfd)},error:function(a){f(a,g,e.dfd)}})},_jobUpdateHandler:function(a,b,c,d,e,m){var l=a.jobId;b=new g(a);this._successHandler([b],"onStatusUpdate",e,c&&m);if(!c)switch(clearTimeout(this._updateTimers[l]),this._updateTimers[l]=null,m&&m.progress(b),a.jobStatus){case g.STATUS_SUBMITTED:case g.STATUS_EXECUTING:case g.STATUS_WAITING:case g.STATUS_NEW:var h=
this._getJobStatus;this._updateTimers[l]=setTimeout(function(){h(l,c,d,e,m)},this.updateDelay);break;default:this._successHandler([b],"onJobComplete",d,m)}},_getJobStatus:function(a,b,c,g,e){var m=this._jobUpdateHandler;d({url:this._url.path+"/jobs/"+a,content:k.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,d){m(a,d,b,c,g,e)},error:this._errorHandler})},_getResultDataHandler:function(a,b,c,d,g){try{var e=this._decode(a);this._successHandler([e],"onGetResultDataComplete",
c,g)}catch(m){this._errorHandler(m,d,g)}},getResultData:function(a,b,g,e){var m=this._getResultDataHandler,l=this._errorHandler,h=new s(c._dfdCanceller);h._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/results/"+b,content:k.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(a,b){m(a,b,g,e,h)},error:function(a){l(a,e,h)}});return h},checkJobStatus:function(a,b,g){var e=this._jobUpdateHandler,m=this._errorHandler,l=new s(c._dfdCanceller);l._pendingDfd=
d({url:this._url.path+"/jobs/"+a,content:k.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,c){e(a,c,!0,null,b,l)},error:function(a){m(a,g,l)}});return l},cancelJob:function(a,b,g){var e=this._errorHandler,m=new s(c._dfdCanceller);m._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/cancel",content:k.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:k.hitch(this,function(a,c){this._successHandler([a],"onJobCancel",b,m)}),error:function(a){e(a,g,m)}});
return m},execute:function(a,b,c,g){var e=this._getOutSR(),m=g.assembly;a=this._gpEncode(k.mixin({},this._url.query,{f:"json","env:outSR":e?e.wkid||q.toJson(e.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||q.toJson(this.processSpatialReference.toJson()):null},a),null,m&&m[0]);var l=this._executeHandler,h=this._errorHandler;return d({url:this._url.path+"/execute",content:a,callbackParamName:"callback",load:function(a,d){l(a,d,b,c,g.dfd)},error:function(a){h(a,
c,g.dfd)}})},_executeHandler:function(a,b,c,d,g){try{var e=a.results,m,l,h=a.messages;m=0;for(l=e.length;m<l;m++)e[m]=this._decode(e[m]);m=0;for(l=h.length;m<l;m++)h[m]=new z(h[m]);this._successHandler([e,h],"onExecuteComplete",c,g)}catch(f){this._errorHandler(f,d,g)}},_getResultImageHandler:function(a,b,c,d,g){try{var e=this._decode(a);this._successHandler([e],"onGetResultImageComplete",c,g)}catch(m){this._errorHandler(m,d,g)}},getResultImage:function(a,b,g,e,m){var l=this._getResultImageHandler,
h=this._errorHandler;g=this._gpEncode(k.mixin({},this._url.query,{f:"json"},g.toJson()));var f=new s(c._dfdCanceller);f._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/results/"+b,content:g,callbackParamName:"callback",load:function(a,b){l(a,b,e,m,f)},error:function(a){h(a,m,f)}});return f},cancelJobStatusUpdates:function(a){clearTimeout(this._updateTimers[a]);this._updateTimers[a]=null},getResultImageLayer:function(a,b,c,d){if(null==b){var g=this._url.path.indexOf("/GPServer/");a=this._url.path.substring(0,
g)+"/MapServer/jobs/"+a}else a=this._url.path+"/jobs/"+a+"/results/"+b;this._url.query&&(a+="?"+e.objectToQuery(this._url.query));b=null==b?new C(a,{imageParameters:c}):new x(a,{imageParameters:c},!0);this.onGetResultImageLayerComplete(b);d&&d(b);return b},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});l._createWrappers(f);
return f})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(f,k,n,s,q){f=f(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(h){this.messages=[];k.mixin(this,h);h=this.messages;var e,b=h.length;for(e=0;e<b;e++)h[e]=new q(h[e])},jobId:"",jobStatus:""});k.mixin(f,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",
STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"});return f})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,k,n,s){f=f(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(f){k.mixin(this,f)}});k.mixin(f,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",
TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"});return f})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,k,n,s){return f(null,{declaredClass:"esri.tasks.LinearUnit",constructor:function(f){f&&k.mixin(this,f)},distance:0,units:null,
toJson:function(){var f={};this.distance&&(f.distance=this.distance);this.units&&(f.units=this.units);return f}})})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,k,n,s){return f(null,{declaredClass:"esri.tasks.DataFile",constructor:function(f){f&&k.mixin(this,f)},url:null,itemID:null,toJson:function(){var f={};this.url&&(f.url=this.url);this.itemID&&(f.itemID=this.itemID);return f}})})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(f,k,n,s){return f(null,{declaredClass:"esri.tasks.RasterData",constructor:function(f){f&&k.mixin(this,f)},url:null,format:null,itemID:null,toJson:function(){var f={};this.url&&(f.url=this.url);this.format&&(f.format=this.format);this.itemID&&(f.itemID=this.itemID);return f}})})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(f,k,n,s,q){return f(null,{declaredClass:"esri.tasks.Date",
constructor:function(h){h&&(h.format&&(this.format=h.format),this.date=n.parse(h.date,{selector:"date",datePattern:this.format}))},date:new Date,format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:n.format(this.date,{selector:"date",datePattern:this.format}),format:this.format}}})})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,k,n,s){return f(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(f){k.mixin(this,
f)}})})},"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),function(f,k,n,s,q,h,e){return f(e,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(b,d){d&&(d.imageParameters&&d.imageParameters.extent)&&(this.initialExtent=this.fullExtent=d.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=k.hitch(this,
this.getImageUrl);this.loaded=!0;this.onLoad(this)},getImageUrl:function(b,d,c,e){var a=b.spatialReference.wkid;e(this._url.path+"?"+q.objectToQuery(k.mixin(this._params,{f:"image",bbox:n.toJson(b.toJson()),bboxSR:a,imageSR:a,size:d+","+c})))}})})},"esri/tasks/PrintTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,k,n,s){return f(null,{declaredClass:"esri.tasks.PrintTemplate",label:null,exportOptions:{width:800,height:1100,dpi:96},layoutOptions:null,
format:"PNG32",layout:"MAP_ONLY",outScale:0,preserveScale:!0,showAttribution:null})})},"dojox/gfx/canvas":function(){define("./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(f,k,n,s,q,h,e,b,d,c,l,a,m){function g(a,b,c,d,g,e,m,l,h,f){var n,k,q=b.length,r=0;f?(k=f.l/g,r=f.i):k=b[0]/g;for(;e<m;)e+k>m&&(n={l:(e+k-m)*g,i:r},k=m-e),r%2||(a.beginPath(),a.arc(c,d,g,e,e+k,l),
h&&a.stroke()),e+=k,++r,k=b[r%q]/g;return n}function z(a,b,c,g){var d=0,e=0,l,h=0;g?(l=g.l,h=g.i):l=b[0];for(;1>e;)e=m.tAtLength(a,l),1==e&&(d=m.computeLength(a),d={l:l-d,i:h}),a=m.splitBezierAtT(a,e),h%2||c.push(a[0]),a=a[1],++h,l=b[h%b.length];return d}function B(a,b,c,d){var g=[b.last.x,b.last.y].concat(c),e=!(a instanceof Array);c=4===c.length?"quadraticCurveTo":"bezierCurveTo";var m=[];b=z(g,b.canvasDash,m,d);for(d=0;d<m.length;++d)g=m[d],e?(a.moveTo(g[0],g[1]),a[c].apply(a,g.slice(2))):(a.push("moveTo",
[g[0],g[1]]),a.push(c,g.slice(2)));return b}function u(a,b,c,g,d,e,l){var h=0,f=0,k=0,n=m.distance(c,g,d,e),q=0;b=b.canvasDash;var r=c,s=g,z,u=!(a instanceof Array);l?(k=l.l,q=l.i):k+=b[0];for(;0.01<Math.abs(1-f);)k>n&&(h={l:k-n,i:q},k=n),f=k/n,l=c+(d-c)*f,z=g+(e-g)*f,q++%2||(u?(a.moveTo(r,s),a.lineTo(l,z)):(a.push("moveTo",[r,s]),a.push("lineTo",[l,z]))),r=l,s=z,k+=b[q%b.length];return h}var r=f.canvas={},A=null,v=l.multiplyPoint,x=Math.PI,C=2*x,y=x/2;a=k.extend;if(q.global.CanvasRenderingContext2D){q=
q.doc.createElement("canvas").getContext("2d");var I="function"==typeof q.setLineDash,K="function"==typeof q.fillText}var L={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};r.Shape=s("dojox.gfx.canvas.Shape",b.Shape,{_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);this._renderShape(a);this._renderFill(a,!0);this._renderStroke(a,
!0);a.restore()},_renderClip:function(a){this.canvasClip&&(this.canvasClip.render(a),a.clip())},_renderTransform:function(a){if("canvasTransform"in this){var b=this.canvasTransform;a.translate(b.dx,b.dy);a.rotate(b.angle2);a.scale(b.sx,b.sy);a.rotate(b.angle1)}},_renderShape:function(a){},_renderFill:function(a,b){if("canvasFill"in this){var c=this.fillStyle;if("canvasFillImage"in this){var g=c.width,d=c.height,e=this.canvasFillImage.width,m=this.canvasFillImage.height,l=Math.min(g==e?1:g/e,d==m?
1:d/m),h=(g-l*e)/2,f=(d-l*m)/2;A.width=g;A.height=d;var k=A.getContext("2d");k.clearRect(0,0,g,d);k.drawImage(this.canvasFillImage,0,0,e,m,h,f,l*e,l*m);this.canvasFill=a.createPattern(A,"repeat");delete this.canvasFillImage}a.fillStyle=this.canvasFill;b&&("pattern"===c.type&&(0!==c.x||0!==c.y)&&a.translate(c.x,c.y),a.fill())}else a.fillStyle="rgba(0,0,0,0.0)"},_renderStroke:function(a,b){var c=this.strokeStyle;c?(a.strokeStyle=c.color.toString(),a.lineWidth=c.width,a.lineCap=c.cap,"number"==typeof c.join?
(a.lineJoin="miter",a.miterLimit=c.join):a.lineJoin=c.join,this.canvasDash?I?(a.setLineDash(this.canvasDash),b&&a.stroke()):this._renderDashedStroke(a,b):b&&a.stroke()):b||(a.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(a,b){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,setClip:function(a){this.inherited(arguments);var b=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&
!b)return this;this.canvasClip=a?M(b,a):null;this.parent&&this.parent._makeDirty();return this}});var M=function(a,b){switch(a){case "ellipse":return{canvasEllipse:J({shape:b}),render:function(a){return r.Ellipse.prototype._renderShape.call(this,a)}};case "rect":return{shape:k.delegate(b,{r:0}),render:function(a){return r.Rect.prototype._renderShape.call(this,a)}};case "path":return{canvasPath:N(b),render:function(a){this.canvasPath._renderShape(a)}};case "polyline":return{canvasPolyline:b.points,
render:function(a){return r.Polyline.prototype._renderShape.call(this,a)}}}return null},N=function(a){var b=new dojox.gfx.canvas.Path;b.canvasPath=[];b._setPath(a.d);return b},F=function(a,b,c){var g=a.prototype[b];a.prototype[b]=c?function(){this.parent&&this.parent._makeDirty();g.apply(this,arguments);c.call(this);return this}:function(){this.parent&&this.parent._makeDirty();return g.apply(this,arguments)}};F(r.Shape,"setTransform",function(){this.matrix?this.canvasTransform=f.decompose(this.matrix):
delete this.canvasTransform});F(r.Shape,"setFill",function(){var a=this.fillStyle,b;if(a){if("object"==typeof a&&"type"in a){var c=this.surface.rawNode.getContext("2d");switch(a.type){case "linear":case "radial":b="linear"==a.type?c.createLinearGradient(a.x1,a.y1,a.x2,a.y2):c.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.r);n.forEach(a.colors,function(a){b.addColorStop(a.offset,f.normalizeColor(a.color).toString())});break;case "pattern":A||(A=document.createElement("canvas")),c=new Image,this.surface.downloadImage(c,
a.src),this.canvasFillImage=c}}else b=a.toString();this.canvasFill=b}else delete this.canvasFill});F(r.Shape,"setStroke",function(){var a=this.strokeStyle;if(a){var b=this.strokeStyle.style.toLowerCase();b in L&&(b=L[b]);if(b instanceof Array){this.canvasDash=b=b.slice();var c;for(c=0;c<b.length;++c)b[c]*=a.width;if("butt"!=a.cap){for(c=0;c<b.length;c+=2)b[c]-=a.width,1>b[c]&&(b[c]=1);for(c=1;c<b.length;c+=2)b[c]+=a.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!I&&
!!this.canvasDash});F(r.Shape,"setShape");r.Group=s("dojox.gfx.canvas.Group",r.Shape,{constructor:function(){b.Container._init.call(this)},_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},destroy:function(){b.Container.clear.call(this,!0);r.Shape.prototype.destroy.apply(this,arguments)}});r.Rect=s("dojox.gfx.canvas.Rect",[r.Shape,b.Rect],{_renderShape:function(a){var b=this.shape,c=Math.min(b.r,
b.height/2,b.width/2),g=b.x,d=g+b.width,e=b.y,b=e+b.height,m=g+c,l=d-c,h=e+c,f=b-c;a.beginPath();a.moveTo(m,e);c?(a.arc(l,h,c,-y,0,!1),a.arc(l,f,c,0,y,!1),a.arc(m,f,c,y,x,!1),a.arc(m,h,c,x,x+y,!1)):(a.lineTo(l,e),a.lineTo(d,f),a.lineTo(m,b),a.lineTo(g,h));a.closePath()},_renderDashedStroke:function(a,b){var c=this.shape,d=Math.min(c.r,c.height/2,c.width/2),e=c.x,m=e+c.width,l=c.y,h=l+c.height,f=e+d,k=m-d,n=l+d,q=h-d;d?(a.beginPath(),c=u(a,this,f,l,k,l),b&&a.stroke(),c=g(a,this.canvasDash,k,n,d,-y,
0,!1,b,c),a.beginPath(),c=u(a,this,m,n,m,q,c),b&&a.stroke(),c=g(a,this.canvasDash,k,q,d,0,y,!1,b,c),a.beginPath(),c=u(a,this,k,h,f,h,c),b&&a.stroke(),c=g(a,this.canvasDash,f,q,d,y,x,!1,b,c),a.beginPath(),c=u(a,this,e,q,e,n,c),b&&a.stroke(),g(a,this.canvasDash,f,n,d,x,x+y,!1,b,c)):(a.beginPath(),c=u(a,this,f,l,k,l),c=u(a,this,k,l,m,q,c),c=u(a,this,m,q,f,h,c),u(a,this,f,h,e,n,c),b&&a.stroke())}});var D=[];(function(){var a=c.curvePI4;D.push(a.s,a.c1,a.c2,a.e);for(var b=45;360>b;b+=45){var d=l.rotateg(b);
D.push(v(d,a.c1),v(d,a.c2),v(d,a.e))}})();var J=function(a){var b,c,d,g=[],e=a.shape,m=l.normalize([l.translate(e.cx,e.cy),l.scale(e.rx,e.ry)]);b=v(m,D[0]);g.push([b.x,b.y]);for(e=1;e<D.length;e+=3)c=v(m,D[e]),d=v(m,D[e+1]),b=v(m,D[e+2]),g.push([c.x,c.y,d.x,d.y,b.x,b.y]);if(a._needsDash){b=[];c=g[0];for(e=1;e<g.length;++e)d=[],z(c.concat(g[e]),a.canvasDash,d),c=[g[e][4],g[e][5]],b.push(d);a._dashedPoints=b}return g};r.Ellipse=s("dojox.gfx.canvas.Ellipse",[r.Shape,b.Ellipse],{setShape:function(){this.inherited(arguments);
this.canvasEllipse=J(this);return this},setStroke:function(){this.inherited(arguments);I||(this.canvasEllipse=J(this));return this},_renderShape:function(a){var b=this.canvasEllipse,c;a.beginPath();a.moveTo.apply(a,b[0]);for(c=1;c<b.length;++c)a.bezierCurveTo.apply(a,b[c]);a.closePath()},_renderDashedStroke:function(a,b){var c=this._dashedPoints;a.beginPath();for(var d=0;d<c.length;++d)for(var g=c[d],e=0;e<g.length;++e){var m=g[e];a.moveTo(m[0],m[1]);a.bezierCurveTo(m[2],m[3],m[4],m[5],m[6],m[7])}b&&
a.stroke()}});r.Circle=s("dojox.gfx.canvas.Circle",[r.Shape,b.Circle],{_renderShape:function(a){var b=this.shape;a.beginPath();a.arc(b.cx,b.cy,b.r,0,C,1)},_renderDashedStroke:function(a,b){var c=this.shape,d=0,g,e=this.canvasDash.length;for(i=0;d<C;)g=this.canvasDash[i%e]/c.r,i%2||(a.beginPath(),a.arc(c.cx,c.cy,c.r,d,d+g,0),b&&a.stroke()),d+=g,++i}});r.Line=s("dojox.gfx.canvas.Line",[r.Shape,b.Line],{_renderShape:function(a){var b=this.shape;a.beginPath();a.moveTo(b.x1,b.y1);a.lineTo(b.x2,b.y2)},
_renderDashedStroke:function(a,b){var c=this.shape;a.beginPath();u(a,this,c.x1,c.y1,c.x2,c.y2);b&&a.stroke()}});r.Polyline=s("dojox.gfx.canvas.Polyline",[r.Shape,b.Polyline],{setShape:function(){this.inherited(arguments);var a=this.shape.points,b=a[0],c,d;this.bbox=null;this._normalizePoints();if(a.length)if("number"==typeof b)b=a;else{b=[];for(d=0;d<a.length;++d)c=a[d],b.push(c.x,c.y)}else b=[];this.canvasPolyline=b;return this},_renderShape:function(a){var b=this.canvasPolyline;if(b.length){a.beginPath();
a.moveTo(b[0],b[1]);for(var c=2;c<b.length;c+=2)a.lineTo(b[c],b[c+1])}},_renderDashedStroke:function(a,b){var c=this.canvasPolyline,d=0;a.beginPath();for(var g=0;g<c.length;g+=2)d=u(a,this,c[g],c[g+1],c[g+2],c[g+3],d);b&&a.stroke()}});r.Image=s("dojox.gfx.canvas.Image",[r.Shape,b.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var b=this.shape;a.drawImage(this.canvasImage,b.x,
b.y,b.width,b.height)}});r.Text=s("dojox.gfx.canvas.Text",[r.Shape,b.Text],{_setFont:function(){this.fontStyle?this.canvasFont=f.makeFontString(this.fontStyle):delete this.canvasFont},getTextWidth:function(){var a=this.shape,b=0,c;a.text&&(c=this.surface.rawNode.getContext("2d"),c.save(),this._renderTransform(c),this._renderFill(c,!1),this._renderStroke(c,!1),this.canvasFont&&(c.font=this.canvasFont),b=c.measureText(a.text).width,c.restore());return b},_render:function(a){a.save();this._renderTransform(a);
this._renderFill(a,!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var b,c=this.shape;c.text&&(b="middle"===c.align?"center":c.align,a.textAlign=b,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(c.text,c.x,c.y),this.strokeStyle&&(a.beginPath(),a.strokeText(c.text,c.x,c.y),a.closePath()))}});F(r.Text,"setFont");K||r.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var G={M:"_moveToA",
m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};r.Path=s("dojox.gfx.canvas.Path",[r.Shape,d.Path],{constructor:function(){this.lastControl={}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);
I||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(a){var b=k.clone(this.last);this[G[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=b;this.inherited(arguments)},_renderShape:function(a){var b=this.canvasPath;a.beginPath();for(var c=0;c<b.length;c+=2)a[b[c]].apply(a,b[c+1])},_renderDashedStroke:I?function(){}:function(a,b){var c=this._dashedPath;
a.beginPath();for(var d=0;d<c.length;d+=2)a[c[d]].apply(a,c[d+1]);b&&a.stroke()},_moveToA:function(a,b,c,d){a.push("moveTo",[c[0],c[1]]);d&&d.push("moveTo",[c[0],c[1]]);for(b=2;b<c.length;b+=2)a.push("lineTo",[c[b],c[b+1]]),d&&(this._dashResidue=u(d,this,c[b-2],c[b-1],c[b],c[b+1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_moveToR:function(a,b,c,d){b="x"in this.last?[this.last.x+=c[0],this.last.y+=c[1]]:[this.last.x=c[0],this.last.y=c[1]];a.push("moveTo",
b);d&&d.push("moveTo",b);for(b=2;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,b,c,d){for(b=0;b<c.length;b+=2)d&&(this._dashResidue=u(d,this,this.last.x,this.last.y,c[b],c[b+1],this._dashResidue)),a.push("lineTo",[c[b],c[b+1]]);this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl={}},_lineToR:function(a,b,c,
d){for(b=0;b<c.length;b+=2)a.push("lineTo",[this.last.x+=c[b],this.last.y+=c[b+1]]),d&&(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_hLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[c[b],this.last.y]),d&&(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],c[b],this.last.y,this._dashResidue));this.last.x=c[c.length-1];this.lastControl={}},_hLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",
[this.last.x+=c[b],this.last.y]),d&&(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_vLineToA:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,c[b]]),d&&(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,c[b],this._dashResidue));this.last.y=c[c.length-1];this.lastControl={}},_vLineToR:function(a,b,c,d){for(b=0;b<c.length;++b)a.push("lineTo",[this.last.x,this.last.y+=c[b]]),d&&
(this._dashResidue=u(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",c.slice(b,b+6)),d&&(this._dashResidue=B(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type="C"},_curveToR:function(a,b,c,d){for(b=0;b<c.length;b+=6)a.push("bezierCurveTo",
[this.last.x+c[b],this.last.y+c[b+1],this.lastControl.x=this.last.x+c[b+2],this.lastControl.y=this.last.y+c[b+3],this.last.x+c[b+4],this.last.y+c[b+5]]),d&&(this._dashResidue=B(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+4],this.last.y+=c[b+5];this.lastControl.type="C"},_smoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4){var g="C"==this.lastControl.type;a.push("bezierCurveTo",[g?2*this.last.x-this.lastControl.x:this.last.x,g?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+
1],c[b+2],c[b+3]]);d&&(this._dashResidue=B(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=c[b];this.lastControl.y=c[b+1];this.lastControl.type="C"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_smoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4){var g="C"==this.lastControl.type;a.push("bezierCurveTo",[g?2*this.last.x-this.lastControl.x:this.last.x,g?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]);d&&
(this._dashResidue=B(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+c[b];this.lastControl.y=this.last.y+c[b+1];this.lastControl.type="C";this.last.x+=c[b+2];this.last.y+=c[b+3]}},_qCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",c.slice(b,b+4));d&&(this._dashResidue=B(d,this,a[a.length-1],this._dashResidue));this.last.x=c[c.length-2];this.last.y=c[c.length-1];this.lastControl.x=c[c.length-4];this.lastControl.y=c[c.length-3];this.lastControl.type=
"Q"},_qCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+c[b],this.lastControl.y=this.last.y+c[b+1],this.last.x+c[b+2],this.last.y+c[b+3]]),d&&(this._dashResidue=B(d,this,a[a.length-1],this._dashResidue)),this.last.x+=c[b+2],this.last.y+=c[b+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,b,c,d){for(b=0;b<c.length;b+=2){var g="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=g?2*this.last.x-this.lastControl.x:
this.last.x,this.lastControl.y=g?2*this.last.y-this.lastControl.y:this.last.y,c[b],c[b+1]]);d&&(this._dashResidue=B(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q"}this.last.x=c[c.length-2];this.last.y=c[c.length-1]},_qSmoothCurveToR:function(a,b,c,d){for(b=0;b<c.length;b+=2){var g="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=g?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=g?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+c[b],
this.last.y+c[b+1]]);d&&(this._dashResidue=B(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=c[b];this.last.y+=c[b+1]}},_arcTo:function(a,b,d,g){b="a"==b;for(var e=0;e<d.length;e+=7){var m=d[e+5],l=d[e+6];b&&(m+=this.last.x,l+=this.last.y);var h=c.arcAsBezier(this.last,d[e],d[e+1],d[e+2],d[e+3]?1:0,d[e+4]?1:0,m,l);n.forEach(h,function(b){a.push("bezierCurveTo",b)});g&&(this._dashResidue=B(g,this,p,this._dashResidue));this.last.x=m;this.last.y=l}this.lastControl={}},
_closePath:function(a,b,c,d){a.push("closePath",[]);d&&(this._dashResidue=u(d,this,this.last.x,this.last.y,d[1][0],d[1][1],this._dashResidue));this.lastControl={}}});n.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),function(a){F(r.Path,a)});r.TextPath=s("dojox.gfx.canvas.TextPath",[r.Shape,d.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});r.Surface=s("dojox.gfx.canvas.Surface",b.Surface,{constructor:function(){b.Container._init.call(this);
this.pendingImageCount=0;this.makeDirty()},destroy:function(){b.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,b){this.width=f.normalizedLength(a);this.height=f.normalizedLength(b);if(!this.rawNode)return this;var c=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,c=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,c=!0);c&&this.makeDirty();return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:
null},_render:function(a){if(this.rawNode&&(a||!this.pendingImageCount))a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender)},render:function(a){a.save();for(var b=0;b<this.children.length;++b)this.children[b]._render(a);a.restore()},makeDirty:function(){!this.pendingImagesCount&&(!("pendingRender"in this)&&!this._batch)&&(this.pendingRender=setTimeout(k.hitch(this,
this._render),0))},downloadImage:function(a,b){var c=k.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=c;a.onerror=c;a.onabort=c;a.src=b},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},on:function(){}});r.createSurface=function(a,b,c){if(!b&&!c){var d=
h.position(a);b=b||d.w;c=c||d.h}"number"==typeof b&&(b+="px");"number"==typeof c&&(c+="px");d=new r.Surface;a=e.byId(a);var g=a.ownerDocument.createElement("canvas");g.width=f.normalizedLength(b);g.height=f.normalizedLength(c);a.appendChild(g);d.rawNode=g;d._parent=a;return d.surface=d};var H=b.Container;s={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},
add:function(a){this._makeDirty();return H.add.apply(this,arguments)},remove:function(a,b){this._makeDirty();return H.remove.apply(this,arguments)},clear:function(){this._makeDirty();return H.clear.apply(this,arguments)},getBoundingBox:H.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return H._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return H._moveChildToBack.apply(this,arguments)}};d={createObject:function(a,b){var c=new a;c.surface=this.surface;
c.setShape(b);this.add(c);return c}};a(r.Group,s);a(r.Group,b.Creator);a(r.Group,d);a(r.Surface,s);a(r.Surface,b.Creator);a(r.Surface,d);r.fixTarget=function(a,b){return!0};return r})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(f,k,n,s,q,h,e,b,d,c){var l=f.shape={};l.Shape=n("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=
this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(q("gfxRegistry")){var a=l.register(this);this.getUID=function(){return a}}},destroy:function(){q("gfxRegistry")&&l.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},
getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var b=this._getRealMatrix();return[c.multiplyPoint(b,a.x,a.y),c.multiplyPoint(b,a.x+a.width,a.y),c.multiplyPoint(b,a.x+a.width,a.y+a.height),c.multiplyPoint(b,a.x,a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=f.makeParameters(this.shape,
a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=f.makeParameters(f.defaultLinearGradient,a);break;case "radial":b=f.makeParameters(f.defaultRadialGradient,a);break;case "pattern":b=f.makeParameters(f.defaultPattern,a)}else b=f.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||k.isArray(a)||a instanceof
d)a={color:a};a=this.strokeStyle=f.makeParameters(f.defaultStroke,a);a.color=f.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=c.clone(a?c.normalize(a):c.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=this.getParent();a&&(a._moveChildToFront(this),this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},
_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&this.parent.remove(this,a);return this},_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=a?c.clone(a):null;return this._applyTransform()},
_getRealMatrix:function(){for(var a=this.matrix,b=this.parent;b;)b.matrix&&(a=c.multiply(b.matrix,a)),b=b.parent;return a}});l._eventsProcessing={on:function(a,b){return h(this.getEventSource(),a,l.fixCallback(this,f.fixTarget,b))},connect:function(a,b,c){"on"==a.substring(0,2)&&(a=a.substring(2));return this.on(a,c?k.hitch(b,c):b)},disconnect:function(a){return a.remove()}};l.fixCallback=function(a,b,c,d){d||(d=c,c=null);if(k.isString(d)){c=c||s.global;if(!c[d])throw['dojox.gfx.shape.fixCallback: scope["',
d,'"] is null (scope\x3d"',c,'")'].join("");return function(e){return b(e,a)?c[d].apply(c,arguments||[]):void 0}}return!c?function(e){return b(e,a)?d.apply(c,arguments):void 0}:function(e){return b(e,a)?d.apply(c,arguments||[]):void 0}};k.extend(l.Shape,l._eventsProcessing);l.Container={_init:function(){this.children=[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,
this._getRealMatrix())},remove:function(a,b){for(var c=0;c<this.children.length;++c)if(this.children[c]==a){b||(a.parent=null,a.parentMatrix=null);this.children.splice(c,1);break}return this},clear:function(a){for(var b,c=0;c<this.children.length;++c)b=this.children[c],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=[];return this},getBoundingBox:function(){if(this.children){var a=null;e.forEach(this.children,function(b){var d=b.getBoundingBox();d&&((b=b.getTransform())&&(d=c.multiplyRectangle(b,
d)),a?(a.x=Math.min(a.x,d.x),a.y=Math.min(a.y,d.y),a.endX=Math.max(a.endX,d.x+d.width),a.endY=Math.max(a.endY,d.y+d.height)):a={x:d.x,y:d.y,endX:d.x+d.width,endY:d.y+d.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){this.children.splice(b,1);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){this.children.splice(b,
1);this.children.unshift(a);break}return this}};l.Surface=n("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){e.forEach(this._nodes,b.destroy);this._nodes=[];e.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;if(q("ie"))for(;this._parent.lastChild;)b.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},
_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,b){var c=k.hitch(a,b);if(this.isLoaded)c(this);else h.once(this,"load",function(a){c(a)})}});k.extend(l.Surface,l._eventsProcessing);l.Rect=n("dojox.gfx.shape.Rect",l.Shape,{constructor:function(a){this.shape=f.getDefault("Rect");this.rawNode=a},getBoundingBox:function(){return this.shape}});l.Ellipse=n("dojox.gfx.shape.Ellipse",l.Shape,{constructor:function(a){this.shape=f.getDefault("Ellipse");this.rawNode=
a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});l.Circle=n("dojox.gfx.shape.Circle",l.Shape,{constructor:function(a){this.shape=f.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});l.Line=n("dojox.gfx.shape.Line",l.Shape,{constructor:function(a){this.shape=f.getDefault("Line");this.rawNode=
a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});l.Polyline=n("dojox.gfx.shape.Polyline",l.Shape,{constructor:function(a){this.shape=f.getDefault("Polyline");this.rawNode=a},setShape:function(a,b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);
return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var c=[],d=0;d<b;d+=2)c.push({x:a[d],y:a[d+1]});this.shape.points=c}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,c=a[0],d=c.x,e=c.y,l=c.x,h=c.y,f=1;f<b;++f)c=a[f],d>c.x&&(d=c.x),l<c.x&&(l=c.x),e>c.y&&(e=c.y),h<c.y&&(h=c.y);this.bbox={x:d,y:e,width:l-d,height:h-e}}return this.bbox}});l.Image=n("dojox.gfx.shape.Image",l.Shape,
{constructor:function(a){this.shape=f.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});l.Text=n(l.Shape,{constructor:function(a){this.fontStyle=null;this.shape=f.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},setFont:function(a){this.fontStyle="string"==typeof a?f.splitFontString(a):f.makeParameters(f.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=
null;this.getShape().text&&(a=f._base._computeTextBoundingBox(this));return a}});l.Creator={createShape:function(a){switch(a.type){case f.defaultPath.type:return this.createPath(a);case f.defaultRect.type:return this.createRect(a);case f.defaultCircle.type:return this.createCircle(a);case f.defaultEllipse.type:return this.createEllipse(a);case f.defaultLine.type:return this.createLine(a);case f.defaultPolyline.type:return this.createPolyline(a);case f.defaultImage.type:return this.createImage(a);
case f.defaultText.type:return this.createText(a);case f.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(f.Group)},createRect:function(a){return this.createObject(f.Rect,a)},createEllipse:function(a){return this.createObject(f.Ellipse,a)},createCircle:function(a){return this.createObject(f.Circle,a)},createLine:function(a){return this.createObject(f.Line,a)},createPolyline:function(a){return this.createObject(f.Polyline,a)},createImage:function(a){return this.createObject(f.Image,
a)},createText:function(a){return this.createObject(f.Text,a)},createPath:function(a){return this.createObject(f.Path,a)},createTextPath:function(a){return this.createObject(f.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return l})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang","dojo/_base/declare","./matrix","./shape"],function(f,k,n,s,q){q=n("dojox.gfx.path.Path",q.Shape,{constructor:function(h){this.shape=k.clone(f.defaultPath);this.segments=[];this.tbbox=
null;this.absolute=!0;this.last={};this.rawNode=h;this.segmented=!1},setAbsoluteMode:function(h){this._confirmSegmented();this.absolute="string"==typeof h?"absolute"==h:h;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;
var h=this.bbox,e=this._getRealMatrix();this.bbox=null;for(var b=0,d=this.segments.length;b<d;++b)this._updateWithSegment(this.segments[b],e);e=this.bbox;this.bbox=h;return this.tbbox=e?[{x:e.l,y:e.t},{x:e.r,y:e.t},{x:e.r,y:e.b},{x:e.l,y:e.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(h,e,b){b&&(e=s.multiplyPoint(b,h,e),h=e.x,e=e.y);this.bbox&&"l"in
this.bbox?(this.bbox.l>h&&(this.bbox.l=h),this.bbox.r<h&&(this.bbox.r=h),this.bbox.t>e&&(this.bbox.t=e),this.bbox.b<e&&(this.bbox.b=e)):this.bbox={l:h,b:e,r:h,t:e}},_updateWithSegment:function(h,e){var b=h.args,d=b.length,c;switch(h.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(c=0;c<d;c+=2)this._updateBBox(b[c],b[c+1],e);this.last.x=b[d-2];this.last.y=b[d-1];this.absolute=!0;break;case "H":for(c=0;c<d;++c)this._updateBBox(b[c],this.last.y,e);this.last.x=b[d-1];this.absolute=!0;
break;case "V":for(c=0;c<d;++c)this._updateBBox(this.last.x,b[c],e);this.last.y=b[d-1];this.absolute=!0;break;case "m":c=0;"x"in this.last||(this._updateBBox(this.last.x=b[0],this.last.y=b[1],e),c=2);for(;c<d;c+=2)this._updateBBox(this.last.x+=b[c],this.last.y+=b[c+1],e);this.absolute=!1;break;case "l":case "t":for(c=0;c<d;c+=2)this._updateBBox(this.last.x+=b[c],this.last.y+=b[c+1],e);this.absolute=!1;break;case "h":for(c=0;c<d;++c)this._updateBBox(this.last.x+=b[c],this.last.y,e);this.absolute=!1;
break;case "v":for(c=0;c<d;++c)this._updateBBox(this.last.x,this.last.y+=b[c],e);this.absolute=!1;break;case "c":for(c=0;c<d;c+=6)this._updateBBox(this.last.x+b[c],this.last.y+b[c+1],e),this._updateBBox(this.last.x+b[c+2],this.last.y+b[c+3],e),this._updateBBox(this.last.x+=b[c+4],this.last.y+=b[c+5],e);this.absolute=!1;break;case "s":case "q":for(c=0;c<d;c+=4)this._updateBBox(this.last.x+b[c],this.last.y+b[c+1],e),this._updateBBox(this.last.x+=b[c+2],this.last.y+=b[c+3],e);this.absolute=!1;break;
case "A":for(c=0;c<d;c+=7)this._updateBBox(b[c+5],b[c+6],e);this.last.x=b[d-2];this.last.y=b[d-1];this.absolute=!0;break;case "a":for(c=0;c<d;c+=7)this._updateBBox(this.last.x+=b[c+5],this.last.y+=b[c+6],e);this.absolute=!1}var l=[h.action];for(c=0;c<d;++c)l.push(f.formatNumber(b[c],!0));if("string"==typeof this.shape.path)this.shape.path+=l.join("");else{c=0;for(d=l.length;c<d;++c)this.shape.path.push(l[c])}},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(h,e){this.tbbox=
null;var b=this._validSegments[h.toLowerCase()];"number"==typeof b&&(b?e.length>=b&&(b={action:h,args:e.slice(0,e.length-e.length%b)},this.segments.push(b),this._updateWithSegment(b)):(b={action:h,args:[]},this.segments.push(b),this._updateWithSegment(b)))},_collectArgs:function(h,e){for(var b=0;b<e.length;++b){var d=e[b];"boolean"==typeof d?h.push(d?1:0):"number"==typeof d?h.push(d):d instanceof Array?this._collectArgs(h,d):"x"in d&&"y"in d&&h.push(d.x,d.y)}},moveTo:function(){this._confirmSegmented();
var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"M":"m",h);return this},lineTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"L":"l",h);return this},hLineTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"H":"h",h);return this},vLineTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"V":"v",h);
return this},curveTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"C":"c",h);return this},smoothCurveTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"S":"s",h);return this},qCurveTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"Q":"q",h);return this},qSmoothCurveTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,
arguments);this._pushSegment(this.absolute?"T":"t",h);return this},arcTo:function(){this._confirmSegmented();var h=[];this._collectArgs(h,arguments);this._pushSegment(this.absolute?"A":"a",h);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var h=this.shape.path;this.shape.path=[];this._setPath(h);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(h){h=k.isArray(h)?h:h.match(f.pathSvgRegExp);
this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(h){for(var e="",b=[],d=h.length,c=0;c<d;++c){var l=h[c],a=parseFloat(l);isNaN(a)?(e&&this._pushSegment(e,b),b=[],e=l):b.push(a)}this._pushSegment(e,b)}},setShape:function(h){this.inherited(arguments,["string"==typeof h?{path:h}:h]);this.segmented=!1;this.segments=[];f.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});n=n("dojox.gfx.path.TextPath",q,{constructor:function(h){"text"in this||(this.text=k.clone(f.defaultTextPath));
"fontStyle"in this||(this.fontStyle=k.clone(f.defaultFont))},getText:function(){return this.text},setText:function(h){this.text=f.makeParameters(this.text,"string"==typeof h?{text:h}:h);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(h){this.fontStyle="string"==typeof h?f.splitFontString(h):f.makeParameters(f.defaultFont,h);this._setFont();return this}});return f.path={Path:q,TextPath:n}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],
function(f,k,n){function s(b){var d=Math.cos(b);b=Math.sin(b);var a={x:d+4/3*(1-d),y:b-4/3*d*(1-d)/b};return{s:{x:d,y:-b},c1:{x:a.x,y:-a.y},c2:a,e:{x:d,y:b}}}var q=2*Math.PI,h=Math.PI/4,e=Math.PI/8,b=h+e,d=s(e);return f.arc={unitArcAsBezier:s,curvePI4:d,arcAsBezier:function(c,l,a,m,g,f,k,u){g=Boolean(g);f=Boolean(f);var r=n._degToRad(m);m=l*l;var A=a*a,v=n.multiplyPoint(n.rotate(-r),{x:(c.x-k)/2,y:(c.y-u)/2}),x=v.x*v.x,C=v.y*v.y;m=Math.sqrt((m*A-m*C-A*x)/(m*C+A*x));isNaN(m)&&(m=0);m={x:m*l*v.y/a,
y:-m*a*v.x/l};g==f&&(m={x:-m.x,y:-m.y});m=n.multiplyPoint([n.translate((c.x+k)/2,(c.y+u)/2),n.rotate(r)],m);l=n.normalize([n.translate(m.x,m.y),n.rotate(r),n.scale(l,a)]);m=n.invert(l);c=n.multiplyPoint(m,c);u=n.multiplyPoint(m,k,u);k=Math.atan2(c.y,c.x);u=Math.atan2(u.y,u.x);m=k-u;f&&(m=-m);0>m?m+=q:m>q&&(m-=q);a=e;u=d;a=f?a:-a;c=[];for(g=m;0<g;g-=h)g<b&&(a=g/2,u=s(a),a=f?a:-a,g=0),v=n.normalize([l,n.rotate(k+a)]),f?(m=n.multiplyPoint(v,u.c1),r=n.multiplyPoint(v,u.c2),v=n.multiplyPoint(v,u.e)):(m=
n.multiplyPoint(v,u.c2),r=n.multiplyPoint(v,u.c1),v=n.multiplyPoint(v,u.s)),c.push([m.x,m.y,r.x,r.y,v.x,v.y]),k+=2*a;return c}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(f,k,n){function s(b,c){return Math.abs(b-c)<=1E-6*(Math.abs(b)+Math.abs(c))}function q(b,c,e,a){if(isFinite(b)){if(!isFinite(e))return b}else return e;c=Math.abs(c);a=Math.abs(a);return(c*b+a*e)/(c+a)}function h(b){b=n.normalize(b);var c=-b.xx-b.yy,e=b.xx*b.yy-b.xy*b.yx,a=Math.sqrt(c*
c-4*e),c=-(c+(0>c?-a:a))/2,e=e/c,a=b.xy/(c-b.xx),m=1,g=b.xy/(e-b.xx),f=1;s(c,e)&&(a=1,g=m=0,f=1);isFinite(a)||(a=1,m=(c-b.xx)/b.xy,isFinite(m)||(a=(c-b.yy)/b.yx,m=1,isFinite(a)||(a=1,m=b.yx/(c-b.yy))));isFinite(g)||(g=1,f=(e-b.xx)/b.xy,isFinite(f)||(g=(e-b.yy)/b.yx,f=1,isFinite(g)||(g=1,f=b.yx/(e-b.yy))));b=Math.sqrt(a*a+m*m);var h=Math.sqrt(g*g+f*f);if(!isFinite(a/=b))a=0;if(!isFinite(m/=b))m=0;if(!isFinite(g/=h))g=0;if(!isFinite(f/=h))f=0;return{value1:c,value2:e,vector1:{x:a,y:m},vector2:{x:g,
y:f}}}function e(b,c){var e=0>b.xx*b.yy||0<b.xy*b.yx?-1:1,a=c.angle1=(Math.atan2(b.yx,b.yy)+Math.atan2(-e*b.xy,e*b.xx))/2,e=Math.cos(a),a=Math.sin(a);c.sx=q(b.xx/e,e,-b.xy/a,a);c.sy=q(b.yy/e,e,b.yx/a,a);return c}function b(b,c){var e=0>b.xx*b.yy||0<b.xy*b.yx?-1:1,a=c.angle2=(Math.atan2(e*b.yx,e*b.xx)+Math.atan2(-b.xy,b.yy))/2,e=Math.cos(a),a=Math.sin(a);c.sx=q(b.xx/e,e,b.yx/a,a);c.sy=q(b.yy/e,e,-b.xy/a,a);return c}return f.decompose=function(d){var c=n.normalize(d);d={dx:c.dx,dy:c.dy,sx:1,sy:1,angle1:0,
angle2:0};if(s(c.xy,0)&&s(c.yx,0))return k.mixin(d,{sx:c.xx,sy:c.yy});if(s(c.xx*c.yx,-c.xy*c.yy))return e(c,d);if(s(c.xx*c.xy,-c.yx*c.yy))return b(c,d);var f,a=new n.Matrix2D(c);f=k.mixin(a,{dx:0,dy:0,xy:a.yx,yx:a.xy});a=h([c,f]);f=h([f,c]);a=new n.Matrix2D({xx:a.vector1.x,xy:a.vector2.x,yx:a.vector1.y,yy:a.vector2.y});f=new n.Matrix2D({xx:f.vector1.x,xy:f.vector1.y,yx:f.vector2.x,yy:f.vector2.y});c=new n.Matrix2D([n.invert(a),c,n.invert(f)]);e(f,d);c.xx*=d.sx;c.yy*=d.sy;b(a,d);c.xx*=d.sx;c.yy*=d.sy;
return k.mixin(d,{sx:c.xx,sy:c.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(f){f=f.bezierutils={};f.tAtLength=function(e,b){var d=0,c=6==e.length,f=0,a=0,m=c?s:h,g=function(h,k){for(var q=0,r=0;r<h.length-2;r+=2)q+=n(h[r],h[r+1],h[r+2],h[r+3]);r=c?n(e[0],e[1],e[4],e[5]):n(e[0],e[1],e[6],e[7]);q-r>k||f+q>b+k?(++a,q=m(h,0.5),g(q[0],k),Math.abs(f-b)<=k||g(q[1],k)):(f+=q,d+=1/(1<<a))};b&&g(e,0.5);return d};var k=f.computeLength=function(e){for(var b=6==e.length,d=0,c=0;c<e.length-
2;c+=2)d+=n(e[c],e[c+1],e[c+2],e[c+3]);c=b?n(e[0],e[1],e[4],e[5]):n(e[0],e[1],e[6],e[7]);0.1<d-c&&(e=b?s(e,0.5):q(e,0.5),d=k(e[0],b),d+=k(e[1],b));return d},n=f.distance=function(e,b,d,c){return Math.sqrt((d-e)*(d-e)+(c-b)*(c-b))},s=function(e,b){var d=1-b,c=d*d,f=b*b,a=e[0],h=e[1],g=e[2],k=e[3],q=e[4],n=e[5],r=c*a+2*d*b*g+f*q,c=c*h+2*d*b*k+f*n;return[[a,h,d*a+b*g,d*h+b*k,r,c],[r,c,d*g+b*q,d*k+b*n,q,n]]},q=function(e,b){var d=1-b,c=d*d,f=c*d,a=b*b,h=a*b,g=e[0],k=e[1],q=e[2],n=e[3],r=e[4],s=e[5],v=
e[6],x=e[7],C=f*g+3*c*b*q+3*d*a*r+h*v,f=f*k+3*c*b*n+3*d*a*s+h*x;return[[g,k,d*g+b*q,d*k+b*n,c*g+2*d*b*q+a*r,c*k+2*d*b*n+a*s,C,f],[C,f,c*q+2*d*b*r+a*v,c*n+2*d*b*s+a*x,d*r+b*v,d*s+b*x,v,x]]},h=f.splitBezierAtT=function(e,b){return 6==e.length?s(e,b):q(e,b)};return f})},"dojox/json/query":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojox","dojo/_base/array"],function(f,k,n){k.getObject("json",!0,n);n.json._slice=function(f,k,h,e){var b=f.length,d=[];h=h||b;k=0>k?Math.max(0,k+b):Math.min(b,
k);for(h=0>h?Math.max(0,h+b):Math.min(b,h);k<h;k+=e)d.push(f[k]);return d};n.json._find=function(f,k){function h(b){k&&(!0===k&&!(b instanceof Array)?e.push(b):b[k]&&e.push(b[k]));for(var c in b){var f=b[c];k?f&&"object"==typeof f&&h(f):e.push(f)}}var e=[];if(k instanceof Array){if(1==k.length)return f[k[0]];for(var b=0;b<k.length;b++)e.push(f[k[b]])}else h(f);return e};n.json._distinctFilter=function(f,k){for(var h=[],e={},b=0,d=f.length;b<d;++b){var c=f[b];k(c,b,f)&&("object"==typeof c&&c?c.__included||
(c.__included=!0,h.push(c)):e[c+typeof c]||(e[c+typeof c]=!0,h.push(c)))}b=0;for(d=h.length;b<d;++b)h[b]&&delete h[b].__included;return h};return n.json.query=function(f,k){function h(a){c=a+"("+c}function e(a,b,c,e,f,h,k,l){return d[l].match(/[\*\?]/)||"~"==k?"/^"+d[l].substring(1,d[l].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,"[\\w\\W]$1")+("~"==k?"$/i":"$/")+".test("+b+")":a}var b=0,d=[];f=f.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,function(a){b+="["==
a?1:"]"==a?-1:0;return"]"==a&&0<b?"`]":'"'==a.charAt(0)||"'"==a.charAt(0)?"`"+(d.push(a)-1):a});var c="";f.replace(/(\]|\)|push|pop|shift|splice|sort|reverse)\s*\(/,function(){throw Error("Unsafe function call");});f=f.replace(/([^<>=]=)([^=])/g,"$1\x3d$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,function(a){return"."==a.charAt(0)?a:"@"==a?"$obj":(a.match(/:|^(\$|Math|true|false|null)$/)?"":"$obj.")+a}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(a,b,c){return(b=a.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/))?
(c="",a.match(/^\./)&&(h("dojox.json._find"),c=",true)"),h(b[1].match(/\=/)?"dojo.map":b[1].match(/\^/)?"dojox.json._distinctFilter":"dojo.filter"),c+",function($obj){return "+b[2]+"})"):(b=a.match(/^\[\s*([\/\\].*)\]/))?".concat().sort(function(a,b){"+b[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(a,b,c){return"var av\x3d "+c.replace(/\$obj/,"a")+",bv\x3d "+c.replace(/\$obj/,"b")+";if(av\x3ebv||bv\x3d\x3dnull){return "+("/"==b?1:-1)+";}\nif(bv\x3eav||av\x3d\x3dnull){return "+("/"==b?-1:
1)+";}\n"})+"return 0;})":(b=a.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/))?(h("dojox.json._slice"),","+(b[1]||0)+","+(b[2]||0)+","+(b[3]||1)+")"):a.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)?(h("dojox.json._find"),("."==a.charAt(1)?",'"+c+"'":a.match(/,/)?","+a:"")+")"):a}).replace(/(\$obj\s*((\.\s*[\w_$]+\s*)|(\[\s*`([0-9]+)\s*`\]))*)(==|~)\s*`([0-9]+)/g,e).replace(/`([0-9]+)\s*(==|~)\s*(\$obj\s*((\.\s*[\w_$]+)|(\[\s*`([0-9]+)\s*`\]))*)/g,function(a,b,c,d,f,h,k,l){return e(a,d,f,h,k,l,c,b)});f=c+("$"==
f.charAt(0)?"":"$")+f.replace(/`([0-9]+|\])/g,function(a,b){return"]"==b?"]":d[b]});for(var l=eval("1\x26\x26function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj\x3d$;return "+f+"}"),a=0;a<arguments.length-1;a++)arguments[a]=arguments[a+1];return k?l.apply(this,arguments):l}})},"esri/tasks/PrintParameters":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,k,n,s){return f(null,{declaredClass:"esri.tasks.PrintParameters",map:null,template:null,outSpatialReference:null,
extraParameters:null})})},"widgets/Print/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\n\t\x3e\x3c/div\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\n\x3e\x3c/div\x3e\n',
"url:widgets/Print/templates/Print.html":'\x3cdiv class\x3d"gis_PrintDijit"\x3e\n    \x3cdiv class\x3d"formContainer"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"printSettingsFormDijit"\x3e\n            \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\n                \x3ctr\x3e\n                    \x3ctd style\x3d"width:65px;"\x3e\n                        ${nls.title}:\n                    \x3c/td\x3e\n                    \x3ctd\x3e\n                        \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'title\',trim:true,required:true,style:\'width:100%;\',value:\'${defaultTitle}\'"\n                        /\x3e\n                    \x3c/td\x3e\n                \x3c/tr\x3e\n                \x3ctr style\x3d"display: none"\x3e\n                    \x3ctd\x3e\n                        ${nls.layout}:\n                    \x3c/td\x3e\n                    \x3ctd\x3e\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'layout\',style:\'width:100%;\'"\n                        data-dojo-attach-point\x3d"layoutDijit" /\x3e\n                    \x3c/td\x3e\n                \x3c/tr\x3e\n                \x3ctr style\x3d"display: none"\x3e\n                    \x3ctd\x3e\n                        ${nls.format}:\n                    \x3c/td\x3e\n                    \x3ctd\x3e\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'format\',style:\'width:100%;\'"\n                        data-dojo-attach-point\x3d"formatDijit" /\x3e\n                    \x3c/td\x3e\n                \x3c/tr\x3e\n            \x3c/table\x3e\n        \x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv class\x3d"buttonActionBar"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton" data-dojo-attach-point\x3d"advancedButtonDijit" data-dojo-props\x3d"iconClass:\'settingsIcon\',showLabel:true" style\x3d"display: none"\x3e\n            \x3cspan\x3e\n                ${nls.settings}\n            \x3c/span\x3e\n            \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" class\x3d"gis_PrintDijit"\x3e\n                \x3cdiv style\x3d"width:250px;"\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${nls.mapScaleExtent}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"preserveFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd style\x3d"vertical-align:middle;"\x3e\n                                    ${nls.preserve}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',checked:true,value:\'true\'"\n                                    /\x3e\n                                    ${nls.mapScale}\x26nbsp;\x26nbsp;\n                                    \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'false\'"\n                                    /\x3e\n                                    ${nls.mapExtent}\n                                \x3c/td\x3e\n                                \x3ctr\x3e\n                                    \x3ctd\x3e\n                                        ${nls.forceScale}:\n                                    \x3c/td\x3e\n                                    \x3ctd\x3e\n                                        \x3cinput type\x3d"radio" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'force\',checked:false"/\x3e \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'forcedScale\',required:false,style:\'width:100px;\'" data-dojo-attach-point\x3d"forceScaleNTB"/\x3e \x3ca href\x3d"#" data-dojo-attach-event\x3d"click:getCurrentMapScale"\x3e${nls.getCurrentScale}\x3c/a\x3e\n                                    \x3c/td\x3e\n                                \x3c/tr\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${nls.mapMetadata}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutMetadataDijit"\x3e\n                        \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${nls.author}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'author\',trim:true,required:false,style:\'width:100%;\',value:\'${defaultAuthor}\'" data-dojo-attach-point\x3d"authorTB"\n                                    /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${nls.copyright}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'copyright\',trim:true,required:false,style:\'width:100%;\',value:\'${defaultCopyright}\'"\n                                    /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${nls.lncludeLegend}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'legend\',value:true,checked:true"\n                                    /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${nls.mapOnlyOptions}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapOnlyFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${nls.width}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'width\',required:true,value:3300,style:\'width:100px;\'"\n                                    /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${nls.height}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'height\',required:true,value:2550,style:\'width:100px;\'"\n                                    /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                    \x3cdiv style\x3d"font-weight:bold;"\x3e\n                        ${nls.printQualityOptions}:\n                    \x3c/div\x3e\n                    \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapQualityFormDijit"\x3e\n                        \x3ctable cellspacing\x3d"5"\x3e\n                            \x3ctr\x3e\n                                \x3ctd\x3e\n                                    ${nls.dpi}:\n                                \x3c/td\x3e\n                                \x3ctd\x3e\n                                    \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'dpi\',required:true,value:300,style:\'width:100px;\'"\n                                    /\x3e\n                                \x3c/td\x3e\n                            \x3c/tr\x3e\n                        \x3c/table\x3e\n                    \x3c/div\x3e\n                \x3c/div\x3e\n            \x3c/div\x3e\n        \x3c/div\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"busyLabel:\'printing\',iconClass:\'printIcon\'"\n        data-dojo-attach-event\x3d"onClick:print" data-dojo-attach-point\x3d"printButtonDijit"\x3e\n            ${nls.print}\n        \x3c/div\x3e\n    \x3c/div\x3e\n    \x3c!-- \x3chr calss\x3d"spacer"\x3e --\x3e\n    \x3cdiv data-dojo-attach-point\x3d"printResultsNode" class\x3d"resultsContainer"\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-attach-point\x3d"clearActionBarNode" class\x3d"buttonActionBar"\n    style\x3d"display:none;padding:0;"\x3e\n        \x3cdiv data-dojo-type\x3d"dijit/form/Button" data-dojo-props\x3d"iconClass:\'clearIcon\'"\n        data-dojo-attach-event\x3d"onClick:clearResults"\x3e\n            ${nls.clearList}\n        \x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n',
"url:widgets/Print/templates/PrintResult.html":'\x3cdiv class\x3d"printResult" data-dojo-attach-point\x3d"resultNode" data-dojo-attach-event\x3d"onclick:_openPrint"\x3e\n    \x3ctable class\x3d"printResultTable"\x3e\n        \x3ctr\x3e\n            \x3ctd width\x3d"25px"\x3e\n                \x3cspan class\x3d"bold"\x3e${count}.\x3c/span\x3e\n            \x3c/td\x3e\n            \x3ctd width\x3d"30px"\x3e\n                \x3cimg src\x3d"${icon}"\x3e\n            \x3c/td\x3e\n            \x3ctd data-dojo-attach-point\x3d"nameNode"\x3e\n                \x3cdiv data-dojo-type\x3d"dijit.ProgressBar" data-dojo-props\x3d"value:Infinity,label:\'${nls.creatingPrint}\'"\x3e\n                \x3c/div\x3e\n            \x3c/td\x3e\n        \x3c/tr\x3e\n    \x3c/table\x3e\n\x3c/div\x3e\n',
"url:widgets/Print/Widget.html":'\x3cdiv\x3e\n  \x3cdiv data-dojo-attach-point\x3d"printNode"\x3e\x3c/div\x3e\n\x3c/div\x3e',"url:widgets/Print/css/style.css":".jimu-widget-print{}.jimu-widget-print .dijitSelect{height: 20px; width: 100%;}.gis_PrintDijit {width: 100%;}.gis_PrintDijit .printResult {height: 28px; margin-bottom: -1px; width: 100%;}.gis_PrintDijit .printResult .printResultTable {width: 100%;}.gis_PrintDijit .printResult .bold {font-weight: bold;}.gis_PrintDijit .printResultError {font-weight: bold; color: red;}.gis_PrintDijit .printResultHover table:hover {background-color: #D4E7F8; cursor: pointer;}.gis_PrintDijit .buttonActionBar {padding: 3px 0px 2px 0px; text-align: right; width: 100%;}.gis_PrintDijit .formContainer {margin-bottom: -1px; width: 100%;}.gis_PrintDijit .resultsContainer {width: 100%; margin-top: 10px;}.gis_PrintDijit .printIcon {background-image: url(../images/print.png); width: 16px; height: 16px;}.gis_PrintDijit .clearIcon {background-image: url(../images/clear.png); width: 16px; height: 16px;}.gis_PrintDijit .settingsIcon {background-image: url(../images/settings.png); width: 16px; height: 16px;}.gis_PrintDijit .dijitArrowButtonContainer{width: 17px;}",
"url:widgets/Print/config.json":'{\n  "serviceURL": "",\n  "defaultTitle": "ArcGIS Web Map",\n  "defaultAuthor": "Web AppBuilder for ArcGIS",\n  "defaultCopyright": "",\n  "defaultFormat": "PDF",\n  "defaultLayout": "Letter ANSI A Landscape"\n}',"*now":function(f){f(['dojo/i18n!*preload*widgets/Print/nls/Widget*["ar","cs","da","de","en","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","ROOT"]'])}}});
define("dojo/_base/declare jimu/BaseWidget jimu/portalUtils dojo/_base/lang dojo/Deferred jimu/dijit/Message jimu/dijit/LoadingShelter ./Print esri/request dojo/json jimu/portalUrlUtils".split(" "),function(f,k,n,s,q,h,e,b,d,c,l){return f([k],{baseClass:"jimu-widget-print",name:"Print",className:"esri.widgets.Print",_portalPrintTaskURL:null,postCreate:function(){this.inherited(arguments);this.shelter=new e({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup()},startup:function(){this.inherited(arguments);
this.shelter.show();this._initPrinter()},_initPrinter:function(){this._getPrintTaskURL(this.appConfig.portalUrl).then(s.hitch(this,function(a){this.shelter.show();this.isAsync(a).then(s.hitch(this,function(c){this.print=new b({map:this.map,appConfig:this.appConfig,printTaskURL:a,defaultAuthor:this.config.defaultAuthor,defaultCopyright:this.config.defaultCopyright,defaultTitle:this.config.defaultTitle,defaultFormat:this.config.defaultFormat,defaultLayout:this.config.defaultLayout,nls:this.nls,async:c});
this.print.placeAt(this.printNode);this.print.startup()}),s.hitch(this,function(a){new h({message:a.message})})).always(s.hitch(this,function(){this.shelter.hide()}))}),s.hitch(this,function(a){new h({message:a});console.error(a);this.shelter.hide()}))},_getPrintTaskURL:function(a){var b=new q;if(this.config&&this.config.serviceURL)return b.resolve(this.config.serviceURL),b;n.getPortalSelfInfo(a).then(s.hitch(this,function(a){(a=a&&a.helperServices&&a.helperServices.printTask&&a.helperServices.printTask.url)?
b.resolve(a):b.reject("error")}),s.hitch(this,function(a){new h({message:this.nls.portalConnectionError});b.reject("error");console.error(a)}));return b},isAsync:function(a){var b=new q;d({url:a,content:{f:"json"},handleAs:"text",load:s.hitch(this,function(d){var e=null;try{e=c.parse(d)}catch(f){d=l.setHttpProtocol(a);e=l.getNewPrintUrl(this.appConfig.portalUrl);d===e?b.resolve(!1):b.reject(f);return}"esriExecutionTypeAsynchronous"===e.executionType?b.resolve(!0):b.resolve(!1)}),error:s.hitch(this,
function(a){b.reject(a)})});return b},onSignIn:function(a){a=a||{};a.userId&&this.print&&this.print.updateAuthor(a.userId)}})});