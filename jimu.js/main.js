//>>built
require({cache:{"jimu/ConfigManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/kernel dojo/_base/config dojo/topic dojo/aspect dojo/i18n dojo/cookie dojo/Deferred dojo/promise/all dojo/request/xhr dojo/request/script require ./utils jimu/tokenUtils jimu/portalUtils ./portalUrlUtils esri/IdentityManager esri/config esri/tasks/GeometryService esri/urlUtils esri/request".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z,A,x,u){function C(a,c){function b(c,
l){var d,e,s=a[c],n="widgetOnScreen"===c;if(s){if(s.groups)for(d=0;d<s.groups.length&&!l(s.groups[d],d,s.groups[d].id,n);d++)for(e=0;e<s.groups[d].widgets.length&&!l(s.groups[d].widgets[e],e,s.groups[d].id,n);e++);if(s.widgets)for(d=0;d<s.widgets.length&&!l(s.widgets[d],d,c,n);d++);}}b("widgetOnScreen",c);b("widgetPool",c)}function E(a,c){var b;if("map"===c)return a.map;C(a,function(a){if(a.id===c)return b=a,!0});return b}function F(a){var c=0,b;C(a,function(a){if(a.id){var l=a.id.lastIndexOf("_");
-1<l&&(b=a.id.substr(l+1),c=Math.max(c,b))}});C(a,function(a){a.id||(c++,a.id=a.uri?a.uri+"_"+c:"_"+c)})}function y(a){var c=0;C(a,function(a){!a.widgets&&!a.uri&&(c++,a.placeholderIndex=c)})}function v(a){a=g.clone(a);var c="inPanel isController hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwithched".split(" ");delete a.mode;C(a,function(a){a.widgets?(delete a.isPreload,delete a.gid,delete a.icon,delete a.openType):(delete a.panel,
delete a.folderUrl,delete a.amdFolder,delete a.thumbnail,delete a.configFile,delete a.gid,delete a.isPreload,c.forEach(function(c){delete a[c]}),a.icon&&(!a.icon.startWith("data")&&!a.originIcon)&&delete a.icon,a.visible&&delete a.visible)});delete a.rawConfig;delete a._ssl;delete a.getConfigElementById;delete a.processNoUriWidgets;delete a.addElementId;delete a.getCleanConfig;delete a.visitElement;delete a.agolConfig;delete a._itemData;return a}var I=null,D;D=p(null,{urlParams:null,config:null,rawConfig:null,
configFile:null,_configLoaded:!1,portalSelf:null,constructor:function(a){this._removeHash(a);this.urlParams=a||{};this.listenBuilderEvents();this.isRunInPortal=!1;"config"===this.urlParams.mode&&(window.parent.setConfigViewerTopic&&g.isFunction(window.parent.setConfigViewerTopic))&&window.parent.setConfigViewerTopic(m);"preview"===this.urlParams.mode&&(window.parent.setPreviewViewerTopic&&g.isFunction(window.parent.setPreviewViewerTopic))&&window.parent.setPreviewViewerTopic(m)},listenBuilderEvents:function(){m.subscribe("configChanged",
g.hitch(this,this.onConfigChanged));m.subscribe("resetConfig",g.hitch(this,this.onConfigReset));m.subscribe("themeChanged",g.hitch(this,this.onThemeChanged));m.subscribe("layoutChanged",g.hitch(this,this.onLayoutChanged));m.subscribe("styleChanged",g.hitch(this,this.onStyleChanged));m.subscribe("appConfigLoaded",g.hitch(this,this._addDefaultGeometryService));m.subscribe("appConfigChanged",g.hitch(this,this._addDefaultGeometryService))},_tryLoadConfig:function(){if(this.urlParams.config)return this.configFile=
this.urlParams.config,n(this.configFile,{handleAs:"json"});if(this.urlParams.id){this.isRunInPortal=!0;var a=w.getPortalUrlFromLocation(),c=new b;s.setPortalUrl(a);l.getPortal(a).loadSelfInfo().then(g.hitch(this,function(b){this.portalSelf=b;this._processSignIn(a).then(g.hitch(this,function(){this._checkLocale();this._getAppConfigFromAppId(a,this.urlParams.id).then(function(a){c.resolve(a)},function(a){c.reject(a)})}))}));return c}this.configFile="config.json";return n(this.configFile,{handleAs:"json"})},
_setPortalUrl:function(a){a.portalUrl||(d("wab_portalurl")?a.portalUrl=d("wab_portalurl"):(this.isRunInPortal=!0,a.portalUrl=w.getPortalUrlFromLocation()))},loadConfig:function(){console.time("Load Config");if("preview"!==this.urlParams.mode){var a=this._tryLoadConfig(),c=new b;a.then(g.hitch(this,function(a){var d=this.checkConfig(a);d?(m.publish("appConfigLoadError",d),console.error(d),c.reject(d)):(this.rawConfig=g.clone(a),this.postProcess(a),this.config=a,this.urlParams.id?this._loadWidgetsManifest(a).then(g.hitch(this,
function(){this._configLoaded=!0;a.title&&(document.title=a.title);console.timeEnd("Load Config");m.publish("appConfigLoaded",this.getConfig());c.resolve(this.getConfig())})):(s.setPortalUrl(a.portalUrl),this._proesssWebTierAndSignin(a).then(g.hitch(this,function(){var c;if(this.urlParams.appid){if(this.isRunInPortal)return this._getAppConfigFromTemplateAppId(a.portalUrl,this.urlParams.appid);c=new b;this._getAppDataFromTemplateAppId(a.portalUrl,this.urlParams.appid).then(g.hitch(this,function(b){a._itemData=
b;c.resolve(a)}));return c}c=new b;c.resolve(a);return c})).then(g.hitch(this,function(a){this.postProcess(a);this.config=a;var c=new b;a.map.itemId?c.resolve(a):l.getDefaultWebMap(a.portalUrl).then(function(b){a.map.itemId=b;c.resolve(a)});return c})).then(g.hitch(this,function(a){return this._loadWidgetsManifest(a)})).then(g.hitch(this,function(a){if(a._itemData)return a.getConfigElementById=function(c){return E(a,c)},this._mergeTemplateAppConfigToAppConfig(a._itemData,a);var c=new b;c.resolve(a);
return c})).then(g.hitch(this,function(){this._configLoaded=!0;a.title&&(document.title=a.title);console.timeEnd("Load Config");m.publish("appConfigLoaded",this.getConfig());c.resolve(this.getConfig())}))))}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c}},_proesssWebTierAndSignin:function(a){var c=new b,d=!1,e=a.portalUrl;this._processWebTier(a).then(g.hitch(this,function(a){d=a;return l.getPortal(e).loadSelfInfo()})).then(g.hitch(this,function(a){this.portalSelf=a;return this._processSignIn(e,
d)})).then(g.hitch(this,function(){c.resolve()}),function(a){c.reject(a)});return c},_processWebTier:function(a){var c=new b,l=a.portalUrl;if(a.isWebTier){if("http:"===window.location.protocol&&!s.isInConfigOrPreviewWindow()){window.location.href=window.location.href.replace("http","https");return}s.isWebTierPortal(l).then(g.hitch(this,function(a){c.resolve(a)}),g.hitch(this,function(a){c.reject(a)}))}else c.resolve(!1);return c},_processSignIn:function(a,c){var d=new b,e=l.getPortal(a),n=w.getSharingUrl(a);
this.isRunInPortal?(n=z.checkSignInStatus(n),n.promise.always(g.hitch(this,function(){d.resolve()}))):(!s.isInBuilderWindow()&&(!s.isInConfigOrPreviewWindow()&&this.portalSelf.supportsOAuth&&this.rawConfig.appId&&!c)&&s.registerOAuthInfo(a,this.rawConfig.appId),n=z.checkSignInStatus(n),n.promise.always(g.hitch(this,function(){s.xtGetCredentialFromCookie(a);e.loadSelfInfo().then(g.hitch(this,function(a){this.portalSelf=a;d.resolve()}))})));return d},onThemeChanged:function(a){this._getAppConfigFromTheme(a).then(g.hitch(this,
function(a){this.config=a;m.publish("appConfigChanged",this.getConfig(),"themeChange")}))},onLayoutChanged:function(a){var c=a.layoutConfig,b=c.widgetOnScreen,l=this.config.widgetOnScreen;b&&(b.panel&&b.panel.uri&&(l.panel.uri=b.panel.uri),k.forEach(b.widgets,function(a,c){l.widgets[c]&&b.widgets[c]&&(b.widgets[c].position&&(l.widgets[c].position=b.widgets[c].position),b.widgets[c].positionRelativeTo&&(l.widgets[c].positionRelativeTo=b.widgets[c].positionRelativeTo),l.widgets[c].panel={uri:l.panel.uri,
position:l.widgets[c].position,positionRelativeTo:l.widgets[c].positionRelativeTo})},this),k.forEach(b.groups,function(a,c){l.groups[c]&&(b.groups[c]&&b.groups[c].panel)&&(l.groups[c].panel=b.groups[c].panel)},this));c.map&&(this.config.map.position=c.map.position);c.widgetPool&&(c.widgetPool.panel&&(this.config.widgetPool.panel=c.widgetPool.panel),k.forEach(c.widgetPool.groups,function(a,b){this.config.widgetPool.groups[b]&&(c.widgetPool.groups[b]&&c.widgetPool.groups[b].panel)&&(this.config.widgetPool.groups[b].panel=
c.widgetPool.groups[b].panel)},this));m.publish("appConfigChanged",this.getConfig(),"layoutChange")},onStyleChanged:function(a){this.config.theme.styles=this._genStyles(this.config.theme.styles,a.name);m.publish("appConfigChanged",this.getConfig(),"styleChange")},_getAppConfigFromTemplateAppId:function(a,c){var l=new b;this._getWabAppIdAndDataFromTemplateAppId(a,c).then(g.hitch(this,function(c){var b=c.itemData;this._getAppConfigFromAppId(a,c.appId).then(function(a){a._itemData=b;l.resolve(a)})}));
return l},_getAppDataFromTemplateAppId:function(a,c){return l.getPortal(a).getItemData(c)},_getWabAppIdAndDataFromTemplateAppId:function(a,c){var d=new b,e=l.getPortal(a);e.getItemData(c).then(g.hitch(this,function(a){e.getItemById(a.source).then(g.hitch(this,function(c){c=u.urlToObject(c.url);d.resolve({appId:c.query.id,itemData:a})}))}),function(a){d.reject(a)});return d},_getAppConfigFromAppId:function(a,c){return l.getPortal(a).getItemData(c)},_mergeTemplateAppConfigToAppConfig:function(a,d){function e(a){var c=
[];k.forEach(a,function(a){a&&c.push(a)},this);return c}function s(){d.widgetPool.widgets=e(d.widgetPool.widgets);r.widgets=e(r.widgets);if(d.widgetPool.groups)for(n=0;n<d.widgetPool.groups.length;n++)d.widgetPool.groups[n].widgets=e(d.widgetPool.groups[n].widgets);if(r.groups)for(n=0;n<r.groups.length;n++)r.groups[n].widgets=e(r.groups[n].widgets)}var n,r=d.widgetOnScreen,f=d.portalUrl;d.agolConfig=a;d.map.itemId=a.values.webmap;d.map.portalUrl=f;var q=null,h=null,t;for(t in a.values)"webmap"!==
t&&c.setConfigByTemplateWithId(d,t,a.values[t]),"app_title"===t&&(q=a.values[t]),"app_subtitle"===t&&(h=a.values[t]);var w=new b;!q||!h?l.getPortal(f).getItemById(a.values.webmap).then(g.hitch(this,function(a){q||(d.title=a.title);h||(d.subtitle=a.snippet);s();w.resolve()})):(s(),w.resolve());return w},_removeHash:function(a){for(var c in a)a[c]&&(a[c]=a[c].replace("#",""))},_genStyles:function(a,c){var b=[];b.push(c);k.forEach(a,function(a){0>b.indexOf(a)&&b.push(a)});return b},_getAppConfigFromTheme:function(a){var c=
new b,l,d=[];if(a.appConfig)return l=g.clone(a.appConfig),l.map=this.getConfig().map,l.map.position=a.appConfig.map.position,c.resolve(l),c;var d=a.getCurrentLayout(),e=a.getCurrentStyle();l=g.clone(this.getConfig()).getCleanConfig();this.processUrlParams(l);delete l.widgetManifestsMerged;l.widgetOnScreen=d.layoutConfig.widgetOnScreen;l.widgetPool=d.layoutConfig.widgetPool;d.layoutConfig.map&&d.layoutConfig.map.position&&(l.map.position=d.layoutConfig.map.position);d=this._genStyles(k.map(a.getStyles(),
function(a){return a.name}),e.name);l.theme={name:a.getName(),styles:d};this._addNeedValues(l);this._loadWidgetsManifest(l).then(function(){c.resolve(l)});return c},getConfig:function(){var a=g.clone(this.config);a.rawConfig=this.rawConfig;a.getConfigElementById=function(a){return E(this,a)};a.processNoUriWidgets=function(){y(this)};a.addElementId=function(){F(this)};a.getCleanConfig=function(){return v(this)};a.visitElement=function(a){C(this,a)};return a},onConfigReset:function(a){a=c.reCreateObject(a);
this.config?(a.map.itemId&&a.map.itemId!==this.config.map.itemId&&a.map.mapOptions&&delete a.map.mapOptions.extent,this.config=a,m.publish("appConfigChanged",this.getConfig(),"resetConfig",a)):(this.config=a,m.publish("appConfigLoaded",this.getConfig()))},_addNeedValues:function(a){y(a);F(a);this.addDefaultValues(a)},postProcess:function(a){this._setPortalUrl(a);this.processUrlParams(a);this._addNeedValues(a);this._processProxy(a);z.tokenValidity=10080;return a},_processProxy:function(a){A.defaults.io.alwaysUseProxy=
a.httpProxy&&a.httpProxy.useProxy&&a.httpProxy.alwaysUseProxy;A.defaults.io.proxyUrl="";A.defaults.io.proxyRules=[];a.httpProxy&&(a.httpProxy.useProxy&&a.httpProxy.url)&&(A.defaults.io.proxyUrl=a.httpProxy.url);a.httpProxy&&(a.httpProxy.useProxy&&a.httpProxy.rules)&&k.forEach(a.httpProxy.rules,function(a){u.addProxyRule(a)})},_loadWidgetsManifest:function(a){var c=[],l=new b;a._buildInfo&&a._buildInfo.widgetManifestsMerged?this._loadMergedWidgetManifests().then(g.hitch(this,function(c){C(a,g.hitch(this,
function(a){!a.widgets&&a.uri&&(this._addNeedValuesForManifest(c[a.uri]),g.mixin(a,c[a.uri].properties),a.label||(a.label=c[a.uri].label))}));l.resolve(a)})):(C(a,g.hitch(this,function(a){!a.widgets&&a.uri&&c.push(this._loadWidgetManifest(a))})),r(c).then(function(c){var b={};k.forEach(c,function(a){g.mixin(b,a)});l.resolve(a)},function(){l.resolve(a)}));setTimeout(function(){l.isResolved()||l.resolve(a)},jimuConfig.timeout);return l},_loadMergedWidgetManifests:function(){return n(path+"widgets/widgets-manifest.json",
{handleAs:"json"})},_loadWidgetManifest:function(a){var l=new b;n(a.folderUrl+"manifest.json",{handleAs:"json"}).then(g.hitch(this,function(b){var d=g.hitch(this,function(){this._addNeedValuesForManifest(b);g.mixin(a,b.properties);a.label||(a.label=b.label);var c={};c[a.uri]=b;l.resolve(c)});b.category="widget";b.amdFolder=a.amdFolder;a.label?d():c.addI18NLabel(b).then(function(){d()})}),function(a){l.reject(a)});return l},_addNeedValuesForManifest:function(a){c.addManifestProperies(a);c.processManifestLabel(a,
f.locale)},_addDefaultPortalUrl:function(a){"undefined"===typeof a.portalUrl&&(a.portalUrl="http://www.arcgis.com/");a.portalUrl&&"/"!==a.portalUrl.substr(a.portalUrl.length-1)&&(a.portalUrl+="/")},_addDefaultGeometryService:function(a){var c=a&&a.geometryService,c=c&&"string"===typeof c&&g.trim(c)?g.trim(c):this.portalSelf.helperServices.geometry.url;a.geometryService=c;A.defaults.geometryService=new x(a.geometryService)},_checkLocale:function(){var a=this.portalSelf.user&&this.portalSelf.user.culture||
this.portalSelf.culture||f.locale,a=a.toLowerCase();c.isLocaleChanged(f.locale,a)&&(d("appbuilder_locale",a),window.location.reload())},_addDefaultStyle:function(a){if(a.theme&&(!a.theme.styles||0===a.theme.styles.length))a.theme.styles=["default"]},_addDefaultMap:function(a){a.map.id="map";"undefined"===typeof a.map["3D"]&&"undefined"===typeof a.map["2D"]&&(a.map["2D"]=!0);"undefined"===typeof a.map.position&&(a.map.position={left:0,right:0,top:0,bottom:0});"undefined"===typeof a.map.portalUrl&&
(a.map.portalUrl=a.portalUrl)},_addDefaultVisible:function(a){C(a,function(a){void 0===a.visible&&(a.visible=!0)})},_addDefaultPanelAndPosition:function(a){var c,b,l=a.widgetOnScreen,d=a.widgetPool;"undefined"===typeof l.panel||"undefined"===typeof l.panel.uri?l.panel={uri:"jimu/BaseWidgetPanel",positionRelativeTo:"map"}:"undefined"===typeof l.panel.positionRelativeTo&&(l.panel.positionRelativeTo="map");"undefined"===typeof d.panel||"undefined"===typeof d.panel.uri?d.panel={uri:"jimu/BaseWidgetPanel",
positionRelativeTo:"map"}:"undefined"===typeof d.panel.positionRelativeTo&&(d.panel.positionRelativeTo="map");if(l.widgets)for(c=0;c<l.widgets.length;c++)l.widgets[c].position||(l.widgets[c].position={left:0,top:0}),l.widgets[c].positionRelativeTo||(l.widgets[c].positionRelativeTo="map"),l.widgets[c].panel||(l.widgets[c].panel=g.clone(l.panel),l.widgets[c].panel.position=l.widgets[c].position,l.widgets[c].panel.positionRelativeTo=l.widgets[c].positionRelativeTo);if(l.groups)for(c=0;c<l.groups.length;c++){l.groups[c].position||
(l.groups[c].position={left:0,top:0});l.groups[c].panel||(l.groups[c].panel=l.panel);for(b=0;b<l.groups[c].widgets.length;b++)l.groups[c].widgets[b].panel=l.groups[c].panel}if(d){if(d.groups)for(c=0;c<d.groups.length;c++){d.groups[c].panel?d.groups[c].panel.positionRelativeTo||(d.groups[c].panel.positionRelativeTo="map"):d.groups[c].panel=d.panel;for(b=0;b<d.groups[c].widgets.length;b++)d.groups[c].widgets[b].panel=d.groups[c].panel}if(d.widgets)for(c=0;c<d.widgets.length;c++)d.widgets[c].panel||
(d.widgets[c].panel=a.widgetPool.panel)}},_addDefaultOfWidgetGroup:function(a){C(a,g.hitch(this,function(a,l,b,d){a.isPreload=d;a.widgets?(a.gid=a.id,1===a.widgets.length?(a.label||(a.label=a.widgets[0].label?a.widgets[0].label:"Group"),a.icon||(a.icon=a.widgets[0].uri?this._getDefaultIconFromUri(a.widgets[0].uri):"jimu.js/images/group_icon.png")):(a.icon=a.icon?a.icon:"jimu.js/images/group_icon.png",a.label=a.label?a.label:"Group_"+l)):(a.gid=b,a.uri&&(l=a.uri.split("/"),l.pop(),l=l.pop(),a.name=
l,c.processWidgetSetting(a)))}))},_getDefaultIconFromUri:function(a){a=a.split("/");a.pop();return a.join("/")+"/images/icon.png"},addDefaultValues:function(a){this._addDefaultPortalUrl(a);this._addDefaultStyle(a);this._addDefaultMap(a);this._addDefaultVisible(a);"undefined"===typeof a.widgetOnScreen&&(a.widgetOnScreen={});"undefined"===typeof a.widgetPool&&(a.widgetPool={});this._addDefaultPanelAndPosition(a);this._addDefaultOfWidgetGroup(a);(a.widgetPool.widgets&&0<a.widgetPool.widgets.length&&
void 0===a.widgetPool.widgets[0].index||a.widgetPool.groups&&0<a.widgetPool.groups.length&&void 0===a.widgetPool.groups[0].index)&&this._addIndexForWidgetPool(a)},_addIndexForWidgetPool:function(a){var c=0,l,b;if(a.widgetPool.widgets)for(l=0;l<a.widgetPool.widgets.length;l++)a.widgetPool.widgets[l].index=c,c++;if(a.widgetPool.groups)for(l=0;l<a.widgetPool.groups.length;l++){a.widgetPool.groups[l].index=c;c++;for(b=0;b<a.widgetPool.groups[l].widgets.length;b++)a.widgetPool.groups[l].widgets[b].index=
b}},checkConfig:function(a){return(a=this._getRepeatedId(a))?"repeated id:"+a:null},_getRepeatedId:function(a){var c=[],l;C(a,function(a){if(0<c.indexOf(a.id))return l=a.id,!0;c.push(a.id)});return l},showError:function(a){document.body.innerHTML='\x3cdiv class\x3d"jimu-error-code"\x3e\x3cspan\x3e'+this.nls.errorCode+":\x3c/span\x3e\x3cspan\x3e"+a.response.status+'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-error-message"\x3e\x3cspan\x3e'+this.nls.errorMessage+":\x3c/span\x3e\x3cspan\x3e"+a.message+
'\x3c/span\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-error-detail"\x3e\x3cspan\x3e'+this.nls.errorDetail+":\x3c/span\x3e\x3cspan\x3e"+a.response.text+"\x3cspan\x3e\x3c/div\x3e"},processUrlParams:function(a){this.urlParams.style&&a.theme&&(a.theme.styles?(a.theme.styles.splice(a.theme.styles.indexOf(this.urlParams.style),1),a.theme.styles=[this.urlParams.style].concat(a.theme.styles)):a.theme.styles=[this.urlParams.style]);this.urlParams.webmap&&(a.map.itemId=this.urlParams.webmap);this.urlParams.mode&&
(a.mode=this.urlParams.mode)},onConfigChanged:function(a,l,b){var d;if("app"===a)g.mixin(this.config,l),d="attributeChange",this._processProxy(l);else if("map"===a)l.itemId&&l.itemId!==this.config.map.itemId&&this.config.map.mapOptions&&this.config.map.mapOptions.extent&&delete this.config.map.mapOptions.extent,g.mixin(this.config.map,l),d="mapChange";else if("widgetPool"===a)this.config.widgetPool.widgets=l.widgets,this.config.widgetPool.groups=l.groups,d="widgetPoolChange";else{a=E(this.config,
a);for(d in l)a[d]=l[d];d=a.widgets?"groupChange":"widgetChange"}this._addNeedValues(this.config);m.publish("appConfigChanged",c.reCreateObject(this.getConfig()),d,l,b)},_processPoolChangeEvent:function(a,c){var l=E(c.controllerId);l.controlledWidgets=k.map(a.widgets,function(a){return a.label});l.controlledGroups=k.map(a.groups,function(a){return a.label})}});D.getInstance=function(a){null===I?I=new D(a):I.urlParams=a;return I};D.getConfig=function(){return D.getInstance().config};window.getConfig=
function(){return D.getInstance().config};return D})},"jimu/utils":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/sniff dojo/_base/config dojo/io-query dojo/query dojo/NodeList-traverse dojo/Deferred dojo/on dojo/json dojo/cookie dojo/request/xhr dojo/i18n dojo/number dojo/date/locale esri/arcgis/utils esri/SpatialReference esri/geometry/Extent esri/geometry/webMercatorUtils esri/tasks/GeometryService esri/tasks/ProjectParameters jimu/portalUrlUtils esri/urlUtils esri/request".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z,A,x,u,C,E,F){function y(a,c){var l=a.match(/url\([^)]+\)/gi),b,d;if(null===l||""===c)return a;for(b=0;b<l.length;b++)if(d=l[b].match(/(url\(["|']?)(.*)((?:['|"]?)\))/i),4<=d.length){var e=d[2];c.endWith("/")||(c+="/");a=a.replace(d[1]+e+d[3],d[1]+c+e+d[3])}return a}function v(a,c){var l=Array.isArray(c),b=l&&[]||{};l?(a=a||[],b=b.concat(a),c.forEach(function(c,l){"undefined"===typeof a[l]?b[l]=c:"object"===typeof c?b[l]=v(a[l],c):-1===a.indexOf(c)&&b.push(c)})):
(a&&"object"===typeof a&&Object.keys(a).forEach(function(c){b[c]=a[c]}),Object.keys(c).forEach(function(l){b[l]="object"!==typeof c[l]||!c[l]?c[l]:a[l]?v(a[l],c[l]):c[l]}));return b}function I(a){var c,l={};c=a.indexOf("/");a.substring(0,c);a=a.substring(0,a.lastIndexOf("/")+1);l.folderUrl=require(B.getRequireConfig()).toUrl(a);l.amdFolder=a;return l}function D(a){a.panels.forEach(function(a){a.uri="panels/"+a.name+"/Panel.js"});a.styles.forEach(function(a){a.uri="styles/"+a.name+"/style.css"});a.layouts.forEach(function(a){a.uri=
"layouts/"+a.name+"/config.json";a.icon="layouts/"+a.name+"/icon.png"})}function K(a){"undefined"!==typeof a["2D"]&&(a.support2D=a["2D"]);"undefined"!==typeof a["3D"]&&(a.support3D=a["3D"]);"undefined"===typeof a["2D"]&&"undefined"===typeof a["3D"]&&(a.support2D=!0);delete a["2D"];delete a["3D"];"undefined"===typeof a.properties&&(a.properties={});"inPanel hasLocale hasStyle hasConfig hasUIFile hasSettingPage hasSettingUIFile hasSettingLocale hasSettingStyle keepConfigAfterMapSwithched".split(" ").forEach(function(c){"undefined"===
typeof a.properties[c]&&(a.properties[c]=!0)});"undefined"===typeof a.properties.isController&&(a.properties.isController=!1)}var B={},M={geometryService:"http://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer"},J=[];require.on("error",function(a){g.forEach(J,function(c){a.info[0]&&-1<a.info[0].indexOf(c.resKey)&&c.def.reject(a);for(var l in a.info)-1<l.indexOf(c.resKey)&&c.def.reject(a)})});B.checkError=function(a,c){J.push({resKey:a,def:c})};B.replacePlaceHolder=function(a,
c){var l=JSON.stringify(a),b=l.match(/\$\{(\w)+\}/g),d;if(null===b)return a;for(d=0;d<b.length;d++){var e=b[d].match(/(\w)+/g)[0];c[e]&&(l=l.replace(b[d],c[e]))}return JSON.parse(l)};B.changeUnit=function(a){var c=Math.abs(a),l;a=Math.floor(c);l=Math.floor(60*(c-a));c=(60*(60*(c-a)-l)).toFixed(2);return a+"\u00b0"+(10>l?"0"+l:l)+"'"+(10>c?"0"+c:c)+'"'};B.formatTime=function(a){var c=a/1E3;a=Math.floor(c/60);c=Number(c-60*a).toFixed(1);return(10>a?"0"+a:a)+":"+(10>c?"0"+c:c)};B.parseTime=function(a){var c=
/(\d{2,})\:(\d{2})\.(\d{1})/;if(!c.test(a))return console.log("wrong time format."),-1;a=a.match(c);return 1E3*(60*parseInt(a[1],10)+parseInt(a[2],10)+parseInt(a[3],10)/10)};B.preloadImg=function(a,c){var l=[],l="string"===typeof a?[a]:a;g.forEach(l,function(a){(new Image).src=c?c+a:a})};B.getPositionStyle=function(a){var c={},l;for(l in a)0<=g.indexOf("left top right bottom width height".split(" "),l)&&("number"===typeof a[l]?c[l]=a[l]+"px":a[l]&&(c[l]=a[l]));return c};B.isEqual=function(a,c){function l(a,
c){var e;if(isNaN(a)&&isNaN(c)&&"number"===typeof a&&"number"===typeof c||a===c)return!0;if("function"===typeof a&&"function"===typeof c||a instanceof Date&&c instanceof Date||a instanceof RegExp&&c instanceof RegExp||a instanceof String&&c instanceof String||a instanceof Number&&c instanceof Number)return a.toString()===c.toString();if(-1<b.indexOf(a)||-1<d.indexOf(c))return!1;if(null!==c){for(e in c)if(c.hasOwnProperty(e)!==a.hasOwnProperty(e)||typeof c[e]!==typeof a[e])return!1;for(e in a){if(c.hasOwnProperty(e)!==
a.hasOwnProperty(e)||typeof c[e]!==typeof a[e])return!1;switch(typeof a[e]){case "object":case "function":b.push(a);d.push(c);if(!l(a[e],c[e]))return!1;b.pop();d.pop();break;default:if(a[e]!==c[e])return!1}}}return!0}var b,d;b=[];d=[];return!l(a,c)?!1:!0};B.file={supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return h("safari")&&6>h("safari")?!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},containSeparator:function(a){return 0<=
a.indexOf("/")?!0:0<=a.indexOf("\\")?!0:!1},getNameFromPath:function(a){var c="",c=0<=a.indexOf("/")?"/":"\\";a=a.split(c);return 0<a.length?a[a.length-1]:null},getFolderFromPath:function(a){return a.substr(0,a.length-B.file.getNameFromPath(a).length)},readFile:function(a,c,l,b){if(this.supportHTML5()){var d=a.target.files[0];d&&(d.type.match(c)?d.size>=l?b({errCode:"exceed"}):(a=new FileReader,a.onload=function(a){b(null,d.name,a.target.result)},a.readAsDataURL(d)):b({errCode:"invalidType"}))}else if(this.supportFileAPI()){var e=
window.FileAPI.getFiles(a);e[0].type.match(c)?e[0].size>=l?b({errCode:"exceed"}):window.FileAPI.readAsDataURL(e[0],function(a){a&&a.result?b(null,e[0].name,a.result):b({errCode:"enableFlash"})}):b({errCode:"invalidType"})}}};B.checkFileExist=function(c){var l=new d,b=require(B.getRequireConfig()).toUrl(c);if(require.cache["url:"+b])return l.resolve(!0),l;for(var e in a.cache){var n=c.substr(0,c.length-3);if(e.startWith(n))return l.resolve(!0),l}t(b).then(function(){l.resolve(!0)},function(){l.resolve(!1)});
return l};B.processWidgetSetting=function(a){if(!a.uri)return a;p.mixin(a,I(a.uri));a.icon||(a.icon=a.amdFolder+"images/icon.png");a.thumbnail||(a.thumbnail=a.amdFolder+"images/thumbnail.png");return a};B.getRequireConfig=function(){if(jimuConfig){var a=[];jimuConfig.widgetsPackage&&(a=a.concat(jimuConfig.widgetsPackage));jimuConfig.themesPackage&&(a=a.concat(jimuConfig.themesPackage));return{packages:a}}return{}};B.getTypeByGeometryType=function(a){var c=null,l="esriGeometryLine esriGeometryCircularArc esriGeometryEllipticArc esriGeometryBezier3Curve esriGeometryPath esriGeometryPolyline".split(" "),
b=["esriGeometryRing","esriGeometryPolygon","esriGeometryEnvelope"];0<=["esriGeometryPoint","esriGeometryMultipoint"].indexOf(a)?c="point":0<=l.indexOf(a)?c="polyline":0<=b.indexOf(a)&&(c="polygon");return c};B.getServices=function(){return M};B.getArcGISDefaultGeometryService=function(){return new x(M.geometryService)};B.restoreToDefaultWebMapExtent=function(a,c,l){var b=new d;if(!(a&&"esri.Map"===a.declaredClass))return setTimeout(function(){b.reject("Invalid map.")},0),b;c=c&&c.itemInfo;if(!c)return setTimeout(function(){b.reject("Invalid itemInfo")},
0),b;c=c.item&&c.item.extent;if(!c)return setTimeout(function(){b.reject("Invalid itemInfo.item.extent")}),b;var e=new w({wkid:4326}),e=new z(c[0][0],c[0][1],c[1][0],c[1][1],e);if(4326===parseInt(a.spatialReference.wkid,10))return a.setExtent(e);if(a.spatialReference.isWebMercator())return e=A.geographicToWebMercator(e),a.setExtent(e);c=new u;c.geometries=[e];c.outSR=a.spatialReference;e=esriConfig&&esriConfig.defaults&&esriConfig.defaults.geometryService;e&&"esri.tasks.GeometryService"===e.declaredClass||
(l&&"string"===typeof l&&p.trim(l)?(l=p.trim(l),e=new x(l)):e=B.getArcGISDefaultGeometryService());e.project(c).then(function(c){if(c=c&&c[0])return a.setExtent(c);b.reject("Invalid projected geometry.");return b},function(a){console.error(a);b.reject(a);return b});return b};B.getAncestorWindow=function(){for(var a=window;a&&a.parent&&a!==a.parent;)a=a.parent;return a};B.getAncestorDom=function(a,c,l){if(a&&1===a.nodeType&&c&&"function"===typeof c){var b=100,d=document.body;l&&("number"===typeof l?
(l=parseInt(l,10),0<l&&(b=l)):1===l.nodeType&&(d=l));for(l=0;a.parentNode&&l<b&&k.isDescendant(a.parentNode,d);){if(c(a.parentNode))return a.parentNode;a=a.parentNode;l++}}return null};B.bindClickAndDblclickEvents=function(a,c,l,d){var e=null;if(a&&1===a.nodeType&&c&&"function"===typeof c&&l&&"function"===typeof l){var n=200;d&&"number"===typeof d&&(d=parseInt(d,10),0<d&&(n=d));var s=0,e=b(a,"click",function(a){s++;1===s?setTimeout(function(){1===s&&(s=0,c(a))},n):2===s&&(s=0,l(a))})}return e};B.isScrollToBottom=
function(a){var c=k.getContentBox(a);return 0===a.scrollHeight-(a.scrollTop+c.h)};B.getAllItemTypes=function(){var a=[],a=a.concat(["Web Map","Web Scene","CityEngine Web Scene"]).concat("Feature Service;Map Service;Image Service;KML;WMS;Feature Collection;Feature Collection Template;Geodata Service;Globe Service".split(";")).concat(["Geometry Service","Geocoding Service","Network Analysis Service","Geoprocessing Service"]).concat(["Web Mapping Application","Mobile Application","Code Attachment","Operations Dashboard Add In",
"Operation View"]).concat("Symbol Set;Color Set;Shapefile;CSV;Service Definition;Document Link;Microsoft Word;Microsoft PowerPoint;Microsoft Excel;PDF;Image;Visio Document".split(";"));return a=a.concat("Map Document;Map Package;Tile Package;ArcPad Package;Explorer Map;Globe Document;Scene Document;Published Map;Map Template;Windows Mobile Package".split(";")).concat(["Layer","Layer Package","Explorer Layer"]).concat(["Geoprocessing Package","Geoprocessing Sample","Locator Package","Rule Package"]).concat("Workflow Manager Package;Desktop Application;Desktop Application Template;Code Sample;Desktop Add In;Explorer Add In".split(";"))};
B.getItemQueryStringByTypes=function(a){var c="",l=B.getAllItemTypes();if(a&&0<a.length&&0<a.length){var b="";g.forEach(a,function(c,l){b+=' type:"'+c+'" ';l!==a.length-1&&(b+=" OR ")});c=" ( "+b+" ) ";g.forEach(l,function(l){var b="";0>g.indexOf(a,l)&&(b=' -type:"'+l+'" ');c+=b})}return c};B.isNotEmptyString=function(a,c){var l=a&&"string"===typeof a;return l?c?l&&p.trim(a):!0:!1};B.isObject=function(a){return a&&"object"===typeof a};B.createWebMap=function(a,c,b,d){a=C.getStandardPortalUrl(a);a=
C.getBaseItemUrl(a);l.arcgisUrl=a;return l.createMap(c,b,d)};B.getRandomString=function(){var a=Math.random().toString();return a=a.slice(2,a.length)};B._getDomainsByServerName=function(a){var c=a.split("."),l=c.length;return g.map(c,p.hitch(this,function(a,b){var d=c.slice(b,l),e="",n=d.length-1;g.forEach(d,p.hitch(this,function(a,c){e+=a;c!==n&&(e+=".")}));return e}))};B.removeCookie=function(a,c){var l=this._getDomainsByServerName(window.location.hostname);g.forEach(l,p.hitch(this,function(l){n(a,
null,{expires:-1,path:c});n(a,null,{expires:-1,path:c,domain:l});n(a,null,{expires:-1,path:c,domain:"."+l})}))};B.isLocaleChanged=function(a,c){return!a.startWith(c)};B.hashToObject=function(a){a=a.replace("#","");a=m.queryToObject(a);for(var c in a)if(a.hasOwnProperty(c))try{a[c]=r.parse(a[c])}catch(l){}return a};B.reCreateObject=function(a){function c(a){var b=[];a.forEach(function(a){Array.isArray(a)?b.push(c(a)):"object"===typeof a?b.push(l(a)):b.push(a)});return b}function l(a){var b={},d;for(d in a)a.hasOwnProperty(d)&&
(null===a[d]?b[d]=null:Array.isArray(a[d])?b[d]=c(a[d]):b[d]="object"===typeof a[d]?l(a[d]):a[d]);return b}return Array.isArray(a)?c(a):l(a)};B.setVerticalCenter=function(a){setTimeout(function(){var c=e(".jimu-vcenter-text",a),l,b;g.forEach(c,function(a){l=k.getContentBox(a).h;k.setStyle(a,{lineHeight:l+"px"})},this);c=e(".jimu-vcenter",a);g.forEach(c,function(a){l=k.getContentBox(a).h;b=k.getContentBox(e(a).parent()[0]).h;k.setStyle(a,{marginTop:(b-l)/2+"px"})},this)},10)};B.merge=v;B.loadStyleLink=
function(a,c,l){var e=new d,n,s=require(B.getRequireConfig()).toUrl(c);if(require.cache["url:"+s]){n=require.cache["url:"+s];var r=s.split("/").pop(),s=s.substr(0,s.length-r.length);n=y(n,s);a=l?k.create("style",{id:a,type:"text/css"},k.byId(l),"before"):k.create("style",{id:a,type:"text/css"},document.getElementsByTagName("head")[0]);a.styleSheet&&!a.sheet?a.styleSheet.cssText=n:a.appendChild(k.toDom(n));e.resolve("load");return e}n=l?k.create("link",{id:a,rel:"stylesheet",type:"text/css",href:s},
k.byId(l),"before"):k.create("link",{id:a,rel:"stylesheet",type:"text/css",href:s},document.getElementsByTagName("head")[0]);b(n,"load",function(){e.resolve("load")});var f=setInterval(function(){var a;g.some(document.styleSheets,function(l){if(l.href&&l.href.substr(l.href.indexOf(c),l.href.length)===c)return a=l,!0})&&(!e.isFulfilled()&&(a.cssRules&&a.cssRules.length||a.rules&&a.rules.length)&&e.resolve("load"),clearInterval(f))},50);return e};B.changeLocation=function(a){window.history.pushState&&
window.history.pushState({path:a},"",a)};B.urlToObject=function(a){var c=null;-1===a.indexOf("#")?(c=E.urlToObject(a),c.hash=null):(a=a.split("#"),c=E.urlToObject(a[0]),c.hash=a[1]?-1<a[1].indexOf("\x3d")?m.queryToObject(a[1]):a[1]:null);return c};B.setConfigByTemplate=function(a,c,l){c=function(a){var c=[];a.split("_").forEach(function(a){var l=!1,b;"--"===a.slice(a.length-2)&&(l=!0,a=a.slice(0,a.length-2));b=a.search(/\[[0-9]+\]/);-1===b&&(b=a.length);c.push({key:a.slice(0,b),index:Number(a.slice(b+
1,-1)),deleteFlag:l})});return c}(c);for(var b=1;b<c.length-1;b++)if(a=p.isArray(a[c[b].key])?a[c[b].key][c[b].index]:a[c[b].key],!a)return;c[c.length-1].deleteFlag?!0===l&&(p.isArray(a[c[c.length-1].key])?delete a[c[c.length-1].key][c[c.length-1].index]:delete a[c[c.length-1].key]):p.isArray(a[c[c.length-1].key])?a[c[c.length-1].key][c[c.length-1].index]=l:a[c[c.length-1].key]=l};B.setConfigByTemplateWithId=function(a,c,l){function b(l){var d;d=c;var e=-1;l=d.search(RegExp(l));0<=l&&(d=d.slice(l,
d.length),d=d.indexOf("]"),e=l+d+1);d=e;e=c.slice(l,d);return-1!==l?(l=c.slice(l+e.indexOf("[")+1,d-1),d=c.slice(d+1,d.length),(l=a.getConfigElementById(l))?{object:l,key:"section_"+d,state:"isSection"}:{state:"deleted"}):{state:"isNotSection"}}var d=a,e=c,n=b("groups\\[.+\\]");"deleted"!==n.state&&("isSection"===n.state&&(d=n.object,e=n.key),n=b("widgets\\[.+\\]"),"delete"!==n.state&&("isSection"===n.state&&(d=n.object,e=n.key),B.setConfigByTemplate(d,e,l)))};B.addManifestProperies=function(a){a.icon=
a.url+"images/icon.png";"theme"===a.category?D(a):K(a)};B.getUniqueValues=function(a,c){var l=new d,b=a.replace(/\/*$/g,"")+"/generateRenderer",e=r.stringify({type:"uniqueValueDef",uniqueValueFields:[c]});F({url:b,content:{classificationDef:e,f:"json"},handleAs:"json",callbackParamName:"callback"}).then(p.hitch(this,function(a){var c=[];(a=a&&a.uniqueValueInfos)&&0<a.length&&(c=g.map(a,p.hitch(this,function(a){return a.value})));l.resolve(c)}),p.hitch(this,function(a){l.reject(a)}));return l};B.processManifestLabel=
function(a,c){a.label=a.i18nLabels&&(a.i18nLabels[c]||a.i18nLabels.defaultLabel)||a.label||a.name;a.layouts&&g.forEach(a.layouts,function(l){var b="i18nLabels_layout_"+l.name;l.label=a[b]&&(a[b][c]||a[b].defaultLabel)||l.label||l.name});a.styles&&g.forEach(a.styles,function(l){var b="i18nLabels_style_"+l.name;l.label=a[b]&&(a[b][c]||a[b].defaultLabel)||l.label||l.name})};B.addI18NLabel=function(a){var c=new d;if(a.i18nLabels)return c.resolve(a),c;a.i18nLabels={};if(a.properties&&!1===a.properties.hasLocale)return c.resolve(a),
c;var l="widget"===a.category?"_widgetLabel":"_themeLabel";require(B.getRequireConfig(),["dojo/i18n!"+a.amdFolder+"/nls/strings"],function(b){a.i18nLabels[dojoConfig.locale]=b[l];"theme"===a.category&&(a.layouts&&a.layouts.forEach(function(c){a["i18nLabels_layout_"+c.name]={};a["i18nLabels_layout_"+c.name][dojoConfig.locale]=b["_layout_"+c.name]}),a.styles&&a.styles.forEach(function(c){a["i18nLabels_style_"+c.name]={};a["i18nLabels_style_"+c.name][dojoConfig.locale]=b["_style_"+c.name]}));c.resolve(a)});
return c};B.localizeNumber=function(a,l){var b={locale:f.locale};p.mixin(b,l||{});return c.format(a,b)};B.parseNumber=function(a,l){var b={locale:f.locale};p.mixin(b,l||{});return c.parse(a,b)};B.localizeDate=function(a,c){var l={locale:f.locale,fullYear:!0};p.mixin(l,c||{});return s.format(a,l)};B.addRelativePathInCss=y;return B})},"dojo/NodeList-traverse":function(){define(["./query","./_base/lang","./_base/array"],function(p,g,k){var h=p.NodeList;g.extend(h,{_buildArrayFromCallback:function(f){for(var g=
[],e=0;e<this.length;e++){var q=f.call(this[e],this[e],g);q&&(g=g.concat(q))}return g},_getUniqueAsNodeList:function(f){for(var g=[],e=0,q;q=f[e];e++)1==q.nodeType&&-1==k.indexOf(g,q)&&g.push(q);return this._wrap(g,null,this._NodeListCtor)},_getUniqueNodeListWithParent:function(f,g){var e=this._getUniqueAsNodeList(f),e=g?p._filterResult(e,g):e;return e._stash(this)},_getRelatedUniqueNodes:function(f,g){return this._getUniqueNodeListWithParent(this._buildArrayFromCallback(g),f)},children:function(f){return this._getRelatedUniqueNodes(f,
function(f,e){return g._toArray(f.childNodes)})},closest:function(f,g){return this._getRelatedUniqueNodes(null,function(e,q){do if(p._filterResult([e],f,g).length)return e;while(e!=g&&(e=e.parentNode)&&1==e.nodeType);return null})},parent:function(f){return this._getRelatedUniqueNodes(f,function(f,e){return f.parentNode})},parents:function(f){return this._getRelatedUniqueNodes(f,function(f,e){for(var q=[];f.parentNode;)f=f.parentNode,q.push(f);return q})},siblings:function(f){return this._getRelatedUniqueNodes(f,
function(f,e){for(var q=[],d=f.parentNode&&f.parentNode.childNodes,b=0;b<d.length;b++)d[b]!=f&&q.push(d[b]);return q})},next:function(f){return this._getRelatedUniqueNodes(f,function(f,e){for(var q=f.nextSibling;q&&1!=q.nodeType;)q=q.nextSibling;return q})},nextAll:function(f){return this._getRelatedUniqueNodes(f,function(f,e){for(var q=[],d=f;d=d.nextSibling;)1==d.nodeType&&q.push(d);return q})},prev:function(f){return this._getRelatedUniqueNodes(f,function(f,e){for(var q=f.previousSibling;q&&1!=
q.nodeType;)q=q.previousSibling;return q})},prevAll:function(f){return this._getRelatedUniqueNodes(f,function(f,e){for(var q=[],d=f;d=d.previousSibling;)1==d.nodeType&&q.push(d);return q})},andSelf:function(){return this.concat(this._parent)},first:function(){return this._wrap(this[0]&&[this[0]]||[],this)},last:function(){return this._wrap(this.length?[this[this.length-1]]:[],this)},even:function(){return this.filter(function(f,g){return 0!=g%2})},odd:function(){return this.filter(function(f,g){return 0==
g%2})}});return h})},"esri/tasks/ProjectParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../lang ../geometry/jsonUtils".split(" "),function(p,g,k,h,f,m,e,q){return p(null,{declaredClass:"esri.tasks.ProjectParameters",geometries:null,outSR:null,transformation:null,transformForward:null,toJson:function(){var d=k.map(this.geometries,function(b){return b.toJson()}),b={};b.outSR=this.outSR.wkid||h.toJson(this.outSR.toJson());b.inSR=this.geometries[0].spatialReference.wkid||
h.toJson(this.geometries[0].spatialReference.toJson());b.geometries=h.toJson({geometryType:q.getJsonType(this.geometries[0]),geometries:d});this.transformation&&(b.transformation=this.transformation.wkid||h.toJson(this.transformation));e.isDefined(this.transformForward)&&(b.transformForward=this.transformForward);return b}})})},"jimu/portalUrlUtils":function(){define(["dojo/_base/lang"],function(p){var g={};String.prototype.startWith=function(g){return this.substr(0,g.length)===g?!0:!1};String.prototype.endWith=
function(g){return this.substr(this.length-g.length,g.length)===g?!0:!1};g.getServerByUrl=function(g){g=p.trim(g||"");g=g.replace(/http(s?):\/\//gi,"");return g.split("/")[0]};g.getServerWithProtocol=function(k){var h="";if(k=p.trim(k||""))h=g.getProtocol(k)||"http",k=g.getServerByUrl(k),h=h+"://"+k;return h};g.isSameServer=function(k,h){k=g.getServerByUrl(k);h=g.getServerByUrl(h);return k===h};g.isOnline=function(k){return 0<=g.getServerByUrl(k).toLowerCase().indexOf(".arcgis.com")};g.isArcGIScom=
function(k){k=g.getServerByUrl(k).toLowerCase();return"www.arcgis.com"===k||"arcgis.com"===k};g.getStandardPortalUrl=function(k){var h=g.getServerByUrl(k);if(""===h)return"";g.isOnline(h)?(g.isArcGIScom(h)&&(h="www.arcgis.com"),k=(g.getProtocol(k)||"http")+"://"+h):(k=p.trim(k||"").replace(/sharing(.*)/gi,"").replace(/\/*$/g,""),k=g.addProtocol(k),k.replace(RegExp("http(s?)://"+h,"g"),"")||(k+="/arcgis"));return k};g.isSamePortalUrl=function(k,h){var f=/^http(s?):\/\//gi;k=g.getStandardPortalUrl(k).toLowerCase().replace(f,
"");h=g.getStandardPortalUrl(h).toLowerCase().replace(f,"");return k===h};g.addProtocol=function(g){-1>=g.indexOf("http://")&&-1>=g.indexOf("https://")&&(g=g.startWith("//")?window.location.protocol+g:g.startWith("/")?window.location.protocol+"//"+window.location.host+g:window.location.protocol+"//"+g);return g};g.getProtocol=function(g){var h="";0===g.indexOf("https://")?h="https":0===g.indexOf("http://")&&(h="http");return h};g.setHttpProtocol=function(k){k=g.addProtocol(k);return k.replace(/^https:\/\//,
"http://")};g.setHttpsProtocol=function(k){k=g.addProtocol(k);return k.replace(/^http:\/\//,"https://")};g.getSharingUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/sharing");return h};g.getOAuth2Url=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/sharing/oauth2");return h};g.getAppIdUrl=function(k,h){var f="",m=g.getStandardPortalUrl(k);m&&(f=m+"/sharing/oauth2/apps/"+h);return f};g.getSignInUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/home/signin.html");
return h};g.getBaseSearchUrl=function(k){var h="";k=g.getStandardPortalUrl(k);(k=k.replace(/\/*$/g,""))&&(h=k+"/sharing/rest/search");return h};g.getBaseItemUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/sharing/rest/content/items");return h};g.getItemUrl=function(k,h){var f="",m=g.getBaseItemUrl(k);m&&h&&(f=m+"/"+h);return f};g.getItemDataUrl=function(k,h){var f="",m=g.getItemUrl(k,h);m&&(f=m+"/data");return f};g.getGenerateTokenUrl=function(k){var h="";k&&(k=g.getStandardPortalUrl(k),
h=k+"/sharing/generateToken");return h};g.getItemDetailsPageUrl=function(k,h){var f="";k&&h&&(k=g.getStandardPortalUrl(k),f=k+"/home/item.html?id\x3d"+h);return f};g.getUserProfilePageUrl=function(k,h){var f="";k&&h&&(k=g.getStandardPortalUrl(k),f=k+"/home/user.html?user\x3d"+h);return f};g.getBaseGroupUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/sharing/rest/community/groups");return h};g.getPortalSelfInfoUrl=function(k){var h="";(k=g.getStandardPortalUrl(k||""))&&(h=k+"/sharing/portals/self");
return h};g.getCommunitySelfUrl=function(k){var h="";(k=g.getStandardPortalUrl(k||""))&&(h=k+"/sharing/rest/community/self");return h};g.getBaseUserUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/sharing/rest/community/users");return h};g.getUserUrl=function(k,h){var f="",m=g.getBaseUserUrl(k);k&&h&&(f=m+"/"+h);return f};g.getUserTagsUrl=function(k,h){var f="",m=g.getUserUrl(k,h);k&&h&&(f=m+"/tags");return f};g.getContentUrl=function(k){var h="";k&&(k=g.getStandardPortalUrl(k),h=k+
"/sharing/rest/content");return h};g.getUserContentUrl=function(k,h,f){var m="",m="";k&&h&&(m=g.getContentUrl(k),m=f?m+"/users/"+h+"/"+f:m+"/users/"+h);return m};g.getAddItemUrl=function(k,h,f){var m="",m="";k&&h&&(m=g.getUserContentUrl(k,h,f),m+="/addItem");return m};g.getDeleteItemUrl=function(k,h,f){var m="";(k=g.getUserItemsUrl(k,h))&&(m=k+"/"+f+"/delete");return m};g.getUserItemsUrl=function(k,h,f){var m="",m="";k&&h&&(m=g.getUserContentUrl(k,h,f),m+="/items");return m};g.getUpdateItemUrl=function(k,
h,f,m){var e="",e="";k&&h&&(e=g.getUserItemsUrl(k,h,m),e=e+"/"+f+"/update");return e};g.shareItemUrl=function(k,h,f,m){var e="",e="";k&&h&&(e=g.getUserItemsUrl(k,h,m),e=e+"/"+f+"/share");return e};g.getHomeIndexUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/home/index.html");return h};g.getHomeMapViewerUrl=function(k,h){var f="",m=g.getStandardPortalUrl(k);m&&(f=m+"/home/webmap/viewer.html",f=h?f+("?webmap\x3d"+h):f+"?useExisting\x3d1");return f};g.getHomeGalleryUrl=function(k){var h=
"";(k=g.getStandardPortalUrl(k))&&(h=k+"/home/gallery.html");return h};g.getHomeGroupsUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/home/groups.html");return h};g.getHomeMyContentUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/home/content.html");return h};g.getHomeMyOrganizationUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/home/organization.html");return h};g.getHomeUserUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/home/user.html");
return h};g.getPortalHelpUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/portalhelp/en/website/help/");return h};g.getPortalProxyUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=(k+"/sharing/proxy").replace("https://","http://"));return h};g.getOAuth2SignOutUrl=function(k){var h="";(k=g.getStandardPortalUrl(k))&&(h=k+"/sharing/oauth2/signout");return h};g.getNewPrintUrl=function(k){var h="";if(k=g.getStandardPortalUrl(k))k=g.setHttpProtocol(k),h=k+"/sharing/tools/newPrint";
return h};g.getPortalUrlFromLocation=function(){return g.getPortalServerFromLocation()+g.getDeployContextFromLocation()};g.getPortalSignInUrlFromLocation=function(){return g.getPortalUrlFromLocation()+"home/signin.html"};g.getPortalServerFromLocation=function(){return window.location.protocol+"//"+window.location.host};g.getDeployContextFromLocation=function(){var g=window.location.href.split("?")[0],h=g.indexOf("/home");0>h&&(h=g.indexOf("/apps"));g=g.substring(g.indexOf(window.location.host)+window.location.host.length+
1,h);"/"!==g&&(g="/"+g+"/");return g};g.getRestBaseUrlFromLocation=function(){return window.location.protocol+"//"+window.location.host+g.getDeployContextFromLocation()+"sharing/rest/"};return g})},"jimu/tokenUtils":function(){define(["jimu/BaseTokenUtils","dojo/topic","dojo/aspect","dojo/_base/lang"],function(p,g,k,h){p=new p;var f=null;p.declaredClass="jimu.TokenUtils";p.getAppConfig=function(){return f};p.setAppConfig=function(g){f=h.mixin({},g);this.setPortalUrl(f.portalUrl)};p.isRightWindowScope=
function(){return!this.isInBuilderWindow()};p.getAppMode=function(){var g="";f&&(g=f.mode);return g};p.tryPublishUserSignInToExternal=function(f){if(this.isRightWindowScope()){var e=this.getAppMode();"config"===e?g.publish("configUserSignIn",f):"preview"===e&&g.publish("previewUserSignIn",f)}};p.tryPublishUserSignOutToExternal=function(f){if(this.isRightWindowScope()){var e=this.getAppMode();"config"===e?g.publish("configUserSignOut",f):"preview"===e&&g.publish("previewUserSignOut",f)}};p.bindEvents=
function(){if(this._bind||this.isRightWindowScope())this._bind=!0,this._bindEvents(),g.subscribe("appConfigLoaded",h.hitch(this,function(f){this.isRightWindowScope()&&this.setAppConfig(f)})),g.subscribe("appConfigChanged",h.hitch(this,function(f){this.isRightWindowScope()&&this.setAppConfig(f)}))};p.startup();return p})},"jimu/BaseTokenUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/aspect dojo/Deferred dojo/cookie dojo/json dojo/topic dojo/request/script esri/request esri/IdentityManager esri/Credential esri/arcgis/OAuthInfo jimu/portalUrlUtils jimu/utils".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s){"function"!==typeof e.getAll&&(e.getAll=function(a){var c=[];(a=e(a))&&c.push(a);return c});return p([],{portalUrl:null,cookiePath:"/",_started:!1,webTierPortalUrls:[],isRightWindowScope:function(){},isInBuilderWindow:function(){return!!window.isBuilder},isInConfigOrPreviewWindow:function(){var a=!1;try{a=!window.isBuilder&&window.parent&&window.parent!==window&&window.parent.isBuilder}catch(c){console.log(c),a=!1}return!!a},isRunInPortal:function(){return window.isRunInPortal},
isStringStartWith:function(a,c){return a.substr(0,c.length)===c},getCookiePath:function(){return this.cookiePath},setPortalUrl:function(a){(a=c.getStandardPortalUrl(a))&&(a+="/");this.portalUrl=a},getPortalUrl:function(){return this.portalUrl},isWebTierPortal:function(a){var d=new m,e=c.getStandardPortalUrl(a),n=e+"/sharing";a=c.setHttpsProtocol(e+"/sharing/generateToken?f\x3djson");b.get(a,{jsonp:"callback"}).then(g.hitch(this,function(a){a.token?(this.webTierPortalUrls.push(e),this.removeWabAuthCookie(),
esri.id.getCredential(n).then(g.hitch(this,function(c){c.token||(c.token=a.token);d.resolve(!0)}),g.hitch(this,function(){d.resolve(!0)}))):d.resolve(!1)}),g.hitch(this,function(a){console.error(a);d.reject(a)}));return d},tryRegisterCredential:function(a){return!this.isValidCredential(a)?!1:!k.some(esri.id.credentials,g.hitch(this,function(c){return a.token===c.token}))?(esri.id.credentials.push(a),!0):!1},_isInvalidPortalUrl:function(a){return a&&"string"===typeof a&&g.trim(a)},signInPortal:function(a){var b=
new m;if(this._isInvalidPortalUrl(a)){a=c.getStandardPortalUrl(a);var d=c.getSharingUrl(a),e=this.getPortalCredential(a);e?setTimeout(g.hitch(this,function(){b.resolve(e)}),0):b=esri.id.getCredential(d)}else setTimeout(g.hitch(this,function(){b.reject("Invalid portalurl.")}),0);return b},_loadPortalSelfInfo:function(a){a=c.getPortalSelfInfoUrl(a);return r({url:a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"})},registerOAuthInfo:function(c,b){if(!c||!("string"===typeof c&&b&&"string"===
typeof b))return null;var d=esri.id.findOAuthInfo(c);d||(d=window.location.protocol+"//"+window.location.host+require.toUrl("jimu")+"/oauth-callback.html",d=new a({appId:b,expiration:20160,portalUrl:c,authNamespace:"/",popup:!0,popupCallbackUrl:d}),esri.id.registerOAuthInfos([d]));d.appId=b;return d},signOutAll:function(){var a=c.getStandardPortalUrl(this.portalUrl),b=!!esri.id.findCredential(a+"/sharing/rest");this.removeWabAuthCookie();this.removeEsriAuthCookieStorage();esri.id.destroyCredentials();
b&&this._publishCurrentPortalUserSignOut(a)},signOutPortal:function(a){if(a=g.trim(a||"")){var b=c.isSamePortalUrl(a,this.portalUrl),d=this.getPortalCredential(a)&&b;this._removePortalCredential(a);b&&(this.isRunInPortal()?this.removeCookie("esri_auth"):this.removeCookie("wab_auth"));d&&this._publishCurrentPortalUserSignOut(a)}},userHaveSignInPortal:function(a){return!!this.getPortalCredential(g.trim(a||""))},isValidCredential:function(a){var c=!1;if(a){var c=a.token,b=a.server,d=a.scope,c=c&&"string"===
typeof c&&g.trim(c),b=b&&"string"===typeof b&&g.trim(b),d="portal"===d||"server"===d,e=!0;a.expires&&(a=parseInt(a.expires,10),e=(new Date).getTime(),e=a>e);c=c&&b&&d&&e}return c},isValidPortalCredentialOfPortalUrl:function(a,b){var d=!1;if(this.isValidCredential(b))var d="portal"===b.scope,e=c.isSameServer(a,b.server),d=d&&e;return d},getPortalCredential:function(a){var b=null;a=g.trim(a||"");if(!a)return null;a=c.getStandardPortalUrl(a);return b=this._filterPortalCredential(a,esri.id.credentials)},
saveAndRegisterCookieToCredential:function(a){a=g.clone(a);a.referer=window.location.host;a.scope="portal";a.isAdmin=!!a.isAdmin;this.saveWabCookie(a);var c=a.server+"/sharing/rest";a.server=c;esri.id.registerToken(a);return esri.id.findCredential(c,a.userId)},registerAuth2Hash:function(a){a=g.clone(a);var b=1E3*parseInt(a.expires_in,10),b=(new Date).getTime()+b,d=c.getStandardPortalUrl(a.state.portalUrl);return this.saveAndRegisterCookieToCredential({referer:window.location.host,server:d,token:a.access_token,
expires:b,userId:a.username,scope:"portal",isAdmin:!!a.isAdmin})},saveWabCookie:function(a){this.removeCookie("wab_auth");e("wab_auth",JSON.stringify(a),{expires:new Date(a.expires),path:"/"})},removeWabAuthCookie:function(){this.removeCookie("wab_auth")},removeEsriAuthCookieStorage:function(){this.removeCookie("esri_auth");window.localStorage&&window.localStorage.removeItem("esriJSAPIOAuth");window.sessionStorage&&window.sessionStorage.removeItem("esriJSAPIOAuth")},_filterPortalCredential:function(a,
c){var b=null;if(c&&0<c.length){var d=k.filter(c,g.hitch(this,function(c){return this.isValidPortalCredentialOfPortalUrl(a,c)}));0<d.length&&(b=d[d.length-1])}return b},_removePortalCredential:function(a){var b=g.trim(a||"");if(b){b=c.getStandardPortalUrl(b);for(a=k.filter(esri.id.credentials,g.hitch(this,function(a){return this.isValidPortalCredentialOfPortalUrl(b,a)}));0<a.length;)a[0].destroy(),a.splice(0,1);esri.id.credentials=k.filter(esri.id.credentials,g.hitch(this,function(a){return!this.isValidPortalCredentialOfPortalUrl(b,
a)}))}},getUserIdByToken:function(a,b){var d=new m;if(a&&"string"===typeof a&&b&&"string"===typeof b){var e=c.getStandardPortalUrl(b),n=k.filter(esri.id.credentials,g.hitch(this,function(b){var d=b.token===a&&b.userId;b=c.isSameServer(e,b.server);return d&&b}));if(0<n.length){var s=n[0];setTimeout(g.hitch(this,function(){d.resolve(s.userId)}),0);return d}n=c.getCommunitySelfUrl(e);r({url:n,handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(g.hitch(this,function(a){d.resolve(a&&
a.username||"")}),g.hitch(this,function(a){console.error(a);d.reject("fail to get userId by token")}))}else setTimeout(g.hitch(this,function(){d.reject("invalid parameters")}),0);return d},xtGetCredentialFromCookie:function(a){var b=e("wab_auth"),d=null;if(b)try{d=q.parse(b)}catch(n){console.error(n)}if(!(d&&"object"===typeof d)||!c.isSameServer(a,d.server)||window.location.host!==d.referer)return null;d.expires=parseInt(d.expires,10);b=(new Date).getTime();if(!(d.expires>b))return this.removeCookie("wab_auth"),
null;a+="/sharing/rest";d.server=a;(b=esri.id.findCredential(a))||esri.id.registerToken(d);return b=esri.id.findCredential(a)},removeCookie:function(a){var c=this.getCookiePath();s.removeCookie(a,c)},_getDomainsByServerName:function(a){var c=a.split("."),b=c.length;return k.map(c,g.hitch(this,function(a,l){var d=c.slice(l,b),e="",n=d.length-1;k.forEach(d,g.hitch(this,function(a,c){e+=a;c!==n&&(e+=".")}));return e}))},_publishCurrentPortalUserSignIn:function(a){if(this.isValidCredential(a))try{d.publish("userSignIn",
a)}catch(c){console.error(c)}},_publishAnyUserSignIn:function(a){if(this.isValidCredential(a))try{d.publish("anyUserSignIn",a)}catch(c){console.error(c)}},_publishCurrentPortalUserSignOut:function(a){try{d.publish("userSignOut",a)}catch(c){console.error(c)}},_signInSuccess:function(a){try{this.isValidPortalCredentialOfPortalUrl(this.portalUrl,a)&&this._publishCurrentPortalUserSignIn(a),this._publishAnyUserSignIn(a),this._isNormalScope(a)}catch(c){console.error(c)}},_isNormalScope:function(a){var c=
!0;esri.id._isRESTService&&(a.resources&&0<a.resources.length)&&(c=k.every(a.resources,g.hitch(this,function(c){return(esri.id._isRESTService(c)?"server":"portal")===a.scope})));return c},tryPublishUserSignInToExternal:function(a){},tryPublishUserSignOutToExternal:function(a){},_bindEvents:function(){this.isRightWindowScope()&&f.after(esri.id,"signIn",g.hitch(this,function(a,c){console.log(c[1]);f.after(a,"callback",g.hitch(this,function(a,c){this._signInSuccess(c[0],!1)}));return a}))},_bind:!1,
bindEvents:function(){if(this._bind||this.isRightWindowScope())this._bind=!0,this._bindEvents()},isStart:function(){return this._started},startup:function(){if(this.isInConfigOrPreviewWindow()){var a=window.parent;if(a&&(a=a.esri&&a.esri.id))window.esri.id=a}this.isRightWindowScope()&&(this._started||this.bindEvents(),this._started=!0)}})})},"jimu/portalUtils":function(){define(["jimu/BasePortalUtils","jimu/tokenUtils"],function(p,g){var k=new p;k.declaredClass="jimu.PortalUtils";k.setTokenUtils(g);
return k})},"jimu/BasePortalUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/config dojo/Deferred dojo/topic esri/request ./utils ./portalUrlUtils".split(" "),function(p,g,k,h,f,m,e,q,d){var b=p([],{declaredClass:"jimu.Portal",selfUrl:null,user:null,selfInfo:null,portalUrl:null,credential:null,tokenUtils:null,constructor:function(a){this.portalUrl=d.getStandardPortalUrl(a);this.selfUrl=d.getPortalSelfInfoUrl(a)},loadSelfInfo:function(){var a=new f;e({url:this.selfUrl,
content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(g.hitch(this,function(c){var b=c.user;delete c.user;g.mixin(this,c);c.user=b;a.resolve(c)}),g.hitch(this,function(c){console.error(c);a.reject(c)}));return a},_checkCredential:function(){var a=this.tokenUtils.isValidCredential(this.credential);a||this.clearCredentialAndUser();return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.credential=
this.tokenUtils.getPortalCredential(this.portalUrl))},signIn:function(){var a=new f;this.updateCredential();this.isValidCredential()?setTimeout(g.hitch(this,function(){a.resolve(this.credential)}),0):a=this.tokenUtils.signInPortal(this.portalUrl);return a},haveSignIn:function(){return this.tokenUtils.userHaveSignInPortal(this.portalUrl)},clearCredentialAndUser:function(){this.user=this.credential=null},getUser:function(){this.updateCredential();var a=new f;this.user&&"jimu.PortalUser"===this.user.declaredClass?
setTimeout(g.hitch(this,function(){this.user.updateCredential();a.resolve(this.user)}),0):this.isValidCredential()?this.credential.userId?this._getUser(this.credential.userId).then(g.hitch(this,function(c){this.user=c;a.resolve(this.user)}),g.hitch(this,function(c){console.error(c);a.reject(c)})):this.tokenUtils.getUserIdByToken(this.credential.token,this.portalUrl).then(g.hitch(this,function(c){this.credential.userId=c;this._getUser(this.credential.userId).then(g.hitch(this,function(c){this.user=
c;a.resolve(this.user)}),g.hitch(this,function(c){console.error(c);a.reject(c)}))}),g.hitch(this,function(c){console.error(c);a.reject(c)})):setTimeout(g.hitch(this,function(){a.reject("credential is null.")}),0);return a},queryItems:function(a){this.updateCredential();var c=new f,b=d.getBaseSearchUrl(this.portalUrl),l={f:"json"};a&&(l=g.mixin(l,a));this.isValidCredential()&&(l.token=this.credential.token);!l.sortField&&!l.sortOrder&&(l.sortField="title",l.sortOrder="asc");e({url:b,handleAs:"json",
content:l,callbackParamName:"callback"}).then(g.hitch(this,function(a){a.results=k.map(a.results,g.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=this;return new t(a)}));c.resolve(a)}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getItemData:function(a){this.updateCredential();a={url:d.getItemDataUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&
(a.content.token=this.credential.token);return e(a)},getItemById:function(a){var c=new f;this.updateCredential();a={url:d.getItemUrl(this.portalUrl,a),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);e(a).then(g.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=this;a=new t(a);c.resolve(a)}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c},
getAppById:function(a){var c=new f;this.updateCredential();this.isValidCredential()?(a=d.getAppIdUrl(this.portalUrl,a),c=e({url:a,handleAs:"json",content:{f:"json",token:this.credential.token}})):setTimeout(g.hitch(this,function(){c.reject("token is null.")}),0);return c},queryGroups:function(a){this.updateCredential();var c=new f,b=d.getBaseGroupUrl(this.portalUrl),l={f:"json"};a&&(l=g.mixin(l,a));this.isValidCredential()&&(l.token=this.credential.token);e({url:b,handleAs:"json",content:l,callbackParamName:"callback"}).then(g.hitch(this,
function(a){a.results=k.map(a.results,g.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=this;return new n(a)}));c.resolve(a)}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c},registerApp:function(a,c,b){var l=new f;this.updateCredential();if(this.isValidCredential())var n=this.credential&&this.credential.token,r=d.getOAuth2Url(this.portalUrl),l=e({url:r+"/registerApp",content:{itemId:a,appType:c,redirect_uris:JSON.stringify(b),
token:n,f:"json"},handleAs:"json"},{usePost:!0});else setTimeout(g.hitch(this,function(){l.reject("token is null.")}),0);return l},createAndRegisterApp:function(a){var c=new f;this.updateCredential();this.isValidCredential()?this.getUser().then(g.hitch(this,function(b){b.addItem({title:"Web AppBuilder for ArcGIS",type:"Web Mapping Application",text:"",snippet:"",tags:"Registered App for OAuth"},"").then(g.hitch(this,function(b){b.success?this.registerApp(b.id,"browser",a).then(g.hitch(this,function(a){c.resolve(a)}),
g.hitch(this,function(a){console.error(a);c.reject(a)})):c.reject("create app failed")}),g.hitch(this,function(a){console.error(a);c.reject(a)}))}),g.hitch(this,function(a){console.error(a);c.reject(a)})):setTimeout(g.hitch(this,function(){c.reject("token is null.")}),0);return c},_getUser:function(a){this.updateCredential();var c=new f;a=d.getUserUrl(this.portalUrl,a);e({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(g.hitch(this,function(a){a.portalUrl=this.portalUrl;
a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=this;this.user=new r(a);c.resolve(this.user)}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c}}),r=p([],{declaredClass:"jimu.PortalUser",portalUrl:null,credential:null,tokenUtils:null,portal:null,constructor:function(a){a&&g.mixin(this,a)},_checkCredential:function(){var a=this.tokenUtils.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},
updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getGroups:function(){var a=[];this.groups&&(a=k.map(this.groups,g.hitch(this,function(a){a.portalUrl=this.portalUrl;a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=this.portal;return new n(a)})));return a},getItemsByKeywords:function(a,c){return this.portal.queryItems({start:c||1,num:100,q:"owner:"+this.username+" AND typekeywords:"+a})},getContent:function(){this.updateCredential();
var a={url:d.getUserContentUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential&&(a.content.token=this.credential.token);return e(a)},getTags:function(){this.updateCredential();var a={url:d.getUserTagsUrl(this.portalUrl,this.username),handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(a.content.token=this.credential.token);return e(a)},addItem:function(a,c){this.updateCredential();var b=new f;
if(this.isValidCredential()){var l={f:"json",token:this.credential.token};a&&(l=g.mixin(l,a));e({url:d.getAddItemUrl(this.portalUrl,this.username,c),handleAs:"json",callbackParamName:"callback",content:l},{usePost:!0}).then(g.hitch(this,function(a){b.resolve(a)}),g.hitch(this,function(a){console.error(a);b.reject(a)}))}else setTimeout(g.hitch(this,function(){b.reject("token is null.")}),0);return b},deleteItem:function(a){this.updateCredential();var c=new f;this.isValidCredential()?(a=d.getDeleteItemUrl(this.portalUrl,
this.username,a),c=e({url:a,content:{token:this.credential.token,f:"json"},handleAs:"json"},{usePost:!0})):setTimeout(g.hitch(this,function(){c.reject("token is null.")}),0);return c},getItemById:function(a,c){this.updateCredential();var b=new f,l={url:d.getUserItemsUrl(this.portalUrl,this.username,c)+"/"+a,handleAs:"json",content:{f:"json"},callbackParamName:"callback"};this.isValidCredential()&&(l.content.token=this.credential.token);e(l).then(g.hitch(this,function(a){a.portalUrl=this.portalUrl;
a.credential=this.credential;a.tokenUtils=this.tokenUtils;a.portal=this;a=new t(a);b.resolve(a)}),g.hitch(this,function(a){console.error(a);b.reject(a)}));return b},shareItem:function(a,c,b){this.updateCredential();var l=new f;this.isValidCredential()?(c={url:d.shareItemUrl(this.portalUrl,this.username,c,b),handleAs:"json",callbackParamName:"callback",content:{f:"json",token:this.credential.token}},a&&(c.content=g.mixin(c.content,a)),e(c,{usePost:!0}).then(g.hitch(this,function(a){l.resolve(a)}),
g.hitch(this,function(a){console.error(a);l.reject(a)}))):setTimeout(g.hitch(this,function(){l.reject("token is null.")}),0);return l},updateItem:function(a,c){this.updateCredential();var b=new f;this.isValidCredential()?this.portal.getItemById(a).then(g.hitch(this,function(l){var n={f:"json",token:this.credential.token};c&&(n=g.mixin(n,c));e({url:d.getUpdateItemUrl(this.portalUrl,this.username,a,l.ownerFolder),handleAs:"json",callbackParamName:"callback",timeout:1E5,content:n},{usePost:!0}).then(g.hitch(this,
function(a){b.resolve(a)}),g.hitch(this,function(a){console.error(a);b.reject(a)}))}),g.hitch(this,function(a){console.error(a);b.reject(a)})):setTimeout(g.hitch(this,function(){b.reject("token is null.")}),0);return b}}),n=p([],{declaredClass:"jimu.PortalGroup",portalUrl:null,credential:null,tokenUtils:null,portal:null,constructor:function(a){a&&g.mixin(this,a)},_checkCredential:function(){var a=this.tokenUtils.isValidCredential(this.credential);a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();
return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},queryItems:function(a){a.q="group:"+this.id+" AND "+a.q;return this.portal.queryItems(a)}}),t=p([],{declaredClass:"jimu.PortalItem",itemUrl:null,detailsPageUrl:null,ownerPageUrl:null,portalUrl:null,credential:null,tokenUtils:null,portal:null,token:null,constructor:function(a){a&&g.mixin(this,a);this.itemUrl=d.getItemUrl(this.portalUrl,this.id);
!this.thumbnailUrl&&(this.thumbnail&&this.itemUrl)&&(this.thumbnailUrl=this.itemUrl+"/info/"+this.thumbnail);this.token=this.credential&&this.credential.token;this.thumbnailUrl&&this.token&&(this.thumbnailUrl+="?token\x3d"+this.token);this.portalUrl&&this.id&&(this.detailsPageUrl=d.getItemDetailsPageUrl(this.portalUrl,this.id));this.portalUrl&&this.owner&&(this.ownerPageUrl=d.getUserProfilePageUrl(this.portalUrl,this.owner))},_checkCredential:function(){var a=this.tokenUtils.isValidCredential(this.credential);
a||(this.credential=null);return a},isValidCredential:function(){this.updateCredential();return this._checkCredential()},updateCredential:function(){this._checkCredential()||(this.portal.updateCredential(),this.credential=this.portal.credential)},getItemData:function(){return this.portal.getItemData(this.id)}});return p([],{portals:[],webMapQueryStr:" "+q.getItemQueryStringByTypes(["Web Map"])+" ",tokenUtils:null,constructor:function(){m.subscribe("userSignOut",g.hitch(this,function(a){(a=this._findPortal(a))&&
a.clearCredentialAndUser()}))},setTokenUtils:function(a){this.tokenUtils=a},_findPortal:function(a){for(var c=0;c<this.portals.length;c++){var b=this.portals[c];if(d.isSamePortalUrl(a,b.portalUrl))return b.updateCredential(),b}return null},getPortal:function(a){if(!a||!("string"===typeof a&&g.trim(a)))return null;a=d.getStandardPortalUrl(a);var c=this._findPortal(a);c||(c=new b(a),c.tokenUtils=this.tokenUtils,c.credential=c.tokenUtils.getPortalCredential(c.portalUrl),c.updateCredential(),this.portals.push(c));
return c},getPortalSelfInfo:function(a){return this.getPortal(a).loadSelfInfo()},getBasemapGalleryGroup:function(a){return this._getPortalSelfGroup(a,"basemapGalleryGroupQuery")},getTemplatesGroup:function(a){return this._getPortalSelfGroup(a,"templatesGroupQuery")},getUnits:function(a){var c="english",b="",d=new f;this.getPortal(a).getUser().then(g.hitch(this,function(a){a&&a.units?c=a.units:(b=h.locale,c=b.startWith("en")?"english":"metric");d.resolve(c)}),g.hitch(this,function(e){console.warn(e);
this.getPortalSelfInfo(a).then(g.hitch(this,function(a){b=a&&a.culture||h.locale}),g.hitch(this,function(a){console.warn(a);b=h.locale})).always(g.hitch(this,function(){c=b.startWith("en")?"english":"metric";d.resolve(c)}))}));return d.promise},_getPortalSelfGroup:function(a,c){var b=new f,d=this.getPortal(a);d||setTimeout(g.hitch(this,function(){b.reject()}),0);this.getPortalSelfInfo(a).then(g.hitch(this,function(a){d.queryGroups({f:"json",q:a[c]}).then(g.hitch(this,function(a){0<a.results.length?
(a=a.results[0],a.portalUrl=d.portalUrl,a.credential=d.credential,a.tokenUtils=d.tokenUtils,a.portal=d,a=new n(a),b.resolve(a)):b.reject("Can't find portal self group.")}),g.hitch(this,function(a){console.error(a);b.reject(a)}))}),g.hitch(this,function(a){console.error(a);b.reject(a)}));return b},getWebMapsFromBasemapGalleryGroup:function(a){var c=new f;this.getBasemapGalleryGroup(a).then(g.hitch(this,function(a){a?a.queryItems({start:1,num:100,f:"json",q:this.webMapQueryStr}).then(g.hitch(this,function(a){c.resolve(a)}),
g.hitch(this,function(a){console.error(a);c.reject(a)})):c.reject()}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c},getDefaultWebMap:function(a){var c=new f;this.getPortalSelfInfo(a).then(g.hitch(this,function(b){var d=b.defaultBasemap&&b.defaultBasemap.id;d?c.resolve(d):this._getDefaultWebMapByBasemapGallery(a,b).then(g.hitch(this,function(b){b?c.resolve(b):this._getMostNumViewsWebMap(a).then(g.hitch(this,function(a){a?c.resolve(a):c.reject()}),g.hitch(this,function(a){console.error(a);
c.reject(a)}))}),g.hitch(this,function(a){console.error(a);c.reject(a)}))}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c},_getDefaultWebMapByBasemapGallery:function(a,c){var b=new f,d=this.getPortal(a),e=c.defaultBasemap&&c.defaultBasemap.title;d.queryGroups({f:"json",q:c.basemapGalleryGroupQuery}).then(g.hitch(this,function(a){a=a.results;0<a.length?d.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND group:"+a[0].id+" AND title:"+e}).then(g.hitch(this,function(a){a=
a.results;a=k.filter(a,g.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?b.resolve(a[0].id):(console.log("Can't find web map under basemapGalleryGroupQuery."),d.queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr+" AND title:"+e}).then(g.hitch(this,function(a){a=a.results;a=k.filter(a,g.hitch(this,function(a){return a.type&&"web map"===a.type.toLowerCase()}));0<a.length?b.resolve(a[0].id):(console.log("Can't find web map by defaultBasemap.title."),b.resolve(null))}),
g.hitch(this,function(a){console.error(a);b.reject(a)})))}),g.hitch(this,function(a){console.error(a);b.reject(a)})):(console.log("Can't find group by basemapGalleryGroupQuery."),b.resolve(null))}),g.hitch(this,function(a){console.error(a);b.reject(a)}));return b},_getMostNumViewsWebMap:function(a){var c=new f;this.getPortal(a).queryItems({start:1,num:1,f:"json",q:this.webMapQueryStr,sortField:"numViews",sortOrder:"desc"}).then(g.hitch(this,function(a){a=a.results;a=k.filter(a,g.hitch(this,function(a){return a.type&&
"web map"===a.type.toLowerCase()}));0<a.length?c.resolve(a[0].id):c.reject("Can't find most-num-views web map.")}),g.hitch(this,function(a){console.error(a);c.reject(a)}));return c}})})},"jimu/LayoutManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dijit/_WidgetBase dojo/topic dojo/on dojo/dom-construct dojo/dom-style dojo/dom-geometry dojo/aspect dojo/cookie dojo/Deferred dojo/promise/all dojo/_base/fx dojo/fx require ./WidgetManager ./ConfigManager ./PanelManager ./MapManager ./utils ./PreloadWidgetIcon ./WidgetPlaceholder ./dijit/LoadingShelter".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z,A,x,u,C,E,F){var y=null,v;v=p([f],{constructor:function(a,c){this.widgetManager=w.getInstance();this.panelManager=A.getInstance();this.own(m.subscribe("appConfigLoaded",g.hitch(this,this.onAppConfigLoaded)));this.own(m.subscribe("appConfigChanged",g.hitch(this,this.onAppConfigChanged)));this.own(m.subscribe("mapLoaded",g.hitch(this,this.onMapLoaded)));this.own(m.subscribe("mapChanged",g.hitch(this,this.onMapChanged)));this.own(m.subscribe("beforeMapDestory",
g.hitch(this,this.onBeforeMapDestory)));this.own(m.subscribe("actionTriggered",g.hitch(this,this.onActionTriggered)));this.widgetPlaceholders=[];this.preloadWidgetIcons=[];this.preloadGroupPanels=[];this.invisibleWidgetIds=[];this.own(e(window,"resize",g.hitch(this,this.resize)));this.id=c},postCreate:function(){this.containerNode=this.domNode},map:null,mapId:"map",hlDiv:null,animTime:500,resize:function(){k.forEach(this.widgetManager.getAllWidgets(),function(a){!1===a.inPanel&&a.resize()},this)},
onAppConfigLoaded:function(a){this.appConfig=g.clone(a);this.appConfig.theme&&this._loadTheme(this.appConfig.theme);this._loadMap()},onAppConfigChanged:function(a,c,b){a=g.clone(a);switch(c){case "themeChange":this._onThemeChange(a);break;case "styleChange":this._onStyleChange(a);break;case "layoutChange":this._onLayoutChange(a);break;case "widgetChange":this._onWidgetChange(a,b);break;case "groupChange":this._onGroupChange(a,b);break;case "widgetPoolChange":this._onWidgetPoolChange(a);break;case "resetConfig":this._onResetConfig(a)}this.appConfig=
a},onMapLoaded:function(a){this.map=a;this.panelManager.map=a;this._loadSplash();this._loadPreloadWidgets(this.appConfig)},onMapChanged:function(a){this.map=a;this.panelManager.map=a;this._loadPreloadWidgets(this.appConfig)},onBeforeMapDestory:function(){this.panelManager.destroyAllPanels();this._destroyPreloadPanelessWidgets();this._destroyWidgetPlaceholders();this._destroyPreloadWidgetIcons()},onActionTriggered:function(a,c,b){"highLight"===c&&(k.forEach(this.widgetPlaceholders,function(c){c.configId===
a&&this._highLight(c)},this),k.forEach(this.preloadWidgetIcons,function(c){c.configId===a&&this._highLight(c)},this),k.forEach(this.widgetManager.getPreloadPanelessWidgets(),function(c){c.configId===a&&this._highLight(c)},this));"removeHighLight"===c&&this._removeHighLight()},_highLight:function(a){if(a.domNode){this.hlDiv&&this._removeHighLight(a);var c=b.getMarginBox(a.domNode);this.hlDiv=q.create("div",{style:{position:"absolute",left:c.l-2+"px",top:c.t-2+"px",width:c.w+"px",height:c.h+"px"},"class":"icon-highlight"},
a.domNode,"before")}},_removeHighLight:function(){this.hlDiv&&(q.destroy(this.hlDiv),this.hlDiv=null)},_onWidgetChange:function(a,c){c=a.getConfigElementById(c.id);c.isController?this._reloadControllerWidget(a):(k.forEach(this.widgetPlaceholders,function(a){a.configId===c.id&&(a.destroy(),this._loadPreloadWidget(c))},this),this._removeDestroyed(this.widgetPlaceholders),k.forEach(this.preloadWidgetIcons,function(a){if(a.configId===c.id){var b=a.state;a.destroy();this._loadPreloadWidget(c).then(function(a){if("opened"===
b)a.onClick()})}},this),this._removeDestroyed(this.preloadWidgetIcons),k.forEach(this.widgetManager.getPreloadPanelessWidgets(),function(a){a.configId===c.id&&(a.destroy(),!1===c.visible?0>this.invisibleWidgetIds.indexOf(c.id)&&this.invisibleWidgetIds.push(c.id):this._loadPreloadWidget(c))},this),k.forEach(this.preloadGroupPanels,function(a){a.reloadWidget(c)},this),this._updatePlaceholder(a),k.forEach(this.invisibleWidgetIds,function(a){a===c.id&&!1!==c.visible&&(this._loadPreloadWidget(c),a=this.invisibleWidgetIds.indexOf(c.id),
this.invisibleWidgetIds.splice(a,1))},this),c.isPreload||this._reloadControllerWidget(a))},_onGroupChange:function(a,c){c=a.getConfigElementById(c.id);k.forEach(this.panelManager.panels,function(a){a.config.id===c.id&&a.updateConfig(c)},this);c.isPreload||this._reloadControllerWidget(a)},_updatePlaceholder:function(a){k.forEach(this.widgetPlaceholders,function(c){c.setIndex(a.getConfigElementById(c.configId).placeholderIndex)},this)},_onWidgetPoolChange:function(a){this._reloadControllerWidget(a)},
_reloadControllerWidget:function(a){var c=0<this.widgetManager.getControllerWidgets().length?this.widgetManager.getControllerWidgets()[0]:null;if(c){var b=c.getOpenedIds(),d=c.windowState;this.appConfig.getConfigElementById(c.id);this.appConfig.visitElement(g.hitch(this,function(a,c,b,d){d||this.panelManager.destroyPanel(a.id+"_panel")}));this.widgetManager.destroyWidget(c)}var l;a.visitElement(g.hitch(this,function(a,c,b,d){a.isController&&(l=a)}));!1!==l.visible&&this._loadPreloadWidget(l).then(g.hitch(this,
function(a){this.widgetManager.changeWindowStateTo(a,d);b&&a.setOpenedIds(b)}))},_removeDestroyed:function(a){var c=[];k.forEach(a,function(a){a._destroyed&&c.push(a)});k.forEach(c,function(c){c=a.indexOf(c);a.splice(c,1)})},_destroyPreloadWidgetIcons:function(){k.forEach(this.preloadWidgetIcons,function(a){a.destroy()},this);this.preloadWidgetIcons=[]},_destroyPreloadPanelessWidgets:function(){k.forEach(this.widgetManager.getPreloadPanelessWidgets(),function(a){this.widgetManager.destroyWidget(a)},
this)},_destroyWidgetPlaceholders:function(){k.forEach(this.widgetPlaceholders,function(a){a.destroy()},this);this.widgetPlaceholders=[]},_destroyPreloadGroupPanels:function(){k.forEach(this.preloadGroupPanels,function(a){this.panelManager.destroyPanel(a)},this);this.preloadGroupPanels=[]},_changeMapPosition:function(a){var c={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"};this.map&&(c=g.mixin(c,u.getPositionStyle(a.map.position)),h.setStyle(this.mapId,c),this.map.resize())},
_onThemeChange:function(a){this._destroyPreloadWidgetIcons();this._destroyWidgetPlaceholders();this._destroyPreloadPanelessWidgets();this.panelManager.destroyAllPanels();this._updateCommonStyle(a);this._onStyleChange(a);this._changeMapPosition(a);this._loadPreloadWidgets(a)},_onResetConfig:function(a){a.map.itemId!==this.appConfig.map.itemId?(m.publish("appConfigChanged",a,"mapChange",a),this._updateCommonStyle(a),this._onStyleChange(a),this._changeMapPosition(a)):this._onThemeChange(a)},_updateCommonStyle:function(a){var c=
this.appConfig.theme;h.removeClass(this.domNode,c.name);h.destroy(this._getThemeCommonStyleId(c));this._loadThemeCommonStyle(a.theme)},_onStyleChange:function(a){var c=this.appConfig.theme;c.styles!==a.theme.styles&&(c.styles[0]!==a.theme.styles[0]&&h.removeClass(this.domNode,c.styles[0]),h.destroy(this._getThemeCurrentStyleId(c)),this._loadThemeCurrentStyle(a.theme))},_onLayoutChange:function(a){var c={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"},c=g.mixin(c,u.getPositionStyle(a.map.position));
h.setStyle(this.mapId,c);this.map.resize();k.forEach(this.widgetPlaceholders,function(c){c.moveTo(a.getConfigElementById(c.configId).panel.position)},this);k.forEach(this.preloadWidgetIcons,function(c){c.moveTo(a.getConfigElementById(c.configId).panel.position)},this);k.forEach(this.widgetManager.getPreloadPanelessWidgets(),function(b){c={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"};var d=u.getPositionStyle(a.getConfigElementById(b.id).panel.position);c=g.mixin(c,
d);h.setStyle(b.domNode,c);b.onPositionChange(d)},this);k.forEach(this.preloadGroupPanels,function(b){c={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"};c=g.mixin(c,u.getPositionStyle(a.getConfigElementById(b.config.id).panel.position));h.setStyle(b.domNode,c);b.resize()},this)},_loadSplash:function(){if(this.appConfig.splashPage&&"false"!==n("isfirst")){var a={};a.uri=this.appConfig.splashPage;a.id=this.appConfig.splashPage+"_1";a.label="splashPage";a.hasConfig=!1;this.widgetManager.loadWidget(a).then(g.hitch(this,
function(a){h.place(a.domNode,this.id);a.startup()}))}},_loadTheme:function(a){l(["themes/"+a.name+"/main"],g.hitch(this,function(){this._loadThemeCommonStyle(a);this._loadThemeCurrentStyle(a)}))},_loadThemeCommonStyle:function(a){u.loadStyleLink(this._getThemeCommonStyleId(a),"themes/"+a.name+"/common.css");h.addClass(this.domNode,a.name)},_loadThemeCurrentStyle:function(a){u.loadStyleLink(this._getThemeCurrentStyleId(a),"themes/"+a.name+"/styles/"+a.styles[0]+"/style.css");h.addClass(this.domNode,
a.styles[0])},_getThemeCommonStyleId:function(a){return"theme_"+a.name+"_style_common"},_getThemeCurrentStyleId:function(a){return"theme_"+a.name+"_style_"+a.styles[0]},_loadMap:function(){var a=h.create("div",{id:this.mapId,style:g.mixin({position:"absolute",backgroundColor:"#EEEEEE",overflow:"hidden",minWidth:"1px",minHeight:"1px"},u.getPositionStyle(this.appConfig.map.position))});h.place(a,this.id);x.getInstance(this.appConfig,this.mapId).showMap()},_createPreloadWidgetPlaceHolder:function(a){var c;
c="map"===a.panel.positionRelativeTo?this.mapId:this.id;var b=g.clone(a);delete b.position.width;delete b.position.height;var d=u.getPositionStyle(b.position);a=new E({index:b.placeholderIndex,configId:a.id});h.setStyle(a.domNode,d);h.place(a.domNode,c);this.widgetPlaceholders.push(a);return a},_createPreloadWidgetIcon:function(a){var c=new C({panelManager:this.panelManager,widgetConfig:a,configId:a.id});"map"===a.panel.positionRelativeTo?h.place(c.domNode,this.mapId):h.place(c.domNode,this.id);h.setStyle(c.domNode,
u.getPositionStyle({top:a.position.top,left:a.position.left,right:a.position.right,bottom:a.position.bottom}));c.startup();!this.openAtStartWidget&&a.openAtStart&&(c.switchToOpen(),this.openAtStartWidget=a.name);this.preloadWidgetIcons.push(c);return c},_loadPreloadWidgets:function(c){console.time("Load widgetOnScreen");var b=new F,d=[];b.placeAt(this.id);b.startup();k.forEach(c.widgetOnScreen.widgets,function(a){!1===a.visible?this.invisibleWidgetIds.push(a.id):d.push(this._loadPreloadWidget(a))},
this);k.forEach(c.widgetOnScreen.groups,function(a){d.push(this._loadPreloadGroup(a))},this);a(d).then(g.hitch(this,function(){b&&(b.destroy(),b=null);console.timeEnd("Load widgetOnScreen");m.publish("preloadWidgetsLoaded");this._doPostLoad()}),g.hitch(this,function(){b&&(b.destroy(),b=null);console.timeEnd("Load widgetOnScreen");m.publish("preloadWidgetsLoaded");this._doPostLoad()}))},_doPostLoad:function(){l(["dynamic-modules/postload"])},_loadPreloadWidget:function(a){var c=new t;if("config"===
this.appConfig.mode&&!a.uri){var b=this._createPreloadWidgetPlaceHolder(a);c.resolve(b);return c}if(!a.uri)return c.resolve(null),c;a.inPanel?(b=this._createPreloadWidgetIcon(a),c.resolve(b)):this.widgetManager.loadWidget(a).then(g.hitch(this,function(b){"map"===b.panel.positionRelativeTo?h.place(b.domNode,this.mapId):h.place(b.domNode,this.id);h.setStyle(b.domNode,u.getPositionStyle(b.position));h.setStyle(b.domNode,"position","absolute");try{b.startup()}catch(d){console.log(console.error("fail to startup widget "+
b.name+". "+d.stack))}b.configId=a.id;c.resolve(b)}),function(a){c.reject(a)});return c},_loadPreloadGroup:function(a){var c=new t;this.panelManager.showPanel(a).then(g.hitch(this,function(a){this.preloadGroupPanels.push(a);c.resolve(a)}),function(a){c.reject(a)});return c}});v.getInstance=function(a,c){null===y&&(y=new v(a,c));return y};return v})},"jimu/WidgetManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/Deferred dojo/topic dojo/aspect dojo/on dojo/json dojo/request/xhr dojo/i18n dojo/promise/all dojo/query dojo/NodeList-traverse dojo/dom-geometry dojo/dom-style esri/request ./utils jimu/tokenUtils ./dijit/Message".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z,A){var x=null,u=p(null,{constructor:function(){this.loaded=[];this.missedActions=[];m.subscribe("appConfigLoaded",g.hitch(this,this._onAppConfigLoaded));m.subscribe("appConfigChanged",g.hitch(this,this._onAppConfigChanged));m.subscribe("mapLoaded",g.hitch(this,this._onMapLoaded));m.subscribe("mapChanged",g.hitch(this,this._onMapChanged));m.subscribe("userSignIn",g.hitch(this,this._onUserSignIn));m.subscribe("userSignOut",g.hitch(this,this._onUserSignOut));
m.subscribe("actionTriggered",g.hitch(this,this._onActionTriggered))},loadWidget:function(a){var c=new f,b;a=g.clone(a);a.folderUrl||w.processWidgetSetting(a);(b=this.getWidgetById(a.id))?c.resolve(b):n([this.loadWidgetClass(a)]).then(g.hitch(this,function(b){var d=b[0];this.loadWidgetResources(a).then(g.hitch(this,function(b){try{var l=this.createWidget(a,d,b);console.log("widget ["+a.uri+"] created.")}catch(e){console.log("create ["+a.uri+"] error:"+e.stack),new A({message:"create widget error: "+
a.uri}),c.reject(e)}setTimeout(function(){c.resolve(l)},50)}),function(a){c.reject(a)})}),function(a){c.reject(a)});return c},loadWidgetClass:function(a){var c=new f;require(w.getRequireConfig(),[a.uri],g.hitch(this,function(a){c.resolve(a)}));w.checkError(a.uri,c);return c},loadWidgetResources:function(a){var c=new f,b,d,l,e=[];l=g.clone(a);a=this.tryLoadWidgetConfig(l);b=this._tryLoadResource(l,"i18n");d=this._tryLoadResource(l,"style");l=this._tryLoadResource(l,"template");e.push(a);e.push(b);
e.push(l);e.push(d);n(e).then(g.hitch(this,function(a){var b={};b.config=a[0];b.i18n=a[1];b.template=a[2];b.style=a[3];c.resolve(b)}),function(a){c.reject(a)});return c},createWidget:function(a,c,b){if(this.getWidgetById(a.id))return this.getWidgetById(a.id);b.config&&b.i18n&&(b.config=w.replacePlaceHolder(b.config,b.i18n));a.rawConfig=a.config;a.config=b.config||{};this.appConfig.agolConfig&&this._mergeAgolConfig(a);a.nls=b.i18n||{};b.template&&(a.templateString=b.template);a["class"]="jimu-widget";
a.label||(a.label=a.name);this.map&&(a.map=this.map);a.appConfig=this.appConfig;b={};for(var d in a)a.hasOwnProperty(d)&&(b[d]=a[d]);a=new c(b);a.clazz=c;e.after(a,"startup",g.hitch(this,this._postWidgetStartup,a));e.before(a,"destroy",g.hitch(this,this._onDestroyWidget,a));this.loaded.push(a);return a},getAllWidgets:function(){return this.loaded},destroyAllWidgets:function(){var a=k.map(this.loaded,function(a){return a.id});k.forEach(a,function(a){this.destroyWidget(a)},this);this.loaded=[]},loadWidgetSettingPage:function(a){var c=
new f;a=g.clone(a);a.id+="_setting";n([this.loadWidgetSettingClass(a)]).then(g.hitch(this,function(b){var d=b[0];this.loadWidgetSettingPageResources(a).then(g.hitch(this,function(b){var l;b={nls:b.i18n,templateString:b.template,appConfig:this.appConfig,map:this.map,"class":"jimu-widget-setting"};for(var n in a)a.hasOwnProperty(n)&&(b[n]=a[n]);try{l=new d(b),e.before(l,"destroy",g.hitch(this,this._onDestroyWidgetSetting,l)),c.resolve(l)}catch(r){new A({message:"Create widget setting page error:"+a.uri}),
c.reject(r)}}),function(a){console.log(a)})}),function(a){c.reject(a)});return c},loadWidgetSettingClass:function(a){var c=new f;require(w.getRequireConfig(),[a.folderUrl+"setting/Setting.js"],g.hitch(this,function(a){c.resolve(a)}));w.checkError(a.folderUrl+"setting/Setting.js",c);return c},loadWidgetSettingPageResources:function(a){var c=new f,b,d,l=[];a=g.clone(a);b=this._tryLoadResource(a,"settingI18n");d=this._tryLoadResource(a,"settingTemplate");a=this._tryLoadResource(a,"settingStyle");l.push(b);
l.push(d);l.push(a);n(l).then(g.hitch(this,function(a){var b={};b.i18n=a[0]||{};b.template=a[1];b.style=a[2];c.resolve(b)}),function(a){console.log(a)});return c},getWidgetById:function(a){var c;k.some(this.loaded,function(b){if(b.id===a)return c=b,!0},this);return c},changeWindowStateTo:function(a,c){"normal"===c?this.normalizeWidget(a):"minimized"===c?this.minimizeWidget(a):"maximized"===c?this.maximizeWidget(a):console.log("error state: "+c)},closeWidget:function(a){if("string"===typeof a&&(a=
this.getWidgetById(a),!a))return;if("closed"!==a.state){a.setState("closed");try{a.onClose()}catch(c){console.log(console.error("fail to close widget "+a.name+". "+c.stack))}}},openWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;if("closed"===a.state){a.setState("opened");try{a.onOpen()}catch(c){console.log(console.error("fail to open widget "+a.name+". "+c.stack))}}},maximizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&
this.openWidget(a);a.setWindowState("maximized");try{a.onMaximize()}catch(c){console.log(console.error("fail to maximize widget "+a.name+". "+c.stack))}},minimizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;"closed"===a.state&&this.openWidget(a);a.setWindowState("minimized");try{a.onMinimize()}catch(c){console.log(console.error("fail to minimize widget "+a.name+". "+c.stack))}},normalizeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;
"closed"===a.state&&this.openWidget(a);a.setWindowState("normal");try{a.onNormalize()}catch(c){console.log(console.error("fail to normalize widget "+a.name+". "+c.stack))}},destroyWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this._removeWidget(a);try{a.destroy()}catch(c){console.log(console.error("fail to destroy widget "+a.name+". "+c.stack))}},tryLoadWidgetConfig:function(a){var c=new f;if(a.config&&g.isObject(a.config))return c.resolve(a.config),c;if(a.config){if(require.cache["url:"+
a.config])return c.resolve(d.parse(require.cache["url:"+a.config])),c;c=a.config;if(a.config.startWith("widgets")||a.config.startWith("themes"))c=require(w.getRequireConfig()).toUrl(a.config);return b(c,{handleAs:"json"})}return this._tryLoadResource(a,"config")},loadWidgetStyle:function(a){var c="widget/style/"+a.uri,b=new f,c=this._replaceId(c);return h.byId(c)?(b.resolve("load"),b):w.loadStyleLink(c,a.styleFile,"theme_"+this.appConfig.theme.name+"_style_common")},loadWidgetSettingStyle:function(a){var c=
"widget/style/"+a.uri+"/setting",b=new f,c=this._replaceId(c);return h.byId(c)?(b.resolve("load"),b):w.loadStyleLink(c,a.settingStyleFile)},loadWidgetConfig:function(a){a=require(w.getRequireConfig()).toUrl(a.configFile);if(require.cache["url:"+a]){var c=new f;c.resolve(d.parse(require.cache["url:"+a]));return c}return b(a,{handleAs:"json"})},loadWidgetI18n:function(a){var c=new f;require(w.getRequireConfig(),["dojo/i18n!"+a.i18nFile],function(a){c.resolve(a)});return c},loadWidgetSettingI18n:function(a){var c=
new f;require(w.getRequireConfig(),["dojo/i18n!"+a.settingI18nFile],function(a){c.resolve(a)});return c},loadWidgetTemplate:function(a){var c=new f;require(w.getRequireConfig(),["dojo/text!"+a.templateFile],function(a){c.resolve(a)});w.checkError(a.templateFile,c);return c},loadWidgetSettingTemplate:function(a){var c=new f;require(w.getRequireConfig(),["dojo/text!"+a.settingTemplateFile],function(a){c.resolve(a)});w.checkError(a.settingTemplateFile,c);return c},removeWidgetStyle:function(a){h.destroy(this._replaceId("widget/style/"+
a.uri))},removeWidgetSettingStyle:function(a){h.destroy(this._replaceId("widget/style/"+a.uri+"/setting"))},getControllerWidgets:function(){return k.filter(this.loaded,function(a){return a.isController})},getPreloadPanelessWidgets:function(){return k.filter(this.loaded,function(a){return a.isPreload&&!a.inPanel})},_mergeAgolConfig:function(a){function c(b,d){for(var l in b)l.startWith(d)&&w.setConfigByTemplate(a.config,l.substr(d.length,l.length),b[l])}var b,d;if(this.appConfig.widgetOnScreen){if(this.appConfig.widgetOnScreen.groups)for(b=
0;b<this.appConfig.widgetOnScreen.groups.length;b++)for(d=0;d<this.appConfig.widgetOnScreen.groups[b].widgets.length;d++)if(this.appConfig.widgetOnScreen.groups[b].widgets[d].label===a.label){c(this.appConfig.agolConfig.values,"app_preloadWidgets_groups["+b+"]_widgets["+d+"]_");return}if(this.appConfig.widgetOnScreen.widgets)for(b=0;b<this.appConfig.widgetOnScreen.widgets.length;b++)if(this.appConfig.widgetOnScreen.widgets[b].label===a.label){c(this.appConfig.agolConfig.values,"app_preloadWidgets_widgets["+
b+"]_");return}}if(this.appConfig.widgetPool){if(this.appConfig.widgetPool.groups)for(b=0;b<this.appConfig.widgetPool.groups.length;b++)for(d=0;d<this.appConfig.widgetPool.groups[b].widgets.length;d++)if(this.appConfig.widgetPool.groups[b].widgets[d].label===a.label){c(this.appConfig.agolConfig.values,"app_widgetPool_groups["+b+"]_widgets["+d+"]_");return}if(this.appConfig.widgetPool.widgets)for(b=0;b<this.appConfig.widgetPool.widgets.length;b++)if(this.appConfig.widgetPool.widgets[b].label===a.label){c(this.appConfig.agolConfig.values,
"app_widgetPool_widgets["+b+"]_");break}}},_onUserSignIn:function(a){k.forEach(this.loaded,function(c){c.onSignIn(a)},this)},_onUserSignOut:function(){k.forEach(this.loaded,function(a){a.onSignOut()},this)},_onAppConfigLoaded:function(a){this.appConfig=a=g.clone(a);z.setPortalUrl(a.portalUrl)},_onMapLoaded:function(a){this.map=a},_onMapChanged:function(a){this.map=a},_onAppConfigChanged:function(a,c,b,d){var l=g.clone(a);this.appConfig=l;k.forEach(this.loaded,function(a){a&&(a.onAppConfigChanged(l,
c,b,d),"widgetChange"===c&&this._onConfigChanged(b.id,b.config,d),a.appConfig=l)},this)},_onConfigChanged:function(a,c){var b=this.getWidgetById(a);b&&(b.onConfigChanged(c),g.mixin(b.config,c))},_onActionTriggered:function(a,c,b){if(!("map"===a||"app"===a)){var d=this.getWidgetById(a);if(d)d.onAction(c,b);else this.missedActions.push({id:a,action:{name:c,data:b}});k.forEach(this.getControllerWidgets(),function(d){if(d.widgetIsControlled(a))d.onAction(c,{widgetId:a,data:b})},this)}},_postWidgetStartup:function(a){a.started=
!0;w.setVerticalCenter(a.domNode);e.after(a,"resize",g.hitch(this,w.setVerticalCenter,a.domNode));this.openWidget(a);var c=z.getPortalCredential(this.appConfig.portalUrl);if(c)a.onSignIn(c);else a.onSignOut();this._triggerMissedAction(a)},_triggerMissedAction:function(a){this.missedActions.forEach(function(c){if(c.id===a.id)a.onAction(c.action.name,c.action.data)})},_remove:function(a){return k.some(this.loaded,function(c,b){if(c.id===a)return this.loaded.splice(b,1),!0},this)},_tryLoadResource:function(a,
c){var b,d,l=new f,e=function(){var b;if("config"===c)b=this.loadWidgetConfig(a);else if("style"===c)b=this.loadWidgetStyle(a);else if("i18n"===c)b=this.loadWidgetI18n(a);else if("template"===c)b=this.loadWidgetTemplate(a);else if("settingTemplate"===c)b=this.loadWidgetSettingTemplate(a);else if("settingStyle"===c)b=this.loadWidgetSettingStyle(a);else if("settingI18n"===c)b=this.loadWidgetSettingI18n(a);else return l;b.then(function(a){l.resolve(a)},function(c){new A({message:"load widget resouce error: "+
a.uri});l.reject(c)})};if("config"===c)b=a.amdFolder+"config.json",a.configFile=b,d="hasConfig";else if("style"===c)b=a.amdFolder+"css/style.css",a.styleFile=b,d="hasStyle";else if("i18n"===c)b=a.amdFolder+"nls/strings.js",a.i18nFile=a.amdFolder+"nls/strings",d="hasLocale";else if("template"===c)b=a.amdFolder+"Widget.html",a.templateFile=b,d="hasUIFile";else if("settingTemplate"===c)b=a.amdFolder+"setting/Setting.html",a.settingTemplateFile=b,d="hasSettingUIFile";else if("settingI18n"===c)b=a.amdFolder+
"setting/nls/strings.js",a.settingI18nFile=a.amdFolder+"setting/nls/strings",d="hasSettingLocale";else if("settingStyle"===c)b=a.amdFolder+"setting/css/style.css",a.settingStyleFile=b,d="hasSettingStyle";else return l;!1===a[d]?l.resolve(null):!0===a[d]?e.apply(this):w.checkFileExist(b).then(g.hitch(this,function(a){a?e.apply(this):l.resolve(null)}));return l},_replaceId:function(a){return a.replace(/\//g,"_").replace(/\./g,"_")},_onDestroyWidget:function(a){"closed"!==a.state&&this.closeWidget(a);
this._removeWidget(a);console.log("destroy widget ["+a.uri+"].")},_onDestroyWidgetSetting:function(a){this.removeWidgetSettingStyle(a)},_removeWidget:function(a){if("string"===typeof a&&(a=this.getWidgetById(a),!a))return;this.removeWidgetStyle(a);this._remove(a.id)}});u.getInstance=function(a){null===x&&(x=new u(a));return x};return u})},"jimu/dijit/Message":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/query dojo/keys dojo/on jimu/dijit/Popup".split(" "),function(p,
g,k,h,f,m,e){return p(e,{baseClass:"jimu-popup jimu-message",type:"message",message:"",autoHeight:!0,maxWidth:350,maxHeight:180,postMixInProperties:function(){this.content=this.message},_createTitleNode:function(){this.titleLabel&&(this.titleNode=k.create("div",{"class":"title"},this.domNode),this.titleLabeNode=k.create("span",{"class":"title-label",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode),this.closeBtnNode=k.create("div",{"class":"close-btn"},this.titleNode),this.own(m(this.closeBtnNode,
"click",g.hitch(this,this.close))))},_preProcessing:function(){0===this.buttons.length&&this.buttons.push({label:"OK",key:f.ENTER,onClick:g.hitch(this,this.close)})},_increaseZIndex:function(){k.setStyle(this.domNode,"zIndex",9999);k.setStyle(this.overlayNode,"zIndex",9998)}})})},"jimu/dijit/Popup":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/on dojo/sniff dojo/keys dojo/query dojo/aspect dojo/NodeList-dom dojo/dnd/move dijit/_WidgetBase".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t){var a=0;return p(t,{"class":"jimu-popup",titleLabel:"",content:null,container:null,buttons:[],enabledButtons:[],disabledButtons:[],onClose:null,_fixedHeight:!1,autoHeight:!1,maxHeight:800,maxWidth:1024,constructor:function(){this.buttons=[];this.enabledButtons=[];this.disabledButtons=[];this.pauseKeyHandles=[];this.container=jimuConfig.layoutId},postCreate:function(){this._preProcessing();this.inherited(arguments);this.domNode.tabIndex=1;this._initDomNode();this._positioning();
h.place(this.domNode,this.container);this._moveToMiddle();this._limitButtonsMaxWidth();this.own(m(window,"resize",g.hitch(this,function(){this._fixedHeight||this.autoHeight?(this._calculatePosition(),this._moveToMiddle()):this._positioning()})));this.overlayNode=h.create("div",{"class":"popup-overlay"},this.container);this._increaseZIndex();f.animateProperty({node:this.domNode,properties:{opacity:1},duration:200}).play();this.domNode.focus()},_preProcessing:function(){"number"===typeof this.height&&
(this._fixedHeight=!0,this.autoHeight=!1);this.autoHeight&&(this.maxHeight=598)},_createTitleNode:function(){this.titleNode=h.create("div",{"class":"title"},this.domNode);this.titleLabeNode=h.create("span",{"class":"title-label",innerHTML:this.titleLabel||"\x26nbsp"},this.titleNode);this.closeBtnNode=h.create("div",{"class":"close-btn"},this.titleNode);this.own(m(this.closeBtnNode,"click",g.hitch(this,this.close)))},_initDomNode:function(){this._createTitleNode();this.contentContainerNode=h.create("div",
{"class":"content"},this.domNode);this.content&&("string"===typeof this.content?this.contentContainerNode.innerHTML=this.content:this.content.domNode?(this.content.placeAt(this.contentContainerNode),this.content.popup=this):1===this.content.nodeType&&h.place(this.content,this.contentContainerNode));this.buttonContainer=h.create("div",{"class":"button-container"},this.domNode);0===this.buttons.length&&h.setStyle(this.buttonContainer,"display","none");for(var a=this.buttons.length-1;-1<a;a--)this._createButton(this.buttons[a]),
this.buttons[a].disable&&this.disableButton(a)},_limitButtonsMaxWidth:function(){var a=this.enabledButtons.length;if(0!==a){var b=h.getContentBox(this.buttonContainer),d=h.getMarginExtents(this.enabledButtons[0]),n=h.getPadBorderExtents(this.enabledButtons[0]),r=0,n=8===e("ie")?n.l+n.r:0,r=(b.w-(d.l+d.r+n)*a)/a;0<r&&(k.forEach(this.enabledButtons,g.hitch(this,function(a){h.setStyle(a,"maxWidth",r+"px")})),k.forEach(this.disabledButtons,g.hitch(this,function(a){h.setStyle(a,"maxWidth",r+"px")})))}},
_moveableNode:function(a,b){this.moveable&&(this.moveable.destroy(),this.moveable=null);var d=h.getMarginBox(this.container);d.l=d.l-a+b;d.w+=2*(a-b);this.moveable=new n.boxConstrainedMoveable(this.domNode,{box:d,handle:this.titleNode,within:!0});this.own(m(this.moveable,"Moving",g.hitch(this,this.onMoving)));this.own(m(this.moveable,"MoveStop",g.hitch(this,this.onMoveStop)))},_getHeaderBox:function(){return 0===d("#header").length?{t:0,l:0,w:0,h:0}:h.getMarginBox("header")},_getFooterBox:function(){return 0===
d(".footer",this.container).length?{t:0,l:0,w:0,h:0}:h.getMarginBox(d(".footer",this.container)[0])},_calculatePosition:function(){var a=h.getContentBox(this.container),b=this._getHeaderBox(),d=this._getFooterBox(),d=a.h-b.h-d.h-40,e=0;e=this._fixedHeight?this.height:this.autoHeight?d-200:this.height=d>this.maxHeight?this.maxHeight:d;d=(d-e)/2+b.h+20;d=d<b.h?b.h:d;this.width=this.width||this.maxWidth;h.setStyle(this.domNode,{left:(a.w-this.width)/2+"px",top:d+"px",width:this.width+"px"})},_calculateHeight:function(){this.autoHeight?
(h.setStyle(this.domNode,"height","auto"),h.addClass(this.contentContainerNode,"content-static"),0===this.buttons.length&&h.setStyle(this.contentContainerNode,{marginBottom:"15px"})):(h.setStyle(this.domNode,"height",this.height+"px"),h.addClass(this.contentContainerNode,"content-absolute"),h.addClass(this.buttonContainer,"button-container-absolute"),0===this.buttons.length&&h.setStyle(this.contentContainerNode,{bottom:"15px"}));this._moveableNode(this.width,100)},_moveToMiddle:function(){if(this.autoHeight){var a=
h.getMarginBox(this.domNode),b=h.getContentBox(this.container),d=this._getHeaderBox(),e=this._getFooterBox(),e=b.h-d.h-e.h-40,n=0,n=a.h||e-200,a=(e-n)/2+d.h+20,a=a<d.h?d.h:a;h.setStyle(this.domNode,{left:(b.w-this.width)/2+"px",top:a+"px",width:this.width+"px"})}},_positioning:function(){this._calculatePosition();this._calculateHeight()},_increaseZIndex:function(){h.setStyle(this.domNode,"zIndex",a+501);h.setStyle(this.overlayNode,"zIndex",a+500);a++},onMoving:function(a){h.setStyle(a.node,"opacity",
0.9)},onMoveStop:function(a){h.setStyle(a.node,"opacity",1)},close:function(){if(!(this.onClose&&!1===this.onClose())){var a=this.domNode.parentNode,b=g.clone(this.domNode);h.setStyle(this.domNode,"display","none");h.destroy(this.overlayNode);this.destroy();this.moveable.destroy();h.place(b,a);f.animateProperty({node:b,properties:{opacity:0},duration:200,onEnd:function(){h.destroy(b)}}).play()}},addButton:function(a){this._createButton(a)},_createButton:function(a){var b=h.create("div",{"class":"jimu-popup-btn",
innerHTML:a.label},this.buttonContainer);this.enabledButtons.unshift(b);var d=h.create("div",{"class":"jimu-popup-btn jimu-state-disabled",innerHTML:a.label,style:{display:"none"}},this.buttonContainer);this.disabledButtons.unshift(d);d="click";"ontouchend"in b&&(d="touchend");this.own(m(b,d,g.hitch(this,function(b){if(a.onClick)a.onClick(b);else this.close()})))},enableButton:function(a){"number"===typeof a?(h.setStyle(this.enabledButtons[a],"display","inline-block"),h.setStyle(this.disabledButtons[a],
"display","none")):(k.forEach(this.enabledButtons[a],g.hitch(this,function(a){h.setStyle(a,"display","inline-block")})),k.forEach(this.disabledButtons[a],g.hitch(this,function(a){h.setStyle(a,"display","none")})))},disableButton:function(a){"number"===typeof a?(h.setStyle(this.disabledButtons[a],"display","inline-block"),h.setStyle(this.enabledButtons[a],"display","none")):(k.forEach(this.disabledButtons,g.hitch(this,function(a){h.setStyle(a,"display","inline-block")})),k.forEach(this.enabledButtons,
g.hitch(this,function(a){h.setStyle(a,"display","none")})))}})})},"dojo/dnd/move":function(){define("../_base/declare ../dom-geometry ../dom-style ./common ./Mover ./Moveable".split(" "),function(p,g,k,h,f,m){h=p("dojo.dnd.move.constrainedMoveable",m,{constraints:function(){},within:!1,constructor:function(e,f){f||(f={});this.constraints=f.constraints;this.within=f.within},onFirstMove:function(e){var f=this.constraintBox=this.constraints.call(this,e);f.r=f.l+f.w;f.b=f.t+f.h;this.within&&(e=g.getMarginSize(e.node),
f.r-=e.w,f.b-=e.h)},onMove:function(e,f){var d=this.constraintBox,b=e.node.style;this.onMoving(e,f);f.l=f.l<d.l?d.l:d.r<f.l?d.r:f.l;f.t=f.t<d.t?d.t:d.b<f.t?d.b:f.t;b.left=f.l+"px";b.top=f.t+"px";this.onMoved(e,f)}});f=p("dojo.dnd.move.boxConstrainedMoveable",h,{box:{},constructor:function(e,f){var d=f&&f.box;this.constraints=function(){return d}}});p=p("dojo.dnd.move.parentConstrainedMoveable",h,{area:"content",constructor:function(e,f){var d=f&&f.area;this.constraints=function(){var b=this.node.parentNode,
e=k.getComputedStyle(b),n=g.getMarginBox(b,e);if("margin"==d)return n;var f=g.getMarginExtents(b,e);n.l+=f.l;n.t+=f.t;n.w-=f.w;n.h-=f.h;if("border"==d)return n;f=g.getBorderExtents(b,e);n.l+=f.l;n.t+=f.t;n.w-=f.w;n.h-=f.h;if("padding"==d)return n;f=g.getPadExtents(b,e);n.l+=f.l;n.t+=f.t;n.w-=f.w;n.h-=f.h;return n}}});return{constrainedMoveable:h,boxConstrainedMoveable:f,parentConstrainedMoveable:p}})},"jimu/PanelManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/fx dojo/Deferred dojo/on dojo/aspect require ./utils ./WidgetManager".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r){var n,t=null;n=p(null,{constructor:function(){this.panels=[];this.widgetManager=r.getInstance();e(window,"resize",g.hitch(this,this.onWindowResize))},showPanel:function(a){var c=a.id+"_panel",e=this.getPanelById(c),l=new m;e?("closed"===e.state&&this.openPanel(e,a.panel.position),l.resolve(e)):d([a.panel.uri],g.hitch(this,function(d){var e;e="map"===a.panel.positionRelativeTo?jimuConfig.mapId:jimuConfig.layoutId;var n={widgetIcon:a.panel.widgetIcon,label:a.label,config:a,
uri:a.panel.uri,position:a.panel.position,positionRelativeTo:a.panel.positionRelativeTo,map:this.map,widgetManager:this.widgetManager,panelManager:this,containerId:e,id:c,gid:a.gid};g.mixin(n,a.panel.options);var r;try{r=new d(n),console.log("panel ["+c+"] created.")}catch(f){console.log("create panel error: "+f+", panelId: "+c);l.reject(f);return}h.setStyle(r.domNode,"opacity",0);h.setStyle(r.domNode,b.getPositionStyle(a.panel.position));q.before(r,"destroy",g.hitch(this,this.onDestroyPanel,r));
h.place(r.domNode,e);try{r.startup()}catch(s){console.log(console.error("fail to startup panel "+r.id+". "+s.stack));l.reject(s);return}this.openPanel(r);b.setVerticalCenter(r.domNode);this.panels.push(r);l.resolve(r)}));return l},closeOtherPanelsInTheSameGroup:function(a){for(var c=0;c<this.panels.length;c++)this.panels[c].gid===a.gid&&this.panels[c].id!==a.id&&this.closePanel(this.panels[c],!1)},openPanel:function(a,c){var d=new m;if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if("opened"===
a.state)d.resolve();else{try{this.closeOtherPanelsInTheSameGroup(a),h.setStyle(a.domNode,"display","block"),h.setStyle(a.domNode,b.getPositionStyle(c)),f.animateProperty({node:a.domNode,properties:{opacity:1},duration:200,onEnd:g.hitch(this,function(){a.setState("opened");a.onOpen();d.resolve()})}).play()}catch(l){console.log(console.error("fail to open panel "+a.id+". "+l.stack))}return d}},closePanel:function(a,c){var b=new m;if("string"===typeof a&&(a=this.getPanelById(a),!a))return b.resolve(),
b;void 0===c&&(c=!0);if("closed"===a.state)return b.resolve(),b;try{c?f.animateProperty({node:a.domNode,properties:{opacity:0},duration:200,onEnd:function(){a.setState("closed");a.onClose();h.setStyle(a.domNode,"display","none");b.resolve()}}).play():(a.setState("closed"),a.onClose(),h.setStyle(a.domNode,"display","none"),b.resolve())}catch(d){console.log(console.error("fail to close panel "+a.id+". "+d.stack))}return b},minimizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;
"closed"===a.state&&this.openPanel(a);a.setWindowState("minimized");try{a.onMinimize()}catch(c){console.log(console.error("fail to minimize panel "+a.id+". "+c.stack))}},maximizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"closed"===a.state&&this.openPanel(a);a.setWindowState("maximized");try{a.onMaximize()}catch(c){console.log(console.error("fail to maximize panel "+a.id+". "+c.stack))}},normalizePanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;
"closed"===a.state&&this.openPanel(a);a.setWindowState("normal");try{a.onNormalize()}catch(c){console.log(console.error("fail to noralize panel "+a.id+". "+c.stack))}},changeWindowStateTo:function(a,c){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;"normal"===c?this.normalizePanel(a):"minimized"===c?this.minimizePanel(a):"maximized"===c?this.maximizePanel(a):console.log("error state: "+c)},getPanelById:function(a){for(var c=0;c<this.panels.length;c++)if(this.panels[c].id===a)return this.panels[c]},
onWindowResize:function(){for(var a=0;a<this.panels.length;a++)"closed"!==this.panels[a].state&&this.panels[a].resize()},destroyPanel:function(a){if("string"===typeof a&&(a=this.getPanelById(a),!a))return;if(a.domNode){"closed"!==a.state&&this.closePanel(a,!1);this._removePanel(a);try{a.destroy()}catch(c){console.log(console.error("fail to destroy panel "+a.id+". "+c.stack))}}},onDestroyPanel:function(a){"closed"!==a.state&&this.closePanel(a,!1);this._removePanel(a);console.log("destroy panel "+a.id)},
destroyAllPanels:function(){var a=k.map(this.panels,function(a){return a.id});k.forEach(a,function(a){this.destroyPanel(a)},this);this.panels=[]},reloadWidgetInPanel:function(a){this.panels.forEach(function(c){c.reloadWidget(a)},this)},_removePanel:function(a){a=this.panels.indexOf(a);-1<a&&this.panels.splice(a,1)}});n.getInstance=function(){null===t&&(t=new n);return t};return n})},"jimu/MapManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/topic dojo/on dojo/aspect dojo/keys esri/arcgis/utils esri/dijit/InfoWindow esri/dijit/PopupMobile esri/InfoTemplate esri/request esri/SpatialReference esri/geometry/Extent require jimu/portalUrlUtils ./utils ./dijit/LoadingShelter".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z){var A=null,x=p(null,{appConfig:null,mapDivId:"",map:null,previousInfoWindow:null,mobileInfoWindow:null,isMobileInfoWindow:!1,constructor:function(a,c){this.appConfig=a;this.id=this.mapDivId=c;f.subscribe("appConfigChanged",g.hitch(this,this.onAppConfigChanged));f.subscribe("changeMapPosition",g.hitch(this,this.onChangeMapPosition));m(window,"resize",g.hitch(this,this.onWindowResize))},showMap:function(){this._showMap(this.appConfig)},_showMap:function(a){console.time("Load Map");
this.loading=new z;this.loading.placeAt(this.mapDivId);this.loading.startup();a.map["3D"]?a.map.itemId?this._show3DWebScene(a):this._show3DLayersMap(a):a.map.itemId?this._show2DWebMap(a):console.log("No webmap found. Please set map.itemId in config.json.")},onWindowResize:function(){this.map&&this.map.resize&&(this.map.resize(),this.resetInfoWindow())},resetInfoWindow:function(){!this.previousInfoWindow&&(this.map&&this.map.infoWindow)&&(this.previousInfoWindow=this.map.infoWindow);!this.mobileInfoWindow&&
(this.map&&this.map.root)&&(this.mobileInfoWindow=new r(null,h.create("div",null,null,this.map.root)));if(jimuConfig&&jimuConfig.widthBreaks&&this.previousInfoWindow&&this.mobileInfoWindow){var a=jimuConfig.widthBreaks[0];h.getContentBox(jimuConfig.layoutId).w<a&&!this.isMobileInfoWindow?(this.map.infoWindow.hide(),this.map.setInfoWindow(this.mobileInfoWindow),this.isMobileInfoWindow=!0):h.getContentBox(jimuConfig.layoutId).w>=a&&this.isMobileInfoWindow&&(this.map.infoWindow.hide(),this.map.setInfoWindow(this.previousInfoWindow),
this.isMobileInfoWindow=!1)}},onChangeMapPosition:function(a){var c=g.clone(this.appConfig.map.position);a=g.mixin(c,a);h.setStyle(this.mapDivId,w.getPositionStyle(a));this.map&&this.map.resize&&this.map.resize()},_visitConfigMapLayers:function(a,c){k.forEach(a.map.basemaps,function(a,b){a.isOperationalLayer=!1;c(a,b)},this);k.forEach(a.map.operationallayers,function(a,b){a.isOperationalLayer=!0;c(a,b)},this)},_show3DLayersMap:function(a){s(["esri3d/Map"],g.hitch(this,function(c){var b;b=new c(this.mapDivId,
{camera:a.map.mapOptions.camera});this._visitConfigMapLayers(a,g.hitch(this,function(a){this.createLayer(b,"3D",a)}));b.usePlugin=c.usePlugin;this._publishMapEvent(b)}))},_show3DWebScene:function(a){this._getWebsceneData(a.map.itemId).then(g.hitch(this,function(c){s(["esri3d/Map"],g.hitch(this,function(b){var d=new b(this.mapDivId,a.map.mapOptions);k.forEach(c.itemData.operationalLayers,function(a){this.createLayer(d,"3D",a)},this);k.forEach(c.itemData.baseMap.baseMapLayers,function(a){a.type="tile";
this.createLayer(d,"3D",a)},this);k.forEach(c.itemData.baseMap.elevationLayers,function(a){a.type="elevation";this.createLayer(d,"3D",a)},this);d.toc=c.itemData.toc;d.bookmarks=c.itemData.bookmarks;d.tours=c.itemData.tours}))}))},_publishMapEvent:function(a){window._viewerMap=a;this.loading&&this.loading.destroy();console.timeEnd("Load Map");this.map?(this.map=a,console.log("map changed."),f.publish("mapChanged",this.map)):(this.map=a,f.publish("mapLoaded",this.map));this.resetInfoWindow()},_getWebsceneData:function(a){return t({url:"http://184.169.133.166/sharing/rest/content/items/"+
a+"/data",handleAs:"json"})},_show2DWebMap:function(b){var d=this._processMapOptions(b.map.mapOptions);if((!b.map.mapOptions||!b.map.mapOptions.extent)&&"6e03e8c26aad4b9c92a87c1063ddb0e3"===b.map.itemId)d||(d={}),d.extent=new c(-1.4480448059223117E7,2605852.2271675873,-6653296.362823148,6514536.1055573225,new a(102100));w.createWebMap(b.map.portalUrl,b.map.itemId,this.mapDivId,{mapOptions:d,bingMapsKey:b.bingMapsKey}).then(g.hitch(this,function(a){var c=a.map;c.itemId=b.map.itemId;c.itemInfo=a.itemInfo;
c.webMapResponse=a;c.enableSnapping({snapKey:q.copyKey});this._publishMapEvent(c)}),g.hitch(this,function(){this.loading&&this.loading.destroy();f.publish("mapCreatedFailed")}))},_processMapOptions:function(a){if(a)return a=g.clone(a),a.extent&&(a.extent=new c(a.extent)),a.infoWindow&&(a.infoWindow=new b(a.infoWindow,h.create("div",{},this.mapDivId))),a},createLayer:function(a,c,b){s([{"2D_tiled":"esri/layers/ArcGISTiledMapServiceLayer","2D_dynamic":"esri/layers/ArcGISDynamicMapServiceLayer","2D_image":"esri/layers/ArcGISImageServiceLayer",
"2D_feature":"esri/layers/FeatureLayer","2D_rss":"esri/layers/GeoRSSLayer","2D_kml":"esri/layers/KMLLayer","2D_webTiled":"esri/layers/WebTiledLayer","2D_wms":"esri/layers/WMSLayer","2D_wmts":"esri/layers/WMTSLayer","3D_tiled":"esri3d/layers/ArcGISTiledMapServiceLayer","3D_dynamic":"esri3d/layers/ArcGISDynamicMapServiceLayer","3D_image":"esri3d/layers/ArcGISImageServiceLayer","3D_feature":"esri3d/layers/FeatureLayer","3D_elevation":"esri3d/layers/ArcGISElevationServiceLayer","3D_3dmodle":"esri3d/layers/SceneLayer"}[c+
"_"+b.type]],g.hitch(this,function(c){var d,l={};d="label url type icon infoTemplate isOperationalLayer".split(" ");for(var r in b)0>d.indexOf(r)&&(l[r]=b[r]);b.infoTemplate?(d=new n(b.infoTemplate.title,b.infoTemplate.content),l.infoTemplate=d,c=new c(b.url,l),b.infoTemplate.width&&b.infoTemplate.height&&e.after(c,"onClick",g.hitch(this,function(){a.infoWindow.resize(b.infoTemplate.width,b.infoTemplate.height)}),!0)):c=new c(b.url,l);c.isOperationalLayer=b.isOperationalLayer;c.label=b.label;c.icon=
b.icon;a.addLayer(c)}))},onAppConfigChanged:function(a,c,b,d){"mapChange"===c&&!(d&&!1===d.reCreateMap)&&(this.map&&(f.publish("beforeMapDestory",this.map),this.map.destroy()),this._showMap(a));this.appConfig=a}});x.getInstance=function(a,c){null===A&&(A=new x(a,c));return A};return x})},"esri/dijit/InfoWindow":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/sniff dojo/dom-class dojo/dom-construct dojo/dom-style dijit/_Widget dijit/_Templated dijit/_Container ../kernel ../domUtils ../InfoWindowBase ./_EventedWidget dojo/text!./templates/InfoWindow.html".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z){var A=p([w,n,t,a,l],{declaredClass:"esri.dijit.InfoWindow",isContainer:!0,templateString:z,anchor:"upperright",fixedAnchor:null,coords:null,isShowing:!0,isContentShowing:!0,isTitleBarShowing:!0,width:250,height:150,title:"Info Window",setMap:function(a){this.inherited(arguments);b.place(this.domNode,a.root)},startup:function(){if(!this._started){this.inherited(arguments);this._ANCHORS=[A.ANCHOR_UPPERRIGHT,A.ANCHOR_LOWERRIGHT,A.ANCHOR_LOWERLEFT,A.ANCHOR_UPPERLEFT];
if(7>m("ie")){var a="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled\x3d'true', sizingMethod\x3d'crop', src\x3d'"+r.getComputedStyle(this._sprite).backgroundImage.replace(/url\(\"/i,"").replace(/\"\)/,"")+"')",c=b.create("div",null,h.body());r.set(c,{width:"1px",height:"1px",display:"none",backgroundImage:"none",filter:a});var d=setTimeout(function(){b.destroy(c);clearTimeout(d);d=c=null},100);f.query(".sprite",this.domNode).forEach(function(c){c.style.backgroundImage="none";c.style.filter=
a})}this.resize(this.width,this.height);this.hide()}},destroy:function(){this._destroyed||(this.__unregisterMapListeners(),this.destroyDijits(this._title),this.destroyDijits(this._content),this._title.innerHTML=this._content.innerHTML="",this.inherited(arguments))},resize:function(a,c){if(a&&c){var b=r.set;b(this._topleft,{height:c+"px",marginLeft:a+"px"});b(this._topright,{width:a+"px",height:c+"px"});b(this._user,"width",a-8+"px");b(this._hide,"marginLeft",a-22+"px");b(this._title,"width",a-25+
"px");b(this._content,"height",c-37+"px");b(this._bottomleft,{marginLeft:a+"px",marginTop:c+"px"});b(this._bottomright,{width:a-5+"px",marginTop:c+"px"});this.width=a;this.height=c;this.coords&&this._adjustPosition(this.coords,this.anchor);this.onResize(a,c)}},_adjustPosition:function(a,c){var b=r.set;b(this._infowindow,{left:Math.round(a.x)+"px",top:Math.round(a.y)+"px"});c===A.ANCHOR_UPPERLEFT?b(this._window,{left:null,right:this.width+18+"px",top:null,bottom:this.height+50+"px"}):c===A.ANCHOR_UPPERRIGHT?
b(this._window,{left:"6px",right:null,top:null,bottom:this.height+50+"px"}):c===A.ANCHOR_LOWERRIGHT?b(this._window,{left:"6px",right:null,top:"43px",bottom:null}):c===A.ANCHOR_LOWERLEFT&&b(this._window,{left:null,right:this.width+18+"px",top:"43px",bottom:null})},_getAnchor:function(a){var c=this.map;return c&&a?(a.y<c.height/2?"lower":"upper")+(a.x<c.width/2?"right":"left"):"upperright"},show:function(a,c,b){if(a){a.spatialReference?(this.mapCoords=a,a=this.coords=this.map.toScreen(a,!0)):(this.mapCoords=
null,this.coords=a);var l=this.map._getFrameWidth();if(-1!==l&&(a.x%=l,0>a.x&&(a.x+=l),this.map.width>l))for(var e=(this.map.width-l)/2;a.x<e;)a.x+=l;if(!c||-1===k.indexOf(this._ANCHORS,c))c=this._getAnchor(a);d.remove(this._pointer,this.anchor);c=this.anchor=this.fixedAnchor||c;this._adjustPosition(a,c);d.add(this._pointer,c);s.show(this.domNode);this.isShowing=!0;if(!b)this.onShow()}},hide:function(a,c){s.hide(this.domNode);this.isShowing=!1;if(!c)this.onHide()},showTitleBar:function(){s.show(this._titlebar);
s.show(this._border);this.isTitleBarShowing=!0},hideTitleBar:function(){s.hide(this._titlebar);s.hide(this._border);this.isTitleBarShowing=!1},showContent:function(){s.show(this._content);s.show(this._border);this.isContentShowing=!0},hideContent:function(){s.hide(this._content);s.hide(this._border);this.isContentShowing=!1},move:function(a,c){c?a=this.coords.offset(a.x,a.y):(this.coords=a,this.mapCoords&&(this.mapCoords=this.map.toMap(a)));r.set(this._infowindow,{left:Math.round(a.x)+"px",top:Math.round(a.y)+
"px"})},setFixedAnchor:function(a){a&&-1===k.indexOf(this._ANCHORS,a)||(this.fixedAnchor=a,this.isShowing&&this.show(this.mapCoords||this.coords,a),this.onAnchorChange(a))},setTitle:function(a){this.destroyDijits(this._title);this.__setValue("_title",a);return this},setContent:function(a){this.destroyDijits(this._content);this.__setValue("_content",a);return this},onShow:function(){this.__registerMapListeners();this.startupDijits(this._title);this.startupDijits(this._content)},onHide:function(){this.__unregisterMapListeners()},
onResize:function(){},onAnchorChange:function(){}});g.mixin(A,{ANCHOR_UPPERRIGHT:"upperright",ANCHOR_LOWERRIGHT:"lowerright",ANCHOR_LOWERLEFT:"lowerleft",ANCHOR_UPPERLEFT:"upperleft"});return A})},"esri/dijit/PopupMobile":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/window dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style ../InfoWindowBase ../PopupBase ./InfoView ./NavigationBar ../kernel ../domUtils dojo/i18n!../nls/jsapi dojo/NodeList-dom".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z,A,x,u){return g([s,l],{declaredClass:"esri.dijit.PopupMobile",offsetX:3,offsetY:3,zoomFactor:4,marginLeft:10,marginTop:10,highlight:!0,popupNavigationBar:null,popupInfoView:null,location:null,xIcon:p.toUrl("./images/whitex.png"),dArrowIcon:p.toUrl("./images/whitedown.png"),lArrowIcon:p.toUrl("./images/whitel.png"),rArrowIcon:p.toUrl("./images/whiter.png"),constructor:function(a,c){this.initialize();k.mixin(this,a);this.domNode=b.byId(c);this._nls=k.mixin({},
u.widgets.popup);var d=this.domNode;n.add(d,"esriPopupMobile");r.set(d,"innerHTML","\x3cdiv class\x3d'sizer'\x3e\x3cdiv class\x3d'titlePane'\x3e\x3cdiv class\x3d'spinner hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'title'\x3e\x3c/div\x3e\x3cdiv style\x3d'text-align:center'\x3e\x3cdiv class\x3d'titleButton prev hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'footer' style\x3d'display:inline-block;width:60px;height:15px;'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton next hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton close'\x3e\x3c/div\x3e\x3cdiv class\x3d'titleButton arrow hidden'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer top hidden'\x3e\x3c/div\x3e\x3cdiv class\x3d'pointer bottom hidden'\x3e\x3c/div\x3e");
var l=e.query(".titlePane",d)[0];this._arrowButton=e.query(".arrow",l)[0];this._pointerTop=e.query(".top",d)[0];this._pointerBottom=e.query(".bottom",d)[0];this._title=e.query(".title",l)[0];this._footer=e.query(".footer",l)[0];this._prev=e.query(".prev",l)[0];this._next=e.query(".next",l)[0];this._spinner=e.query(".spinner",l)[0];this._eventConnections=[h.connect(e.query(".close",l)[0],"onclick",this,this.hide),h.connect(this._arrowButton,"onclick",this,this._toggleView),h.connect(this._prev,"onclick",
this,function(){this.selectPrevious();this._updateUI()}),h.connect(this._next,"onclick",this,function(){this.selectNext();this._updateUI()})];this._initPopupNavigationBar();this._initPopupInfoView();x.hide(d);this.isShowing=!1},setMap:function(a){this.inherited(arguments);t.place(this.domNode,a.root);this.highlight&&this.enableHighlight(a)},unsetMap:function(){this.disableHighlight(this.map);this.inherited(arguments)},setTitle:function(a,c){this.destroyDijits(this._title);this.place(a,this._title);
this.destroyDijits(this._footer);this.place(c,this._footer);this.isShowing&&(this.startupDijits(this._title),this.startupDijits(this._footer))},setContent:function(a){this.destroyDijits(this._contentPane);this.place(a,this._contentPane);this.startupDijits(this._contentPane)},show:function(a){if(a){var c=this.map;a.spatialReference?(this.location=a,a=c.toScreen(a)):this.location=c.toMap(a);this._maximized?this.restore():this._setPosition(a);this.isShowing||(x.show(this.domNode),this.isShowing=!0,this.onShow())}else x.show(this.domNode),
this.isShowing=!0},hide:function(){this.isShowing&&(x.hide(this.domNode),this.isShowing=!1,this.onHide())},onShow:function(){this._followMap();this.startupDijits(this._title);this.showHighlight()},onHide:function(){this._unfollowMap();this.hideHighlight()},destroy:function(){this.map&&this.unsetMap();this.cleanup();this.isShowing&&this.hide();this.destroyDijits(this._title);this.destroyDijits(this._footer);f.forEach(this._eventConnections,h.disconnect);t.destroy(this.domNode)},selectNext:function(){this.select(this.selectedIndex+
1)},selectPrevious:function(){this.select(this.selectedIndex-1)},setFeatures:function(){this.inherited(arguments);this._updateUI()},onSetFeatures:function(){},onClearFeatures:function(){this.setTitle("\x26nbsp;","\x26nbsp;");n.add(this._arrowButton,"hidden");this._updateUI();this.hideHighlight()},onSelectionChange:function(){var a=this.selectedIndex;this._updateUI();0<=a&&(this.setContent(this.features[a].getContent()),this.updateHighlight(this.map,this.features[a]),this.isShowing&&this.showHighlight())},
onDfdComplete:function(){this._updateUI()},_followMap:function(){this._unfollowMap();var a=this.map;this._handles=[h.connect(a,"onPanStart",this,this._onPanStart),h.connect(a,"onPan",this,this._onPan),h.connect(a,"onZoomStart",this,this._onZoomStart),h.connect(a,"onExtentChange",this,this._onExtentChange)]},_unfollowMap:function(){var a=this._handles;a&&(f.forEach(a,h.disconnect),this._handles=null)},_onPanStart:function(){var a=this.domNode.style;this._panOrigin={left:a.left,top:a.top,right:a.right,
bottom:a.bottom}},_onPan:function(a,b){var d=this._panOrigin,l=b.x,e=b.y,n=d.left,r=d.top,f=d.right,d=d.bottom;n&&(n=parseFloat(n)+l+"px");r&&(r=parseFloat(r)+e+"px");f&&(f=parseFloat(f)-l+"px");d&&(d=parseFloat(d)-e+"px");c.set(this.domNode,{left:n,top:r,right:f,bottom:d})},_onZoomStart:function(){x.hide(this.domNode)},_onExtentChange:function(a,c,b){b&&(x.show(this.domNode),this.show(this._targetLocation||this.location),this._targetLocation=null)},_setPosition:function(b){var d=b.x;b=b.y;var l=
a.getContentBox(this.map.container),e=l.w,l=l.h,r=0,f=b+10,g=118,s=e-18;18<d&&d<s?(r=d-130,0>r?r=0:r>e-260&&(r=e-260)):18>=d?r=d-18:d>=s&&(r=e-260+(d-s));118<d&&d<e-130?g=118:118>=d?18<d?g=d-12:18>=d&&(g=6):d>=e-130&&(d<s?g=118+d-(e-130):d>=s&&(g=118+s-(e-130)));b<=l/2?(c.set(this.domNode,{left:r+"px",top:f+"px",bottom:null}),c.set(this._pointerTop,{left:g+"px"}),n.add(this._pointerBottom,"hidden"),n.remove(this._pointerTop,"hidden")):(c.set(this.domNode,{left:r+"px",top:f-64+"px",bottom:null}),c.set(this._pointerBottom,
{left:g+"px"}),n.add(this._pointerTop,"hidden"),n.remove(this._pointerBottom,"hidden"))},_showPointer:function(a){f.forEach(["topLeft","topRight","bottomRight","bottomLeft"],function(c){c===a?e.query(".pointer."+c,this.domNode).removeClass("hidden"):e.query(".pointer."+c,this.domNode).addClass("hidden")},this)},_toggleView:function(){this.popupNavigationBar||this._initPopupNavigationBar();this.popupInfoView||this._initPopupInfoView();this.hide();x.show(this.popupNavigationBar.container);x.show(this.popupInfoView.container);
0<=this.selectedIndex&&this.setContent(this.features[this.selectedIndex].getContent())},_handleNavigationBar:function(a){this.popupInfoView.animateTo(0);switch(a.name){case "CloseButton":x.hide(this.popupNavigationBar.container);x.hide(this.popupInfoView.container);this.hide();break;case "ToggleButton":x.hide(this.popupNavigationBar.container);x.hide(this.popupInfoView.container);this.show(this.location);break;case "PreviousButton":this.selectPrevious();this._updateUI();break;case "NextButton":this.selectNext(),
this._updateUI()}},_initPopupNavigationBar:function(){var a={};a.items=[{name:"CloseButton",type:"img",src:this.xIcon,srcAlt:this.xIcon,position:"left"},{name:"Title",type:"span",text:"",position:"center"},{name:"ToggleButton",type:"img",src:this.dArrowIcon,srcAlt:this.dArrowIcon,position:"right",toggleGroup:"toggle"},{name:"PreviousButton",type:"img",src:this.lArrowIcon,srcAlt:this.lArrowIcon,position:"right2",toggleGroup:"previous"},{name:"NextButton",type:"img",src:this.rArrowIcon,srcAlt:this.rArrowIcon,
position:"right1",toggleGroup:"next"}];this.popupNavigationBar=new z(a,t.create("div",{},m.body()));h.connect(this.popupNavigationBar,"onCreate",this,function(a){this._prevFeatureButton=a[3]._node;this._nextFeatureButton=a[4]._node});h.connect(this.popupNavigationBar,"onSelect",this,this._handleNavigationBar);h.connect(this.popupNavigationBar,"onUnSelect",this,this._handleNavigationBar);this.popupNavigationBar.startup();x.hide(this.popupNavigationBar.container)},_initPopupInfoView:function(){this.popupInfoView=
new w({items:[{name:"Navigator",type:"div",text:""},{name:"content",type:"div",text:""},{name:"attachment",type:"div",text:""}]},t.create("div",{},m.body()));n.add(this.popupInfoView.container,"esriMobilePopupInfoView");this.popupInfoView.enableTouchScroll();h.connect(this.popupInfoView,"onCreate",this,function(a){this._contentPane=a[1]._node;0<=this.selectedIndex&&this.setContent(this.features[this.selectedIndex].getContent())});h.connect(this.popupInfoView,"onSwipeLeft",this,function(){});h.connect(this.popupInfoView,
"onSwipeRight",this,function(){});this.popupInfoView.startup()},_updateUI:function(){var a="\x26nbsp;",c="\x26nbsp;",b=this.selectedIndex,d=this.features,l=this.deferreds,e=this._prevFeatureButton.parentNode,r=this._nextFeatureButton.parentNode,f=this._spinner,g=this._nls;d&&1<=d.length?(a=d[b].getTitle(),c=b+1+" of "+d.length,n.remove(this._arrowButton,"hidden"),0===b?(n.add(e,"hidden"),n.add(this._prev,"hidden")):(n.remove(e,"hidden"),n.remove(this._prev,"hidden")),b===d.length-1?(n.add(r,"hidden"),
n.add(this._next,"hidden")):(n.remove(r,"hidden"),n.remove(this._next,"hidden"))):(n.add(this._arrowButton,"hidden"),n.add(e,"hidden"),n.add(r,"hidden"),n.add(this._prev,"hidden"),n.add(this._next,"hidden"));this.setTitle(a,c);this.popupNavigationBar.getItems()[1]._node.innerHTML=c;l&&l.length?(n.remove(f,"hidden"),this.setTitle(g.NLS_searching+"...","\x26nbsp;")):(n.add(f,"hidden"),(!d||!d.length)&&this.setTitle("No Information","\x26nbsp;"))}})})},"esri/dijit/InfoView":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-geometry ../kernel ./_TouchBase".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t){return p(null,{declaredClass:"esri.dijit.InfoView",_items:[],_top:null,_sections:[],_isDecelerate:!1,constructor:function(a,c){var e;this.container=q.byId(c);this._touchBase=t(this.container,null);this._slideDiv=b.create("div",null,this.container,"first");this.events=[];this._items=a.items;a.sections&&(this._sections=a.sections);d.add(this.container,"esriMobileInfoView");if(0===this._sections.length)b.create("div",{},this._slideDiv);else for(e=0;e<this._sections.length;e++){var l=
b.create("div",{"class":"esriMobileInfoViewSection"},this._slideDiv);b.create("div",{innerHTML:this._sections[e].title},l)}for(e=0;e<this._items.length;e++){var n,l=0;this._items[e].section&&(l=this._items[e].section);switch(this._items[e].type){case "div":n=b.create("div",{"class":"esriMobileInfoViewItem",style:this._items[e].style},this._slideDiv.childNodes[l]),n=b.create("div",{innerHTML:this._items[e].text},n)}this._items[e].className&&d.add(n,this._items[e].className);n._index=e;n._item=this._items[e];
this._items[e]._node=n}this.startTouchY=0},startup:function(){this.onCreate(this._items);this._animateTo(0)},destroy:function(){k.forEach(this.events,h.disconnect);this._touchBase=null;f.query("img",this.container).forEach(function(a){a._index=null;a._item=null;b.destroy(a)});this._items=null;b.destroy(this._slideDiv);b.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},setPreventDefault:function(a){this._touchBase.setPreventDefault(a)},enableTouchScroll:function(){this._touchBase.setPreventDefault(!0);
this.events.push(h.connect(this._touchBase,"onTouchStart",this,this._onTouchStartHandler));this.events.push(h.connect(this._touchBase,"onTouchMove",this,this._onTouchMoveHandler));this.events.push(h.connect(this._touchBase,"onTouchEnd",this,this._onTouchEndHandler));this._slideDiv.style.webkitTransform="translate3d(0,"+this._top+"px, 0)"},disableTouchScroll:function(){h.disconnect(this.events.pop());h.disconnect(this.events.pop());h.disconnect(this.events.pop());this._touchBase.setPreventDefault(!1);
this._slideDiv.style.webkitTransform="translate3d(0, 0px, 0)"},animateTo:function(){this._slideDiv.style.WebkitTransitionDuration="0s";this._animateTo(0)},onSelect:function(a){},onUnSelect:function(a){},onCreate:function(a){},onClick:function(a){},onSwipeLeft:function(){},onSwipeRight:function(){},_onTouchStartHandler:function(a){this._slideDiv.style.WebkitTransitionDuration="0s";this._moveDirection=null;this._startTime=new Date;this.startTouchY=a.touches[0].clientY;this.contentStartOffsetY=this.contentOffsetY},
_onTouchMoveHandler:function(a){this._moveDirection||(Math.abs(a.curY)>Math.abs(a.curX)?this._moveDirection="vertical":this._moveDirection="horizontal");"horizontal"!==this._moveDirection&&"vertical"===this._moveDirection&&this._animateTo(a.touches[0].clientY-this.startTouchY+this.contentStartOffsetY)},_onTouchEndHandler:function(a){this._endTime=new Date;this._deltaMovement=a.curY;if("vertical"===this._moveDirection)this._shouldStartMomentum()?this._doMomentum():this._snapToBounds();else if("horizontal"===
this._moveDirection)if("left"===a.swipeDirection)this.onSwipeLeft();else if("right"===a.swipeDirection)this.onSwipeRight()},_shouldStartMomentum:function(){this._diff=this._endTime-this._startTime;this._velocity=this._deltaMovement/this._diff;return 0.2<Math.abs(this._velocity)&&200>this._diff?!0:!1},_pullToStop:function(a){80<Math.abs(a)&&(a=0<a?80:-contentBox.h+parentBox.h-10-80);console.log(a);this._slideDiv.style.webkitTransition="-webkit-transform 200ms cubic-bezier(0, 0, 1, 1)";var c=h.connect(this._slideDiv,
"webkitTransitionEnd",this,function(){0<a?this._animateTo(0):this._animateTo(-contentBox.h+parentBox.h-10);h.disconnect(c)});this._animateTo(a)},_doMomentum:function(){var a,c;a=r.getContentBox(this.container);var b=0>this._velocity?0.0010:-0.0010;c=-(this._velocity*this._velocity)/(2*b);var d=-this._velocity/b,b=3*0.6-0,e=1-b,n=0,f=0;if(a.h>this._slideDiv.scrollHeight)this.contentOffsetY=0,f=300;else if(0<this.contentOffsetY+c){a=0;for(c=Math.floor(d/20);a<c;a++)if(n=(e*20*a^3)+(b*20*a^2)+0*20*a+
0,n=0>this._velocity?-n:n,0<this.contentOffsetY+n){f=20*a;break}0===f&&(f=300);this.contentOffsetY=0}else if(Math.abs(this.contentOffsetY+c)+a.h>this._slideDiv.scrollHeight){this.contentOffsetY=a.h-this._slideDiv.scrollHeight;a=0;for(c=Math.floor(d/20);a<c;a++)if(n=(e*20*a^3)+(b*20*a^2)+0*20*a+0,n=0>this._velocity?-n:n,Math.abs(this.contentOffsetY+n)>this._slideDiv.scrollHeight){f=20*a;break}}else f=d,this.contentOffsetY+=c;this._slideDiv.style.webkitTransition="-webkit-transform "+f+"ms cubic-bezier(0, 0.3, 0.6, 1)";
this._animateTo(this.contentOffsetY)},_snapToBounds:function(){var a=r.getContentBox(this.container);a.h>this._slideDiv.scrollHeight?this.contentOffsetY=0:0<this.contentOffsetY?this.contentOffsetY=0:Math.abs(this.contentOffsetY)+a.h>this._slideDiv.scrollHeight&&(this.contentOffsetY=a.h-this._slideDiv.scrollHeight);this._slideDiv.style.WebkitTransitionDuration="0.5s";this._animateTo(this.contentOffsetY)},_animateTo:function(a){this.contentOffsetY=a;this._slideDiv.style.webkitTransform="translate3d(0, "+
a+"px, 0)"},_stopMomentum:function(){if(this._isDecelerating()){var a=document.defaultView.getComputedStyle(this._slideDiv,null),a=new WebKitCSSMatrix(a.webkitTransform);this._slideDiv.style.webkitTransition="";this.animateTo(a.m42)}},_isDecelerating:function(){return this.isDecelerate?!0:!1},_toggleNode:function(a,c){"ON"===c.toggleState?(c.toggleState="OFF",c.src&&(a.src=c.src.toString()),this.onUnSelect(c)):(c.toggleState="ON",c.srcAlt&&(a.src=c.srcAlt),this.onSelect(c))}})})},"esri/dijit/_TouchBase":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/dom dojo/has ../kernel".split(" "),
function(p,g,k,h,f,m){return p(null,{declaredClass:"esri.dijit._TouchBase",_preventDefault:!0,_swipeThreshold:20,constructor:function(e,f){this.domNode=h.byId(e);this.events=[k.connect(this.domNode,"touchstart",this,this._touchStartHandler),k.connect(this.domNode,"touchmove",this,this._touchMoveHandler),k.connect(this.domNode,"touchend",this,this._touchEndHandler),k.connect(this.domNode,"onclick",this,this._clickHandler)]},setPreventDefault:function(e){this._preventDefault=e},disableOnClick:function(){k.disconnect(this.events.pop())},
_clickHandler:function(e){if(this._moved)e.preventDefault();else this.onclick(e)},_touchStartHandler:function(e){this._moved=!1;this.client_x=e.targetTouches[0].clientX;this.client_y=e.targetTouches[0].clientY;this.down_x=e.targetTouches[0].pageX;this.down_y=e.targetTouches[0].pageY;e.downX=this.down_x;e.downY=this.down_y;this.onTouchStart(e)},_touchMoveHandler:function(e){this._preventDefault&&e.preventDefault();this._moved=!0;this.up_x=e.targetTouches[0].pageX;this.cur_x=e.targetTouches[0].pageX-
this.down_x;this.cur_y=e.targetTouches[0].pageY-this.down_y;e.curX=this.cur_x;e.curY=this.cur_y;this.onTouchMove(e)},_touchEndHandler:function(e){this._moved?(e.curX=this.cur_x,e.curY=this.cur_y,this.down_x-this.up_x>this._swipeThreshold?e.swipeDirection="left":this.up_x-this.down_x>this._swipeThreshold&&(e.swipeDirection="right")):(e.clientX=this.client_x,e.clientY=this.client_y);this.onTouchEnd(e)},onTouchStart:function(e){},onTouchMove:function(e){},onTouchEnd:function(e){},onclick:function(e){}})})},
"esri/dijit/NavigationBar":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/dom dojo/dom-class dojo/dom-construct ./_TouchBase ../kernel".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n){return p(null,{declaredClass:"esri.dijit.NavigationBar",_items:[],constructor:function(e,a){var c;this.container=q.byId(a);this._touchBase=r(this.container,null);this._slideDiv=b.create("div",{},this.container,"first");this.events=[k.connect(this._touchBase,
"onclick",this,this._onClickHandler)];this._items=e.items;d.add(this.container,"esriMobileNavigationBar");var n=b.create("div",{},this._slideDiv);for(c=0;c<this._items.length;c++){var l,f;switch(this._items[c].type){case "img":f=b.create("div",{"class":"esriMobileNavigationItem"},n);l=b.create("img",{src:this._items[c].src.toString(),style:{width:"100%",height:"100%"}},f);break;case "span":f=b.create("div",{"class":"esriMobileNavigationItem"},n);l=b.create("span",{innerHTML:this._items[c].text},f);
break;case "div":f=b.create("div",{"class":"esriMobileNavigationInfoPanel"},n),l=b.create("div",{innerHTML:this._items[c].text},f)}d.add(f,this._items[c].position);this._items[c].className&&d.add(l,this._items[c].className);l._index=c;l._item=this._items[c];this._items[c]._node=l}},startup:function(){this.onCreate(this._items)},destroy:function(){h.forEach(this.events,k.disconnect);this._touchBase=null;f.query("img",this.container).forEach(function(d){d._index=null;d._item=null;b.destroy(d)});this._items=
null;b.destroy(this._slideDiv);b.destroy(this.container);this.container=this._slideDiv=null},getItems:function(){return this._items},select:function(b){this._markSelected(b._node,b)},onSelect:function(b){},onUnSelect:function(b){},onCreate:function(b){},_onClickHandler:function(b){if("img"===b.target.tagName.toLowerCase()){var a=b.target,c=a._item;f.query("img",this.container).forEach(function(b){b!==a&&b._item.toggleGroup===c.toggleGroup&&this._markUnSelected(b,b._item)},this);this._toggleNode(a,
c)}},_toggleNode:function(b,a){"ON"===a.toggleState?(a.toggleState="OFF",a.src&&(b.src=a.src.toString()),this.onUnSelect(a)):(a.toggleState="ON",a.srcAlt&&(b.src=a.srcAlt),this.onSelect(a))},_markSelected:function(b,a){a.toggleState="ON";a.srcAlt&&(b.src=a.srcAlt);this.onSelect(a)},_markUnSelected:function(b,a){"ON"===a.toggleState&&(a.toggleState="OFF",a.src&&(b.src=a.src.toString()),this.onUnSelect(a))}})})},"jimu/dijit/LoadingShelter":function(){define(["dojo/_base/declare","dijit/_WidgetBase",
"dijit/_TemplatedMixin","dojo/text!./templates/LoadingShelter.html","dojo/_base/html"],function(p,g,k,h,f){return p([g,k],{"class":"jimu-loading-shelter",templateString:h,loadingText:null,hidden:!1,postMixInProperties:function(){this.nls=window.jimuNls.loadingShelter},postCreate:function(){this.inherited(arguments);this.hidden&&f.setStyle(this.domNode,"display","none");f.setStyle(this.domNode,{width:"100%",height:"100%"});this.loadingImg.src=require.toUrl("jimu")+"/images/loading.gif";"string"===
typeof this.loadingText&&(this.textNode.innerHTML=this.loadingText)},show:function(g){this.domNode&&this.hidden&&("string"===typeof g&&(this.textNode.innerHTML=g),f.setStyle(this.domNode,"display","block"),this.hidden=!1)},hide:function(){this.domNode&&!this.hidden&&(f.setStyle(this.domNode,"display","none"),this.hidden=!0)}})})},"jimu/PreloadWidgetIcon":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/dom-construct dojo/dom-style dojo/dom-geometry dijit/_WidgetBase ./utils".split(" "),
function(p,g,k,h,f,m,e,q,d){return p(q,{"class":"jimu-preload-widget-icon",postCreate:function(){this.inherited(arguments);this.iconNode=k.create("img",{src:this.widgetConfig.icon},this.domNode);k.setAttr(this.domNode,"title",this.widgetConfig.label);this.own(h(this.domNode,"click",g.hitch(this,function(){this.onClick()})));this.state="closed"},startup:function(){this.inherited(arguments)},onClick:function(){"closed"===this.state?this.switchToOpen():this.switchToClose()},moveTo:function(b){var e=
{left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"},e=g.mixin(e,d.getPositionStyle(b));delete e.width;delete e.height;k.setStyle(this.domNode,e);"opened"===this.state&&this.panel&&k.setStyle(this.panel.domNode,this.getIconPanelPosition())},destroy:function(){this.panel&&this.panelManager.destroyPanel(this.panel);this.inherited(arguments)},switchToOpen:function(){this.state="opened";k.addClass(this.domNode,"jimu-state-selected");this.widgetConfig.panel.widgetIcon=this.domNode;
this.widgetConfig.panel.position=this.getIconPanelPosition();this.panelManager.showPanel(this.widgetConfig).then(g.hitch(this,function(b){this.panel=b;this.own(h(b,"close",g.hitch(this,function(){this.switchToClose()})))}))},switchToClose:function(){this.state="closed";k.removeClass(this.domNode,"jimu-state-selected");this.panelManager.closePanel(this.panel)},getIconPanelPosition:function(){var b={},d,e;d="map"===this.widgetConfig.panel.positionRelativeTo?jimuConfig.mapId:jimuConfig.layoutId;e=k.getMarginBox(this.domNode);
b.width=this.widgetConfig.panel.position.width?this.widgetConfig.panel.position.width:400;b.height=this.widgetConfig.panel.position.height?this.widgetConfig.panel.position.height:400;d=k.getContentBox(d);var f,a;b.top=e.t+e.h+2;b.top+b.height>d.h&&(f=e.t,a=d.h-e.t-e.h,a=Math.max(f,a),a===f&&(b.top=e.t-b.height-2));b.left=e.l;b.left+b.width>d.w&&(b.left="",b.right=0);return b}})})},"jimu/WidgetPlaceholder":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/dom-construct dojo/dom-style dojo/dom-geometry dijit/_WidgetBase ./utils".split(" "),
function(p,g,k,h,f,m,e,q,d){return p(q,{"class":"jimu-widget-placeholder",postCreate:function(){this.inherited(arguments);this.indexNode=k.create("div",{"class":"inner",innerHTML:this.index},this.domNode);k.setAttr(this.domNode,"title",window.jimuNls.widgetPlaceholderTooltip)},moveTo:function(b){var e={left:"auto",right:"auto",bottom:"auto",top:"auto",width:"auto",height:"auto"},e=g.mixin(e,d.getPositionStyle(b));delete e.width;delete e.height;k.setStyle(this.domNode,e)},setIndex:function(b){this.index=
b;this.indexNode.innerHTML=b}})})},"jimu/BaseWidget":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(p,g,k,h,f,m){return p([f,m],{listenWidgetNames:[],listenWidgetIds:[],type:"widget",id:void 0,label:void 0,icon:void 0,uri:void 0,position:{},config:void 0,openAtStart:!1,map:null,appConfig:null,folderUrl:null,state:"closed",windowState:"normal",started:!1,name:"",baseClass:null,templateString:"\x3cdiv\x3e\x3c/div\x3e",
constructor:function(){this.listenWidgetClassNames=[];this.listenWidgetIds=[];this.own(h.subscribe("publishData",g.hitch(this,this._onReceiveData)));this.own(h.subscribe("dataFetched",g.hitch(this,this._onReceiveData)));this.own(h.subscribe("noData",g.hitch(this,this._onNoData)))},onOpen:function(){},onClose:function(){},onNormalize:function(){},onMinimize:function(){},onMaximize:function(){},onSignIn:function(e){},onSignOut:function(){},onPositionChange:function(e){this.position=e},setMap:function(e){this.map=
e},setState:function(e){this.state=e},setWindowState:function(e){this.windowState=e},resize:function(){},onConfigChanged:function(e){},onAppConfigChanged:function(e,f,d){},onAction:function(e,f){},publishData:function(e,f){"undefined"===typeof f&&(f=!0);h.publish("publishData",this.name,this.id,e,f)},fetchData:function(e){e?h.publish("fetcheData",e):0!==this.listenWidgetIds.length?k.forEach(this.listenWidgetIds,function(e){h.publish("fetcheData",e)},this):h.publish("fetcheData")},_onReceiveData:function(e,
f,d){if(!(e===this.name||f===this.id)&&!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(f)))this.onReceiveData(e,f,d)},onReceiveData:function(e,f,d){},_onNoData:function(e,f){if(!(0!==this.listenWidgetIds.length&&0>this.listenWidgetIds.indexOf(f)))this.onNoData(e,f)},onNoData:function(e,f){}})})},"jimu/BaseWidgetFrame":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dijit/_WidgetBase"],function(p,g,k,h){return p([h],{widget:null,baseClass:"jimu-widget-frame jimu-container",
postCreate:function(){this.inherited(arguments);this.containerNode||(this.containerNode=this.domNode);this.widget&&this.setWidget(this.widget)},startup:function(){this.inherited(arguments);this.widget&&this.widget.startup()},resize:function(){this.widget&&g.isFunction(this.widget.resize)&&this.widget.resize()},setLoading:function(f){this.loading=f;this.loading.placeAt(this.containerNode)},getWidget:function(){return this.widget},setWidget:function(f){this.widget=f;this.loading&&this.loading.destroy();
k.place(f.domNode,this.containerNode);this.resize()},destroy:function(){if(this.widget&&this.widget.domNode)try{this.widget.destroy()}catch(f){console.error("destroy widget error. widget: ["+this.widget.uri+"], "+f.stack)}this.loading&&this.loading.domNode&&this.loading.destroy()}})})},"jimu/BaseWidgetPanel":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dijit/_WidgetBase dijit/_Container ./dijit/LoadingIndicator ./BaseWidgetFrame".split(" "),function(p,g,k,
h,f,m,e,q){return p([f,m],{baseClass:"jimu-widget-panel jimu-container",started:!1,state:"closed",windowState:"normal",defaultState:"normal",type:"panel",constructor:function(){},postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);this.loadAllWidgetsInOrder();this.started=!0},loadAllWidgetsInOrder:function(){var d=this.getAllWidgetConfigs(),d=Array.isArray(this.config.widgets)?this.config.widgets:[this.config];k.forEach(d,function(b){var d,n;n=new e;d=this.createFrame(b);
this.addChild(d);d.setLoading(n);this.widgetManager.loadWidget(b).then(g.hitch(this,function(b){d.setWidget(b);b.startup()}))},this)},getAllWidgetConfigs:function(){var d=[];return d=Array.isArray(this.config.widgets)?this.config.widgets:[this.config]},getWidgetById:function(d){for(var b=this.getChildren(),e=0;e<b.length;e++)if(b[e].getWidget()&&b[e].getWidget().id===d)return b[e].getWidget()},createFrame:function(d){return new q},setState:function(d){this.state=d},setWindowState:function(d){this.windowState=
d},resize:function(){this.getChildren().forEach(function(d){d.resize()})},onOpen:function(){k.forEach(this.getChildren(),function(d){d.getWidget()&&this.widgetManager.openWidget(d.getWidget())},this)},onClose:function(){k.forEach(this.getChildren(),function(d){d.getWidget()&&this.widgetManager.closeWidget(d.getWidget())},this)},onMaximize:function(){k.forEach(this.getChildren(),function(d){d.getWidget()&&this.widgetManager.maximizeWidget(d.getWidget())},this)},onMinimize:function(){k.forEach(this.getChildren(),
function(d){d.getWidget()&&this.widgetManager.minimizeWidget(d.getWidget())},this)},onNormalize:function(){k.forEach(this.getChildren(),function(d){d.getWidget()&&this.widgetManager.normalizeWidget(d.getWidget())},this)},updateConfig:function(d){this._updateConfig(d)},reloadWidget:function(d){this.isWidgetInPanel(d)&&(this._updateConfig(d),this.getChildren().forEach(function(b){b.getWidget()&&b.getWidget().id===d.id&&(b.getWidget().destroy(),b.setLoading(new e),this.widgetManager.loadWidget(d).then(g.hitch(this,
function(d){b.setWidget(d);d.startup();"closed"===this.state&&this.widgetManager.closeWidget(d)})))},this))},isWidgetInPanel:function(d){return k.some(this.getAllWidgetConfigs(),function(b){if(d.id===b.id)return!0})?!0:!1},_updateConfig:function(d){if(Array.isArray(this.config.widgets)){for(var b=-1,e=0;e<this.config.widgets.length;e++)this.config.widgets[e].id===d.id&&(b=e);0<b&&(this.config.widgets[b]=d)}else this.config=d},destroy:function(){this.getChildren().forEach(function(d){try{d.domNode&&
d.destroy()}catch(b){console.error("destroy widget frame error."+b.stack)}});this.inherited(arguments)}})})},"jimu/dijit/LoadingIndicator":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/dom-style","dojo/dom-construct"],function(p,g,k,h){return p(g,{"class":"jimu-loading-indicator",hidden:!1,postCreate:function(){this.inherited(arguments);(this.hidden=!0===this.hidden)&&k.set(this.domNode,{display:"none"});k.set(this.domNode,{width:"100%",height:"100%"});var f='\x3cimg class\x3d"jimu-loading" src\x3d"'+
require.toUrl("jimu")+'/images/loading.gif"\x3e';h.place(f,this.domNode)},show:function(){this.domNode&&k.set(this.domNode,"display","block")},hide:function(){this.domNode&&k.set(this.domNode,"display","none")}})})},"jimu/BaseWidgetSetting":function(){define("dojo/_base/declare dojo/_base/lang dojo/topic dojo/on dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(p,g,k,h,f,m){return p([f,m],{templateString:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.own(h(window,"resize",g.hitch(this,
this._onWindowResize)))},getConfig:function(){},setConfig:function(e){},resize:function(){},_onWindowResize:function(){this.resize()}})})},"jimu/symbolUtils":function(){define(["dojo/_base/lang","dojo/_base/html","dojox/gfx","esri/symbols/jsonUtils"],function(p,g,k,h){return{cloneSymbol:function(f){if(!f)return null;var g=null;try{var e=f.toJson(),g=h.fromJson(e)}catch(q){console.error(q)}return g},getDefaultMarkerSymbol:function(){return h.fromJson({style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",
outline:{color:[0,0,128,255],width:1},type:"esriSMS",size:18})},getDefaultLineSymbol:function(){return h.fromJson({tags:["solid"],title:"Blue Thin",style:"esriSLSSolid",color:[79,129,189,255],width:3,name:"Blue 1",type:"esriSLS"})},getDefaultFillSymbol:function(){return h.fromJson({tags:["opaque"],title:"Blue",style:"esriSFSSolid",color:[79,129,189,255],name:"Blue 6",type:"esriSFS",outline:{style:"esriSLSSolid",color:[54,93,141,255],width:1.5,type:"esriSLS"}})},getHightlightMarkerSymbol:function(){return h.fromJson({color:[255,
255,255,128],size:18,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"}})},getHightlightLineSymbol:function(){return h.fromJson({color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"})},getHightlightFillSymbol:function(){return h.fromJson({color:[255,255,255,128],outline:{color:[0,255,255,255],width:1.5,type:"esriSLS",style:"esriSLSSolid"},type:"esriSFS",style:"esriSFSSolid"})},createSymbolNode:function(f,
m){var e=32,q=32,d=g.create("div");g.setStyle(d,"display","inline-block");if(m)e=m.width,q=m.height;else if(e=80,q=30,this.isSimpleMarkerSymbol(f))q=e=Math.min(f.size+12,125);else if(this.isPictureMarkerSymbol(f)){if(!f.url||"http://"===f.url||-1===f.url.indexOf("http://")&&-1===f.url.indexOf("https://")&&-1===f.url.indexOf("data:"))return;q=e=Math.min(Math.max(f.width,f.height),125)}else if(this.isSimpleLineSymbol(f)||this.isCartographicLineSymbol(f))e=190,q=20;var b=k.createSurface(d,e,q);if("vml"===
k.renderer){var r=b.getEventSource();g.setStyle(r,"position","relative");g.setStyle(r.parentNode,"position","relative")}var r=null,r=m?h.getShapeDescriptors(f):this.isSimpleLineSymbol(f)||this.isCartographicLineSymbol(f)?this._getLineShapeDesc(f):h.getShapeDescriptors(f),n;try{n=b.createShape(r.defaultShape),r.fill&&n.setFill(r.fill),r.stroke&&n.setStroke(r.stroke)}catch(t){b.clear();b.destroy();return}var b=b.getDimensions(),b={dx:b.width/2,dy:b.height/2},a=n.getBoundingBox(),r=a.width,a=a.height;
if(r>e||a>q)e=((e<q?e:q)-5)/(r>a?r:a),p.mixin(b,{xx:e,yy:e});n.applyTransform(b);return d},_getLineShapeDesc:function(f){var g=null;if(this.isSimpleLineSymbol(f)||this.isCartographicLineSymbol(f))g={defaultShape:{type:"path",path:"M -90,0 L 90,0 E"},fill:null,stroke:f.getStroke()};return g},isSimpleMarkerSymbol:function(f){return f&&"esri.symbol.SimpleMarkerSymbol"===f.declaredClass},isPictureMarkerSymbol:function(f){return f&&"esri.symbol.PictureMarkerSymbol"===f.declaredClass},isSimpleLineSymbol:function(f){return f&&
"esri.symbol.SimpleLineSymbol"===f.declaredClass},isCartographicLineSymbol:function(f){return f&&"esri.symbol.CartographicLineSymbol"===f.declaredClass},isSimpleFillSymbol:function(f){return f&&"esri.symbol.SimpleFillSymbol"===f.declaredClass},isPictureFillSymbol:function(f){return f&&"esri.symbol.PictureFillSymbol"===f.declaredClass},isTextSymbol:function(f){return f&&"esri.symbol.TextSymbol"===f.declaredClass}}})},"jimu/filterUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/date/locale esri/lang dojo/data/ItemFileWriteStore".split(" "),
function(p,g,k,h,f,m){return p([],{_stringFieldType:"esriFieldTypeString",_dateFieldType:"esriFieldTypeDate",_numberFieldTypes:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],_supportFieldTypes:[],dayInMS:86399E3,fieldsStore:null,isHosted:!1,constructor:function(){String.prototype.startsWith=function(e){return 0===this.indexOf(e)};String.prototype.endsWith=function(e){return this.substring(this.length-e.length)===e};String.prototype.count=function(e){return this.split(e).length-
1};String.prototype.trim||(String.prototype.trim=g.trim);this._supportFieldTypes=[];this._supportFieldTypes.push(this._stringFieldType);this._supportFieldTypes.push(this._dateFieldType);this._supportFieldTypes=this._supportFieldTypes.concat(this._numberFieldTypes)},OPERATORS:{stringOperatorIs:"stringOperatorIs",stringOperatorIsNot:"stringOperatorIsNot",stringOperatorStartsWith:"stringOperatorStartsWith",stringOperatorEndsWith:"stringOperatorEndsWith",stringOperatorContains:"stringOperatorContains",
stringOperatorDoesNotContain:"stringOperatorDoesNotContain",stringOperatorIsBlank:"stringOperatorIsBlank",stringOperatorIsNotBlank:"stringOperatorIsNotBlank",numberOperatorIs:"numberOperatorIs",numberOperatorIsNot:"numberOperatorIsNot",numberOperatorIsAtLeast:"numberOperatorIsAtLeast",numberOperatorIsLessThan:"numberOperatorIsLessThan",numberOperatorIsAtMost:"numberOperatorIsAtMost",numberOperatorIsGreaterThan:"numberOperatorIsGreaterThan",numberOperatorIsBetween:"numberOperatorIsBetween",numberOperatorIsNotBetween:"numberOperatorIsNotBetween",
numberOperatorIsBlank:"numberOperatorIsBlank",numberOperatorIsNotBlank:"numberOperatorIsNotBlank",dateOperatorIsOn:"dateOperatorIsOn",dateOperatorIsNotOn:"dateOperatorIsNotOn",dateOperatorIsBefore:"dateOperatorIsBefore",dateOperatorIsAfter:"dateOperatorIsAfter",dateOperatorIsBetween:"dateOperatorIsBetween",dateOperatorIsNotBetween:"dateOperatorIsNotBetween",dateOperatorIsBlank:"dateOperatorIsBlank",dateOperatorIsNotBlank:"dateOperatorIsNotBlank",dateOperatorDays:"dateOperatorDays",dateOperatorWeeks:"dateOperatorWeeks",
dateOperatorMonths:"dateOperatorMonths",dateOperatorInTheLast:"dateOperatorInTheLast",dateOperatorNotInTheLast:"dateOperatorNotInTheLast"},setFieldsStoreByFieldInfos:function(e){e=k.filter(e,g.hitch(this,function(e){return 0<=this._supportFieldTypes.indexOf(e.type)}));e=k.map(e,function(e,d){var b;switch(e.type){case "esriFieldTypeString":b="string";break;case "esriFieldTypeDate":b="date";break;default:b="number"}return{id:d,label:e.name,shortType:b,alias:e.alias,editable:e.editable,name:e.name,nullable:e.nullable,
type:e.type}},this);this.fieldsStore=new m({data:{identifier:"id",label:"label",items:e}});return e.length},_validatePartsObj:function(e){return e&&"object"===typeof e},_isObject:function(e){return e&&"object"===typeof e},_isString:function(e){return e&&"string"===typeof e},getExprByFilterObj:function(e){var g="";if(1===e.parts.length)g=this.builtFilterString(e.parts[0]);else for(var d="",b=0;b<e.parts.length;b++){var r=this.builtFilterString(e.parts[b]);if(!f.isDefined(r))return null;g+=d+"("+r+
")";d=d||" "+e.logicalOperator+" "}return e.expr=g},builtFilterString:function(e){var g="";if(e.parts)for(var d="",b=0;b<e.parts.length;b++){var r=e.parts[b],n=this.builtSingleFilterString(r);r.expr=n.whereClause;if(!f.isDefined(n.whereClause))return null;g+=d+n.whereClause;d=" "+e.logicalOperator+" "}else g=this.builtSingleFilterString(e).whereClause;return e.expr=g},builtSingleFilterString:function(e,g){if(f.isDefined(e.valueObj.isValid)&&!e.valueObj.isValid)return{whereClause:null};var d=e.valueObj.value,
b=e.valueObj.value1,r=e.valueObj.value2,n=!1;if(e.interactiveObj){if(!e.interactiveObj.prompt||!e.interactiveObj.hint)return{whereClause:null};f.isDefined(g)&&(n=!0,f.isDefined(e.valueObj.value)&&(d="{"+g+"}"),f.isDefined(e.valueObj.value1)&&(b="{"+g+"}"),f.isDefined(e.valueObj.value2)&&(r="{"+(g+1)+"}"))}var h="";if("string"===e.fieldObj.shortType)switch(e.operator){case this.OPERATORS.stringOperatorIs:h="field"===e.valueObj.type?e.fieldObj.name+" \x3d "+d:e.fieldObj.name+" \x3d '"+d.replace(/\'/g,
"''")+"'";break;case this.OPERATORS.stringOperatorIsNot:h="field"===e.valueObj.type?e.fieldObj.name+" \x3c\x3e "+d:e.fieldObj.name+" \x3c\x3e '"+d.replace(/\'/g,"''")+"'";break;case this.OPERATORS.stringOperatorStartsWith:h=e.fieldObj.name+" LIKE '"+d.replace(/\'/g,"''")+"%'";break;case this.OPERATORS.stringOperatorEndsWith:h=e.fieldObj.name+" LIKE '%"+d.replace(/\'/g,"''")+"'";break;case this.OPERATORS.stringOperatorContains:h=e.fieldObj.name+" LIKE '%"+d.replace(/\'/g,"''")+"%'";break;case this.OPERATORS.stringOperatorDoesNotContain:h=
e.fieldObj.name+" NOT LIKE '%"+d.replace(/\'/g,"''")+"%'";break;case this.OPERATORS.stringOperatorIsBlank:h=e.fieldObj.name+" IS NULL";break;case this.OPERATORS.stringOperatorIsNotBlank:h=e.fieldObj.name+" IS NOT NULL"}else if("number"===e.fieldObj.shortType)switch(e.operator){case this.OPERATORS.numberOperatorIs:h=e.fieldObj.name+" \x3d "+d;break;case this.OPERATORS.numberOperatorIsNot:h=e.fieldObj.name+" \x3c\x3e "+d;break;case this.OPERATORS.numberOperatorIsAtLeast:h=e.fieldObj.name+" \x3e\x3d "+
d;break;case this.OPERATORS.numberOperatorIsLessThan:h=e.fieldObj.name+" \x3c "+d;break;case this.OPERATORS.numberOperatorIsAtMost:h=e.fieldObj.name+" \x3c\x3d "+d;break;case this.OPERATORS.numberOperatorIsGreaterThan:h=e.fieldObj.name+" \x3e "+d;break;case this.OPERATORS.numberOperatorIsBetween:h=e.fieldObj.name+" BETWEEN "+b+" AND "+r;break;case this.OPERATORS.numberOperatorIsNotBetween:h=e.fieldObj.name+" NOT BETWEEN "+b+" AND "+r;break;case this.OPERATORS.numberOperatorIsBlank:h=e.fieldObj.name+
" IS NULL";break;case this.OPERATORS.numberOperatorIsNotBlank:h=e.fieldObj.name+" IS NOT NULL"}else switch(f.isDefined(d)&&("field"!==e.valueObj.type&&"string"===typeof d)&&(d=new Date(d)),"field"!==e.valueObj.type&&(d&&(d=new Date(d)),b&&(b=new Date(b)),r&&(r=new Date(r))),e.operator){case this.OPERATORS.dateOperatorIsOn:h="field"===e.valueObj.type?e.fieldObj.name+" \x3d "+d:n?e.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+g+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(g+1)+
"}'":e.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(d)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(d))+"'";break;case this.OPERATORS.dateOperatorIsNotOn:h="field"===e.valueObj.type?e.fieldObj.name+" \x3c\x3e "+d:n?e.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'{"+g+"}' AND "+(this.isHosted?"":"timestamp ")+"'{"+(g+1)+"}'":e.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(d)+"' AND "+
(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(d))+"'";break;case this.OPERATORS.dateOperatorIsBefore:h="field"===e.valueObj.type?e.fieldObj.name+" \x3c "+d:e.fieldObj.name+" \x3c "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(d)+"'";break;case this.OPERATORS.dateOperatorIsAfter:h="field"===e.valueObj.type?e.fieldObj.name+" \x3e "+d:e.fieldObj.name+" \x3e "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(d))+"'";break;case this.OPERATORS.dateOperatorIsBetween:h=
n?e.fieldObj.name+" BETWEEN '"+b+"' AND '"+r+"'":e.fieldObj.name+" BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(b)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(r))+"'";break;case this.OPERATORS.dateOperatorIsNotBetween:h=n?e.fieldObj.name+" NOT BETWEEN '"+b+"' AND '"+r+"'":e.fieldObj.name+" NOT BETWEEN "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(b)+"' AND "+(this.isHosted?"":"timestamp ")+"'"+this.formatDate(this.addDay(r))+"'";break;case this.OPERATORS.dateOperatorIsBlank:h=
e.fieldObj.name+" IS NULL";break;case this.OPERATORS.dateOperatorIsNotBlank:h=e.fieldObj.name+" IS NOT NULL"}return{whereClause:h}},formatDate:function(e){var f=h.format(e,{datePattern:"yyyy-MM-dd",selector:"date"});e=h.format(e,{selector:"time",timePattern:"HH:mm:ss"});return f+" "+e},addDay:function(e){return new Date(e.getTime()+this.dayInMS)},getFilterObjByExpr:function(e){if(e&&this.fieldsStore){var f=this.replaceStrings(e);e=f.defExpr;var d=this.findParts(e,"AND");1===d.parts.length&&(d=this.findParts(e,
"OR"),1===d.parts.length&&(d.logicalOperator="AND"));k.forEach(d.parts,function(b){b.expr=b.expr.trim();if(b.expr.startsWith("(")&&-1<b.expr.search(/\)$/)){var d=b.expr.substring(1,b.expr.length-1),e=d.indexOf("("),f=d.indexOf(")");if(-1===e&&-1===f||e<f)b.expr=d}d=this.findParts(b.expr,"AND");1===d.parts.length&&(d=this.findParts(b.expr,"OR"));1<d.parts.length&&(b.parts=d.parts,b.logicalOperator=d.logicalOperator)},this);this.parseExpr(d);this.reReplaceStrings(f,d);return d}},replaceStrings:function(e){for(var f=
e,d=function(a,b,e){var n=-1,n=a.indexOf("'",e+1);return n===e+1?(n=a.indexOf("'",n+1),d(a,b,n)):e},b=[],r=e.indexOf("'");-1<r;){var n=r,r=e.indexOf("'",r+1),g=0,r=d(e,n,r);"%"===e[n+1]&&n++;"%"===e[r-1]&&(r-=1,g++);var a=e.substring(n+1,r);"N"===e[n-1]&&(e=e.substring(0,n-1)+e.substring(n),n-=1,r-=1);!this.isDateString(a)&&-1===a.indexOf("{")?(b.push(a),e=e.substring(0,n+1)+"#"+(b.length-1)+"#"+e.substring(r),r=e.indexOf("'",e.lastIndexOf("#")+2+g)):r=e.indexOf("'",r+1+g)}return{origDefExpr:f,defExpr:e,
savedStrings:b}},reReplaceStrings:function(e,h){var d=e.savedStrings;if(d.length&&d.length){var b=function(b,d){if("string"!==b.fieldObj.shortType)return!1;var a=b.valueObj.value.indexOf("#"),c=b.valueObj.value.lastIndexOf("#");return f.isDefined(b.valueObj.value)&&-1<a?(b.valueObj.value=d[parseInt(b.valueObj.value.substring(a+1,c),10)].replace(/\'\'/g,"'"),this.builtSingleFilterString(b),!0):!1},b=g.hitch(this,b),r=!1;k.forEach(h.parts,function(e){if(e.parts){var f=!1;k.forEach(e.parts,function(a){f=
b(a,d)||f});f&&(r=f,e.expr=this.builtFilterString(e))}else(r=b(e,d)||r)&&this.builtFilterString(e)},this);r&&(h.expr=null,this.getExprByFilterObj(h))}},isDateString:function(e){return 19===e.length&&"-"===e.charAt(4)&&"-"===e.charAt(7)&&" "===e.charAt(10)&&":"===e.charAt(13)&&":"===e.charAt(16)?!0:!1},findParts:function(e,f){for(var d=e.toLowerCase(),b=" "+f.toLowerCase()+" ",r=[],n=0,g=d.indexOf(b);0<g;){var a=e.substring(n,g),c=a.toLowerCase(),s=a.count("("),l=a.count(")"),h=a.count("'");s!==l||
1===h%2?g=d.indexOf(b,g+1):-1<c.indexOf(" between ")&&-1===c.indexOf(" and ")?g=d.indexOf(b,g+1):(r.push({expr:a}),n=g+b.length,g=d.indexOf(b,n))}r.push({expr:e.substring(n)});for(d=r.length-1;0<=d;d--)!this.hasOperator(r[d].expr)&&0<d&&(r[d-1].expr+=" "+f+" "+r[d].expr,r.splice(d,1));return{expr:e,parts:r,logicalOperator:f}},hasOperator:function(e){e=e.toLowerCase();return-1<e.indexOf("{")&&-1<e.indexOf("}")||-1<e.indexOf(" \x3d ")||-1<e.indexOf(" \x3c ")||-1<e.indexOf(" \x3e ")||-1<e.indexOf(" \x3c\x3e ")||
-1<e.indexOf(" \x3c\x3d ")||-1<e.indexOf(" \x3e\x3d ")||-1<e.indexOf(" like ")||-1<e.indexOf(" between ")||-1<e.indexOf(" date")||-1<e.indexOf(" is null")||-1<e.indexOf(" is not null")?!0:!1},parseExpr:function(e){k.forEach(e.parts,function(e){e.parts?this.parseExpr(e):this.parseSingleExpr(e)},this)},_preParseSingleExpr:function(e){var f=g.clone(e);f.expr=f.expr.trim();e=f.expr;if(/^UPPER(.*)(\s+)LIKE(\s+)UPPER((.*))$/i.test(e)){var d=e.indexOf("("),b=e.indexOf(")"),r=e.substring(d+1,b),d=e.lastIndexOf("("),
b=e.lastIndexOf(")");e=e.substring(d+2,b+1);f.fieldObj={name:r};f.valueObj={};this.getFieldItemByName({name:r},g.hitch(this,function(b){f.fieldObj.shortType=b.shortType[0];f.fieldObj.label=b.label[0]}),g.hitch(this,function(){f.error={msg:"unknown field name ("+r+")",code:1}}));this.storeValue(e,f);f.operator="stringOperatorContainsCaseInSensitive";return f}return null},parseSingleExpr:function(e){var g=e.expr.trim(),d=g.indexOf(" "),b=g.substring(0,d);e.fieldObj={name:b};e.valueObj={};this.getFieldItemByName({name:b},
function(b){e.fieldObj.shortType=b.shortType[0];e.fieldObj.label=b.label[0]},function(){e.error={msg:"unknown field name ("+b+")",code:1}});g=g.substring(d+1).trim();d=g.toLowerCase();d.startsWith("\x3d ")?(g="date"===e.fieldObj.shortType&&!this.isHosted?g.substring(12).trim():g.substring(2).trim(),this.storeValue(g,e),e.operator="date"===e.fieldObj.shortType?this.OPERATORS.dateOperatorIsOn:"string"===e.fieldObj.shortType?this.OPERATORS.stringOperatorIs:this.OPERATORS.numberOperatorIs):d.startsWith("\x3c ")?
(g="date"===e.fieldObj.shortType&&!this.isHosted?g.substring(12).trim():g.substring(2).trim(),this.storeValue(g,e),"date"===e.fieldObj.shortType?e.operator=this.OPERATORS.dateOperatorIsBefore:"number"===e.fieldObj.shortType?e.operator=this.OPERATORS.numberOperatorIsLessThan:e.error={msg:"operator ("+d+") not supported for string",code:3}):d.startsWith("\x3e ")?(g="date"===e.fieldObj.shortType&&!this.isHosted?g.substring(12).trim():g.substring(2).trim(),this.storeValue(g,e),"date"===e.fieldObj.shortType?
e.operator=this.OPERATORS.dateOperatorIsAfter:"number"===e.fieldObj.shortType?e.operator=this.OPERATORS.numberOperatorIsGreaterThan:e.error={msg:"operator ("+d+") not supported for string",code:3}):d.startsWith("\x3c\x3e ")?(g="date"===e.fieldObj.shortType&&!this.isHosted?g.substring(13).trim():g.substring(3).trim(),this.storeValue(g,e),e.operator="date"===e.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotOn:"string"===e.fieldObj.shortType?this.OPERATORS.stringOperatorIsNot:this.OPERATORS.numberOperatorIsNot):
d.startsWith("\x3c\x3d ")?(this.storeValue(g.substring(3).trim(),e),e.operator=this.OPERATORS.numberOperatorIsAtMost):d.startsWith("\x3e\x3d ")?(this.storeValue(g.substring(3).trim(),e),e.operator=this.OPERATORS.numberOperatorIsAtLeast):d.startsWith("like ")?(g=g.substring(5).trim(),g.startsWith("N'")&&(g=g.substring(1,g.length)),g.startsWith("'%")&&g.endsWith("%'")?(this.storeValue(g.substring(2,g.length-2),e),e.operator=this.OPERATORS.stringOperatorContains):g.startsWith("'%")&&g.endsWith("'")?
(this.storeValue(g.substring(2,g.length-1),e),e.operator=this.OPERATORS.stringOperatorEndsWith):g.startsWith("'")&&g.endsWith("%'")?(this.storeValue(g.substring(1,g.length-2),e),e.operator=this.OPERATORS.stringOperatorStartsWith):e.error={msg:"value ("+d+") not supported for LIKE",code:3}):d.startsWith("not like ")?(g=g.substring(9).trim(),g.startsWith("N'")&&(g=g.substring(1,g.length)),g.startsWith("'%")&&g.endsWith("%'")?(this.storeValue(g.substring(2,g.length-2),e),e.operator=this.OPERATORS.stringOperatorDoesNotContain):
e.error={msg:"value ("+d+") not supported for NOT LIKE",code:3}):d.startsWith("between ")?(g="date"===e.fieldObj.shortType&&!this.isHosted?g.substring(18).trim():g.substring(8).trim(),d=g.toLowerCase().indexOf(" and "),-1<d?(this.storeValue1(g.substring(0,d).trim(),e),"date"===e.fieldObj.shortType&&!this.isHosted?this.storeValue2(g.substring(d+15).trim(),e):this.storeValue2(g.substring(d+5).trim(),e)):e.error={msg:"missing AND operator for BETWEEN",code:3},"date"===e.fieldObj.shortType?"string"===
typeof e.valueObj.value1?e.operator=this.OPERATORS.dateOperatorIsBetween:1E3>Math.abs(this.subtractDay(e.valueObj.value2).getTime()-e.valueObj.value1.getTime())?(e.valueObj.value=e.valueObj.value1,delete e.valueObj.value1,delete e.valueObj.value2,e.operator=this.OPERATORS.dateOperatorIsOn):e.operator=this.OPERATORS.dateOperatorIsBetween:"number"===e.fieldObj.shortType||"oid"===e.fieldObj.shortType?e.operator=this.OPERATORS.numberOperatorIsBetween:e.error={msg:"string field not supported for BETWEEN",
code:3}):d.startsWith("not between ")?(g="date"===e.fieldObj.shortType&&!this.isHosted?g.substring(22).trim():g.substring(12).trim(),d=g.toLowerCase().indexOf(" and "),-1<d?(this.storeValue1(g.substring(0,d).trim(),e),"date"===e.fieldObj.shortType&&!this.isHosted?this.storeValue2(g.substring(d+15).trim(),e):this.storeValue2(g.substring(d+5).trim(),e)):e.error={msg:"missing AND operator for NOT BETWEEN",code:3},"date"===e.fieldObj.shortType?"string"===typeof e.valueObj.value1?e.operator=this.OPERATORS.dateOperatorIsNotBetween:
1E3>Math.abs(this.subtractDay(e.valueObj.value2).getTime()-e.valueObj.value1.getTime())?(e.valueObj.value=e.valueObj.value1,delete e.valueObj.value1,delete e.valueObj.value2,e.operator=this.OPERATORS.dateOperatorIsNotOn):e.operator=this.OPERATORS.dateOperatorIsNotBetween:"number"===e.fieldObj.shortType||"oid"===e.fieldObj.shortType?e.operator=this.OPERATORS.numberOperatorIsNotBetween:e.error={msg:"string field not supported for NOT BETWEEN",code:3}):"is null"===d?(e.valueObj.value=null,e.operator=
"date"===e.fieldObj.shortType?this.OPERATORS.dateOperatorIsBlank:"string"===e.fieldObj.shortType?this.OPERATORS.stringOperatorIsBlank:this.OPERATORS.numberOperatorIsBlank):"is not null"===d?(e.valueObj.value=null,e.operator="date"===e.fieldObj.shortType?this.OPERATORS.dateOperatorIsNotBlank:"string"===e.fieldObj.shortType?this.OPERATORS.stringOperatorIsNotBlank:this.OPERATORS.numberOperatorIsNotBlank):e.error={msg:"unknown operator ("+d+")",code:2};if(f.isDefined(e.valueObj.value)&&"string"===typeof e.valueObj.value&&
e.valueObj.value.startsWith("{")&&e.valueObj.value.endsWith("}")||f.isDefined(e.valueObj.value1)&&"string"===typeof e.valueObj.value1&&e.valueObj.value1.startsWith("{")&&e.valueObj.value1.endsWith("}"))e.isInteractive=!0},getFieldItemByName:function(e,f,d){this.fieldsStore.fetch({query:e,onComplete:g.hitch(this,function(b){b&&b.length?f(b[0]):d()})})},subtractDay:function(e){return new Date(e.getTime()-this.dayInMS)},storeValue:function(e,f){if(e.startsWith("{")&&e.endsWith("}"))f.valueObj.value=
e;else if(e.startsWith("'{")&&e.endsWith("}'"))f.valueObj.value=e.substring(1,e.length-1);else if("date"===f.fieldObj.shortType)if(e.startsWith("'")&&e.endsWith("'")){var d=e.substring(1,e.length-1);f.valueObj.value=this.parseDate(d)}else f.valueObj.value=e,f.valueObj.type="field";else"string"===f.fieldObj.shortType?(e.startsWith("#")||e.startsWith("%#"))&&(e.endsWith("#")||e.endsWith("#%"))?f.valueObj.value=e:e.startsWith("'")&&e.endsWith("'")?f.valueObj.value=e.substring(1,e.length-1).replace(/\'\'/g,
"'"):(f.valueObj.value=e,f.valueObj.type="field",this.getFieldItemByName({name:e},function(b){f.valueObj.label=b.label[0]},function(){f.error={msg:"unknown field name ("+e+")",code:1}})):(f.valueObj.value=e,isNaN(e)&&(f.valueObj.type="field",this.getFieldItemByName({name:e},function(b){f.valueObj.label=b.label[0]},function(){f.error={msg:"unknown field name ("+e+")",code:1}})))},storeValue1:function(e,f){if(e.startsWith("{")&&e.endsWith("}"))f.valueObj.value1=e;else if(e.startsWith("'{")&&e.endsWith("}'"))f.valueObj.value1=
e.substring(1,e.length-1);else if("date"===f.fieldObj.shortType)if(e.startsWith("'")&&e.endsWith("'")){var d=e.substring(1,e.length-1);f.valueObj.value1=this.parseDate(d)}else f.valueObj.value1=e,f.valueObj.type="field";else f.valueObj.value1=e,isNaN(e)&&(f.valueObj.type="field")},storeValue2:function(e,f){if(e.startsWith("{")&&e.endsWith("}"))f.valueObj.value2=e;else if(e.startsWith("'{")&&e.endsWith("}'"))f.valueObj.value2=e.substring(1,e.length-1);else if("date"===f.fieldObj.shortType)if(e.startsWith("'")&&
e.endsWith("'")){var d=e.substring(1,e.length-1);f.valueObj.value2=this.parseDate(d)}else f.valueObj.value2=e,f.valueObj.type="field";else f.valueObj.value2=e,isNaN(e)&&(f.valueObj.type="field")},parseDate:function(e){var f=h.parse(e,{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"});f||(f=h.parse(e.replace(" ",", "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}))||(f=h.parse(e.replace(" "," - "),{datePattern:"yyyy-MM-dd",timePattern:"HH:mm:ss"}));return f}})})},"dojo/data/ItemFileWriteStore":function(){define("../_base/lang ../_base/declare ../_base/array ../_base/json ../_base/kernel ./ItemFileReadStore ../date/stamp".split(" "),
function(p,g,k,h,f,m,e){return g("dojo.data.ItemFileWriteStore",m,{constructor:function(f){this._features["dojo.data.api.Write"]=!0;this._features["dojo.data.api.Notification"]=!0;this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};this._datatypeMap.Date.serialize||(this._datatypeMap.Date.serialize=function(d){return e.toISOString(d,{zulu:!0})});f&&!1===f.referenceIntegrity&&(this.referenceIntegrity=!1);this._saveInProgress=!1},referenceIntegrity:!0,_assert:function(e){if(!e)throw Error("assertion failed in ItemFileWriteStore");
},_getIdentifierAttribute:function(){return this.getFeatures()["dojo.data.api.Identity"]},newItem:function(e,d){this._assert(!this._saveInProgress);this._loadFinished||this._forceLoad();if("object"!=typeof e&&"undefined"!=typeof e)throw Error("newItem() was passed something other than an object");var b=null,f=this._getIdentifierAttribute();if(f===Number)b=this._arrayOfAllItems.length;else{b=e[f];if("undefined"===typeof b)throw Error("newItem() was not passed an identity for the new item");if(p.isArray(b))throw Error("newItem() was not passed an single-valued identity");
}this._itemsByIdentity&&this._assert("undefined"===typeof this._itemsByIdentity[b]);this._assert("undefined"===typeof this._pending._newItems[b]);this._assert("undefined"===typeof this._pending._deletedItems[b]);var n={};n[this._storeRefPropName]=this;n[this._itemNumPropName]=this._arrayOfAllItems.length;this._itemsByIdentity&&(this._itemsByIdentity[b]=n,n[f]=[b]);this._arrayOfAllItems.push(n);f=null;if(d&&d.parent&&d.attribute){var f={item:d.parent,attribute:d.attribute,oldValue:void 0},g=this.getValues(d.parent,
d.attribute);if(g&&0<g.length){var a=g.slice(0,g.length);f.oldValue=1===g.length?g[0]:g.slice(0,g.length);a.push(n);this._setValueOrValues(d.parent,d.attribute,a,!1);f.newValue=this.getValues(d.parent,d.attribute)}else this._setValueOrValues(d.parent,d.attribute,n,!1),f.newValue=n}else n[this._rootItemPropName]=!0,this._arrayOfTopLevelItems.push(n);this._pending._newItems[b]=n;for(var c in e){if(c===this._storeRefPropName||c===this._itemNumPropName)throw Error("encountered bug in ItemFileWriteStore.newItem");
b=e[c];p.isArray(b)||(b=[b]);n[c]=b;if(this.referenceIntegrity)for(g=0;g<b.length;g++)a=b[g],this.isItem(a)&&this._addReferenceToMap(a,n,c)}this.onNew(n,f);return n},_removeArrayElement:function(e,d){var b=k.indexOf(e,d);return-1!=b?(e.splice(b,1),!0):!1},deleteItem:function(e){this._assert(!this._saveInProgress);this._assertIsItem(e);var d=e[this._itemNumPropName],b=this.getIdentity(e);if(this.referenceIntegrity){var f=this.getAttributes(e);e[this._reverseRefMap]&&(e["backup_"+this._reverseRefMap]=
p.clone(e[this._reverseRefMap]));k.forEach(f,function(a){k.forEach(this.getValues(e,a),function(c){this.isItem(c)&&(e["backupRefs_"+this._reverseRefMap]||(e["backupRefs_"+this._reverseRefMap]=[]),e["backupRefs_"+this._reverseRefMap].push({id:this.getIdentity(c),attr:a}),this._removeReferenceFromMap(c,e,a))},this)},this);if(f=e[this._reverseRefMap])for(var n in f){var g=null;if(g=this._itemsByIdentity?this._itemsByIdentity[n]:this._arrayOfAllItems[n])for(var a in f[n]){var c=this.getValues(g,a)||[],
s=k.filter(c,function(a){return!(this.isItem(a)&&this.getIdentity(a)==b)},this);this._removeReferenceFromMap(e,g,a);s.length<c.length&&this._setValueOrValues(g,a,s,!0)}}}this._arrayOfAllItems[d]=null;e[this._storeRefPropName]=null;this._itemsByIdentity&&delete this._itemsByIdentity[b];this._pending._deletedItems[b]=e;e[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,e);this.onDelete(e);return!0},setValue:function(e,d,b){return this._setValueOrValues(e,d,b,!0)},setValues:function(e,
d,b){return this._setValueOrValues(e,d,b,!0)},unsetAttribute:function(e,d){return this._setValueOrValues(e,d,[],!0)},_setValueOrValues:function(e,d,b,f){this._assert(!this._saveInProgress);this._assertIsItem(e);this._assert(p.isString(d));this._assert("undefined"!==typeof b);var n=this._getIdentifierAttribute();if(d==n)throw Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");var n=this._getValueOrValues(e,d),g=this.getIdentity(e);if(!this._pending._modifiedItems[g]){var a=
{},c;for(c in e)a[c]=c===this._storeRefPropName||c===this._itemNumPropName||c===this._rootItemPropName?e[c]:c===this._reverseRefMap?p.clone(e[c]):e[c].slice(0,e[c].length);this._pending._modifiedItems[g]=a}g=!1;if(p.isArray(b)&&0===b.length){if(g=delete e[d],b=void 0,this.referenceIntegrity&&n){c=n;p.isArray(c)||(c=[c]);for(var s=0;s<c.length;s++)a=c[s],this.isItem(a)&&this._removeReferenceFromMap(a,e,d)}}else{g=p.isArray(b)?b.slice(0,b.length):[b];if(this.referenceIntegrity)if(n){c=n;p.isArray(c)||
(c=[c]);var l={};k.forEach(c,function(a){this.isItem(a)&&(a=this.getIdentity(a),l[a.toString()]=!0)},this);k.forEach(g,function(a){if(this.isItem(a)){var c=this.getIdentity(a);l[c.toString()]?delete l[c.toString()]:this._addReferenceToMap(a,e,d)}},this);for(s in l)this._removeReferenceFromMap(this._itemsByIdentity?this._itemsByIdentity[s]:this._arrayOfAllItems[s],e,d)}else for(s=0;s<g.length;s++)a=g[s],this.isItem(a)&&this._addReferenceToMap(a,e,d);e[d]=g;g=!0}if(f)this.onSet(e,d,n,b);return g},_addReferenceToMap:function(e,
d,b){d=this.getIdentity(d);var f=e[this._reverseRefMap];f||(f=e[this._reverseRefMap]={});(e=f[d])||(e=f[d]={});e[b]=!0},_removeReferenceFromMap:function(e,d,b){d=this.getIdentity(d);var f=e[this._reverseRefMap],n;if(f){for(n in f)n==d&&(delete f[n][b],this._isEmpty(f[n])&&delete f[n]);this._isEmpty(f)&&delete e[this._reverseRefMap]}},_dumpReferenceMap:function(){var e;for(e=0;e<this._arrayOfAllItems.length;e++){var d=this._arrayOfAllItems[e];d&&d[this._reverseRefMap]&&console.log("Item: ["+this.getIdentity(d)+
"] is referenced by: "+h.toJson(d[this._reverseRefMap]))}},_getValueOrValues:function(e,d){var b=void 0;this.hasAttribute(e,d)&&(b=this.getValues(e,d),b=1==b.length?b[0]:b);return b},_flatten:function(e){if(this.isItem(e))return{_reference:this.getIdentity(e)};if("object"===typeof e)for(var d in this._datatypeMap){var b=this._datatypeMap[d];if(p.isObject(b)&&!p.isFunction(b)){if(e instanceof b.type){if(!b.serialize)throw Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+d+"]");
return{_type:d,_value:b.serialize(e)}}}else if(e instanceof b)return{_type:d,_value:e.toString()}}return e},_getNewFileContentString:function(){var e={},d=this._getIdentifierAttribute();d!==Number&&(e.identifier=d);this._labelAttr&&(e.label=this._labelAttr);e.items=[];for(d=0;d<this._arrayOfAllItems.length;++d){var b=this._arrayOfAllItems[d];if(null!==b){var f={},n;for(n in b)if(n!==this._storeRefPropName&&n!==this._itemNumPropName&&n!==this._reverseRefMap&&n!==this._rootItemPropName){var g=this.getValues(b,
n);if(1==g.length)f[n]=this._flatten(g[0]);else for(var a=[],c=0;c<g.length;++c)a.push(this._flatten(g[c])),f[n]=a}e.items.push(f)}}return h.toJson(e,!0)},_isEmpty:function(e){var d=!0;if(p.isObject(e))for(var b in e){d=!1;break}else p.isArray(e)&&0<e.length&&(d=!1);return d},save:function(e){this._assert(!this._saveInProgress);this._saveInProgress=!0;var d=this,b=function(){d._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};d._saveInProgress=!1;e&&e.onComplete&&e.onComplete.call(e.scope||
f.global)},g=function(b){d._saveInProgress=!1;e&&e.onError&&e.onError.call(e.scope||f.global,b)};if(this._saveEverything){var n=this._getNewFileContentString();this._saveEverything(b,g,n)}this._saveCustom&&this._saveCustom(b,g);!this._saveEverything&&!this._saveCustom&&b()},revert:function(){this._assert(!this._saveInProgress);for(var e in this._pending._modifiedItems){var d=this._pending._modifiedItems[e],b=null,b=this._itemsByIdentity?this._itemsByIdentity[e]:this._arrayOfAllItems[e];d[this._storeRefPropName]=
this;for(var f in b)delete b[f];p.mixin(b,d)}var n;for(e in this._pending._deletedItems)n=this._pending._deletedItems[e],n[this._storeRefPropName]=this,d=n[this._itemNumPropName],n["backup_"+this._reverseRefMap]&&(n[this._reverseRefMap]=n["backup_"+this._reverseRefMap],delete n["backup_"+this._reverseRefMap]),this._arrayOfAllItems[d]=n,this._itemsByIdentity&&(this._itemsByIdentity[e]=n),n[this._rootItemPropName]&&this._arrayOfTopLevelItems.push(n);for(e in this._pending._deletedItems)n=this._pending._deletedItems[e],
n["backupRefs_"+this._reverseRefMap]&&(k.forEach(n["backupRefs_"+this._reverseRefMap],function(b){this._addReferenceToMap(this._itemsByIdentity?this._itemsByIdentity[b.id]:this._arrayOfAllItems[b.id],n,b.attr)},this),delete n["backupRefs_"+this._reverseRefMap]);for(e in this._pending._newItems)d=this._pending._newItems[e],d[this._storeRefPropName]=null,this._arrayOfAllItems[d[this._itemNumPropName]]=null,d[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,d),this._itemsByIdentity&&
delete this._itemsByIdentity[e];this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}};return!0},isDirty:function(e){return e?(e=this.getIdentity(e),(new Boolean(this._pending._newItems[e]||this._pending._modifiedItems[e]||this._pending._deletedItems[e])).valueOf()):!this._isEmpty(this._pending._newItems)||!this._isEmpty(this._pending._modifiedItems)||!this._isEmpty(this._pending._deletedItems)},onSet:function(e,d,b,f){},onNew:function(e,d){},onDelete:function(e){},close:function(e){if(this.clearOnClose){if(this.isDirty())throw Error("dojo.data.ItemFileWriteStore: There are unsaved changes present in the store.  Please save or revert the changes before invoking close.");
this.inherited(arguments)}}})})},"dojo/data/ItemFileReadStore":function(){define("../_base/kernel ../_base/lang ../_base/declare ../_base/array ../_base/xhr ../Evented ./util/filter ./util/simpleFetch ../date/stamp".split(" "),function(p,g,k,h,f,m,e,q,d){k=k("dojo.data.ItemFileReadStore",[m],{constructor:function(b){this._arrayOfAllItems=[];this._arrayOfTopLevelItems=[];this._loadFinished=!1;this.url=this._ccUrl=this._jsonFileUrl=b.url;this._jsonData=b.data;this.data=null;this._datatypeMap=b.typeMap||
{};this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(b){return d.fromISOString(b)}});this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._itemsByIdentity=null;this._storeRefPropName="_S";this._itemNumPropName="_0";this._rootItemPropName="_RI";this._reverseRefMap="_RRM";this._loadInProgress=!1;this._queuedFetches=[];void 0!==b.urlPreventCache&&(this.urlPreventCache=b.urlPreventCache?!0:!1);void 0!==b.hierarchical&&(this.hierarchical=b.hierarchical?
!0:!1);b.clearOnClose&&(this.clearOnClose=!0);"failOk"in b&&(this.failOk=b.failOk?!0:!1)},url:"",_ccUrl:"",data:null,typeMap:null,clearOnClose:!1,urlPreventCache:!1,failOk:!1,hierarchical:!0,_assertIsItem:function(b){if(!this.isItem(b))throw Error(this.declaredClass+": Invalid item argument.");},_assertIsAttribute:function(b){if("string"!==typeof b)throw Error(this.declaredClass+": Invalid attribute argument.");},getValue:function(b,d,e){b=this.getValues(b,d);return 0<b.length?b[0]:e},getValues:function(b,
d){this._assertIsItem(b);this._assertIsAttribute(d);return(b[d]||[]).slice(0)},getAttributes:function(b){this._assertIsItem(b);var d=[],e;for(e in b)e!==this._storeRefPropName&&(e!==this._itemNumPropName&&e!==this._rootItemPropName&&e!==this._reverseRefMap)&&d.push(e);return d},hasAttribute:function(b,d){this._assertIsItem(b);this._assertIsAttribute(d);return d in b},containsValue:function(b,d,f){var g=void 0;"string"===typeof f&&(g=e.patternToRegExp(f,!1));return this._containsValue(b,d,f,g)},_containsValue:function(b,
d,e,f){return h.some(this.getValues(b,d),function(a){if(null!==a&&!g.isObject(a)&&f){if(a.toString().match(f))return!0}else if(e===a)return!0})},isItem:function(b){return b&&b[this._storeRefPropName]===this&&this._arrayOfAllItems[b[this._itemNumPropName]]===b?!0:!1},isItemLoaded:function(b){return this.isItem(b)},loadItem:function(b){this._assertIsItem(b.item)},getFeatures:function(){return this._features},getLabel:function(b){if(this._labelAttr&&this.isItem(b))return this.getValue(b,this._labelAttr)},
getLabelAttributes:function(b){return this._labelAttr?[this._labelAttr]:null},filter:function(b,d,f){var g=[],a,c;if(b.query){var s;a=b.queryOptions?b.queryOptions.ignoreCase:!1;var l={};for(c in b.query)s=b.query[c],"string"===typeof s?l[c]=e.patternToRegExp(s,a):s instanceof RegExp&&(l[c]=s);for(a=0;a<d.length;++a){var h=!0,k=d[a];if(null===k)h=!1;else for(c in b.query)s=b.query[c],this._containsValue(k,c,s,l[c])||(h=!1);h&&g.push(k)}}else for(a=0;a<d.length;++a)c=d[a],null!==c&&g.push(c);f(g,b)},
_fetchItems:function(b,d,e){var h=this;if(this._loadFinished)this.filter(b,this._getItemsArray(b.queryOptions),d);else if(this._jsonFileUrl!==this._ccUrl?(p.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url),null!=this.data&&(this._jsonData=this.data,this.data=null),this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:b,
filter:g.hitch(h,"filter"),findCallback:g.hitch(h,d)});else{this._loadInProgress=!0;var a=f.get({url:h._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk});a.addCallback(function(a){try{h._getItemsFromLoadedData(a),h._loadFinished=!0,h._loadInProgress=!1,h.filter(b,h._getItemsArray(b.queryOptions),d),h._handleQueuedFetches()}catch(c){h._loadFinished=!0,h._loadInProgress=!1,e(c,b)}});a.addErrback(function(a){h._loadInProgress=!1;e(a,b)});var c=null;b.abort&&
(c=b.abort);b.abort=function(){a&&-1===a.fired&&a.cancel();c&&c.call(b)}}else if(this._jsonData)try{this._loadFinished=!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,h.filter(b,this._getItemsArray(b.queryOptions),d)}catch(s){e(s,b)}else e(Error(this.declaredClass+": No JSON source data was provided as either URL or a nested Javascript object."),b)},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var b=0;b<this._queuedFetches.length;b++){var d=this._queuedFetches[b],
e=d.args,f=d.filter,d=d.findCallback;f?f(e,this._getItemsArray(e.queryOptions),d):this.fetchItemByIdentity(e)}this._queuedFetches=[]}},_getItemsArray:function(b){return b&&b.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(b){this.clearOnClose&&(this._loadFinished&&!this._loadInProgress)&&((""==this._jsonFileUrl||null==this._jsonFileUrl)&&(""==this.url||null==this.url)&&null==this.data&&console.debug(this.declaredClass+": WARNING!  Data reload  information has not been provided.  Please set 'url' or 'data' to the appropriate value before the next fetch"),
this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._itemsByIdentity=null,this._loadInProgress=!1,this._queuedFetches=[])},_getItemsFromLoadedData:function(b){function d(c){return null!==c&&"object"===typeof c&&(!g.isArray(c)||f)&&!g.isFunction(c)&&(c.constructor==Object||g.isArray(c))&&"undefined"===typeof c._reference&&"undefined"===typeof c._type&&"undefined"===typeof c._value&&a.hierarchical}function e(c){a._arrayOfAllItems.push(c);for(var b in c){var l=c[b];if(l)if(g.isArray(l))for(var f=
0;f<l.length;++f){var h=l[f];d(h)&&e(h)}else d(l)&&e(l)}}var f=!1,a=this;this._labelAttr=b.label;var c,h;this._arrayOfAllItems=[];this._arrayOfTopLevelItems=b.items;for(c=0;c<this._arrayOfTopLevelItems.length;++c)h=this._arrayOfTopLevelItems[c],g.isArray(h)&&(f=!0),e(h),h[this._rootItemPropName]=!0;var l={},k;for(c=0;c<this._arrayOfAllItems.length;++c)for(k in h=this._arrayOfAllItems[c],h){if(k!==this._rootItemPropName){var m=h[k];null!==m?g.isArray(m)||(h[k]=[m]):h[k]=[null]}l[k]=k}for(;l[this._storeRefPropName];)this._storeRefPropName+=
"_";for(;l[this._itemNumPropName];)this._itemNumPropName+="_";for(;l[this._reverseRefMap];)this._reverseRefMap+="_";if(l=b.identifier){this._itemsByIdentity={};this._features["dojo.data.api.Identity"]=l;for(c=0;c<this._arrayOfAllItems.length;++c)if(h=this._arrayOfAllItems[c],b=h[l],b=b[0],Object.hasOwnProperty.call(this._itemsByIdentity,b)){if(this._jsonFileUrl)throw Error(this.declaredClass+":  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+
l+"].  Value collided: ["+b+"]");if(this._jsonData)throw Error(this.declaredClass+":  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+l+"].  Value collided: ["+b+"]");}else this._itemsByIdentity[b]=h}else this._features["dojo.data.api.Identity"]=Number;for(c=0;c<this._arrayOfAllItems.length;++c)h=this._arrayOfAllItems[c],h[this._storeRefPropName]=this,h[this._itemNumPropName]=c;for(c=0;c<this._arrayOfAllItems.length;++c)for(k in h=this._arrayOfAllItems[c],
h){b=h[k];for(l=0;l<b.length;++l)if(m=b[l],null!==m&&"object"==typeof m){if("_type"in m&&"_value"in m){var q=m._type,p=this._datatypeMap[q];if(p)if(g.isFunction(p))b[l]=new p(m._value);else if(g.isFunction(p.deserialize))b[l]=p.deserialize(m._value);else throw Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");else throw Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+
q+"'");}if(m._reference){m=m._reference;if(g.isObject(m))for(q=0;q<this._arrayOfAllItems.length;++q){var p=this._arrayOfAllItems[q],u=!0,C;for(C in m)p[C]!=m[C]&&(u=!1);u&&(b[l]=p)}else b[l]=this._getItemByIdentity(m);this.referenceIntegrity&&(m=b[l],this.isItem(m)&&this._addReferenceToMap(m,h,k))}else this.isItem(m)&&this.referenceIntegrity&&this._addReferenceToMap(m,h,k)}}},_addReferenceToMap:function(b,d,e){},getIdentity:function(b){var d=this._features["dojo.data.api.Identity"];return d===Number?
b[this._itemNumPropName]:(b=b[d])?b[0]:null},fetchItemByIdentity:function(b){var d,e;if(this._loadFinished)d=this._getItemByIdentity(b.identity),b.onItem&&(e=b.scope?b.scope:p.global,b.onItem.call(e,d));else{var g=this;this._jsonFileUrl!==this._ccUrl?(p.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=
this.url);null!=this.data&&null==this._jsonData&&(this._jsonData=this.data,this.data=null);this._jsonFileUrl?this._loadInProgress?this._queuedFetches.push({args:b}):(this._loadInProgress=!0,e=f.get({url:g._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk}),e.addCallback(function(a){var c=b.scope?b.scope:p.global;try{g._getItemsFromLoadedData(a),g._loadFinished=!0,g._loadInProgress=!1,d=g._getItemByIdentity(b.identity),b.onItem&&b.onItem.call(c,d),g._handleQueuedFetches()}catch(e){g._loadInProgress=
!1,b.onError&&b.onError.call(c,e)}}),e.addErrback(function(a){g._loadInProgress=!1;b.onError&&b.onError.call(b.scope?b.scope:p.global,a)})):this._jsonData&&(g._getItemsFromLoadedData(g._jsonData),g._jsonData=null,g._loadFinished=!0,d=g._getItemByIdentity(b.identity),b.onItem&&(e=b.scope?b.scope:p.global,b.onItem.call(e,d)))}},_getItemByIdentity:function(b){var d=null;this._itemsByIdentity?Object.hasOwnProperty.call(this._itemsByIdentity,b)&&(d=this._itemsByIdentity[b]):Object.hasOwnProperty.call(this._arrayOfAllItems,
b)&&(d=this._arrayOfAllItems[b]);void 0===d&&(d=null);return d},getIdentityAttributes:function(b){b=this._features["dojo.data.api.Identity"];return b===Number?null:[b]},_forceLoad:function(){var b=this;this._jsonFileUrl!==this._ccUrl?(p.deprecated(this.declaredClass+": ","To change the url, set the url property of the store, not _jsonFileUrl.  _jsonFileUrl support will be removed in 2.0"),this.url=this._ccUrl=this._jsonFileUrl):this.url!==this._ccUrl&&(this._ccUrl=this._jsonFileUrl=this.url);null!=
this.data&&(this._jsonData=this.data,this.data=null);if(this._jsonFileUrl){var d=f.get({url:this._jsonFileUrl,handleAs:"json-comment-optional",preventCache:this.urlPreventCache,failOk:this.failOk,sync:!0});d.addCallback(function(d){try{if(!0!==b._loadInProgress&&!b._loadFinished)b._getItemsFromLoadedData(d),b._loadFinished=!0;else if(b._loadInProgress)throw Error(this.declaredClass+":  Unable to perform a synchronous load, an async load is in progress.");}catch(e){throw console.log(e),e;}});d.addErrback(function(b){throw b;
})}else this._jsonData&&(b._getItemsFromLoadedData(b._jsonData),b._jsonData=null,b._loadFinished=!0)}});g.extend(k,q);return k})},"dojo/data/util/filter":function(){define(["../../_base/lang"],function(p){var g={};p.setObject("dojo.data.util.filter",g);g.patternToRegExp=function(g,h){for(var f="^",m=null,e=0;e<g.length;e++)switch(m=g.charAt(e),m){case "\\":f+=m;e++;f+=g.charAt(e);break;case "*":f+=".*";break;case "?":f+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":f+=
"\\";default:f+=m}f+="$";return h?RegExp(f,"mi"):RegExp(f,"m")};return g})},"dojo/data/util/simpleFetch":function(){define(["../../_base/lang","../../_base/kernel","./sorter"],function(p,g,k){var h={};p.setObject("dojo.data.util.simpleFetch",h);h.errorHandler=function(f,h){h.onError&&h.onError.call(h.scope||g.global,f,h)};h.fetchHandler=function(f,h){var e=h.abort||null,q=!1,d=h.start?h.start:0,b=h.count&&Infinity!==h.count?d+h.count:f.length;h.abort=function(){q=!0;e&&e.call(h)};var r=h.scope||g.global;
h.store||(h.store=this);h.onBegin&&h.onBegin.call(r,f.length,h);h.sort&&f.sort(k.createSortFunction(h.sort,this));if(h.onItem)for(var n=d;n<f.length&&n<b;++n){var t=f[n];q||h.onItem.call(r,t,h)}h.onComplete&&!q&&(n=null,h.onItem||(n=f.slice(d,b)),h.onComplete.call(r,n,h))};h.fetch=function(f){f=f||{};f.store||(f.store=this);this._fetchItems(f,p.hitch(this,"fetchHandler"),p.hitch(this,"errorHandler"));return f};return h})},"dojo/data/util/sorter":function(){define(["../../_base/lang"],function(p){var g=
{};p.setObject("dojo.data.util.sorter",g);g.basicComparator=function(g,h){var f=-1;null===g&&(g=void 0);null===h&&(h=void 0);if(g==h)f=0;else if(g>h||null==g)f=1;return f};g.createSortFunction=function(k,h){function f(b,a,c,d){return function(e,f){var g=d.getValue(e,b),n=d.getValue(f,b);return a*c(g,n)}}for(var m=[],e,q=h.comparatorMap,d=g.basicComparator,b=0;b<k.length;b++){e=k[b];var r=e.attribute;if(r){e=e.descending?-1:1;var n=d;q&&("string"!==typeof r&&"toString"in r&&(r=r.toString()),n=q[r]||
d);m.push(f(r,e,n,h))}}return function(b,a){for(var c=0;c<m.length;){var d=m[c++](b,a);if(0!==d)return d}return 0}};return g})},"jimu/DataManager":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/topic","./WidgetManager"],function(p,g,k,h){var f=null,m;m=p(null,{constructor:function(){k.subscribe("publishData",g.hitch(this,this.onDataPublished));k.subscribe("fetcheData",g.hitch(this,this.onFetchData));k.subscribe("clearAllData",g.hitch(this,this.onClearAllData));k.subscribe("removeData",
g.hitch(this,this.onRemoveData));this.widgetManager=h.getInstance()},_dataStore:{},onDataPublished:function(e,f,d,b){"undefined"===typeof b&&(b=!0);g.isArray(d)||(d=[d]);this._dataStore[f]=this._dataStore[f]&&b||!this._dataStore[f]?d:this._dataStore[f].concat(d)},onFetchData:function(e){var f;if(e)(f=this.widgetManager.getWidgetById(e))?this._dataStore[e]?k.publish("dataFetched",f.name,e,this._dataStore[e]):k.publish("noData",f.name,e):k.publish("noData",void 0,e);else for(var d in this._dataStore)f=
this.widgetManager.getWidgetById(d),k.publish("dataFetched",f.name,d,this._dataStore[d])},onClearAllData:function(){this._dataStore={};k.publish("allDataCleared")},onRemoveData:function(e){delete this._dataStore[e];k.publish("dataRemoved",e)}});m.getInstance=function(){null===f&&(f=new m);return f};return m})},"jimu/PoolControllerMixin":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/topic dojo/aspect dojo/Deferred jimu/WidgetManager jimu/PanelManager".split(" "),
function(p,g,k,h,f,m,e,q,d){return p(null,{constructor:function(){this.widgetManager=q.getInstance();this.panelManager=d.getInstance()},postCreate:function(){this.controlledWidgets||(this.controlledWidgets="all");this.controlledGroups||(this.controlledGroups="all")},getOpenedIds:function(){},setOpenedIds:function(b){},getConfigById:function(b){for(var d=this.getAllConfigs(),e=0;e<d.length;e++)if(d[e].id===b)return d[e]},getAllConfigs:function(){var b=[],b=b.concat(this.getWidgetConfigs(),this.getGroupConfigs()),
b=k.filter(b,function(b){return b.visible});return b.sort(function(b,d){return b.index-d.index})},isControlled:function(b){return k.some(this.getAllConfigs(),function(d){return d.id===b})},widgetIsControlled:function(b){return k.some(this.getAllConfigs(),function(d){return d.id===b?!0:k.some(d.widgets,function(d){return d.id===b})})},getGroupConfigs:function(){var b=[];if(!this.appConfig.widgetPool)return b;this.appConfig.widgetPool.groups&&k.forEach(this.appConfig.widgetPool.groups,function(d){this.controlledGroups&&
(Array.isArray(this.controlledGroups)?-1<this.controlledGroups.indexOf(d.label)&&b.push(d):"all"===this.controlledGroups&&b.push(d))},this);return b},getWidgetConfigs:function(){var b=[];if(!this.appConfig.widgetPool)return b;this.appConfig.widgetPool.widgets&&k.forEach(this.appConfig.widgetPool.widgets,function(d){this.controlledWidgets&&(Array.isArray(this.controlledWidgets)?-1<this.controlledWidgets.indexOf(d.label)&&b.push(d):"all"===this.controlledWidgets&&b.push(d))},this);return b}})})},"jimu/SpatialReference/utils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all dojo/request ./unitUtils".split(" "),
function(p,g,k,h,f,m,e){var q=null,d=null,b=!1;p=p(null,function(){});var r=require.toUrl("jimu"),n=m(r+"/SpatialReference/wkidDetails.json",{handleAs:"json"}),t=m(r+"/SpatialReference/transform.json",{handleAs:"json"});p.loadResource=function(){var a=new h;if(q&&d)return a.resolve(),a;f([n,t]).then(function(c){q=c[0];d=c[1];b=!0;a.resolve()},function(c){console.error(c);b=!1;a.reject(c)});return a};p.getAllCSUnits=function(){if(b){var a=[];k.forEach(q.wkids,g.hitch(this,function(c){c=this.getCSUnit(c);
-1===k.indexOf(a,c)&&a.push(c)}));return a}};p.convertUnit=function(a,c,d){if(b)return e.convertUnit(a,c,d)};p.getUnitRate=function(a,c){if(b)return e.getUnitRate(a,c)};p.isProjectUnit=function(a){if(b)return e.isProjectUnit(a)};p.isGeographicUnit=function(a){if(b)return e.isGeographicUnit(a)};p.getGeographicUnits=function(){if(b)return e.getGeographicUnits()};p.getProjectUnits=function(){if(b)return e.getProjectUnits()};p.getCSUnit=function(a){if(b){a=this.getCSStr(a);var c=0,d=0,c=a.lastIndexOf("UNIT"),
d=a.indexOf(",",c);return a.slice(c+6,d-1)}};p.isSameSR=function(a,c){if(b){var d=this.indexOfWkid(a),e=this.indexOfWkid(c);return q.labels[d]===q.labels[e]}};p.isValidWkid=function(a){if(b)return-1<this.indexOfWkid(a)};p.getSRLabel=function(a){if(b&&this.isValidWkid(a))return a=this.indexOfWkid(a),q.labels[a]};p.indexOfWkid=function(a){if(b)return k.indexOf(q.wkids,a)};p.isValidTfWkid=function(a){if(b)return-1<this.indexOfTfWkid(a)};p.getTransformationLabel=function(a){if(b)return this.isValidTfWkid(a)?
(a=this.indexOfTfWkid(a),d.labels[a]):""};p.indexOfTfWkid=function(a){if(b)return k.indexOf(d.tfWkids,a)};p.isGeographicCS=function(a){if(b)return this.isValidWkid(a)?q.details[this.indexOfWkid(a)].startWith("GEOGCS"):!1};p.isProjectedCS=function(a){if(b)return this.isValidWkid(a)?q.details[this.indexOfWkid(a)].startWith("PROJCS"):!1};p.getGeoCSByProj=function(a){if(b&&this.isProjectedCS(a))return a=this.getSpheroidStr(a),a=k.indexOf(q.details,a),q.wkids[a]};p.getSpheroidStr=function(a){if(b){if(this.isGeographicCS(a))return q.details[this.indexOfWkid(a)];
if(this.isProjectedCS(a)){a=q.details[this.indexOfWkid(a)];var c=a.indexOf("GEOGCS"),d=a.indexOf("PROJECTION")-1;return a.slice(c,d)}return null}};p.getCSStr=function(a){if(b)return q.details[this.indexOfWkid(a)]};p.isSameSpheroid=function(a,c){if(b){var d=this.getSpheroidStr(a),e=this.getSpheroidStr(c);return d&&e&&d===e?!0:!1}};return p})},"jimu/SpatialReference/unitUtils":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array"],function(p,g,k){var h="INCHES FOOT FOOT_US YARDS MILES NAUTICAL_MILES MILLIMETERS CENTIMETERS METER KILOMETERS DECIMETERS LINK_CLARKE FOOT_GOLD_COAST FOOT_CLARKE CHAIN_SEARS_1992_TRUNCATED YARD_INDIAN CHAIN_BENOIT_1895_B YARD_SEARS CHAIN_SEARS FOOT_SEARS YARD_INDIAN_1937 50_KILOMETERS 150_KILOMETERS".split(" "),
f="DECIMAL_DEGREES DEGREE_MINUTE_SECONDS DEGREE GRAD MGRS USNG".split(" "),m={INCHES:0.0254,FOOT:0.3048,FOOT_US:0.3048006096012192,YARDS:0.9144,MILES:1609.344,NAUTICAL_MILES:1852,MILLIMETERS:0.0010,CENTIMETERS:0.01,METER:1,KILOMETERS:1E3,DECIMETERS:0.1,LINK_CLARKE:0.2011661949,FOOT_GOLD_COAST:0.3047997101815088,FOOT_CLARKE:0.304797265,CHAIN_SEARS_1922_TRUNCATED:20.116756,YARD_INDIAN:0.9143985307444408,CHAIN_BENOIT_1895_B:20.11678249437587,YARD_SEARS:0.9143984146160287,CHAIN_SEARS:20.11676512155263,
FOOT_SEARS:0.3047994715386762,YARD_INDIAN_1937:0.91439523,"50_KILOMETERS":5E4,"150_KILOMETERS":15E4,DEGREE:0.0174532925199433,DECIMAL_DEGREES:0.0174532925199433,MGRS:0.0174532925199433,USNG:0.0174532925199433,DEGREE_MINUTE_SECONDS:0.0174532925199433,GRAD:0.01570796326794897};p=p(null,function(){});p.convertUnit=function(e,f,d){return m[e.toUpperCase()]/m[f.toUpperCase()]*d};p.getUnitRate=function(e,f){return m[e.toUpperCase()]/m[f.toUpperCase()]};p.isProjectUnit=function(e){return-1<k.indexOf(h,e.toUpperCase())};
p.isGeographicUnit=function(e){return-1<k.indexOf(f,e.toUpperCase())};p.getGeographicUnits=function(){return f};p.getProjectUnits=function(){return h};return p})},"jimu/LayerInfos/LayerInfos":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/aspect dojo/Deferred dojo/on dojo/topic dojo/_base/unload dojo/Evented dojo/promise/all esri/layers/WMSLayer esri/layers/GeoRSSLayer esri/layers/KMLLayer esri/layers/FeatureLayer ./LayerInfoForCollection ./LayerInfoForMapService ./LayerInfoForKML ./LayerInfoForGeoRSS ./LayerInfoForDefault ./LayerInfoForWMS ./LayerInfoFactory".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z,A,x){var u=[],C=p([d],{operLayers:null,map:null,finalLayerInfos:null,basemapLayers:null,constructor:function(a,c,b){this.basemapLayers=a;this.operLayers=c;this.map=b;this.finalLayerInfos=[];this._initLayerInfos();this.update();this._bindEvents()},update:function(){this._extraSetLayerInfos();this._clearAddedFlag(this.layerInfos);this._initFinalLayerInfos(this.layerInfos);this._markFirstOrLastNode()},getLayerInfoArray:function(){return this.finalLayerInfos},
traversal:function(a){for(var c=this.getLayerInfoArray(),b=0;b<c.length;b++)if(c[b].traversal(a))return!0},moveUpLayer:function(a){var c=null,b;a=this._getTopLayerInfoIndexById(a);0<a&&(c=this.finalLayerInfos[a-1].obtainLayerIndexesInMap().length,this.finalLayerInfos[a].moveRightOfIndex(this.finalLayerInfos[a-1].obtainLayerIndexesInMap()[c-1].index),c=this.finalLayerInfos[a-1].id,b=this.finalLayerInfos[a],this.finalLayerInfos.splice(a,1),this.finalLayerInfos.splice(a-1,0,b),this._markFirstOrLastNode());
return c},moveDownLayer:function(a){var c=null,b=this._getTopLayerInfoIndexById(a);b<this.finalLayerInfos.length-1&&(this.finalLayerInfos[b].moveLeftOfIndex(this.finalLayerInfos[b+1].obtainLayerIndexesInMap()[0].index),c=this.finalLayerInfos[b+1].id,a=this.finalLayerInfos[b+1],this.finalLayerInfos.splice(b+1,1),this.finalLayerInfos.splice(b,0,a),this._markFirstOrLastNode());return c},_initLayerInfos:function(){var a,c=[];g.forEach(this.operLayers,function(b){try{a=x.getInstance().create(b),a.init()}catch(d){console.warn(d.message),
a=null}a&&c.push(a)},this);this.layerInfos=c},_extraSetLayerInfos:function(){g.forEach(this.layerInfos,function(a,c){var b;if("esri.layers.GeoRSSLayer"===a.layerObject.declaredClass||"esri.layers.KMLLayer"===a.layerObject.declaredClass){try{b=x.getInstance().create(a.originOperLayer),b.init()}catch(d){console.warn(d.message),b=null}b&&(this.layerInfos[c]=b)}},this)},_initFinalLayerInfos:function(a){var c,b;this.finalLayerInfos.length=0;for(c=this.map.graphicsLayerIds.length-1;0<=c;c--)b=this.map.graphicsLayerIds[c],
this._isBasemap(b)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(b,a),b,!0);for(c=this.map.layerIds.length-1;0<=c;c--)b=this.map.layerIds[c],this._isBasemap(b)||this._addToFinalLayerInfos(this._findLayerInfoByIdAndReturnTopLayer(b,a),b,!1)},_isBasemap:function(a){var c=!1,b=[];g.forEach(this.map.layerIds,function(a){a=this.map.getLayer(a);("basemap"===a._basemapGalleryLayerType||"reference"===a._basemapGalleryLayerType)&&b.push(a)},this);0===b.length&&(b=this.basemapLayers);
for(var d=0;d<b.length;d++)b[d].id===a&&(c=!0);return c},_addToFinalLayerInfos:function(a,c,b){var d;if(a)!a._addedFlag&&a.isGraphicLayer()===b&&(this.finalLayerInfos.push(a),a._addedFlag=!0);else if(a=this.map.getLayer(c),"esri.layers.GraphicsLayer"!==a.declaredClass){try{d=x.getInstance().create({layerObject:a,title:a.label||a.title||a.name||a.id||" ",id:a.id||" "},this.map),d.init()}catch(e){console.warn(e.message),d=null}d&&this.finalLayerInfos.push(d)}},_findLayerInfoByIdAndReturnTopLayer:function(a,
c){var b,d=null;c||(c=this.finalLayerInfos);for(b=0;b<c.length;b++)if(d=c[b].findLayerInfoById(a)){d=c[b];break}return d},_findLayerInfoById:function(a,c){var b,d=null;c||(c=this.finalLayerInfos);for(b=0;b<c.length&&!(d=c[b].findLayerInfoById(a));b++);return d},_findTopLayerInfoById:function(a){var c,b=null,d=this.finalLayerInfos;for(c=0;c<d.length;c++)if(d[c].id===a){b=d[c];break}return b},_getTopLayerInfoIndexById:function(a){var c,b=-1;for(c=0;c<this.finalLayerInfos.length;c++)if(this.finalLayerInfos[c].id===
a){b=c;break}return b},_clearAddedFlag:function(a){g.forEach(a,function(a){a._addedFlag=!1})},_markFirstOrLastNode:function(){var a;if(this.finalLayerInfos.length){for(a=0;a<this.finalLayerInfos.length;a++)this.finalLayerInfos[a].isFirst=!1,this.finalLayerInfos[a].isLast=!1;this.finalLayerInfos[0].isFirst=!0;this.finalLayerInfos[this.finalLayerInfos.length-1].isLast=!0;for(a=0;a<this.finalLayerInfos.length;a++)if(!this.finalLayerInfos[a].isGraphicLayer()){a&&(this.finalLayerInfos[a-1].isLast=!0);
this.finalLayerInfos[a].isFirst=!0;break}}},_onReceiveBasemapGalleryeData:function(a,c,b){"BasemapGallery"===a&&(this.basemapLayers.length=0,g.forEach(b,k.hitch(this,function(a){this.basemapLayers.push({layerObject:a,id:a.id})}),this),this.update(),this.emit("layerInfosChanged"))},_onBasemapChange:function(a){var c;for(c=this.basemapLayers.length=0;c<a.layers.length;c++)this.basemapLayers.push({layerObject:a.layer[c],id:a.layers[c].id})},_bindEvents:function(){var a,c,b,d;a=m(this.map,"layer-add-result",
k.hitch(this,this._onLayersChange,"added"));c=m(this.map,"layer-remove",k.hitch(this,this._onLayersChange,"removed"));d=e.subscribe("layerInfos/layerInfo/isShowInMapChanged",k.hitch(this,this._onShowInMapChanged));b=m(this.map,"before-unload",k.hitch(this,function(){a.remove();c.remove();d.remove()}));q.addOnUnload(function(){a.remove();c.remove();b.remove();d.remove()})},_onLayersChange:function(a,c){var b=null,d;!c.error&&("esri.layers.GraphicsLayer"!==c.layer.declaredClass&&!c.layer._basemapGalleryLayerType)&&
("added"===a?(this.update(),b=this._findTopLayerInfoById(c.layer.id),d=this._findLayerInfoById(c.layer.id)):(b=this._findTopLayerInfoById(c.layer.id),d=this._findLayerInfoById(c.layer.id),this.update()),this.emit("layerInfosChanged",b,a,d))},_onShowInMapChanged:function(a){this.emit("layerInfosIsShowInMapChanged",a)}});C.getLayerInfoArrayByType=function(a,c){var d=new f,e=[],l=[];C.getInstance(a,a.iteminfo).then(function(a){a.traversal(function(a){var c=a.getLayerType();c.layerInfo=a;e.push(c)});
b(e).then(function(a){g.forEach(a,function(a,b){c===a&&l.push(e[b].layerInfo)});d.resolve(l)})});return d};C.getInstance=function(a,c){var b=new f,d,e=null;for(d=0;d<u.length;d++)if(u[d].map===a){e=u[d].layerInfos;break}e?b.resolve(e):x.getInstance(a).init().then(k.hitch(this,function(){var d=new C(c.itemData.baseMap.baseMapLayers,c.itemData.operationalLayers,a);u.push({map:a,layerInfos:d});b.resolve(d)}));return b};return C})},"esri/layers/WMSLayer":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/has ../kernel ../request ../urlUtils ../SpatialReference ../geometry/Extent ./DynamicMapServiceLayer ./WMSLayerInfo dojo/query".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t){return k([n],{declaredClass:"esri.layers.WMSLayer",_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],
[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],version:null,constructor:function(a,c){var b=d.urlToObject(a);if(b.query&&(b.query.version||b.query.Version||b.query.VERSION))this.version=
b.query.version||b.query.Version||b.query.VERSION;this.url=a=this._stripParameters(a,"version service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));this._url=d.urlToObject(a);this._getCapabilitiesURL=a;this._initLayer=h.hitch(this,this._initLayer);this._parseCapabilities=h.hitch(this,this._parseCapabilities);this._getCapabilitiesError=h.hitch(this,this._getCapabilitiesError);c?(this.imageFormat=this._getImageFormat(c.format),
this.imageTransparency=!1!==c.transparent,this.visibleLayers=c.visibleLayers?c.visibleLayers:[],this.version=c.version||this.version,c.resourceInfo?this._readResourceInfo(c.resourceInfo):this._getCapabilities()):(this.imageFormat="image/png",this.imageTransparency=!0,this.visibleLayers=[],this._getCapabilities());this._blankImageURL=p.toUrl("../images/pixel.png")},setVisibleLayers:function(a){this.visibleLayers=(a=this._checkVisibleLayersList(a))?a:[];this.refresh(!0)},setImageFormat:function(a){this.imageFormat=
this._getImageFormat(a);this.refresh(!0)},setImageTransparency:function(a){this.imageTransparency=a;this.refresh(!0)},getImageUrl:function(a,c,b,e){if(!this.visibleLayers||0===this.visibleLayers.length)e(this._blankImageURL);else{var g=a.spatialReference.wkid;-1===f.indexOf(this.spatialReferences,g)&&a.spatialReference.latestWkid&&(g=a.spatialReference.latestWkid);if(f.some(this._WEB_MERCATOR,function(a){return a==g})){var n=f.filter(this.spatialReferences,function(a){return f.some(this._WEB_MERCATOR,
function(c){return c==a})},this);0===n.length&&(n=f.filter(this.spatialReferences,function(a){return f.some(this._WORLD_MERCATOR,function(c){return c==a})},this));g=0<n.length?n[0]:this._WEB_MERCATOR[0]}this.spatialReferences=f.filter(this.spatialReferences,function(a){return a!==g});this.spatialReferences.unshift(g);var n=a.xmin,h=a.xmax,r=a.ymin,k=a.ymax;a={SERVICE:"WMS",REQUEST:"GetMap"};a.FORMAT=this.imageFormat;a.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";a.STYLES="";a.VERSION=this.version;
a.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;a.WIDTH=c;a.HEIGHT=b;this.maxWidth<c&&(a.WIDTH=this.maxWidth);this.maxHeight<b&&(a.HEIGHT=this.maxHeight);c=g?g:NaN;isNaN(c)||("1.3.0"==this.version?a.CRS="EPSG:"+c:a.SRS="EPSG:"+c);"1.3.0"==this.version&&this._useLatLong(c)?a.BBOX=r+","+n+","+k+","+h:a.BBOX=n+","+r+","+h+","+k;c=this.getMapURL;var m;c+=-1==c.indexOf("?")?"?":"";for(m in a)a.hasOwnProperty(m)&&(c+="?"==c.substring(c.length-1,c.length)?"":"\x26",c+=m+"\x3d"+a[m]);e(d.addProxy(c))}},
_initLayer:function(a,c){this.spatialReference=new b(this.extent.spatialReference);this.initialExtent=new r(this.extent);this.fullExtent=new r(this.extent);this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);this.loaded=!0;this.onLoad(this);var d=this._loadCallback;d&&(delete this._loadCallback,d(this))},_readResourceInfo:function(a){a.extent?a.layerInfos?(this.extent=a.extent,this.allExtents[0]=a.extent,this.layerInfos=a.layerInfos,this.description=a.description?a.description:"",
this.copyright=a.copyright?a.copyright:"",this.title=a.title?a.title:"",this.getMapURL=a.getMapURL?a.getMapURL:this._getCapabilitiesURL,this.version=a.version?a.version:"1.3.0",this.maxWidth=a.maxWidth?a.maxWidth:5E3,this.maxHeight=a.maxHeight?a.maxHeight:5E3,this.spatialReferences=a.spatialReferences?a.spatialReferences:[],this.imageFormat=this._getImageFormat(a.format),this.setScaleRange(a.minScale,a.maxScale),this._initLayer()):console.error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo"):
console.error("esri.layers.WMSLayer: unable to find the 'extent' property in resourceInfo")},_getCapabilities:function(){var a=this._url.query?this._url.query:{};a.SERVICE="WMS";a.REQUEST="GetCapabilities";this.version&&(a.VERSION=this.version);var c=this._url.path+"?",b;for(b in a)a.hasOwnProperty(b)&&(c+="?"==c.substring(c.length-1,c.length)?"":"\x26",c+=b+"\x3d"+a[b]);q({url:c,handleAs:"xml",headers:{"Content-Type":null},load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:!1})},
_parseCapabilities:function(a){if(a){this.version=this._getAttributeValue("WMS_Capabilities","version",a,null);this.version||(this.version=this._getAttributeValue("WMT_MS_Capabilities","version",a,"1.3.0"));var c=this._getTag("Service",a);this.title=this._getTagValue("Title",c,"");this.title||(this.title=this._getTagValue("Name",c,""));this.copyright=this._getTagValue("AccessConstraints",c,"");this.description=this._getTagValue("Abstract",c,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",
c,5E3),10);this.maxHeight=parseInt(this._getTagValue("MaxHeight",c,5E3),10);if(c=this._getTag("Layer",a)){var b=this._getLayerInfo(c),d=0,e=null,c=this._getTag("Capability",a);f.forEach(c.childNodes,function(a){"Layer"==a.nodeName&&(0===d?e=a:(1===d&&b.name&&(b.name="",b.subLayers=[],b.subLayers.push(this._getLayerInfo(e))),b.subLayers.push(this._getLayerInfo(a))),d++)},this);if(b){this.layerInfos=b.subLayers;if(!this.layerInfos||0===this.layerInfos.length)this.layerInfos=[b];this.extent=b.extent;
this.extent||(b.extent=new r(this.layerInfos[0].extent.toJson()),this.extent=b.extent);this.allExtents=b.allExtents;if(!this.allExtents||!this.allExtents.length)b.allExtents=[],f.forEach(this.layerInfos[0].allExtents,function(a,c){a&&(b.allExtents[c]=new r(a.toJson()))}),this.allExtents=b.allExtents;this.spatialReferences=b.spatialReferences;0===this.spatialReferences.length&&0<this.layerInfos.length&&(this.spatialReferences=this.layerInfos[0].spatialReferences)}this.getMapURL=this._getCapabilitiesURL;
if((c=g.query("DCPType",this._getTag("GetMap",a)))&&0<c.length)if((c=g.query("HTTP",c[0]))&&0<c.length)if((c=g.query("Get",c[0]))&&0<c.length)if(c=this._getAttributeValue("OnlineResource","xlink:href",c[0],null))c.indexOf("\x26")==c.length-1&&(c=c.substring(0,c.length-1)),this.getMapURL=c;this.getMapFormats=[];0===g.query("Operation",a).length?f.forEach(g.query("Format",this._getTag("GetMap",a)),function(a){this.getMapFormats.push(a.text?a.text:a.textContent)},this):f.forEach(g.query("Operation",
a),function(a){"GetMap"==a.getAttribute("name")&&f.forEach(g.query("Format",a),function(a){this.getMapFormats.push(a.text?a.text:a.textContent)},this)},this);f.some(this.getMapFormats,function(a){return-1<a.indexOf(this.imageFormat)},this)||(this.imageFormat=this.getMapFormats[0]);this._initLayer()}else this._getCapabilitiesError({error:{message:"Response does not contain any layers."}})}else this.onError("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)")},_getCapabilitiesError:function(a){this.onError("GetCapabilities request for "+
this._getCapabilitiesURL+" failed.",a)},_getLayerInfo:function(a){if(!a)return null;var c=new t;c.name="";c.title="";c.description="";c.allExtents=[];c.spatialReferences=[];c.subLayers=[];var d=this._getTag("LatLonBoundingBox",a);d&&(c.allExtents[0]=this._getExtent(d,4326));var e=this._getTag("EX_GeographicBoundingBox",a),g;e&&(g=new r(0,0,0,0,new b({wkid:4326})),g.xmin=parseFloat(this._getTagValue("westBoundLongitude",e,0)),g.ymin=parseFloat(this._getTagValue("southBoundLatitude",e,0)),g.xmax=parseFloat(this._getTagValue("eastBoundLongitude",
e,0)),g.ymax=parseFloat(this._getTagValue("northBoundLatitude",e,0)),c.allExtents[0]=g);!d&&!e&&(g=new r(-180,-90,180,90,new b({wkid:4326})),c.allExtents[0]=g);c.extent=c.allExtents[0];var n=-1<f.indexOf(["1.0.0","1.1.0","1.1.1"],this.version)?"SRS":"CRS";f.forEach(a.childNodes,function(a){if("Name"==a.nodeName)c.name=(a.text?a.text:a.textContent)||"";else if("Title"==a.nodeName)c.title=(a.text?a.text:a.textContent)||"";else if("Abstract"==a.nodeName)c.description=(a.text?a.text:a.textContent)||"";
else if("BoundingBox"==a.nodeName){var b=a.getAttribute(n);b&&0===b.indexOf("EPSG:")?(b=parseInt(b.substring(5),10),0!==b&&!isNaN(b)&&(a="1.3.0"==this.version?this._getExtent(a,b,this._useLatLong(b)):this._getExtent(a,b),c.allExtents[b]=a,c.extent||(c.extent=a))):b&&0===b.indexOf("CRS:")?(b=parseInt(b.substring(4),10),0!==b&&!isNaN(b)&&(this._CRS_TO_EPSG[b]&&(b=this._CRS_TO_EPSG[b]),c.allExtents[b]=this._getExtent(a,b))):(b=parseInt(b,10),0!==b&&!isNaN(b)&&(c.allExtents[b]=this._getExtent(a,b)))}else if(a.nodeName==
n)a=(a.text?a.text:a.textContent).split(" "),f.forEach(a,function(a){a=-1<a.indexOf(":")?parseInt(a.split(":")[1],10):parseInt(a,10);0!==a&&!isNaN(a)&&(this._CRS_TO_EPSG[a]&&(a=this._CRS_TO_EPSG[a]),-1==f.indexOf(c.spatialReferences,a)&&c.spatialReferences.push(a))},this);else if("Style"==a.nodeName){if(a=this._getTag("LegendURL",a))if(a=this._getTag("OnlineResource",a))c.legendURL=a.getAttribute("xlink:href")}else"Layer"===a.nodeName&&c.subLayers.push(this._getLayerInfo(a))},this);c.title=c.title||
c.name;return c},_getImageFormat:function(a){switch(a?a.toLowerCase():""){case "jpg":return"image/jpeg";case "bmp":return"image/bmp";case "gif":return"image/gif";case "svg":return"image/svg+xml";default:return"image/png"}},getImageFormat:function(){switch(this.imageFormat?this.imageFormat.toLowerCase():""){case "image/jpeg":return"jpg";case "image/bmp":return"bmp";case "image/gif":return"gif";case "image/svg+xml":return"svg";default:return"png"}},_getExtent:function(a,c,d){var e;if(a){e=new r;var f=
parseFloat(a.getAttribute("minx")),g=parseFloat(a.getAttribute("miny")),n=parseFloat(a.getAttribute("maxx"));a=parseFloat(a.getAttribute("maxy"));d?(e.xmin=isNaN(g)?-1*Number.MAX_VALUE:g,e.ymin=isNaN(f)?-1*Number.MAX_VALUE:f,e.xmax=isNaN(a)?Number.MAX_VALUE:a,e.ymax=isNaN(n)?Number.MAX_VALUE:n):(e.xmin=isNaN(f)?-1*Number.MAX_VALUE:f,e.ymin=isNaN(g)?-1*Number.MAX_VALUE:g,e.xmax=isNaN(n)?Number.MAX_VALUE:n,e.ymax=isNaN(a)?Number.MAX_VALUE:a);e.spatialReference=new b({wkid:c})}return e},_useLatLong:function(a){var c,
b;for(b=0;b<this._REVERSED_LAT_LONG_RANGES.length;b++){var d=this._REVERSED_LAT_LONG_RANGES[b];if(a>=d[0]&&a<=d[1]){c=!0;break}}return c},_getTag:function(a,c){var b=g.query(a,c);return b&&0<b.length?b[0]:null},_getTagValue:function(a,c,b){return(a=g.query(a,c))&&0<a.length?a[0].text?a[0].text:a[0].textContent:b},_getAttributeValue:function(a,c,b,d){return(a=g.query(a,b))&&0<a.length?a[0].getAttribute(c):d},_checkVisibleLayersList:function(a){if(a&&(0<a.length&&this.layerInfos&&0<this.layerInfos.length)&&
"number"==typeof a[0]){var c=[];f.forEach(a,function(a){a<this.layerInfos.length&&c.push(this.layerInfos[a].name)},this);a=c}return a},_stripParameters:function(a,c){var b=d.urlToObject(a),e,g=[];for(e in b.query)b.query.hasOwnProperty(e)&&-1===f.indexOf(c,e.toLowerCase())&&g.push(e+"\x3d"+b.query[e]);return b.path+(g.length?"?"+g.join("\x26"):"")}})})},"esri/layers/WMSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","../kernel"],function(p,g,k,h,
f){return p(null,{declaredClass:"esri.layers.WMSLayerInfo",name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],allExtents:[],spatialReferences:[],constructor:function(f){f&&(this.name=f.name,this.title=f.title,this.description=f.description,this.extent=f.extent,this.legendURL=f.legendURL,this.subLayers=f.subLayers?f.subLayers:[],this.allExtents=f.allExtents?f.allExtents:[],this.spatialReferences=f.spatialReferences?f.spatialReferences:[])},clone:function(){var f={name:this.name,
title:this.title,description:this.description,legendURL:this.legendURL},e;this.extent&&(f.extent=this.extent.getExtent());f.subLayers=[];k.forEach(this.subLayers,function(e){f.subLayers.push(e.clone())});f.allExtents=[];for(e in this.allExtents)e=parseInt(e,10),isNaN(e)||(f.allExtents[e]=this.allExtents[e].getExtent());f.spatialReferences=[];k.forEach(this.spatialReferences,function(e){f.spatialReferences.push(e)});return f}})})},"esri/layers/GeoRSSLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../config ../request ./ServiceGeneratedFeatureCollection".split(" "),
function(p,g,k,h,f,m,e,q){return p([q],{declaredClass:"esri.layers.GeoRSSLayer",serviceUrl:location.protocol+"//utility.arcgis.com/sharing/rss",constructor:function(d,b){m.defaults.geoRSSService&&(this.serviceUrl=m.defaults.geoRSSService);this._createLayer()},parse:function(){return this._io=e({url:this.serviceUrl,content:{url:this.url,refresh:this.loaded?!0:void 0,outSR:this._outSR?k.toJson(this._outSR.toJson()):void 0},callbackParamName:"callback"})},_initLayer:function(d){this.inherited(arguments);
this.loaded||(this.loaded=!0,this.onLoad(this))}})})},"esri/layers/ServiceGeneratedFeatureCollection":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/webMercatorUtils ../renderers/SimpleRenderer ./layer ./FeatureLayer ../dijit/PopupTemplate".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c){return p([t],{declaredClass:"esri.layers._ServiceGeneratedFeatureCollection",
constructor:function(a,c){this.pointSymbol=c&&c.pointSymbol;this.polylineSymbol=c&&c.polylineSymbol;this.polygonSymbol=c&&c.polygonSymbol;this._outSR=c&&(c.outSpatialReference||c.outSR)||new d({wkid:4326});this._options=k.mixin({},c)},parse:function(){console.error("parse function has not been implemented")},getFeatureLayers:function(){var a=[];this._fLayers&&(a=a.concat(this._fLayers));return a},onRefresh:function(){},onOpacityChange:function(){},refresh:function(){this.loaded&&(this._map&&!this._io&&
this.visible)&&this._createLayer()},_createLayer:function(a){var c=this;this._fireUpdateStart();a=this.parse(a);a.addCallback(function(a){c._io=null;c._initLayer(a)});a.addErrback(function(a){c._io=null;a=k.mixin(Error(),a);a.message="Unable to load resource: "+c.url+" "+(a.message||"");c._fireUpdateEnd(a);c.onError(a)})},_initLayer:function(d){this.loaded&&this._removeInternalLayers();this.name=d.name;this.description=d.description;this.snippet=d.snippet;this.defaultVisibility=void 0!==d.visibility?
this.visible=!!d.visibility:this.visible=!0;this.featureInfos=d.featureInfos;this.fullExtent=this.initialExtent=new b(d.lookAtExtent);this.copyright=d.author||d.copyright;var e;if((d=k.getObject("featureCollection.layers",!1,d))&&0<d.length)this._fLayers=[],h.forEach(d,function(b,d){var f=k.getObject("featureSet.features",!1,b);f&&0<f.length&&(e=k.mixin({outFields:["*"],infoTemplate:b.popupInfo?new c(b.popupInfo):null,editable:!1},this._options),e.id&&(e.id=e.id+"_"+d),b.layerDefinition.capabilities=
"Query,Data",f=new a(b,e),f.geometryType&&(this["_"+f.geometryType]=f),this._fLayers.push(f))},this),0===this._fLayers.length&&delete this._fLayers;this.items=[];this._esriGeometryPoint&&(this.items=this.items.concat(this._esriGeometryPoint.graphics),this.pointSymbol&&(d=new n(this.pointSymbol),this._esriGeometryPoint.setRenderer(d)));this._esriGeometryPolyline&&(this.items=this.items.concat(this._esriGeometryPolyline.graphics),this.polylineSymbol&&(d=new n(this.polylineSymbol),this._esriGeometryPolyline.setRenderer(d)));
this._esriGeometryPolygon&&(this.items=this.items.concat(this._esriGeometryPolygon.graphics),this.polygonSymbol&&(d=new n(this.polygonSymbol),this._esriGeometryPolygon.setRenderer(d)));this._fireUpdateEnd();this.loaded&&(this._addInternalLayers(),this.onRefresh())},_addInternalLayers:function(){var a=this._map;this._fireUpdateStart();var c=a.spatialReference,b=this._outSR,d;if(c.wkid)d=c._isWebMercator()&&b._isWebMercator()||c.wkid===b.wkid;else if(c.wkt)d=c.wkt===b.wkt;else{console.log("_setMap - map has invalid spatial reference");
return}if(!d)if(c._isWebMercator()&&4326===b.wkid)this._converter=r.geographicToWebMercator;else if(b._isWebMercator()&&4326===c.wkid)this._converter=r.webMercatorToGeographic;else{console.log("_setMap - unsupported workflow. Spatial reference of the map and layer do not match, and the conversion cannot be done on the client.");return}(c=this._fLayers)&&0<c.length&&h.forEach(c,function(c){if(this._converter){var b=c.graphics,d,e,f=b?b.length:0;for(d=0;d<f;d++)(e=b[d].geometry)&&b[d].setGeometry(this._converter(e))}a.addLayer(c)},
this);this.setVisibility(this.visible);this._fireUpdateEnd()},_removeInternalLayers:function(){var a=this._map;a&&h.forEach(this.getFeatureLayers(),a.removeLayer,a)},setScaleRange:function(a,c){this.inherited(arguments);h.forEach(this.getFeatureLayers(),function(b){b.setScaleRange(a,c)});this._options.minScale=this.minScale;this._options.maxScale=this.maxScale},setOpacity:function(a){this.opacity!=a&&(h.forEach(this.getFeatureLayers(),function(c){c.setOpacity(a)}),this.opacity=this._options.opacity=
a,this.onOpacityChange(a))},onVisibilityChange:function(a){this._fireUpdateStart();h.forEach(this.getFeatureLayers(),function(c){c.setVisibility(a)});this._fireUpdateEnd()},_setMap:function(a,c){this.inherited(arguments);this._map=a;var b=this._div=f.create("div",null,c);m.set(b,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return b},_unsetMap:function(a,c){this._io&&this._io.cancel();g.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();
var b=this._div;b&&(c.removeChild(b),f.destroy(b));this._div=null;this.inherited(arguments)}})})},"esri/layers/KMLLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z,A,x,u){var C=g([w],{declaredClass:"esri.layers.KMLLayer",serviceUrl:location.protocol+"//utility.arcgis.com/sharing/kml",constructor:function(a,b){a||console.log("KMLLayer:constructor - please provide url for the KML file");this._outSR=b&&b.outSR||new c({wkid:4326});this._options=h.mixin({},b);n.defaults.kmlService&&(this.serviceUrl=n.defaults.kmlService);var d=this.linkInfo=b&&b.linkInfo;d&&(this.visible=!!d.visibility,this._waitingForMap=!!d.viewFormat);
(!d||d&&d.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=h.hitch(this,this.refresh);this.registerConnectEvents("esri.layers.KMLLayer",!0)},getFeature:function(a){if(a){var c=a.type,b=a.id,d;switch(c){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(a=this["_"+c])&&(d=h.getObject("_mode._featureMap."+b,!1,a));break;case "GroundOverlay":if(a=this._groundLyr){var e=a.getImages(),c=e.length;for(a=0;a<c;a++)if(e[a].id===b){d=e[a];break}}break;case "ScreenOverlay":break;
case "NetworkLink":f.some(this._links,function(a){return a.linkInfo&&a.linkInfo.id===b?(d=a,!0):!1});break;case "Folder":c=(e=this.folders)?e.length:0;for(a=0;a<c;a++)if(e[a].id===b){d=e[a];break}break;default:console.log("KMLLayer:getFeature - unknown feature type")}return d}},getLayers:function(){var a=[];this._groundLyr&&a.push(this._groundLyr);this._fLayers&&(a=a.concat(this._fLayers));this._links&&f.forEach(this._links,function(c){c.declaredClass&&a.push(c)});return a},setFolderVisibility:function(a,
c){a&&(this._fireUpdateStart(),(a.visible=c)&&(c=this._areLocalAncestorsVisible(a)),this._setState(a,c),this._fireUpdateEnd())},onRefresh:function(){},onOpacityChange:function(){},_parseKml:function(c){var b=this;this._fireUpdateStart();this._io=a({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(c),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:m.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(a){b._io=null;b._initLayer(a)},error:function(a){b._io=
null;a=h.mixin(Error(),a);a.message="Unable to load KML: "+b.url+" "+(a.message||"");b._fireUpdateEnd(a);b.onError(a)}})},_initLayer:function(a){this.loaded&&this._removeInternalLayers();this.name=a.name;this.description=a.description;this.snippet=a.snippet;this.visibility=a.visibility;this.featureInfos=a.featureInfos;var c,b,d=this.folders=a.folders,e=[],g;if(d){b=d.length;for(c=0;c<b;c++)g=d[c]=new z(d[c]),-1===g.parentFolderId&&e.push(g)}var d=this._links=a.networkLinks,n;b=d?d.length:0;for(c=
0;c<b;c++)d[c].viewRefreshMode&&-1!==d[c].viewRefreshMode.toLowerCase().indexOf("onregion")||(n=h.mixin({},this._options),n.linkInfo=d[c],n.id&&(n.id=n.id+"_"+c),d[c]=new C(d[c].href,n),d[c]._parentLayer=this,d[c]._parentFolderId=this._getLinkParentId(d[c].linkInfo.id));if((d=a.groundOverlays)&&0<d.length){n=h.mixin({},this._options);n.id&&(n.id+="_mapImage");g=this._groundLyr=new x(n);b=d.length;for(c=0;c<b;c++)g.addImage(new A(d[c]))}if((a=h.getObject("featureCollection.layers",!1,a))&&0<a.length)this._fLayers=
[],f.forEach(a,function(a,c){var b=h.getObject("featureSet.features",!1,a);b&&0<b.length&&(n=h.mixin({outFields:["*"],infoTemplate:a.popupInfo?new l(a.popupInfo):null,editable:!1},this._options),n.id&&(n.id=n.id+"_"+c),a.layerDefinition.capabilities="Query,Data",b=new u(a,n),b.geometryType&&(this["_"+b.geometryType]=b),this._fLayers.push(b))},this),0===this._fLayers.length&&delete this._fLayers;b=e.length;for(c=0;c<b;c++)g=e[c],this._setState(g,g.visible);this._fireUpdateEnd();this.loaded?(this._addInternalLayers(),
this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var a=this._map;this._fireUpdateStart();this._links&&f.forEach(this._links,function(c){c.declaredClass&&(a.addLayer(c),c._waitingForMap&&(c._waitingForMap=null,c.visible?c._parseKml(a):c._wMap=a))});var c=a.spatialReference,b=this._outSR,d;if(!c.equals(b))if(c.isWebMercator()&&4326===b.wkid)d=s.geographicToWebMercator;else if(b.isWebMercator()&&4326===c.wkid)d=s.webMercatorToGeographic;else{console.log("KMLLayer:_setMap - unsupported workflow. Spatial reference of the map and kml layer do not match, and the conversion cannot be done on the client.");
return}this._groundLyr&&(d&&f.forEach(this._groundLyr.getImages(),function(a){a.extent=d(a.extent)}),a.addLayer(this._groundLyr));(c=this._fLayers)&&0<c.length&&f.forEach(c,function(c){if(d){var b=c.graphics,e,f,l=b?b.length:0;for(e=0;e<l;e++)(f=b[e].geometry)&&b[e].setGeometry(d(f))}a.addLayer(c)});this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var a=this._map;this._links&&f.forEach(this._links,function(a){a.declaredClass&&a._io&&a._io.cancel()});a&&f.forEach(this.getLayers(),
a.removeLayer,a)},_setState:function(a,c){var b=a.featureInfos,d,e,f,l=b?b.length:0,g=c?"show":"hide";for(f=0;f<l;f++)if(d=b[f],e=this.getFeature(d))if("Folder"===d.type)this._setState(e,c&&e.visible);else if("NetworkLink"===d.type)this._setInternalVisibility(e,c);else e[g]()},_areLocalAncestorsVisible:function(a){var c=a.parentFolderId;for(a=a.visible;a&&-1!==c;)c=this.getFeature({type:"Folder",id:c}),a=a&&c.visible,c=c.parentFolderId;return a},_setInternalVisibility:function(a,c){var b=a._parentLayer,
d=a._parentFolderId;for(c=c&&a.visible;c&&b;)c=c&&b.visible,-1<d&&(c=c&&b._areLocalAncestorsVisible(b.getFeature({type:"Folder",id:d}))),d=b._parentFolderId,b=b._parentLayer;this._setIntState(a,c)},_setIntState:function(a,c){a&&f.forEach(a.getLayers(),function(b){b.linkInfo?a._setIntState(b,c&&b.visible&&a._areLocalAncestorsVisible(a.getFeature({type:"Folder",id:b._parentFolderId}))):b.setVisibility(c)})},_getLinkParentId:function(a){var c=-1;this.folders&&f.some(this.folders,function(b){return b.networkLinkIds&&
-1!==f.indexOf(b.networkLinkIds,a)?(c=b.id,!0):!1});return c},_checkAutoRefresh:function(){var a=this.linkInfo;if(a)if(this.visible){if(this.loaded&&this._map){var c=a.refreshMode,b=a.refreshInterval,d=a.viewRefreshMode,a=a.viewRefreshTime;c&&(-1!==c.toLowerCase().indexOf("oninterval")&&0<b)&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*b));d&&(-1!==d.toLowerCase().indexOf("onstop")&&0<a)&&!this._extChgHandle&&(this._extChgHandle=k.connect(this._map,"onExtentChange",this,
this._extentChanged))}}else this._stopAutoRefresh(),k.disconnect(this._extChgHandle),delete this._extChgHandle},_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null},_getQueryParameters:function(a){a=a||this._map;var c={},b=this.linkInfo,d=a&&a.extent,e;this._url.query&&(h.mixin(c,this._url.query),e=!!this._url.query.token);if(r.id&&!e&&(e=r.id.findCredential(this._url.path)))c.token=e.token;if(b){e=b.viewFormat;var f=b.httpQuery,b=b.viewBoundScale;if(d&&e){var l=
d,g=d,n=d.spatialReference;n&&(n.isWebMercator()?l=s.webMercatorToGeographic(d):4326===n.wkid&&(g=s.geographicToWebMercator(d)));d=l.getCenter();g=Math.max(g.getWidth(),g.getHeight());b&&(l=l.expand(b));e=e.replace(/\[bboxWest\]/ig,l.xmin).replace(/\[bboxEast\]/ig,l.xmax).replace(/\[bboxSouth\]/ig,l.ymin).replace(/\[bboxNorth\]/ig,l.ymax).replace(/\[lookatLon\]/ig,d.x).replace(/\[lookatLat\]/ig,d.y).replace(/\[lookatRange\]/ig,g).replace(/\[lookatTilt\]/ig,0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,
d.x).replace(/\[lookatTerrainLat\]/ig,d.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,d.x).replace(/\[cameraLat\]/ig,d.y).replace(/\[cameraAlt\]/ig,g).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,a.width).replace(/\[vertPixels\]/ig,a.height).replace(/\[terrainEnabled\]/ig,0);h.mixin(c,q.queryToObject(e))}f&&(f=f.replace(/\[clientVersion\]/ig,r.version).replace(/\[kmlVersion\]/ig,2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,
p.locale),h.mixin(c,q.queryToObject(f)))}a=[];for(var k in c)t.isDefined(c[k])&&a.push(k+"\x3d"+c[k]);return(a=a.join("\x26"))?"?"+a:""},setScaleRange:function(a,c){this.inherited(arguments);f.forEach(this.getLayers(),function(b){b.setScaleRange(a,c)});this._options.minScale=this.minScale;this._options.maxScale=this.maxScale},setOpacity:function(a){this.opacity!=a&&(f.forEach(this.getLayers(),function(c){c.setOpacity(a)}),this.opacity=this._options.opacity=a,this.onOpacityChange(a))},_setMap:function(a,
c){this.inherited(arguments);this._map=a;var e=this._div=d.create("div",null,c);b.set(e,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return e},_unsetMap:function(a,c){this._io&&this._io.cancel();this._stopAutoRefresh();k.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var b=this._div;b&&(c.removeChild(b),d.destroy(b));this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(a){this.loaded?(this._fireUpdateStart(),
this._setInternalVisibility(this,a),this._checkAutoRefresh(),this._fireUpdateEnd()):this.linkInfo&&a&&(this._waitingForMap||this._parseKml(this._wMap))},refresh:function(){this.loaded&&(this._map&&!this._io&&this.visible)&&this._parseKml()},getFeatureCollection:function(a){var c,b=[];if(a=this.getFeature({type:"Folder",id:a}))(c=f.map(a.featureInfos,function(a){if("esriGeometryPoint"===a.type||"esriGeometryPolyline"===a.type||"esriGeometryPolygon"===a.type)return a.id},this))&&0<c.length&&f.forEach(this._fLayers,
function(a){var d,e;d=a.toJson();d.featureSet.features&&0<d.featureSet.features.length&&(e=f.filter(d.featureSet.features,function(b){if(-1!==f.indexOf(c,b.attributes[a.objectIdField]))return b},this));e&&0<e.length&&(d.featureSet.features=e,b.push(d))},this);return b},getFeatureCount:function(a){a=this.getFeature({type:"Folder",id:a});var c={points:0,polylines:0,polygons:0};a&&f.forEach(a.featureInfos,function(a){"esriGeometryPoint"===a.type&&(c.points+=1);"esriGeometryPolyline"===a.type&&(c.polylines+=
1);"esriGeometryPolygon"===a.type&&(c.polygons+=1)});return c},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});return C})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,g,k,h,f){return p(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(h){g.mixin(this,h);f.isDefined(this.visibility)&&(this.visible=!!this.visibility)}})})},
"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),function(p,g,k,h,f,m){return p([m],{declaredClass:"esri.layers.KMLGroundOverlay",constructor:function(e){f.isDefined(this.visibility)&&(this.visible=!!this.visibility)}})})},"jimu/LayerInfos/LayerInfoForCollection":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect dojo/Deferred ./LayerInfo ./LayerInfoForDefault ./LayerInfoFactory".split(" "),
function(p,g,k,h,f,m,e,q,d){return p(e,{constructor:function(){this.layerObject={declaredClass:"esri.layers.FeatureCollection",type:"FeatureCollection"}},getExtent:function(){var b=[],d;g.forEach(this.originOperLayer.featureCollection.layers,function(d){b=b.concat(d.layerObject.graphics)});0===b.length?d=null:(d=1===b.length?b[0].getLayer().fullExtent:h.graphicsExtent(b),d=this._convertGeometryToMapSpatialRef(d));return d},initVisible:function(){var b=!1,d;if(this.newSubLayers.length)for(d=0;d<this.newSubLayers.length;d++)b=
b||this.newSubLayers[d].layerObject.visible;else b=!1;this._visible=b},_setTopLayerVisible:function(b){this._visible=b?!0:!1;g.forEach(this.newSubLayers,function(b){b.setLayerVisiblefromTopLayer()},this)},obtainNewSubLayers:function(){var b=[];g.forEach(this.originOperLayer.featureCollection.layers,function(e){this._getLayerIndexesInMapByLayerId(e.layerObject.id)&&(e=d.getInstance().create({layerObject:e.layerObject,title:e.layerObject.label||e.layerObject.title||e.layerObject.name||e.layerObject.id||
" ",id:e.id||" ",collection:{layerInfo:this},selfType:"collection",parentLayerInfo:this}),b.push(e),e.init())},this);b.reverse();return b},_obtainLayerIndexesInMap:function(){var b=[],d,e;for(e=0;e<this.newSubLayers.length;e++)(d=this._getLayerIndexesInMapByLayerId(this.newSubLayers[e].layerObject.id))&&b.push(d);return b},moveLeftOfIndex:function(b){var d;for(d=this.newSubLayers.length-1;0<=d;d--)this.map.reorderLayer(this.newSubLayers[d].layerObject,b)},moveRightOfIndex:function(b){var d;for(d=
0;d<this.newSubLayers.length;d++)this.map.reorderLayer(this.newSubLayers[d].layerObject,b)}})})},"jimu/LayerInfos/LayerInfo":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred esri/graphicsUtils dojo/aspect dojo/dom-style dojo/dom-class dojo/dom-attr dojo/dom-construct dojo/topic esri/layers/FeatureLayer esri/config esri/tasks/ProjectParameters esri/SpatialReference esri/geometry/webMercatorUtils".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s){return p(null,
{originOperLayer:null,layerObject:null,map:null,title:null,id:null,newSubLayers:null,parentLayerInfo:null,constructor:function(a,c){this.originOperLayer=a;this.layerObject=a.layerObject;this.map=c;this.title=this.originOperLayer.title;this.id=this.originOperLayer.id;this.parentLayerInfo=a.parentLayerInfo?a.parentLayerInfo:null;this.nls=window.jimuNls.layerInfosMenu;this.popupMenuInfo={menuItems:[{key:"zoomto",label:this.nls.itemZoomTo},{key:"transparency",label:this.nls.itemTransparency},{key:null,
label:""},{key:"moveup",label:this.nls.itemMoveUp},{key:"movedown",label:this.nls.itemMoveDown},{key:null,label:""},{key:"description",label:'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d'+(this.layerObject&&this.layerObject.url?this.layerObject.url:"")+"\x3e"+this.nls.itemDesc+"\x3c/a\x3e"}],deniedItems:[]}},init:function(){this.newSubLayers=this.obtainNewSubLayers();this.initVisible();this.originOperLayer.popupInfo&&(this.popupVisible=!0)},isGraphicLayer:function(){var a=this._obtainLayerIndexesInMap();
return a.length?a[0].isGraphicLayer:!1},obtainLayerIndexesInMap:function(){return this._obtainLayerIndexesInMap()},getExtent:function(){},getOpacity:function(){var a,c=0;for(a=0;a<this.newSubLayers.length;a++)if(this.newSubLayers[a].layerObject.opacity)c=this.newSubLayers[a].layerObject.opacity>c?this.newSubLayers[a].layerObject.opacity:c;else return 1;return c},setOpacity:function(a){g.forEach(this.newSubLayers,function(c){c.layerObject.setOpacity&&c.layerObject.setOpacity(a)})},moveLeftOfIndex:function(a){this.map.reorderLayer(this.layerObject,
a)},moveRightOfIndex:function(a){this.map.reorderLayer(this.layerObject,a)},traversal:function(a){if(a(this))return!0;for(var c=this.getSubLayers(),b=0;b<c.length;b++)if(c[b].traversal(a))return!0},findLayerInfoById:function(a){var c=null,b=0;if(this.id&&this.id===a)return this;for(b=0;b<this.newSubLayers.length&&!(c=this.newSubLayers[b].findLayerInfoById(a));b++);return c},setTopLayerVisible:function(a){var c=this.isShowInMap();this._setTopLayerVisible(a);this._isShowInMapChanged(c)},_setTopLayerVisible:function(a){},
setSubLayerVisible:function(a,c){},setLayerVisiblefromTopLayer:function(){},initVisible:function(){},isVisible:function(){return this._visible},_obtainLayerIndexesInMap:function(){var a=[],c;(c=this._getLayerIndexesInMapByLayerId(this.id))&&a.push(c);return a},_getLayerIndexesInMapByLayerId:function(a){var c;for(c=0;c<this.map.graphicsLayerIds.length;c++)if(this.map.graphicsLayerIds[c]===a)return{isGraphicLayer:!0,index:c};for(c=0;c<this.map.layerIds.length;c++)if(this.map.layerIds[c]===a)return{isGraphicLayer:!1,
index:c};return null},_convertGeometryToMapSpatialRef:function(b){var d=new h;if(this.map.spatialReference.equals(b.spatialReference))return d.resolve([b]),d;if(this.map.spatialReference.isWebMercator()&&b.spatialReference.equals(new c(4326)))return d.resolve([s.geographicToWebMercator(b)]),d;if(this.map.spatialReference.equals(new c(4326))&&b.spatialReference.isWebMercator())return d.resolve([s.webMercatorToGeographic(b)]),d;d=new a;d.geometries=[b];d.outSR=this.map.spatialReference;return t.defaults.geometryService.project(d)},
_isShowInMapChanged:function(a){if(a!==this.isShowInMap()){var c=[];this.traversal(function(a){c.push(a)});r.publish("layerInfos/layerInfo/isShowInMapChanged",c)}},obtainNewSubLayers:function(){return[]},obtainLegendsNode:function(){return b.create("div",{"class":"legends-div"})},initLegendsNode:function(a){},loadLegends:function(){},getDeniedItems:function(){var a=new h,c=[];this.isFirst?c.push("moveup"):this.isLast&&c.push("movedown");if(!this.layerObject||!this.layerObject.url)c.push("description"),
c.push("download");this.getLayerType().then(k.hitch(this,function(b){"FeatureLayer"!==b&&c.push("table");a.resolve(this.popupMenuInfo.deniedItems.concat(c))}),function(){a.resolve(this.popupMenuInfo.deniedItems.concat(c))});return a},onPopupMenuClick:function(a){var c={closeMenu:!0};switch(a.itemKey){case "zoomto":this._onItemZoomToClick(a);break;case "moveup":this._onMoveUpItemClick(a);break;case "movedown":this._onMoveDownItemClick(a);break;case "table":this._onTableItemClick(a);break;case "transparencyChanged":this._onTransparencyChanged(a),
c.closeMenu=!1}return c},_onItemZoomToClick:function(a){this.getExtent().then(k.hitch(this,function(a){this.map.setExtent(a[0])}))},_onTransparencyItemClick:function(a){},_onMoveUpItemClick:function(a){this.isFirst||a.layerListView.moveUpLayer(this.id)},_onMoveDownItemClick:function(a){this.isLast||a.layerListView.moveDownLayer(this.id)},_onTableItemClick:function(a){this.getLayerType().then(k.hitch(this,function(c){"FeatureLayer"===c&&a.layerListWidget.publishData({target:"AttributeTable",layer:this})}))},
_onUrlItemClick:function(a){this.layerObject&&this.layerObject.url&&(a=b.create("a",{href:this.layerObject.url,target:"_blank"}),a.click())},_onTransparencyChanged:function(a){this.setOpacity(1-a.data.newTransValue)},getLayerObject:function(){var a=new h;this.layerObject?a.resolve(this.layerObject):a.reject("layerObject is null");return a},getSubLayers:function(){return this.newSubLayers},isShowInMap:function(){for(var a=!0,c=this;c;)a=a&&c.isVisible(),c=c.parentLayerInfo;return a},getLayerType:function(){var a=
[null],c=new h;this.layerObject.declaredClass&&(a=this.layerObject.declaredClass.split("."));c.resolve(a[a.length-1]);return c},getPopupInfo:function(){return this.originOperLayer.popupInfo},getUrl:function(){return this.originOperLayer.url},hasLayerTypes:function(a){}})})},"jimu/LayerInfos/LayerInfoForDefault":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfo dojox/gfx dojo/dom-construct dojo/dom-attr dojo/Deferred esri/geometry/webMercatorUtils esri/symbols/jsonUtils".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n){var t=p(m,{_legendsNode:null,constructor:function(a,c){this.layerLoadedDef=new b;if(a.selfType)this.popupMenuInfo.menuItems=[{key:"table",label:this.nls.itemToAttributeTable},{key:null,label:""},{key:"description",label:'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d'+(this.layerObject&&this.layerObject.url?this.layerObject.url:"")+"\x3e"+this.nls.itemDesc+"\x3c/a\x3e"}];else if("esri.layers.FeatureLayer"===this.layerObject.declaredClass){for(var d=
-1,e=0,e=0;e<this.popupMenuInfo.menuItems.length;e++)if("movedown"===this.popupMenuInfo.menuItems[e].key){d=e;break}this.popupMenuInfo.menuItems.splice(d+1,0,"",{key:"table",label:this.nls.itemToAttributeTable})}},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.fullExtent)||this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.initialExtent)},initVisible:function(){var a=!1;this._visible=a=this.originOperLayer.layerObject.visible},
_setTopLayerVisible:function(a){this.originOperLayer.collection?this.originOperLayer.collection.layerInfo._visible?a?(this.layerObject.show(),this._visible=!0):(this.layerObject.hide(),this._visible=!1):a?(this.layerObject.hide(),this._visible=!0):(this.layerObject.hide(),this._visible=!1):(a?this.layerObject.show():this.layerObject.hide(),this._visible=a)},setLayerVisiblefromTopLayer:function(){this.originOperLayer.collection.layerInfo._visible?this._visible&&this.layerObject.show():this.layerObject.hide()},
obtainLegendsNode:function(){var a=q.create("div",{"class":"legends-div"});q.create("img",{"class":"legends-loading-img",src:require.toUrl("jimu")+"/images/loading.gif"},a);this._legendsNode=a;this.initLegendsNode();return a},initLegendsNode:function(){var a=[],c=this.layerObject;if(this.layerObject&&!this.layerObject.empty&&(!this.originOperLayer.subLayer||0===this.originOperLayer.subLayers.length))q.empty(this._legendsNode),c.renderer&&(c.renderer.infos?a=k.clone(c.renderer.infos):a.push({label:c.renderer.label,
symbol:c.renderer.symbol}),g.forEach(a,function(a){a.legendDiv=q.create("div",{"class":"legend-div"},this._legendsNode);a.symbolDiv=q.create("div",{"class":"legend-symbol"},a.legendDiv);a.labelDiv=q.create("div",{"class":"legend-label",innerHTML:a.label||" "},a.legendDiv);if("textsymbol"===a.symbol.type)d.set(a.symbolDiv,"innerHTML",a.symbol.text);else{var c=e.createSurface(a.symbolDiv,50,50);a=n.getShapeDescriptors(a.symbol);c.createShape(a.defaultShape).setFill(a.fill).setStroke(a.stroke).setTransform(e.matrix.translate(25,
25))}},this))},obtainNewSubLayers:function(){var a=[];this.originOperLayer.subLayers&&0!==this.originOperLayer.subLayers.length&&g.forEach(this.originOperLayer.subLayers,function(c){c=new t(c,this.map);a.push(c);c.init()},this);return a},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(a){this.layerObject.setOpacity&&this.layerObject.setOpacity(a)}});return t})},"jimu/LayerInfos/LayerInfoFactory":function(){define(["dojo/_base/declare","dojo/_base/array",
"dojo/_base/lang","dojo/aspect","dojo/Deferred"],function(p,g,k,h,f){var m=null,e=p(null,{constructor:function(){},init:function(){var e=new f;require("jimu/LayerInfos/LayerInfoForCollection jimu/LayerInfos/LayerInfoForMapService jimu/LayerInfos/LayerInfoForKML jimu/LayerInfos/LayerInfoForGeoRSS jimu/LayerInfos/LayerInfoForDefault jimu/LayerInfos/LayerInfoForWMS jimu/LayerInfos/LayerInfoForGroup jimu/LayerInfos/LayerInfoForDefaultDynamic jimu/LayerInfos/LayerInfoForDefaultTile jimu/LayerInfos/LayerInfoForDefaultWMS".split(" "),
k.hitch(this,function(d,b,f,g,h,a,c,k,l,m){this.LayerInfoForCollection=d;this.LayerInfoForMapService=b;this.LayerInfoForKML=f;this.LayerInfoForGeoRSS=g;this.LayerInfoForDefault=h;this.LayerInfoForWMS=a;this.LayerInfoForGroup=c;this.LayerInfoForDefaultDynamic=k;this.LayerInfoForDefaultTile=l;this.LayerInfoForDefaultWMS=m;e.resolve()}));return e},create:function(e){if(e.featureCollection)return new this.LayerInfoForCollection(e,this.map);if("esri.layers.KMLLayer"===e.layerObject.declaredClass)return new this.LayerInfoForKML(e,
this.map);if("esri.layers.GeoRSSLayer"===e.layerObject.declaredClass)return new this.LayerInfoForGeoRSS(e,this.map);if("esri.layers.WMSLayer"===e.layerObject.declaredClass&&!e.selfType)return new this.LayerInfoForWMS(e,this.map);if("esri.layers.ArcGISDynamicMapServiceLayer"===e.layerObject.declaredClass||"esri.layers.ArcGISTiledMapServiceLayer"===e.layerObject.declaredClass)return new this.LayerInfoForMapService(e,this.map);switch(e.selfType){case "mapservice_dynamic_group":return new this.LayerInfoForGroup(e,
this.map);case "mapservice_tiled_group":return new this.LayerInfoForGroup(e,this.map,!0);case "mapservice_dynamic":return new this.LayerInfoForDefaultDynamic(e,this.map);case "mapservice_tiled":return new this.LayerInfoForDefaultTile(e,this.map);case "wms":return new this.LayerInfoForDefaultWMS(e,this.map);default:return new this.LayerInfoForDefault(e,this.map)}}});e.getInstance=function(f){null===m&&(m=new e);f&&(m.map=f);return m};return e})},"jimu/LayerInfos/LayerInfoForMapService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/json ./LayerInfo ./LayerInfoForDefault ./LayerInfoForDefaultDynamic ./LayerInfoForDefaultTile ./LayerInfoForGroup esri/layers/ArcGISDynamicMapServiceLayer esri/layers/FeatureLayer esri/request ./LayerInfoFactory".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a){return p(m,{_legendInfo:null,_sublayerIdent:null,constructor:function(a,b){this.initSubLayerVisible();this._sublayerIdent={idents:[],empty:!0,defLoad:new h};this._sublayerIdent.idents[this.layerObject.layerInfos.length-1]=null},initSubLayerVisible:function(){this.subLayerVisible=[];for(var a=this.subLayerVisible[this.layerObject.layerInfos.length-1]=0;a<this.subLayerVisible.length;a++)this.subLayerVisible[a]=0;this.originOperLayer.visibleLayers?g.forEach(this.originOperLayer.visibleLayers,
function(a){this.subLayerVisible[a]++},this):g.forEach(this.layerObject.layerInfos,function(a,c){a.defaultVisibility&&this.subLayerVisible[c]++},this)},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.fullExtent||this.originOperLayer.layerObject.initialExtent)},initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},_setTopLayerVisible:function(a){this.originOperLayer.layerObject.setVisibility(a);this._visible=a},setSubLayerVisible:function(a,
b){var d=[],e;null!==a&&(b?(d=k.clone(this.originOperLayer.layerObject.visibleLayers),e=g.indexOf(d,a),0>e&&(d.push(a),this.originOperLayer.layerObject.setVisibleLayers(d))):(d=k.clone(this.originOperLayer.layerObject.visibleLayers),e=g.indexOf(d,a),0<=e&&d.splice(e,1),0===d.length&&d.push(-1),this.originOperLayer.layerObject.setVisibleLayers(d)))},obtainNewSubLayers:function(){var c=[],b=this.originOperLayer.layerObject,d=null,d="esri.layers.ArcGISDynamicMapServiceLayer"===b.declaredClass?"dynamic":
"tiled";g.forEach(b.layerInfos,function(a){var e=null,e=b.url+"/"+a.id,f=b.id+"_"+a.id;a.subLayerIds&&0<a.subLayerIds.length?(e={url:e,empty:!0},this._addNewSubLayer(c,e,f,a,d+"_group")):(e={url:e,empty:!0},this._addNewSubLayer(c,e,f,a,d))},this);var e=[];g.forEach(b.layerInfos,function(a,b){var d=a.parentLayerId;-1!==d&&c[d].subLayers.push(c[b])});g.forEach(b.layerInfos,function(b,d){var f;-1===b.parentLayerId&&(f=a.getInstance().create(c[d]),e.push(f),f.init())},this);return e},_addNewSubLayer:function(a,
b,d,e,f){a.push({layerObject:b,title:e.name||e.id||" ",id:d||" ",subLayers:[],mapService:{layerInfo:this,subId:e.id},selfType:"mapservice_"+f,url:b.url,parentLayerInfo:this})},_handleErrorSubLayer:function(a,b,d,e,f,g){a[b]={layerObject:null,title:g.name||g.id||" ",id:d||" ",subLayers:[],mapService:{layerInfo:this,subId:e}}},getOpacity:function(){return this.layerObject.opacity?this.layerObject.opacity:1},setOpacity:function(a){this.layerObject.setOpacity&&this.layerObject.setOpacity(a)},getLegendInfo:function(a){var b=
new h;this._legendInfo?b.resolve(this._legendInfo):this._legendRequest(a).then(k.hitch(this,function(a){this._legendInfo=a.layers;b.resolve(this._legendInfo)}),function(){b.reject()});return b},_legendRequest:function(a){return 10.01<=this.layerObject.version?this._legendRequestServer():this._legendRequestTools(a)},_legendRequestServer:function(){var a=this.layerObject.url+"/legend",b={f:"json"};this.layerObject._params.dynamicLayers&&(b.dynamicLayers=f.stringify(this._createDynamicLayers(this.layerObject)),
"[{}]"===b.dynamicLayers&&(b.dynamicLayers="[]"));return t({url:a,content:b,handleAs:"json",callbackParamName:"callback"})},_legendRequestTools:function(a){return t({url:a+"sharing/tools/legend?soapUrl\x3d"+this.layerObject.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"})},_createDynamicLayers:function(a){var b=[],d;g.forEach(a.dynamicLayerInfos||a.layerInfos,function(e){d={id:e.id};d.source=e.source&&e.source.toJson();var f;a.layerDefinitions&&a.layerDefinitions[e.id]&&(f=a.layerDefinitions[e.id]);
f&&(d.definitionExpression=f);var g;a.layerDrawingOptions&&a.layerDrawingOptions[e.id]&&(g=a.layerDrawingOptions[e.id]);g&&(d.drawingInfo=g.toJson());d.minScale=e.minScale||0;d.maxScale=e.maxScale||0;b.push(d)});return b},_getSublayerIdent:function(a){var b;this._sublayerIdent[a]?(b=new h,b.resolve(this._sublayerIdent[a])):b=this._layerAndTableRequest(a);return b},_layerAndTableRequest:function(a){return 10.11<=this.layerObject.version?this._allLayerAndTableServer(a):this._allLayerAndTable(a)},_allLayerAndTableServer:function(a){var b=
new h,d=this.originOperLayer.url+"/layers";this._sublayerIdent.empty?(this._sublayerIdent.empty=!1,this._request(d).then(k.hitch(this,function(d){this._sublayerIdent.idents=d.layers;this._sublayerIdent.defLoad.resolve();b.resolve(this._sublayerIdent.idents[a])}),k.hitch(this,function(a){console.err(a.message||a);this._sublayerIdent.defLoad.reject();this._sublayerIdent.defLoad=new h;this._sublayerIdent.empty=!0;b.resolve(null)}))):this._sublayerIdent.defLoad.then(k.hitch(this,function(){b.resolve(this._sublayerIdent.idents[a])}),
function(a){console.err(a.message||a);b.resolve(null)});return b},_allLayerAndTable:function(a){var b=new h;this._request(this.originOperLayer.url+"/"+a).then(k.hitch(this,function(d){this._sublayerIdent.idents[a]=d;b.resolve(d)}),function(a){console.err(a.message||a);b.resolve(null)});return b},_request:function(a){return t({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"})}})})},"jimu/LayerInfos/LayerInfoForDefaultDynamic":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfoForDefaultService".split(" "),
function(p,g,k,h,f,m){return p(m,{constructor:function(e,f){},initVisible:function(){var e=!1,f=this.originOperLayer.mapService;this.originOperLayer.mapService&&0<f.layerInfo.subLayerVisible[f.subId]&&(e=!0);this._visible=e},_setTopLayerVisible:function(e){var f;this.originOperLayer.mapService&&(f=this.originOperLayer.mapService,e?f.layerInfo.subLayerVisible[f.subId]++:f.layerInfo.subLayerVisible[f.subId]--,this._visible=e,this.visbleOrInvisilbe())},visbleOrInvisilbe:function(){var e=this.originOperLayer.mapService;
e.layerInfo.setSubLayerVisible(e.subId,this.isVisbleOrInvisilbe())},isVisbleOrInvisilbe:function(){for(var e=this.originOperLayer.mapService,f=-1,d=e.subId,b=0,g=e.layerInfo.layerObject.layerInfos;;){f++;b+=e.layerInfo.subLayerVisible[d];if(-1===g[d].parentLayerId)return b>f?!0:!1;d=g[d].parentLayerId}}})})},"jimu/LayerInfos/LayerInfoForDefaultService":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred dojo/dom-construct dojo/dom-attr dojo/query ./LayerInfoForDefault esri/layers/FeatureLayer".split(" "),
function(p,g,k,h,f,m,e,q,d){return p(q,{_legendsNode:null,loadLegends:function(b){this.originOperLayer.mapService.layerInfo.getLegendInfo(b).then(k.hitch(this,function(b){this.initLegendsNode(b)}))},initLegendsNode:function(b){var d=this.originOperLayer.mapService,n=e(".legends-loading-img",this._legendsNode)[0];if(b&&n){f.empty(this._legendsNode);for(var n=null,h=0;h<b.length;h++)if(b[h].layerId===d.subId){n=b[h];break}n&&g.forEach(n.legend,function(a){if("\x3call other values\x3e"!==a.label){var c=
f.create("div",{"class":"legend-div"},this._legendsNode),b=f.create("div",{"class":"legend-symbol",style:"width:50px;height:50px;position:relative"},c),d=null,d=a.imageData?"data:"+a.contentType+";base64,"+a.imageData:a.url;f.create("img",{"class":"legend-symbol-image",style:"overflow:auto;margin:auto;position:absolute;top:0;left:0;bottom:0;right:0",src:d},b);f.create("div",{"class":"legend-label",innerHTML:a.label||" "},c)}},this)}},getLayerObject:function(){var b=new h;this.layerObject.empty?(this.layerObject=
new d(this.layerObject.url),this.layerObject.on("load",k.hitch(this,function(){b.resolve(this.layerObject)})),this.layerObject.on("error",k.hitch(this,function(){b.resolve(null)}))):b.resolve(this.layerObject);return b},getPopupInfo:function(){var b=null,d=this.originOperLayer.mapService.layerInfo.originOperLayer.layers;if(d)for(var e=0;e<d.length;e++)if(d[e].id===this.originOperLayer.mapService.subId){b=d[e].popupInfo;break}return b},getLayerType:function(){var b=new h,d=this.originOperLayer.mapService;
d.layerInfo._getSublayerIdent(d.subId).then(k.hitch(this,function(d){d?b.resolve(d.type.replace(/\ /g,"")):b.resolve(null)}));return b}})})},"jimu/LayerInfos/LayerInfoForDefaultTile":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfoForDefaultService".split(" "),function(p,g,k,h,f,m){return p(m,{constructor:function(e,f){this.noLegend=!0},getExtent:function(){},initVisible:function(){},_setTopLayerVisible:function(e){},setLayerVisiblefromTopLayer:function(){},
getOpacity:function(){},setOpacity:function(e){},isShowInMap:function(){return this.originOperLayer.mapService.layerInfo.layerObject.visible}})})},"jimu/LayerInfos/LayerInfoForGroup":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/aspect dojo/Deferred esri/request ./LayerInfoForDefault ./LayerInfoForDefaultDynamic ./LayerInfoForDefaultTile ./LayerInfo ./LayerInfoFactory".split(" "),function(p,g,k,h,f,m,e,q,d,b,r){return p(b,{constructor:function(b,d,a){this.noLegend=a;
this.popupMenuInfo.menuItems=[{key:"description",label:'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d'+(this.layerObject&&this.layerObject.url?this.layerObject.url:"")+"\x3e"+this.nls.itemDesc+"\x3c/a\x3e"}]},getExtent:function(){},initVisible:function(){var b=!1,d=this.originOperLayer.mapService;this.originOperLayer.mapService&&0<d.layerInfo.subLayerVisible[d.subId]&&(b=!0);this._visible=b},_setTopLayerVisible:function(b){var d;this.originOperLayer.mapService&&(d=this.originOperLayer.mapService,
0<this.originOperLayer.subLayers.length&&(b?d.layerInfo.subLayerVisible[d.subId]++:d.layerInfo.subLayerVisible[d.subId]--,this._visible=b,this.traversal(function(a){0===a.getSubLayers().length&&a.visbleOrInvisilbe()})))},setLayerVisiblefromTopLayer:function(){},obtainNewSubLayers:function(){var b=[];g.forEach(this.originOperLayer.subLayers,function(d){d.parentLayerInfo=this;d=r.getInstance().create(d);b.push(d);d.init()},this);return b},getOpacity:function(){},setOpacity:function(b){},getLayerObject:function(){var b=
new f;this.layerObject.empty?m({url:this.layerObject.url,handleAs:"json",callbackParamName:"callback",timeout:1E5,content:{f:"json"}}).then(k.hitch(this,function(d){var a=this.layerObject.url;this.layerObject=d;this.layerObject[a]=a;b.resolve(this.layerObject)}),function(d){b.reject(d)}):b.resolve(this.layerObject);return b},getLayerType:function(){var b=new f;b.resolve("GroupLayer");return b}})})},"jimu/LayerInfos/LayerInfoForKML":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefault dojo/Deferred".split(" "),
function(p,g,k,h,f,m,e,q){return p(m,{constructor:function(d,b){for(var e=-1,f=0,f=0;f<this.popupMenuInfo.menuItems.length;f++)if("description"===this.popupMenuInfo.menuItems[f].key){e=f;break}this.popupMenuInfo.menuItems.splice(e,1,{key:"download",label:'\x3ca class\x3d"menu-item-description" target\x3d"_blank" href\x3d'+(this.layerObject&&this.layerObject.url?this.layerObject.url:"")+"\x3e"+this.nls.itemDownload+"\x3c/a\x3e"})},getExtent:function(){var d=this.originOperLayer.layerObject.getLayers(),
b=null,e;g.forEach(d,function(d){e=this._convertGeometryToMapSpatialRef(d.initialExtent);b=b?b.union(e):e},this);return b},initVisible:function(){this._visible=this.originOperLayer.layerObject.visible},_setTopLayerVisible:function(d){d?this.originOperLayer.layerObject.show():this.originOperLayer.layerObject.hide();this._visible=d},obtainNewSubLayers:function(){var d=[],b=this.originOperLayer.layerObject.getLayers();g.forEach(b,function(b){this._getLayerIndexesInMapByLayerId(b.id)&&(b=new e({layerObject:b,
title:b.label||b.title||b.name||b.id||" ",id:b.id||" ",selfType:"kml",url:b.url,parentLayerInfo:this},this.map),d.push(b),b.init())},this);return d}})})},"jimu/LayerInfos/LayerInfoForGeoRSS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect dojo/Deferred ./LayerInfo ./LayerInfoForDefault ./LayerInfoFactory".split(" "),function(p,g,k,h,f,m,e,q,d){return p(e,{constructor:function(){},getExtent:function(){var b=this.layerObject.items;if(0===b.length)return null;
b=h.graphicsExtent(b);return this._convertGeometryToMapSpatialRef(b)},initVisible:function(){var b=!1,d;if(this.newSubLayers.length)for(d=0;d<this.newSubLayers.length;d++)b=b||this.newSubLayers[d].layerObject.visible;else b=!1;this._visible=b},_setTopLayerVisible:function(b){this._visible=b?!0:!1;g.forEach(this.newSubLayers,function(b){b.setLayerVisiblefromTopLayer()},this)},obtainNewSubLayers:function(){var b=[],e=this.layerObject.getFeatureLayers();g.forEach(e,function(e){e=d.getInstance().create({layerObject:e,
title:e.label||e.title||e.name||e.id||" ",id:e.id||" ",collection:{layerInfo:this},selfType:"geo_rss",url:e.url,parentLayerInfo:this});b.push(e);e.init()},this);return b},_obtainLayerIndexesInMap:function(){var b=[],d,e;for(e=0;e<this.newSubLayers.length;e++)(d=this._getLayerIndexesInMapByLayerId(this.newSubLayers[e].layerObject.id))&&b.push(d);return b},moveLeftOfIndex:function(b){var d;for(d=this.newSubLayers.length-1;0<=d;d--)this.map.reorderLayer(this.newSubLayers[d].layerObject,b)},moveRightOfIndex:function(b){var d;
for(d=0;d<this.newSubLayers.length;d++)this.map.reorderLayer(this.newSubLayers[d].layerObject,b)}})})},"jimu/LayerInfos/LayerInfoForWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/Deferred esri/graphicsUtils dojo/aspect ./LayerInfo ./LayerInfoForDefaultWMS ./LayerInfoFactory esri/layers/FeatureLayer".split(" "),function(p,g,k,h,f,m,e,q,d,b){return p(e,{constructor:function(b,d){this.layerObject=b.layerObject},getExtent:function(){return this._convertGeometryToMapSpatialRef(this.originOperLayer.layerObject.extent)},
initVisible:function(){this._visible=this.layerObject.visible},_setTopLayerVisible:function(b){b?this.layerObject.setVisibility(!0):this.layerObject.setVisibility(!1);this._visible=b;g.forEach(this.newSubLayers,function(b){b.setLayerVisiblefromTopLayer()},this)},obtainNewSubLayers:function(){var b=[];g.forEach(this.layerObject.layerInfos,function(e){e=d.getInstance().create({layerObject:this.layerObject,title:e.label||e.title||e.name||" ",id:e.name||" ",wms:{layerInfo:this,subId:e.name},selfType:"wms",
url:this.layerObject.url,parentLayerInfo:this});b.push(e);e.init()},this);return b}})})},"jimu/LayerInfos/LayerInfoForDefaultWMS":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang esri/graphicsUtils dojo/aspect ./LayerInfoForDefault".split(" "),function(p,g,k,h,f,m){return p(m,{constructor:function(e,f){this.layerObject=e.layerObject},getExtent:function(){},initVisible:function(){var e=[],e=!1,e=k.clone(this.originOperLayer.layerObject.visibleLayers);this._visible=e=0<=g.indexOf(e,
this.originOperLayer.id)?!0:!1},_setTopLayerVisible:function(e){this.originOperLayer.layerObject.visible?e?(this._show(),this._visible=!0):(this._hide(),this._visible=!1):e?(this._hide(),this._visible=!0):(this._hide(),this._visible=!1)},_show:function(){var e=[],e=k.clone(this.originOperLayer.layerObject.visibleLayers);0>g.indexOf(e,this.id)&&(e.push(this.id),this.originOperLayer.layerObject.setVisibleLayers(e))},_hide:function(){var e=[],f,e=k.clone(this.originOperLayer.layerObject.visibleLayers);
f=g.indexOf(e,this.id);0<=f&&e.splice(f,1);this.originOperLayer.layerObject.setVisibleLayers(e)},setLayerVisiblefromTopLayer:function(){this.originOperLayer.layerObject.visible?this._visible&&this._show():this._hide()},_obtainLegendInfos:function(e){return[]},obtainNewSubLayers:function(){return[]},getOpacity:function(){},setOpacity:function(e){}})})},"jimu/dijit-all":function(){define([],1)},"jimu/dijit/RadioBtn":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dojo/dom-construct dijit/registry".split(" "),
function(p,g,k,h,f,m,e,q){return p(g,{"class":"jimu-radio",checked:!1,group:null,constructor:function(){},postCreate:function(){e.create("div",{"class":"jimu-radio-inner"},this.domNode);this.checked&&m.add(this.domNode,"jimu-radio-checked");this.own(f(this.domNode,"click",k.hitch(this,function(){this.checked||this.check()})))},check:function(d){void 0===d&&(d=!0);this.checked=!0;m.add(this.domNode,"jimu-radio-checked");d&&this._changeOthersState(!1);this.onStateChange()},uncheck:function(d){void 0===
d&&(d=!0);this.checked=!1;m.remove(this.domNode,"jimu-radio-checked");d&&this._changeOthersState(!1);this.onStateChange()},_changeOthersState:function(d){null!==this.group&&h.forEach(q.toArray(),function(b){b.id!==this.id&&(b["class"]===this["class"]&&b.group===this.group)&&(d?b.check(!1):b.uncheck(!1))},this)},onStateChange:function(){}})})},"jimu/dijit/CheckBox":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/_base/lang","dojo/_base/html","dojo/on"],function(p,g,k,h,f){return p(g,
{"class":"jimu-checkbox",checked:!1,status:!0,postCreate:function(){this.checkNode=h.create("div",{"class":"checkbox"},this.domNode);this.label&&(this.labelNode=h.create("div",{"class":"label",innerHTML:this.label},this.domNode));this.checked&&h.addClass(this.checkNode,"checked");this.own(f(this.checkNode,"click",k.hitch(this,function(){this.checked&&this.status?this.uncheck():this.status&&this.check()})));this.label&&this.own(f(this.labelNode,"click",k.hitch(this,function(){this.checked&&this.status?
this.uncheck():this.status&&this.check()})))},setValue:function(f){!0===f?this.check():this.uncheck()},getValue:function(){return this.checked},setStatus:function(f){this.status=f;this.labelNode&&(f?h.setStyle(this.labelNode,"color","#000000"):h.setStyle(this.labelNode,"color","#818181"))},check:function(){this.checked=!0;h.addClass(this.checkNode,"checked");this.onStateChange()},uncheck:function(f){this.checked=!1;h.removeClass(this.checkNode,"checked");if(!f)this.onStateChange()},onStateChange:function(){if(this.onChange&&
k.isFunction(this.onChange))this.onChange(this.checked)}})})},"jimu/dijit/SymbolChooser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SymbolChooser.html dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojox/gfx dojo/_base/Color dojo/request/xhr dijit/form/Select dijit/form/NumberSpinner jimu/dijit/ColorPicker jimu/dijit/_Transparency jimu/utils jimu/symbolUtils esri/request esri/symbols/jsonUtils esri/symbols/SimpleMarkerSymbol esri/symbols/PictureMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/CartographicLineSymbol esri/symbols/SimpleFillSymbol esri/symbols/TextSymbol esri/symbols/Font".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z,A,x,u,C,E,F,y,v,I,D){return p([g,k,h,m],{templateString:f,baseClass:"jimu-symbol-chooser",declaredClass:"jimu.dijit.SymbolChooser",nls:null,_pointEventsBinded:!1,_lineEventBinded:!1,_fillEventBinded:!1,_textEventBinded:!1,_invokeSymbolChangeEvent:!0,symbol:null,type:null,postMixInProperties:function(){this.nls=window.jimuNls.symbolChooser},postCreate:function(){this.inherited(arguments);this.symbol?this.showBySymbol(this.symbol):this.type&&this.showByType(this.type)},
reset:function(){this.symbol=this.type=null;this._hideAllSections()},showBySymbol:function(a){this.reset();var c=a&&a.declaredClass;c&&("string"===typeof c&&0<=c.indexOf("esri.symbol"))&&(this.symbol=this._cloneSymbol(a),this.isSimpleMarkerSymbol(this.symbol)||this.isPictureMarkerSymbol(this.symbol)?(this.type="marker",this._initPointSection()):this.isSimpleLineSymbol(this.symbol)?(this.type="line",this._initLineSection()):this._isSimpleFillSymbol(this.symbol)?(this.type="fill",this._initFillSection()):
this._isTextSymbol(this.symbol)&&(this.type="text",this._initTextSection()))},showByType:function(a){this.reset();if("marker"===a||"line"===a||"fill"===a||"text"===a)this.type=a,"marker"===this.type?this._initPointSection():"line"===this.type?this._initLineSection():"fill"===this.type?this._initFillSection():"text"===this.type&&this._initTextSection()},getSymbol:function(){var a=null;"marker"===this.type?a=this._getPointSymbolBySetting():"line"===this.type?a=this._getLineSymbolBySetting():"fill"===
this.type?a=this._getFillSymbolBySetting():"text"===this.type&&(a=this._getTextSymbolBySetting());var c=null;a&&(c=this._cloneSymbol(a));return c},_onChange:function(a){a=this._cloneSymbol(a);this.emit("change",a)},_hideAllSections:function(){r(".symbol-section",this.domNode).style("display","none")},_showSection:function(a){this._hideAllSections();r("."+a+"-symbol-section",this.domNode).style("display","block")},_getAncestor:function(a,c,b){return z.getAncestorDom(a,c,b)},_getAbsoluteUrl:function(a){return window.location.protocol+
"//"+window.location.host+require.toUrl(a)},_cloneSymbol:function(a){if(!a)return null;var c=a;try{var b=a.toJson(),c=u.fromJson(b)}catch(d){console.error(d)}return c},_createSymbolIconTable:function(a,c){for(var b=this.type+"-icon-table",b=q.toDom('\x3ctable class\x3d"'+("icon-table "+b+" "+(b+"-"+a))+'"\x3e\x3ctbody\x3e\x3c/tbody\x3e\x3c/table\x3e'),f=r("tbody",b)[0],g=Math.ceil(c.length/8),l=0;l<g;l++)q.create("tr",{},f);var n=r("tr",b);d.forEach(c,e.hitch(this,function(a,c){var b=e.clone(a),d=
u.fromJson(a),f=q.create("td",{},n[Math.floor(c/8)]);q.addClass(f,"symbol-td-item");d=this._createSymbolNode(d);q.addClass(d,"symbol-div-item");d.symbol=b;q.place(d,f)}));return b},_updatePreview:function(a){var c=this._cloneSymbol(this.symbol);q.empty(a);(c=A.createSymbolNode(c))||(c=q.create("div"));q.place(c,a)},_createSymbolNode:function(a){(a=A.createSymbolNode(a,{width:32,height:32}))||(a=q.create("div"));q.setStyle(a,{width:"36px",height:"36px"});return a},_getLineShapeDesc:function(a){var c=
null;if(this.isSimpleLineSymbol(a)||this.isCartographicLineSymbol(a))c={defaultShape:{type:"path",path:"M -90,0 L 90,0 E"},fill:null,stroke:a.getStroke()};return c},_initPointSection:function(){this._showSection("point");this._pointEventsBinded||(this._pointEventsBinded=!0,this._bindPointEvents(),this._onPointSymClassSelectChange());this.isPictureMarkerSymbol(this.symbol)?this._showPictureMarkerSymSettings():(this.isSimpleMarkerSymbol(this.symbol)||(this.symbol=new C({style:"esriSMSCircle",color:[0,
0,128,128],name:"Circle",outline:{color:[0,0,128,255],width:1},type:"esriSMS",size:18})),this._showSimpleMarkerSymSettings());this._initPointSettings(this.symbol);this._getPointSymbolBySetting()},_bindPointEvents:function(){this.own(b(this.pointIconTables,".symbol-div-item:click",e.hitch(this,this._onPointSymIconItemClick)));this.own(b(this.pointSymClassSelect,"Change",e.hitch(this,this._onPointSymClassSelectChange)));this.own(b(this.pointSize,"change",e.hitch(this,this._onPointSymbolChange)));this.own(b(this.pointColor,
"change",e.hitch(this,this._onPointSymbolChange)));this.own(b(this.pointAlpha,"change",e.hitch(this,this._onPointSymbolChange)));this.own(b(this.pointOutlineColor,"change",e.hitch(this,this._onPointSymbolChange)));this.own(b(this.pointOutlineWidth,"change",e.hitch(this,this._onPointSymbolChange)))},_onPointSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getPointSymbolBySetting(),this._onChange(this.symbol))},_initPointSettings:function(a){if(a){this._invokeSymbolChangeEvent=!1;if(this.isSimpleMarkerSymbol(a)){if(this.pointSize.set("value",
a.size),this.pointColor.setColor(a.color),this.pointAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),a=a.outline)this.pointOutlineColor.setColor(a.color),this.pointOutlineWidth.set("value",parseFloat(a.width.toFixed(0)))}else this.isPictureMarkerSymbol(a)&&this.pointSize.set("value",a.width);this._invokeSymbolChangeEvent=!0}},isSimpleMarkerSymbol:function(a){return a&&"esri.symbol.SimpleMarkerSymbol"===a.declaredClass},isPictureMarkerSymbol:function(a){return a&&"esri.symbol.PictureMarkerSymbol"===
a.declaredClass},_onPointSymClassSelectChange:function(){this._showSelectedPointSymIconTable();var a=this.pointSymClassSelect.get("value");this.pointSymClassSelect["def"+a]||this._requestPointSymJson(a)},_showSelectedPointSymIconTable:function(){var a=this.pointSymClassSelect.get("value");r(".marker-icon-table",this.pointIconTables).style("display","none");a=r(".marker-icon-table-"+a,this.pointIconTables);0<a.length&&a.style("display","table")},_requestPointSymJson:function(c){var b="def"+c,d=this.pointSymClassSelect[b];
d||(d=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+c+".json"),d=a(d,{handleAs:"json"}),this.pointSymClassSelect[b]=d,d.then(e.hitch(this,function(a){a=this._createSymbolIconTable(c,a);q.place(a,this.pointIconTables);this._showSelectedPointSymIconTable()}),e.hitch(this,function(a){console.error("get point symbol failed",a)})))},_onPointSymIconItemClick:function(a){if(a=this._getAncestor(a.target||a.srcElement,function(a){return q.hasClass(a,"symbol-div-item")},5))if(r(".selected-symbol-div-item",
a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),q.addClass(a,"selected-symbol-div-item"),a=a.symbol)this.symbol=u.fromJson(a),this.isSimpleMarkerSymbol(this.symbol)?this._showSimpleMarkerSymSettings():this._showPictureMarkerSymSettings(),this._onPointSymbolChange()},_showSimpleMarkerSymSettings:function(){q.setStyle(this.pointColorTr,"display","");q.setStyle(this.pointOpacityTr,"display","");q.setStyle(this.pointOutlineColorTr,"display","");q.setStyle(this.pointOulineWidthTr,
"display","")},_showPictureMarkerSymSettings:function(){q.setStyle(this.pointColorTr,"display","none");q.setStyle(this.pointOpacityTr,"display","none");q.setStyle(this.pointOutlineColorTr,"display","none");q.setStyle(this.pointOulineWidthTr,"display","none")},_getPointSymbolBySetting:function(){if(!this.symbol)return null;var a=parseFloat(this.pointSize.get("value"));if(this.isSimpleMarkerSymbol(this.symbol)){this.symbol.setSize(a);var a=this.pointColor.getColor(),c=this.pointAlpha.getAlpha();a.a=
c;this.symbol.setColor(a);var a=this.pointOutlineColor.getColor(),c=parseFloat(this.pointOutlineWidth.get("value")),b=new F;b.setStyle(F.STYLE_SOLID);b.setColor(a);b.setWidth(c);this.symbol.setOutline(b)}else this.isPictureMarkerSymbol(this.symbol)&&(this.symbol.setWidth(a),this.symbol.setHeight(a));this._updatePreview(this.pointSymPreview);return this.symbol},_initLineSection:function(){this._showSection("line");this._lineEventBinded||(this._lineEventBinded=!0,this._bindLineEvents(),this._requestLineSymJson("line"));
this._initLineSettings(this.symbol);this._getLineSymbolBySetting()},_bindLineEvents:function(){this.own(b(this.lineIconTables,".symbol-div-item:click",e.hitch(this,this._onLineSymIconItemClick)));this.own(b(this.lineColor,"change",e.hitch(this,this._onLineSymbolChange)));this.own(b(this.lineStylesSelect,"change",e.hitch(this,this._onLineSymbolChange)));this.own(b(this.lineAlpha,"change",e.hitch(this,this._onLineSymbolChange)));this.own(b(this.lineWidth,"change",e.hitch(this,this._onLineSymbolChange)))},
_onLineSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getLineSymbolBySetting(),this._onChange(this.symbol))},_initLineSettings:function(a){a&&(this._invokeSymbolChangeEvent=!1,this.lineColor.setColor(a.color),this.lineAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),this.lineWidth.set("value",parseFloat(a.width.toFixed(0))),this.lineStylesSelect.set("value",a.style),this._invokeSymbolChangeEvent=!0)},isSimpleLineSymbol:function(a){return a&&"esri.symbol.SimpleLineSymbol"===a.declaredClass},
isCartographicLineSymbol:function(a){return a&&"esri.symbol.CartographicLineSymbol"===a.declaredClass},_requestLineSymJson:function(c){var b=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+c+".json");a(b,{handleAs:"json"}).then(e.hitch(this,function(a){a=this._createSymbolIconTable(c,a);q.place(a,this.lineIconTables)}),e.hitch(this,function(a){console.error("get line symbol failed",a)}))},_onLineSymIconItemClick:function(a){if(a=this._getAncestor(a.target||a.srcElement,function(a){return q.hasClass(a,
"symbol-div-item")},5))if(r(".selected-symbol-div-item",a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),q.addClass(a,"selected-symbol-div-item"),a=a.symbol)a=u.fromJson(a),this._initLineSettings(a),this._onLineSymbolChange()},_getLineSymbolBySetting:function(){this.symbol=new F;var a=this.lineColor.getColor(),c=this.lineStylesSelect.get("value");a.a=this.lineAlpha.getAlpha();var b=parseFloat(this.lineWidth.get("value"));this.symbol.setStyle(c);this.symbol.setColor(a);this.symbol.setWidth(b);
this._updatePreview(this.lineSymPreview);return this.symbol},_initFillSection:function(){this._showSection("fill");this._fillEventBinded||(this._fillEventBinded=!0,this._bindFillEvents(),this._requestFillSymJson("fill"));this._initFillSettings(this.symbol);this._getFillSymbolBySetting()},_bindFillEvents:function(){this.own(b(this.fillIconTables,".symbol-div-item:click",e.hitch(this,this._onFillSymIconItemClick)));this.own(b(this.fillColor,"change",e.hitch(this,this._onFillSymbolChange)));this.own(b(this.fillAlpha,
"change",e.hitch(this,this._onFillSymbolChange)));this.own(b(this.fillOutlineColor,"change",e.hitch(this,this._onFillSymbolChange)));this.own(b(this.fillOutlineWidth,"change",e.hitch(this,this._onFillSymbolChange)))},_onFillSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getFillSymbolBySetting(),this._onChange(this.symbol))},_initFillSettings:function(a){a&&(this._invokeSymbolChangeEvent=!1,this.fillColor.setColor(a.color),this.fillAlpha.setAlpha(parseFloat(a.color.a.toFixed(2))),a.outline&&
(this.fillOutlineColor.setColor(a.outline.color),this.fillOutlineWidth.set("value",parseInt(a.outline.width,10))),this._invokeSymbolChangeEvent=!0)},_isSimpleFillSymbol:function(a){return a&&"esri.symbol.SimpleFillSymbol"===a.declaredClass},_requestFillSymJson:function(c){var b=this._getAbsoluteUrl("jimu/dijit/SymbolsInfo/"+c+".json");a(b,{handleAs:"json"}).then(e.hitch(this,function(a){a=this._createSymbolIconTable(c,a);q.place(a,this.fillIconTables)}),e.hitch(this,function(a){console.error("get fill symbol failed",
a)}))},_onFillSymIconItemClick:function(a){if(a=this._getAncestor(a.target||a.srcElement,function(a){return q.hasClass(a,"symbol-div-item")},5))if(r(".selected-symbol-div-item",a.parentNode.parentNode.parentNode).removeClass("selected-symbol-div-item"),q.addClass(a,"selected-symbol-div-item"),a=a.symbol)a=u.fromJson(a),this._initFillSettings(a),this._onFillSymbolChange()},_getFillSymbolBySetting:function(){this.symbol=new v;var a=this.fillColor.getColor();a.a=this.fillAlpha.getAlpha();var c=this.fillOutlineColor.getColor(),
b=parseInt(this.fillOutlineWidth.get("value"),10);this.symbol.setColor(a);this.symbol.setStyle(v.STYLE_SOLID);a=new F;a.setStyle(F.STYLE_SOLID);a.setColor(c);a.setWidth(b);this.symbol.setOutline(a);this._updatePreview(this.fillSymPreview);return this.symbol},_initTextSection:function(){this._showSection("text");this._textEventBinded||(this._textEventBinded=!0,this._bindTextEvents());this._initTextSettings();this._getTextSymbolBySetting()},_bindTextEvents:function(){this.own(b(this.inputText,"change",
e.hitch(this,this._onTextSymbolChange)));this.own(b(this.textColor,"change",e.hitch(this,this._onTextSymbolChange)));this.own(b(this.textFontSize,"change",e.hitch(this,this._onTextSymbolChange)))},_onTextSymbolChange:function(){this._invokeSymbolChangeEvent&&(this._getTextSymbolBySetting(),this._onChange(this.symbol))},_initTextSettings:function(a){a&&(this._invokeSymbolChangeEvent=!1,this.inputText.value=a.text,this.textColor.setColor(a.color),a=parseInt(a.font.size,10),this.textFontSize.set("value",
a),this._invokeSymbolChangeEvent=!0)},_isTextSymbol:function(a){return a&&"esri.symbol.TextSymbol"===a.declaredClass},_updateTextPreview:function(){var a=this.textColor.getColor().toHex(),c=parseInt(this.textFontSize.get("value"),10)+"px";q.setStyle(this.textPreview,{color:a,fontSize:c});this.textPreview.innerHTML=this.inputText.value},_getTextSymbolBySetting:function(){this.symbol=new I;var a=this.inputText.value,c=this.textColor.getColor(),b=parseInt(this.textFontSize.get("value"),10),d=new D;d.setSize(b);
this.symbol.setText(a);this.symbol.setColor(c);this.symbol.setFont(d);this._updateTextPreview();return this.symbol}})})},"dijit/form/Select":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/i18n dojo/keys dojo/_base/lang dojo/on dojo/sniff ./_FormSelectWidget ../_HasDropDown ../DropDownMenu ../MenuItem ../MenuSeparator ../Tooltip ../_KeyNavMixin ../registry dojo/text!./templates/Select.html dojo/i18n!./nls/validate".split(" "),function(p,g,
k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z){function A(a){return function(c){this._isLoaded?this.inherited(a,arguments):this.loadDropDown(q.hitch(this,a,c))}}var x=g("dijit.form._SelectMenu",t,{autoFocus:!0,buildRendering:function(){this.inherited(arguments);this.domNode.setAttribute("role","listbox")},postCreate:function(){this.inherited(arguments);this.own(d(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}))},focus:function(){var a=!1,c=this.parentWidget.value;q.isArray(c)&&
(c=c[c.length-1]);c&&p.forEach(this.parentWidget._getChildren(),function(b){b.option&&c===b.option.value&&(a=!0,this.focusChild(b,!1))},this);a||this.inherited(arguments)}});f=g("dijit.form.Select"+(b("dojo-bidi")?"_NoBidi":""),[r,n,l],{baseClass:"dijitSelect dijitValidationTextBox",templateString:z,_buttonInputDisabled:b("ie")?"disabled":"",required:!1,state:"",message:"",tooltipPosition:[],emptyLabel:"\x26#160;",_isLoaded:!1,_childrenLoaded:!1,labelType:"html",_fillContent:function(){this.inherited(arguments);
if(this.options.length&&!this.value&&this.srcNodeRef){var a=this.srcNodeRef.selectedIndex||0;this._set("value",this.options[0<=a?a:0].value)}this.dropDown=new x({id:this.id+"_menu",parentWidget:this});h.add(this.dropDown.domNode,this.baseClass.replace(/\s+|$/g,"Menu "))},_getMenuItemForOption:function(b){if(!b.value&&!b.label)return new c({ownerDocument:this.ownerDocument});var d=q.hitch(this,"_setValueAttr",b);b=new a({option:b,label:("text"===this.labelType?(b.label||"").toString().replace(/&/g,
"\x26amp;").replace(/</g,"\x26lt;"):b.label)||this.emptyLabel,onClick:d,ownerDocument:this.ownerDocument,dir:this.dir,textDir:this.textDir,disabled:b.disabled||!1});b.focusNode.setAttribute("role","option");return b},_addOptionItem:function(a){this.dropDown&&this.dropDown.addChild(this._getMenuItemForOption(a))},_getChildren:function(){return!this.dropDown?[]:this.dropDown.getChildren()},focus:function(){if(!this.disabled&&this.focusNode.focus)try{this.focusNode.focus()}catch(a){}},focusChild:function(a){a&&
this.set("value",a.option)},_getFirst:function(){var a=this._getChildren();return a.length?a[0]:null},_getLast:function(){var a=this._getChildren();return a.length?a[a.length-1]:null},childSelector:function(a){return(a=w.byNode(a))&&a.getParent()==this.dropDown},onKeyboardSearch:function(a,c,b,d){a&&this.focusChild(a)},_loadChildren:function(c){if(!0===c)if(this.dropDown&&(delete this.dropDown.focusedChild,this.focusedChild=null),this.options.length)this.inherited(arguments);else{p.forEach(this._getChildren(),
function(a){a.destroyRecursive()});var b=new a({ownerDocument:this.ownerDocument,label:this.emptyLabel});this.dropDown.addChild(b)}else this._updateSelection();this._isLoaded=!1;this._childrenLoaded=!0;this._loadingStore||this._setValueAttr(this.value,!1)},_refreshState:function(){this._started&&this.validate(this.focused)},startup:function(){this.inherited(arguments);this._refreshState()},_setValueAttr:function(a){this.inherited(arguments);k.set(this.valueNode,"value",this.get("value"));this._refreshState()},
_setNameAttr:"valueNode",_setDisabledAttr:function(a){this.inherited(arguments);this._refreshState()},_setRequiredAttr:function(a){this._set("required",a);this.focusNode.setAttribute("aria-required",a);this._refreshState()},_setOptionsAttr:function(a){this._isLoaded=!1;this._set("options",a)},_setDisplay:function(a){a=("text"===this.labelType?(a||"").replace(/&/g,"\x26amp;").replace(/</g,"\x26lt;"):a)||this.emptyLabel;this.containerNode.innerHTML='\x3cspan role\x3d"option" class\x3d"dijitReset dijitInline '+
this.baseClass.replace(/\s+|$/g,"Label ")+'"\x3e'+a+"\x3c/span\x3e"},validate:function(a){a=this.disabled||this.isValid(a);this._set("state",a?"":this._hasBeenBlurred?"Error":"Incomplete");this.focusNode.setAttribute("aria-invalid",a?"false":"true");var c=a?"":this._missingMsg;c&&this.focused&&this._hasBeenBlurred?s.show(c,this.domNode,this.tooltipPosition,!this.isLeftToRight()):s.hide(this.domNode);this._set("message",c);return a},isValid:function(){return!this.required||0===this.value||!/^\s*$/.test(this.value||
"")},reset:function(){this.inherited(arguments);s.hide(this.domNode);this._refreshState()},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=m.getLocalization("dijit.form","validate",this.lang).missingMessage},postCreate:function(){this.inherited(arguments);this.own(d(this.domNode,"selectstart",function(a){a.preventDefault();a.stopPropagation()}));this.domNode.setAttribute("aria-expanded","false");var a=this._keyNavCodes;delete a[e.LEFT_ARROW];delete a[e.RIGHT_ARROW]},_setStyleAttr:function(a){this.inherited(arguments);
h.toggle(this.domNode,this.baseClass.replace(/\s+|$/g,"FixedWidth "),!!this.domNode.style.width)},isLoaded:function(){return this._isLoaded},loadDropDown:function(a){this._loadChildren(!0);this._isLoaded=!0;a()},destroy:function(a){this.dropDown&&!this.dropDown._destroyed&&(this.dropDown.destroyRecursive(a),delete this.dropDown);s.hide(this.domNode);this.inherited(arguments)},_onFocus:function(){this.validate(!0)},_onBlur:function(){s.hide(this.domNode);this.inherited(arguments);this.validate(!1)}});
b("dojo-bidi")&&(f=g("dijit.form.Select",f,{_setDisplay:function(a){this.inherited(arguments);this.applyTextDir(this.containerNode)}}));f._Menu=x;f.prototype._onContainerKeydown=A("_onContainerKeydown");f.prototype._onContainerKeypress=A("_onContainerKeypress");return f})},"dijit/form/_FormSelectWidget":function(){define("dojo/_base/array dojo/_base/Deferred dojo/aspect dojo/data/util/sorter dojo/_base/declare dojo/dom dojo/dom-class dojo/_base/kernel dojo/_base/lang dojo/query dojo/when dojo/store/util/QueryResults ./_FormValueWidget".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t){return f("dijit.form._FormSelectWidget",t,{multiple:!1,options:null,store:null,_setStoreAttr:function(a){this._created&&this._deprecatedSetStore(a)},query:null,_setQueryAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{query:a})},queryOptions:null,_setQueryOptionsAttr:function(a){this._created&&this._deprecatedSetStore(this.store,this.selectedValue,{queryOptions:a})},labelAttr:"",onFetch:null,sortByLabel:!0,loadChildrenOnOpen:!1,
onLoadDeferred:null,getOptions:function(a){var c=this.options||[];if(null==a)return c;if(d.isArray(a))return p.map(a,"return this.getOptions(item);",this);d.isString(a)&&(a={value:a});d.isObject(a)&&(p.some(c,function(c,b){for(var d in a)if(!(d in c)||c[d]!=a[d])return!1;a=b;return!0})||(a=-1));return 0<=a&&a<c.length?c[a]:null},addOption:function(a){p.forEach(d.isArray(a)?a:[a],function(a){a&&d.isObject(a)&&this.options.push(a)},this);this._loadChildren()},removeOption:function(a){a=this.getOptions(d.isArray(a)?
a:[a]);p.forEach(a,function(a){a&&(this.options=p.filter(this.options,function(b){return b.value!==a.value||b.label!==a.label}),this._removeOptionItem(a))},this);this._loadChildren()},updateOption:function(a){p.forEach(d.isArray(a)?a:[a],function(a){var b=this.getOptions({value:a.value}),d;if(b)for(d in a)b[d]=a[d]},this);this._loadChildren()},setStore:function(a,c,b){q.deprecated(this.declaredClass+"::setStore(store, selectedValue, fetchArgs) is deprecated. Use set('query', fetchArgs.query), set('queryOptions', fetchArgs.queryOptions), set('store', store), or set('value', selectedValue) instead.",
"","2.0");this._deprecatedSetStore(a,c,b)},_deprecatedSetStore:function(a,c,b){var e=this.store;b=b||{};if(e!==a){for(var f;f=this._notifyConnections.pop();)f.remove();a.get||(d.mixin(a,{_oldAPI:!0,get:function(a){var c=new g;this.fetchItemByIdentity({identity:a,onItem:function(a){c.resolve(a)},onError:function(a){c.reject(a)}});return c.promise},query:function(a,c){var b=new g(function(){e.abort&&e.abort()});b.total=new g;var e=this.fetch(d.mixin({query:a,onBegin:function(a){b.total.resolve(a)},
onComplete:function(a){b.resolve(a)},onError:function(a){b.reject(a)}},c));return new n(b)}}),a.getFeatures()["dojo.data.api.Notification"]&&(this._notifyConnections=[k.after(a,"onNew",d.hitch(this,"_onNewItem"),!0),k.after(a,"onDelete",d.hitch(this,"_onDeleteItem"),!0),k.after(a,"onSet",d.hitch(this,"_onSetItem"),!0)]));this._set("store",a)}this.options&&this.options.length&&this.removeOption(this.options);this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&
(this._observeHandle.remove(),this._observeHandle=null);b.query&&this._set("query",b.query);b.queryOptions&&this._set("queryOptions",b.queryOptions);a&&a.query&&(this._loadingStore=!0,this.onLoadDeferred=new g,this._queryRes=a.query(this.query,this.queryOptions),r(this._queryRes,d.hitch(this,function(e){if(this.sortByLabel&&!b.sort&&e.length)if(a.getValue)e.sort(h.createSortFunction([{attribute:a.getLabelAttributes(e[0])[0]}],a));else{var f=this.labelAttr;e.sort(function(a,c){return a[f]>c[f]?1:c[f]>
a[f]?-1:0})}b.onFetch&&(e=b.onFetch.call(this,e,b));p.forEach(e,function(a){this._addOptionForItem(a)},this);this._queryRes.observe&&(this._observeHandle=this._queryRes.observe(d.hitch(this,function(a,c,b){c==b?this._onSetItem(a):(-1!=c&&this._onDeleteItem(a),-1!=b&&this._onNewItem(a))}),!0));this._loadingStore=!1;this.set("value","_pendingValue"in this?this._pendingValue:c);delete this._pendingValue;this.loadChildrenOnOpen?this._pseudoLoadChildren(e):this._loadChildren();this.onLoadDeferred.resolve(!0);
this.onSetStore()}),function(a){console.error("dijit.form.Select: "+a.toString());this.onLoadDeferred.reject(a)}));return e},_setValueAttr:function(a,c){this._onChangeActive||(c=null);if(this._loadingStore)this._pendingValue=a;else if(null!=a){a=d.isArray(a)?p.map(a,function(a){return d.isObject(a)?a:{value:a}}):d.isObject(a)?[a]:[{value:a}];a=p.filter(this.getOptions(a),function(a){return a&&a.value});var b=this.getOptions()||[];if(!this.multiple&&(!a[0]||!a[0].value)&&b.length)a[0]=b[0];p.forEach(b,
function(c){c.selected=p.some(a,function(a){return a.value===c.value})});b=p.map(a,function(a){return a.value});if(!("undefined"==typeof b||"undefined"==typeof b[0])){var e=p.map(a,function(a){return a.label});this._setDisplay(this.multiple?e:e[0]);this.inherited(arguments,[this.multiple?b:b[0],c]);this._updateSelection()}}},_getDisplayedValueAttr:function(){var a=p.map([].concat(this.get("selectedOptions")),function(a){return a&&"label"in a?a.label:a?a.value:null},this);return this.multiple?a:a[0]},
_setDisplayedValueAttr:function(a){this.set("value",this.getOptions("string"==typeof a?{label:a}:a))},_loadChildren:function(){this._loadingStore||(p.forEach(this._getChildren(),function(a){a.destroyRecursive()}),p.forEach(this.options,this._addOptionItem,this),this._updateSelection())},_updateSelection:function(){this.focusedChild=null;this._set("value",this._getValueFromOpts());var a=[].concat(this.value);if(a&&a[0]){var c=this;p.forEach(this._getChildren(),function(b){var d=p.some(a,function(a){return b.option&&
a===b.option.value});d&&!c.multiple&&(c.focusedChild=b);e.toggle(b.domNode,this.baseClass.replace(/\s+|$/g,"SelectedOption "),d);b.domNode.setAttribute("aria-selected",d?"true":"false")},this)}},_getValueFromOpts:function(){var a=this.getOptions()||[];if(!this.multiple&&a.length){var c=p.filter(a,function(a){return a.selected})[0];if(c&&c.value)return c.value;a[0].selected=!0;return a[0].value}return this.multiple?p.map(p.filter(a,function(a){return a.selected}),function(a){return a.value})||[]:""},
_onNewItem:function(a,c){(!c||!c.parent)&&this._addOptionForItem(a)},_onDeleteItem:function(a){this.removeOption({value:this.store.getIdentity(a)})},_onSetItem:function(a){this.updateOption(this._getOptionObjForItem(a))},_getOptionObjForItem:function(a){var c=this.store,b=this.labelAttr&&this.labelAttr in a?a[this.labelAttr]:c.getLabel(a);return{value:b?c.getIdentity(a):null,label:b,item:a}},_addOptionForItem:function(a){var c=this.store;c.isItemLoaded&&!c.isItemLoaded(a)?c.loadItem({item:a,onItem:function(a){this._addOptionForItem(a)},
scope:this}):(a=this._getOptionObjForItem(a),this.addOption(a))},constructor:function(a){this._oValue=(a||{}).value||null;this._notifyConnections=[]},buildRendering:function(){this.inherited(arguments);m.setSelectable(this.focusNode,!1)},_fillContent:function(){this.options||(this.options=this.srcNodeRef?b("\x3e *",this.srcNodeRef).map(function(a){return"separator"===a.getAttribute("type")?{value:"",label:"",selected:!1,disabled:!1}:{value:a.getAttribute("data-"+q._scopeName+"-value")||a.getAttribute("value"),
label:String(a.innerHTML),selected:a.getAttribute("selected")||!1,disabled:a.getAttribute("disabled")||!1}},this):[]);this.value?this.multiple&&"string"==typeof this.value&&this._set("value",this.value.split(",")):this._set("value",this._getValueFromOpts())},postCreate:function(){this.inherited(arguments);k.after(this,"onChange",d.hitch(this,"_updateSelection"));var a=this.store;if(a&&(a.getIdentity||a.getFeatures()["dojo.data.api.Identity"]))this.store=null,this._deprecatedSetStore(a,this._oValue,
{query:this.query,queryOptions:this.queryOptions});this._storeInitialized=!0},startup:function(){this._loadChildren();this.inherited(arguments)},destroy:function(){for(var a;a=this._notifyConnections.pop();)a.remove();this._queryRes&&this._queryRes.close&&this._queryRes.close();this._observeHandle&&this._observeHandle.remove&&(this._observeHandle.remove(),this._observeHandle=null);this.inherited(arguments)},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return[]},
_getSelectedOptionsAttr:function(){return this.getOptions({selected:!0})},_pseudoLoadChildren:function(){},onSetStore:function(){}})})},"dojo/store/util/QueryResults":function(){define(["../../_base/array","../../_base/lang","../../when"],function(p,g,k){var h=function(f){function m(g){f[g]=function(){var d=arguments,b=k(f,function(b){Array.prototype.unshift.call(d,b);return h(p[g].apply(p,d))});if("forEach"!==g||e)return b}}if(!f)return f;var e=!!f.then;e&&(f=g.delegate(f));m("forEach");m("filter");
m("map");null==f.total&&(f.total=k(f,function(e){return e.length}));return f};g.setObject("dojo.store.util.QueryResults",h);return h})},"dijit/DropDownMenu":function(){define(["dojo/_base/declare","dojo/keys","dojo/text!./templates/Menu.html","./_MenuBase"],function(p,g,k,h){return p("dijit.DropDownMenu",h,{templateString:k,baseClass:"dijitMenu",_onUpArrow:function(){this.focusPrev()},_onDownArrow:function(){this.focusNext()},_onRightArrow:function(f){this._moveToPopup(f);f.stopPropagation();f.preventDefault()},
_onLeftArrow:function(f){if(this.parentMenu)if(this.parentMenu._isMenuBar)this.parentMenu.focusPrev();else this.onCancel(!1);else f.stopPropagation(),f.preventDefault()}})})},"dijit/_MenuBase":function(){define("dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/lang dojo/mouse dojo/on dojo/window ./a11yclick ./registry ./_Widget ./_CssStateMixin ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c){return g("dijit._MenuBase",[n,
c,a,t],{selected:null,_setSelectedAttr:function(a){this.selected!=a&&(this.selected&&(this.selected._setSelected(!1),this._onChildDeselect(this.selected)),a&&a._setSelected(!0),this._set("selected",a))},activated:!1,_setActivatedAttr:function(a){f.toggle(this.domNode,"dijitMenuActive",a);f.toggle(this.domNode,"dijitMenuPassive",!a);this._set("activated",a)},parentMenu:null,popupDelay:500,passivePopupDelay:Infinity,autoFocus:!1,childSelector:function(a){var c=r.byNode(a);return a.parentNode==this.containerNode&&
c&&c.focus},postCreate:function(){var a=this,c="string"==typeof this.childSelector?this.childSelector:m.hitch(this,"childSelector");this.own(q(this.containerNode,q.selector(c,e.enter),function(){a.onItemHover(r.byNode(this))}),q(this.containerNode,q.selector(c,e.leave),function(){a.onItemUnhover(r.byNode(this))}),q(this.containerNode,q.selector(c,b),function(c){a.onItemClick(r.byNode(this),c);c.stopPropagation()}),q(this.containerNode,q.selector(c,"focusin"),function(){a._onItemFocus(r.byNode(this))}));
this.inherited(arguments)},onKeyboardSearch:function(a,c,b,d){this.inherited(arguments);if(a&&(-1==d||a.popup&&1==d))this.onItemClick(a,c)},_keyboardSearchCompare:function(a,c){return a.shortcutKey?c==a.shortcutKey.toLowerCase()?-1:0:this.inherited(arguments)?1:0},onExecute:function(){},onCancel:function(){},_moveToPopup:function(a){if(this.focusedChild&&this.focusedChild.popup&&!this.focusedChild.disabled)this.onItemClick(this.focusedChild,a);else(a=this._getTopMenu())&&a._isMenuBar&&a.focusNext()},
_onPopupHover:function(){this.set("selected",this.currentPopupItem);this._stopPendingCloseTimer()},onItemHover:function(a){this.activated?(this.set("selected",a),a.popup&&(!a.disabled&&!this.hover_timer)&&(this.hover_timer=this.defer(function(){this._openItemPopup(a)},this.popupDelay))):Infinity>this.passivePopupDelay&&(this.passive_hover_timer&&this.passive_hover_timer.remove(),this.passive_hover_timer=this.defer(function(){this.onItemClick(a,{type:"click"})},this.passivePopupDelay));this._hoveredChild=
a;a._set("hovering",!0)},_onChildDeselect:function(a){this._stopPopupTimer();this.currentPopupItem==a&&(this._stopPendingCloseTimer(),this._pendingClose_timer=this.defer(function(){this.currentPopupItem=this._pendingClose_timer=null;a._closePopup()},this.popupDelay))},onItemUnhover:function(a){this._hoveredChild==a&&(this._hoveredChild=null);this.passive_hover_timer&&(this.passive_hover_timer.remove(),this.passive_hover_timer=null);a._set("hovering",!1)},_stopPopupTimer:function(){this.hover_timer&&
(this.hover_timer=this.hover_timer.remove())},_stopPendingCloseTimer:function(){this._pendingClose_timer&&(this._pendingClose_timer=this._pendingClose_timer.remove())},_getTopMenu:function(){for(var a=this;a.parentMenu;a=a.parentMenu);return a},onItemClick:function(a,c){this.passive_hover_timer&&this.passive_hover_timer.remove();this.focusChild(a);if(a.disabled)return!1;if(a.popup){this.set("selected",a);this.set("activated",!0);var b=/^key/.test(c._origType||c.type)||0==c.clientX&&0==c.clientY;this._openItemPopup(a,
b)}else this.onExecute(),a._onClick?a._onClick(c):a.onClick(c)},_openItemPopup:function(a,c){if(a!=this.currentPopupItem){this.currentPopupItem&&(this._stopPendingCloseTimer(),this.currentPopupItem._closePopup());this._stopPopupTimer();var b=a.popup;b.parentMenu=this;this.own(this._mouseoverHandle=q.once(b.domNode,"mouseover",m.hitch(this,"_onPopupHover")));var d=this;a._openPopup({parent:this,orient:this._orient||["after","before"],onCancel:function(){c&&d.focusChild(a);d._cleanUp()},onExecute:m.hitch(this,
"_cleanUp",!0),onClose:function(){d._mouseoverHandle&&(d._mouseoverHandle.remove(),delete d._mouseoverHandle)}},c);this.currentPopupItem=a}},onOpen:function(){this.isShowingNow=!0;this.set("activated",!0)},onClose:function(){this.set("activated",!1);this.set("selected",null);this.isShowingNow=!1;this.parentMenu=null},_closeChild:function(){this._stopPopupTimer();this.currentPopupItem&&(this.focused&&(h.set(this.selected.focusNode,"tabIndex",this.tabIndex),this.selected.focusNode.focus()),this.currentPopupItem._closePopup(),
this.currentPopupItem=null)},_onItemFocus:function(a){if(this._hoveredChild&&this._hoveredChild!=a)this.onItemUnhover(this._hoveredChild);this.set("selected",a)},_onBlur:function(){this._cleanUp(!0);this.inherited(arguments)},_cleanUp:function(a){this._closeChild();"undefined"==typeof this.isShowingNow&&this.set("activated",!1);a&&this.set("selected",null)}})})},"dijit/_KeyNavContainer":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/_base/kernel dojo/keys dojo/_base/lang ./registry ./_Container ./_FocusMixin ./_KeyNavMixin".split(" "),
function(p,g,k,h,f,m,e,q,d,b){return g("dijit._KeyNavContainer",[d,b,q],{connectKeyNavHandlers:function(b,d){var e=this._keyNavCodes={},a=m.hitch(this,"focusPrev"),c=m.hitch(this,"focusNext");p.forEach(b,function(c){e[c]=a});p.forEach(d,function(a){e[a]=c});e[f.HOME]=m.hitch(this,"focusFirstChild");e[f.END]=m.hitch(this,"focusLastChild")},startupKeyNavChildren:function(){h.deprecated("startupKeyNavChildren() call no longer needed","","2.0")},startup:function(){this.inherited(arguments);p.forEach(this.getChildren(),
m.hitch(this,"_startupChild"))},addChild:function(b,d){this.inherited(arguments);this._startupChild(b)},_startupChild:function(b){b.set("tabIndex","-1")},_getFirst:function(){var b=this.getChildren();return b.length?b[0]:null},_getLast:function(){var b=this.getChildren();return b.length?b[b.length-1]:null},focusNext:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,1))},focusPrev:function(){this.focusChild(this._getNextFocusableChild(this.focusedChild,-1),!0)},childSelector:function(b){return(b=
e.byNode(b))&&b.getParent()==this}})})},"dijit/_KeyNavMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dijit/registry dijit/_FocusMixin".split(" "),function(p,g,k,h,f,m,e,q){return g("dijit._KeyNavMixin",q,{tabIndex:"0",childSelector:null,postCreate:function(){this.inherited(arguments);k.set(this.domNode,"tabIndex",this.tabIndex);if(!this._keyNavCodes){var d=this._keyNavCodes={};d[h.HOME]=f.hitch(this,"focusFirstChild");d[h.END]=f.hitch(this,
"focusLastChild");d[this.isLeftToRight()?h.LEFT_ARROW:h.RIGHT_ARROW]=f.hitch(this,"_onLeftArrow");d[this.isLeftToRight()?h.RIGHT_ARROW:h.LEFT_ARROW]=f.hitch(this,"_onRightArrow");d[h.UP_ARROW]=f.hitch(this,"_onUpArrow");d[h.DOWN_ARROW]=f.hitch(this,"_onDownArrow")}var b=this,d="string"==typeof this.childSelector?this.childSelector:f.hitch(this,"childSelector");this.own(m(this.domNode,"keypress",f.hitch(this,"_onContainerKeypress")),m(this.domNode,"keydown",f.hitch(this,"_onContainerKeydown")),m(this.domNode,
"focus",f.hitch(this,"_onContainerFocus")),m(this.containerNode,m.selector(d,"focusin"),function(d){b._onChildFocus(e.getEnclosingWidget(this),d)}))},_onLeftArrow:function(){},_onRightArrow:function(){},_onUpArrow:function(){},_onDownArrow:function(){},focus:function(){this.focusFirstChild()},_getFirstFocusableChild:function(){return this._getNextFocusableChild(null,1)},_getLastFocusableChild:function(){return this._getNextFocusableChild(null,-1)},focusFirstChild:function(){this.focusChild(this._getFirstFocusableChild())},
focusLastChild:function(){this.focusChild(this._getLastFocusableChild())},focusChild:function(d,b){d&&(this.focusedChild&&d!==this.focusedChild&&this._onChildBlur(this.focusedChild),d.set("tabIndex",this.tabIndex),d.focus(b?"end":"start"))},_onContainerFocus:function(d){d.target!==this.domNode||this.focusedChild||this.focus()},_onFocus:function(){k.set(this.domNode,"tabIndex","-1");this.inherited(arguments)},_onBlur:function(d){k.set(this.domNode,"tabIndex",this.tabIndex);this.focusedChild&&(this.focusedChild.set("tabIndex",
"-1"),this.lastFocusedChild=this.focusedChild,this._set("focusedChild",null));this.inherited(arguments)},_onChildFocus:function(d){d&&d!=this.focusedChild&&(this.focusedChild&&!this.focusedChild._destroyed&&this.focusedChild.set("tabIndex","-1"),d.set("tabIndex",this.tabIndex),this.lastFocused=d,this._set("focusedChild",d))},_searchString:"",multiCharSearchDuration:1E3,onKeyboardSearch:function(d,b,e,f){d&&this.focusChild(d)},_keyboardSearchCompare:function(d,b){var e=d.domNode,e=(d.label||(e.focusNode?
e.focusNode.label:"")||e.innerText||e.textContent||"").replace(/^\s+/,"").substr(0,b.length).toLowerCase();return b.length&&e==b?-1:0},_isFormElement:function(d){return"INPUT"===d.tagName||"TEXTAREA"===d.tagName||"SELECT"===d.tagName||"BUTTON"===d.tagName},_onContainerKeydown:function(d){if(!this._isFormElement(document.activeElement)){var b=this._keyNavCodes[d.keyCode];b?(b(d,this.focusedChild),d.stopPropagation(),d.preventDefault(),this._searchString=""):d.keyCode==h.SPACE&&(this._searchTimer&&
!d.ctrlKey&&!d.altKey&&!d.metaKey)&&(d.stopImmediatePropagation(),d.preventDefault(),this._keyboardSearch(d," "))}},_onContainerKeypress:function(d){if(!this._isFormElement(document.activeElement)&&!(d.charCode<=h.SPACE||d.ctrlKey||d.altKey||d.metaKey))d.preventDefault(),d.stopPropagation(),this._keyboardSearch(d,String.fromCharCode(d.charCode).toLowerCase())},_keyboardSearch:function(d,b){var e=null,g,h=0;f.hitch(this,function(){this._searchTimer&&this._searchTimer.remove();this._searchString+=b;
var a=/^(.)\1*$/.test(this._searchString)?1:this._searchString.length;g=this._searchString.substr(0,a);this._searchTimer=this.defer(function(){this._searchTimer=null;this._searchString=""},this.multiCharSearchDuration);var c=this.focusedChild||null;if(1==a||!c)if(c=this._getNextFocusableChild(c,1),!c)return;a=c;do{var d=this._keyboardSearchCompare(c,g);d&&0==h++&&(e=c);if(-1==d){h=-1;break}c=this._getNextFocusableChild(c,1)}while(c!=a)})();this.onKeyboardSearch(e,d,g,h)},_onChildBlur:function(){},
_getNextFocusableChild:function(d,b){var e=d;do{if(d)d=this._getNext(d,b);else if(d=this[0<b?"_getFirst":"_getLast"](),!d)break;if(null!=d&&d!=e&&d.isFocusable())return d}while(d!=e);return null},_getFirst:function(){return null},_getLast:function(){return null},_getNext:function(d,b){if(d)for(d=d.domNode;d;)if((d=d[0>b?"previousSibling":"nextSibling"])&&"getAttribute"in d){var f=e.byNode(d);if(f)return f}return null}})})},"dijit/MenuItem":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/_base/kernel dojo/sniff dojo/_base/lang ./_Widget ./_TemplatedMixin ./_Contained ./_CssStateMixin dojo/text!./templates/MenuItem.html".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n){e=p("dijit.MenuItem"+(m("dojo-bidi")?"_NoBidi":""),[q,d,b,r],{templateString:n,baseClass:"dijitMenuItem",label:"",_setLabelAttr:function(b){this._set("label",b);var a="",c;c=b.search(/{\S}/);if(0<=c){var a=b.charAt(c+1),d=b.substr(0,c);b=b.substr(c+3);c=d+a+b;b=d+'\x3cspan class\x3d"dijitMenuItemShortcutKey"\x3e'+a+"\x3c/span\x3e"+b}else c=b;this.domNode.setAttribute("aria-label",c+" "+this.accelKey);this.containerNode.innerHTML=b;this._set("shortcutKey",a)},iconClass:"dijitNoIcon",
_setIconClassAttr:{node:"iconNode",type:"class"},accelKey:"",disabled:!1,_fillContent:function(b){b&&!("label"in this.params)&&this._set("label",b.innerHTML)},buildRendering:function(){this.inherited(arguments);k.set(this.containerNode,"id",this.id+"_text");this.accelKeyNode&&k.set(this.accelKeyNode,"id",this.id+"_accel");g.setSelectable(this.domNode,!1)},onClick:function(){},focus:function(){try{8==m("ie")&&this.containerNode.focus(),this.focusNode.focus()}catch(b){}},_setSelected:function(b){h.toggle(this.domNode,
"dijitMenuItemSelected",b)},setLabel:function(b){f.deprecated("dijit.MenuItem.setLabel() is deprecated.  Use set('label', ...) instead.","","2.0");this.set("label",b)},setDisabled:function(b){f.deprecated("dijit.Menu.setDisabled() is deprecated.  Use set('disabled', bool) instead.","","2.0");this.set("disabled",b)},_setDisabledAttr:function(b){this.focusNode.setAttribute("aria-disabled",b?"true":"false");this._set("disabled",b)},_setAccelKeyAttr:function(b){this.accelKeyNode&&(this.accelKeyNode.style.display=
b?"":"none",this.accelKeyNode.innerHTML=b,k.set(this.containerNode,"colSpan",b?"1":"2"));this._set("accelKey",b)}});m("dojo-bidi")&&(e=p("dijit.MenuItem",e,{_setLabelAttr:function(b){this.inherited(arguments);"auto"===this.textDir&&this.applyTextDir(this.textDirNode)}}));return e})},"dijit/_Contained":function(){define(["dojo/_base/declare","./registry"],function(p,g){return p("dijit._Contained",null,{_getSibling:function(k){var h=this.domNode;do h=h[k+"Sibling"];while(h&&1!=h.nodeType);return h&&
g.byNode(h)},getPreviousSibling:function(){return this._getSibling("previous")},getNextSibling:function(){return this._getSibling("next")},getIndexInParent:function(){var g=this.getParent();return!g||!g.getIndexOfChild?-1:g.getIndexOfChild(this)}})})},"dijit/MenuSeparator":function(){define("dojo/_base/declare dojo/dom ./_WidgetBase ./_TemplatedMixin ./_Contained dojo/text!./templates/MenuSeparator.html".split(" "),function(p,g,k,h,f,m){return p("dijit.MenuSeparator",[k,h,f],{templateString:m,buildRendering:function(){this.inherited(arguments);
g.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/form/NumberSpinner":function(){define(["dojo/_base/declare","dojo/keys","./_Spinner","./NumberTextBox"],function(p,g,k,h){return p("dijit.form.NumberSpinner",[k,h.Mixin],{baseClass:"dijitTextBox dijitSpinner dijitNumberTextBox",adjust:function(f,g){var e=this.constraints,h=isNaN(f),d=!isNaN(e.max),b=!isNaN(e.min);h&&0!=g&&(f=0<g?b?e.min:d?e.max:0:d?this.constraints.max:b?e.min:0);var k=f+g;if(h||isNaN(k))return f;d&&k>
e.max&&(k=e.max);b&&k<e.min&&(k=e.min);return k},_onKeyDown:function(f){if(!this.disabled&&!this.readOnly&&(f.keyCode==g.HOME||f.keyCode==g.END)&&!f.ctrlKey&&(!f.altKey&&!f.metaKey)&&"undefined"!=typeof this.get("value")){var h=this.constraints[f.keyCode==g.HOME?"min":"max"];"number"==typeof h&&this._setValueAttr(h,!1);f.stopPropagation();f.preventDefault()}}})})},"dijit/form/_Spinner":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/sniff dojo/mouse dojo/on ../typematic ./RangeBoundTextBox dojo/text!./templates/Spinner.html ./_TextBoxMixin".split(" "),
function(p,g,k,h,f,m,e,q,d,b){return p("dijit.form._Spinner",q,{defaultTimeout:500,minimumTimeout:10,timeoutChangeRate:0.9,smallDelta:1,largeDelta:10,templateString:d,baseClass:"dijitTextBox dijitSpinner",cssStateNodes:{upArrowNode:"dijitUpArrowButton",downArrowNode:"dijitDownArrowButton"},adjust:function(b){return b},_arrowPressed:function(d,e,f){!this.disabled&&!this.readOnly&&(this._setValueAttr(this.adjust(this.get("value"),e*f),!1),b.selectInputText(this.textbox,this.textbox.value.length))},
_arrowReleased:function(){this._wheelTimer=null},_typematicCallback:function(b,d,e){var a=this.smallDelta;d==this.textbox&&(d=e.keyCode,a=d==g.PAGE_UP||d==g.PAGE_DOWN?this.largeDelta:this.smallDelta,d=d==g.UP_ARROW||d==g.PAGE_UP?this.upArrowNode:this.downArrowNode);-1==b?this._arrowReleased(d):this._arrowPressed(d,d==this.upArrowNode?1:-1,a)},_wheelTimer:null,_mouseWheeled:function(b){b.stopPropagation();b.preventDefault();var d=b.wheelDelta/120;Math.floor(d)!=d&&(d=0<b.wheelDelta?1:-1);b=b.detail?
-1*b.detail:d;if(0!==b){var e=this[0<b?"upArrowNode":"downArrowNode"];this._arrowPressed(e,b,this.smallDelta);this._wheelTimer&&this._wheelTimer.remove();this._wheelTimer=this.defer(function(){this._arrowReleased(e)},50)}},_setConstraintsAttr:function(b){this.inherited(arguments);this.focusNode&&(void 0!==this.constraints.min?this.focusNode.setAttribute("aria-valuemin",this.constraints.min):this.focusNode.removeAttribute("aria-valuemin"),void 0!==this.constraints.max?this.focusNode.setAttribute("aria-valuemax",
this.constraints.max):this.focusNode.removeAttribute("aria-valuemax"))},_setValueAttr:function(b,d){this.focusNode.setAttribute("aria-valuenow",b);this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.own(m(this.domNode,f.wheel,k.hitch(this,"_mouseWheeled")),e.addListener(this.upArrowNode,this.textbox,{keyCode:g.UP_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),e.addListener(this.downArrowNode,
this.textbox,{keyCode:g.DOWN_ARROW,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),e.addListener(this.upArrowNode,this.textbox,{keyCode:g.PAGE_UP,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout),e.addListener(this.downArrowNode,this.textbox,{keyCode:g.PAGE_DOWN,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1},this,"_typematicCallback",
this.timeoutChangeRate,this.defaultTimeout,this.minimumTimeout))}})})},"dijit/form/RangeBoundTextBox":function(){define(["dojo/_base/declare","dojo/i18n","./MappedTextBox","dojo/i18n!./nls/validate"],function(p,g,k){return p("dijit.form.RangeBoundTextBox",k,{rangeMessage:"",rangeCheck:function(g,f){return("min"in f?0<=this.compare(g,f.min):!0)&&("max"in f?0>=this.compare(g,f.max):!0)},isInRange:function(){return this.rangeCheck(this.get("value"),this.constraints)},_isDefinitelyOutOfRange:function(){var g=
this.get("value");if(null==g)return!1;var f=!1;"min"in this.constraints&&(f=this.constraints.min,f=0>this.compare(g,"number"==typeof f&&0<=f&&0!=g?0:f));!f&&"max"in this.constraints&&(f=this.constraints.max,f=0<this.compare(g,"number"!=typeof f||0<f?f:0));return f},_isValidSubset:function(){return this.inherited(arguments)&&!this._isDefinitelyOutOfRange()},isValid:function(g){return this.inherited(arguments)&&(this._isEmpty(this.textbox.value)&&!this.required||this.isInRange(g))},getErrorMessage:function(g){var f=
this.get("value");return null!=f&&""!==f&&("number"!=typeof f||!isNaN(f))&&!this.isInRange(g)?this.rangeMessage:this.inherited(arguments)},postMixInProperties:function(){this.inherited(arguments);this.rangeMessage||(this.messages=g.getLocalization("dijit.form","validate",this.lang),this.rangeMessage=this.messages.rangeMessage)}})})},"dijit/form/MappedTextBox":function(){define(["dojo/_base/declare","dojo/sniff","dojo/dom-construct","./ValidationTextBox"],function(p,g,k,h){return p("dijit.form.MappedTextBox",
h,{postMixInProperties:function(){this.inherited(arguments);this.nameAttrSetting=""},_setNameAttr:"valueNode",serialize:function(f){return f.toString?f.toString():""},toString:function(){var f=this.filter(this.get("value"));return null!=f?"string"==typeof f?f:this.serialize(f,this.constraints):""},validate:function(){this.valueNode.value=this.toString();return this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.valueNode=k.place("\x3cinput type\x3d'hidden'"+(this.name&&
!g("msapp")?' name\x3d"'+this.name.replace(/"/g,"\x26quot;")+'"':"")+"/\x3e",this.textbox,"after")},reset:function(){this.valueNode.value="";this.inherited(arguments)}})})},"dijit/form/NumberTextBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/i18n dojo/string dojo/number ./RangeBoundTextBox".split(" "),function(p,g,k,h,f,m){var e=function(d){d=d||{};var b=k.getLocalization("dojo.cldr","number",k.normalizeLocale(d.locale)),e=d.pattern?d.pattern:b[(d.type||"decimal")+"Format"];d="number"==
typeof d.places?d.places:-1!=e.indexOf(b.decimal)?e.split(b.decimal)[1].replace(/[^#0]/g,"").length:0;return{sep:b.decimal,places:d}},q=p("dijit.form.NumberTextBoxMixin",null,{pattern:function(d){return"("+(this.focused&&this.editOptions?this._regExpGenerator(g.delegate(d,this.editOptions))+"|":"")+this._regExpGenerator(d)+")"},value:NaN,editOptions:{pattern:"#.######"},_formatter:f.format,_regExpGenerator:f.regexp,_decimalInfo:e(),postMixInProperties:function(){this.inherited(arguments);this._set("type",
"text")},_setConstraintsAttr:function(d){var b="number"==typeof d.places?d.places:0;b&&b++;"number"!=typeof d.max&&(d.max=9*Math.pow(10,15-b));"number"!=typeof d.min&&(d.min=-9*Math.pow(10,15-b));this.inherited(arguments,[d]);this.focusNode&&(this.focusNode.value&&!isNaN(this.value))&&this.set("value",this.value);this._decimalInfo=e(d)},_onFocus:function(){if(!this.disabled&&!this.readOnly){var d=this.get("value");"number"==typeof d&&!isNaN(d)&&(d=this.format(d,this.constraints),void 0!==d&&(this.textbox.value=
d));this.inherited(arguments)}},format:function(d,b){var e=String(d);if("number"!=typeof d)return e;if(isNaN(d))return"";if(!("rangeCheck"in this&&this.rangeCheck(d,b))&&!1!==b.exponent&&/\de[-+]?\d/i.test(e))return e;this.editOptions&&this.focused&&(b=g.mixin({},b,this.editOptions));return this._formatter(d,b)},_parser:f.parse,parse:function(d,b){var e=this._parser(d,g.mixin({},b,this.editOptions&&this.focused?this.editOptions:{}));this.editOptions&&(this.focused&&isNaN(e))&&(e=this._parser(d,b));
return e},_getDisplayedValueAttr:function(){var d=this.inherited(arguments);return isNaN(d)?this.textbox.value:d},filter:function(d){if(null==d||"string"==typeof d&&""==d)return NaN;"number"==typeof d&&(!isNaN(d)&&0!=d)&&(d=f.round(d,this._decimalInfo.places));return this.inherited(arguments,[d])},serialize:function(d,b){return"number"!=typeof d||isNaN(d)?"":this.inherited(arguments)},_setBlurValue:function(){var d=g.hitch(g.delegate(this,{focused:!0}),"get")("value");this._setValueAttr(d,!0)},_setValueAttr:function(d,
b,e){if(void 0!==d&&void 0===e)if(e=String(d),"number"==typeof d)if(isNaN(d))e="";else{if("rangeCheck"in this&&this.rangeCheck(d,this.constraints)||!1===this.constraints.exponent||!/\de[-+]?\d/i.test(e))e=void 0}else d?d=void 0:(e="",d=NaN);this.inherited(arguments,[d,b,e])},_getValueAttr:function(){var d=this.inherited(arguments);if(isNaN(d)&&""!==this.textbox.value){if(!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)&&RegExp("^"+f._realNumberRegexp(g.delegate(this.constraints))+
"$").test(this.textbox.value))return d=Number(this.textbox.value),isNaN(d)?void 0:d}else return d},isValid:function(d){if(!this.focused||this._isEmpty(this.textbox.value))return this.inherited(arguments);var b=this.get("value");return!isNaN(b)&&this.rangeCheck(b,this.constraints)?!1!==this.constraints.exponent&&/\de[-+]?\d/i.test(this.textbox.value)?!0:this.inherited(arguments):!1},_isValidSubset:function(){var d="number"==typeof this.constraints.min,b="number"==typeof this.constraints.max,e=this.get("value");
if(isNaN(e)||!d&&!b)return this.inherited(arguments);var f=e|0,g=0>e,a=-1!=this.textbox.value.indexOf(this._decimalInfo.sep),c=(this.maxLength||20)-this.textbox.value.length,k=a?this.textbox.value.split(this._decimalInfo.sep)[1].replace(/[^0-9]/g,""):"",f=a?f+"."+k:f+"",c=h.rep("9",c),a=e;g?a=Number(f+c):e=Number(f+c);return!(d&&e<this.constraints.min||b&&a>this.constraints.max)}});p=p("dijit.form.NumberTextBox",[m,q],{baseClass:"dijitTextBox dijitNumberTextBox"});p.Mixin=q;return p})},"jimu/dijit/ColorPicker":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/_base/lang dojo/_base/html dojo/on dojo/_base/Color dijit/TooltipDialog dijit/ColorPalette dijit/popup".split(" "),
function(p,g,k,h,f,m,e,q,d,b){return p([g,k],{baseClass:"jimu-color-picker",declaredClass:"jimu.dijit.ColorPicker",templateString:"\x3cdiv\x3e\x3c/div\x3e",color:null,postCreate:function(){this.inherited(arguments);this.color?this.color instanceof e||(this.color=new e(this.color)):this.color=new e("#ccc");f.setStyle(this.domNode,"backgroundColor",this.color.toHex());this._createTooltipDialog(this.domNode)},_createTooltipDialog:function(g){var n=f.create("div"),k=new q({style:"width: 250px;cursor:pointer",
content:n}),a=new d({palette:"7x10",cellClass:"cursor:pointer",onChange:h.hitch(this,function(a){f.setStyle(g,"backgroundColor",a);b.close(k);this.color=new e(a);this.onChange(this.color)})});a.placeAt(n);a.startup();this.own(m(g,"click",h.hitch(this,function(a){a.stopPropagation();a.preventDefault();b.open({parent:this.getParent(),popup:k,around:g})})));this.own(m(window,"click",h.hitch(this,function(a){a=a.target||a.srcElement;var d=k.domNode;a===d||f.isDescendant(a,d)||b.close(k)})));return k},
setColor:function(b){if(b instanceof e){var d=this.color,g="";d&&(g=d.toHex());d=b.toHex();this.color=b;f.setStyle(this.domNode,"backgroundColor",d);if(g!==d)this.onChange(new e(d))}},getColor:function(){return this.color},onChange:function(b){}})})},"dijit/ColorPalette":function(){define("require dojo/text!./templates/ColorPalette.html ./_Widget ./_TemplatedMixin ./_PaletteMixin ./hccss dojo/i18n dojo/_base/Color dojo/_base/declare dojo/dom-construct dojo/string dojo/i18n!dojo/nls/colors dojo/colors".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r){var n=d("dijit.ColorPalette",[k,h,f],{palette:"7x10",_palettes:{"7x10":["white seashell cornsilk lemonchiffon lightyellow palegreen paleturquoise lightcyan lavender plum".split(" "),"lightgray pink bisque moccasin khaki lightgreen lightseagreen lightskyblue cornflowerblue violet".split(" "),"silver lightcoral sandybrown orange palegoldenrod chartreuse mediumturquoise skyblue mediumslateblue orchid".split(" "),"gray red orangered darkorange yellow limegreen darkseagreen royalblue slateblue mediumorchid".split(" "),
"dimgray crimson chocolate coral gold forestgreen seagreen blue blueviolet darkorchid".split(" "),"darkslategray firebrick saddlebrown sienna olive green darkcyan mediumblue darkslateblue darkmagenta".split(" "),"black darkred maroon brown darkolivegreen darkgreen midnightblue navy indigo purple".split(" ")],"3x4":[["white","lime","green","blue"],["silver","yellow","fuchsia","navy"],["gray","red","purple","black"]]},templateString:g,baseClass:"dijitColorPalette",_dyeFactory:function(b,a,c,d){return new this._dyeClass(b,
a,c,d)},buildRendering:function(){this.inherited(arguments);this._dyeClass=d(n._Color,{palette:this.palette});this._preparePalette(this._palettes[this.palette],e.getLocalization("dojo","colors",this.lang))}});n._Color=d("dijit._Color",q,{template:"\x3cspan class\x3d'dijitInline dijitPaletteImg'\x3e\x3cimg src\x3d'${blankGif}' alt\x3d'${alt}' title\x3d'${title}' class\x3d'dijitColorPaletteSwatch' style\x3d'background-color: ${color}'/\x3e\x3c/span\x3e",hcTemplate:"\x3cspan class\x3d'dijitInline dijitPaletteImg' style\x3d'position: relative; overflow: hidden; height: 12px; width: 14px;'\x3e\x3cimg src\x3d'${image}' alt\x3d'${alt}' title\x3d'${title}' style\x3d'position: absolute; left: ${left}px; top: ${top}px; ${size}'/\x3e\x3c/span\x3e",
_imagePaths:{"7x10":p.toUrl("./themes/a11y/colors7x10.png"),"3x4":p.toUrl("./themes/a11y/colors3x4.png")},constructor:function(b,a,c,d){this._title=d;this._row=a;this._col=c;this.setColor(q.named[b])},getValue:function(){return this.toHex()},fillCell:function(d,a){var c=r.substitute(m("highcontrast")?this.hcTemplate:this.template,{color:this.toHex(),blankGif:a,alt:this._title,title:this._title,image:this._imagePaths[this.palette].toString(),left:-20*this._col-5,top:-20*this._row-5,size:"7x10"==this.palette?
"height: 145px; width: 206px":"height: 64px; width: 86px"});b.place(c,d)}});return n})},"dijit/_PaletteMixin":function(){define("dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on ./_CssStateMixin ./a11yclick ./focus ./typematic".split(" "),function(p,g,k,h,f,m,e,q,d,b,r){return p("dijit._PaletteMixin",q,{defaultTimeout:500,timeoutChangeRate:0.9,value:"",_selectedCell:-1,tabIndex:"0",cellClass:"dijitPaletteCell",dyeClass:null,_dyeFactory:function(b){return new ("string"==
typeof this.dyeClass?m.getObject(this.dyeClass):this.dyeClass)(b)},_preparePalette:function(b,g){this._cells=[];var a=this._blankGif;this.own(e(this.gridNode,d,m.hitch(this,"_onCellClick")));for(var c=0;c<b.length;c++)for(var k=h.create("tr",{tabIndex:"-1",role:"row"},this.gridNode),l=0;l<b[c].length;l++){var p=b[c][l];if(p){var q=this._dyeFactory(p,c,l,g[p]),p=h.create("td",{"class":this.cellClass,tabIndex:"-1",title:g[p],role:"gridcell"},k);q.fillCell(p,a);p.idx=this._cells.length;this._cells.push({node:p,
dye:q})}}this._xDim=b[0].length;this._yDim=b.length;var A={UP_ARROW:-this._xDim,DOWN_ARROW:this._xDim,RIGHT_ARROW:this.isLeftToRight()?1:-1,LEFT_ARROW:this.isLeftToRight()?-1:1},x;for(x in A)this.own(r.addKeyListener(this.domNode,{keyCode:f[x],ctrlKey:!1,altKey:!1,shiftKey:!1},this,function(){var a=A[x];return function(b){this._navigateByKey(a,b)}}(),this.timeoutChangeRate,this.defaultTimeout))},postCreate:function(){this.inherited(arguments);this._setCurrent(this._cells[0].node)},focus:function(){b.focus(this._currentFocus)},
_onCellClick:function(d){for(var e=d.target;"TD"!=e.tagName;){if(!e.parentNode||e==this.gridNode)return;e=e.parentNode}var a=this._getDye(e).getValue();this._setCurrent(e);b.focus(e);this._setValueAttr(a,!0);d.stopPropagation();d.preventDefault()},_setCurrent:function(b){"_currentFocus"in this&&g.set(this._currentFocus,"tabIndex","-1");(this._currentFocus=b)&&g.set(b,"tabIndex",this.tabIndex)},_setValueAttr:function(b,d){0<=this._selectedCell&&k.remove(this._cells[this._selectedCell].node,this.cellClass+
"Selected");this._selectedCell=-1;if(b)for(var a=0;a<this._cells.length;a++)if(b==this._cells[a].dye.getValue()){this._selectedCell=a;k.add(this._cells[a].node,this.cellClass+"Selected");break}this._set("value",0<=this._selectedCell?b:null);if(d||void 0===d)this.onChange(b)},onChange:function(){},_navigateByKey:function(d,e){if(-1!=e){var a=this._currentFocus.idx+d;a<this._cells.length&&-1<a&&(a=this._cells[a].node,this._setCurrent(a),this.defer(m.hitch(b,"focus",a)))}},_getDye:function(b){return this._cells[b.idx].dye}})})},
"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(p,g,k,h){var f={};g.setObject("dojo.colors",f);var m=function(e,d,b){0>b&&++b;1<b&&--b;var f=6*b;return 1>f?e+(d-e)*f:1>2*b?d:2>3*b?e+6*(d-e)*(2/3-b):e};p.colorFromRgb=k.fromRgb=function(e,d){var b=e.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(b){var f=b[2].split(/\s*,\s*/),g=f.length,b=b[1];if("rgb"==b&&3==g||"rgba"==b&&4==g)return b=f[0],"%"==b.charAt(b.length-1)?(b=h.map(f,
function(a){return 2.56*parseFloat(a)}),4==g&&(b[3]=f[3]),k.fromArray(b,d)):k.fromArray(f,d);if("hsl"==b&&3==g||"hsla"==b&&4==g){var b=(parseFloat(f[0])%360+360)%360/360,t=parseFloat(f[1])/100,a=parseFloat(f[2])/100,t=0.5>=a?a*(t+1):a+t-a*t,a=2*a-t,b=[256*m(a,t,b+1/3),256*m(a,t,b),256*m(a,t,b-1/3),1];4==g&&(b[3]=f[3]);return k.fromArray(b,d)}}return null};var e=function(e,d,b){e=Number(e);return isNaN(e)?b:e<d?d:e>b?b:e};k.prototype.sanitize=function(){this.r=Math.round(e(this.r,0,255));this.g=Math.round(e(this.g,
0,255));this.b=Math.round(e(this.b,0,255));this.a=e(this.a,0,1);return this};f.makeGrey=k.makeGrey=function(e,d){return k.fromArray([e,e,e,d])};g.mixin(k.named,{aliceblue:[240,248,255],antiquewhite:[250,235,215],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],blanchedalmond:[255,235,205],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,
149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,
0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],
lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,
0,255],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],oldlace:[253,245,230],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,
232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,
250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],whitesmoke:[245,245,245],yellowgreen:[154,205,50]});return k})},"jimu/dijit/_Transparency":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!./templates/_Transparency.html dojo/_base/lang dojo/_base/html dojo/on dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels dijit/form/HorizontalRule".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n){return p([g,k,h,f],{baseClass:"jimu-transparency",declaredClass:"jimu.dijit.Transparency",templateString:m,nls:null,alpha:1,postMixInProperties:function(){this.nls=window.jimuNls.transparency},postCreate:function(){this.inherited(arguments);"number"===typeof this.alpha&&this.setAlpha(this.alpha)},setAlpha:function(b){b=Math.round(100-100*b);this.opacitySlider.set("value",b)},getAlpha:function(){return Math.round(100-this.opacitySlider.get("value"))/100},_onAlphaChanged:function(){var b=
this.getAlpha();this.emit("change",b)}})})},"dijit/form/HorizontalSlider":function(){define("dojo/_base/array dojo/_base/declare dojo/dnd/move dojo/_base/fx dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/dnd/Moveable dojo/dnd/Mover dojo/query dojo/mouse dojo/on ../_base/manager ../focus ../typematic ./Button ./_FormValueWidget ../_Container dojo/text!./templates/HorizontalSlider.html".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z,A,x){var u=g("dijit.form._SliderMover",
r,{onMouseMove:function(a){var b=this.widget,c=b._abspos;c||(c=b._abspos=f.position(b.sliderBarContainer,!0),b._setPixelValue_=q.hitch(b,"_setPixelValue"),b._isReversed_=b._isReversed());a=a[b._mousePixelCoord]-c[b._startingPixelCoord];b._setPixelValue_(b._isReversed_?c[b._pixelCount]-a:a,c[b._pixelCount],!1)},destroy:function(a){r.prototype.destroy.apply(this,arguments);var b=this.widget;b._abspos=null;b._setValueAttr(b.value,!0)}});k=g("dijit.form.HorizontalSlider",[z,A],{templateString:x,value:0,
showButtons:!0,minimum:0,maximum:100,discreteValues:Infinity,pageIncrement:2,clickSelect:!0,slideDuration:c.defaultDuration,_setIdAttr:"",_setNameAttr:"valueNode",baseClass:"dijitSlider",cssStateNodes:{incrementButton:"dijitSliderIncrementButton",decrementButton:"dijitSliderDecrementButton",focusNode:"dijitSliderThumb"},_mousePixelCoord:"pageX",_pixelCount:"w",_startingPixelCoord:"x",_handleOffsetCoord:"left",_progressPixelSize:"width",_onKeyUp:function(a){!this.disabled&&(!this.readOnly&&!a.altKey&&
!a.ctrlKey&&!a.metaKey)&&this._setValueAttr(this.value,!0)},_onKeyDown:function(a){if(!this.disabled&&!this.readOnly&&!a.altKey&&!a.ctrlKey&&!a.metaKey){switch(a.keyCode){case e.HOME:this._setValueAttr(this.minimum,!1);break;case e.END:this._setValueAttr(this.maximum,!1);break;case this._descending||this.isLeftToRight()?e.RIGHT_ARROW:e.LEFT_ARROW:case !1===this._descending?e.DOWN_ARROW:e.UP_ARROW:case !1===this._descending?e.PAGE_DOWN:e.PAGE_UP:this.increment(a);break;case this._descending||this.isLeftToRight()?
e.LEFT_ARROW:e.RIGHT_ARROW:case !1===this._descending?e.UP_ARROW:e.DOWN_ARROW:case !1===this._descending?e.PAGE_UP:e.PAGE_DOWN:this.decrement(a);break;default:return}a.stopPropagation();a.preventDefault()}},_onHandleClick:function(a){!this.disabled&&!this.readOnly&&(d("ie")||s.focus(this.sliderHandle),a.stopPropagation(),a.preventDefault())},_isReversed:function(){return!this.isLeftToRight()},_onBarClick:function(a){if(!this.disabled&&!this.readOnly&&this.clickSelect){s.focus(this.sliderHandle);a.stopPropagation();
a.preventDefault();var b=f.position(this.sliderBarContainer,!0),c=a[this._mousePixelCoord]-b[this._startingPixelCoord];this._setPixelValue(this._isReversed()?b[this._pixelCount]-c:c,b[this._pixelCount],!0);this._movable.onMouseDown(a)}},_setPixelValue:function(a,b,c){if(!this.disabled&&!this.readOnly){var d=this.discreteValues;if(1>=d||Infinity==d)d=b;d--;a=Math.round(a/(b/d));this._setValueAttr(Math.max(Math.min((this.maximum-this.minimum)*a/d+this.minimum,this.maximum),this.minimum),c)}},_setValueAttr:function(a,
b){this._set("value",a);this.valueNode.value=a;this.focusNode.setAttribute("aria-valuenow",a);this.inherited(arguments);var c=this.maximum>this.minimum?(a-this.minimum)/(this.maximum-this.minimum):0,d=!1===this._descending?this.remainingBar:this.progressBar,e=!1===this._descending?this.progressBar:this.remainingBar;this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);if(b&&0<this.slideDuration&&d.style[this._progressPixelSize]){var f=this,g={},l=parseFloat(d.style[this._progressPixelSize]),
n=this.slideDuration*(c-l/100);0!=n&&(0>n&&(n=0-n),g[this._progressPixelSize]={start:l,end:100*c,units:"%"},this._inProgressAnim=h.animateProperty({node:d,duration:n,onAnimate:function(a){e.style[f._progressPixelSize]=100-parseFloat(a[f._progressPixelSize])+"%"},onEnd:function(){delete f._inProgressAnim},properties:g}),this._inProgressAnim.play())}else d.style[this._progressPixelSize]=100*c+"%",e.style[this._progressPixelSize]=100*(1-c)+"%"},_bumpValue:function(a,b){if(!this.disabled&&!(this.readOnly||
this.maximum<=this.minimum)){var c=m.getComputedStyle(this.sliderBarContainer),d=f.getContentBox(this.sliderBarContainer,c),c=this.discreteValues;if(1>=c||Infinity==c)c=d[this._pixelCount];c--;d=(this.value-this.minimum)*c/(this.maximum-this.minimum)+a;0>d&&(d=0);d>c&&(d=c);d=d*(this.maximum-this.minimum)/c+this.minimum;this._setValueAttr(d,b)}},_onClkBumper:function(a){!this.disabled&&(!this.readOnly&&this.clickSelect)&&this._setValueAttr(a,!0)},_onClkIncBumper:function(){this._onClkBumper(!1===
this._descending?this.minimum:this.maximum)},_onClkDecBumper:function(){this._onClkBumper(!1===this._descending?this.maximum:this.minimum)},decrement:function(a){this._bumpValue(a.keyCode==e.PAGE_DOWN?-this.pageIncrement:-1)},increment:function(a){this._bumpValue(a.keyCode==e.PAGE_UP?this.pageIncrement:1)},_mouseWheeled:function(a){a.stopPropagation();a.preventDefault();this._bumpValue(0>a.wheelDelta?-1:1,!0)},startup:function(){this._started||(p.forEach(this.getChildren(),function(a){this[a.container]!=
this.containerNode&&this[a.container].appendChild(a.domNode)},this),this.inherited(arguments))},_typematicCallback:function(a,b,c){if(-1==a)this._setValueAttr(this.value,!0);else this[b==(this._descending?this.incrementButton:this.decrementButton)?"decrement":"increment"](c)},buildRendering:function(){this.inherited(arguments);this.showButtons&&(this.incrementButton.style.display="",this.decrementButton.style.display="");var a=n('label[for\x3d"'+this.id+'"]');a.length&&(a[0].id||(a[0].id=this.id+
"_label"),this.focusNode.setAttribute("aria-labelledby",a[0].id));this.focusNode.setAttribute("aria-valuemin",this.minimum);this.focusNode.setAttribute("aria-valuemax",this.maximum)},postCreate:function(){this.inherited(arguments);this.showButtons&&this.own(l.addMouseListener(this.decrementButton,this,"_typematicCallback",25,500),l.addMouseListener(this.incrementButton,this,"_typematicCallback",25,500));this.own(a(this.domNode,t.wheel,q.hitch(this,"_mouseWheeled")));var c=g(u,{widget:this});this._movable=
new b(this.sliderHandle,{mover:c});this._layoutHackIE7()},destroy:function(){this._movable.destroy();this._inProgressAnim&&"stopped"!=this._inProgressAnim.status&&this._inProgressAnim.stop(!0);this.inherited(arguments)}});k._Mover=u;return k})},"dijit/form/HorizontalRuleLabels":function(){define("dojo/_base/declare dojo/has dojo/number dojo/query dojo/_base/lang ./HorizontalRule".split(" "),function(p,g,k,h,f,m){p=p("dijit.form.HorizontalRuleLabels",m,{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH dijitRuleLabelsContainer dijitRuleLabelsContainerH"\x3e\x3c/div\x3e',
labelStyle:"",labels:[],numericMargin:0,minimum:0,maximum:1,constraints:{pattern:"#%"},_positionPrefix:'\x3cdiv class\x3d"dijitRuleLabelContainer dijitRuleLabelContainerH" style\x3d"left:',_labelPrefix:'"\x3e\x3cdiv class\x3d"dijitRuleLabel dijitRuleLabelH"\x3e',_suffix:"\x3c/div\x3e\x3c/div\x3e",_calcPosition:function(e){return e},_genHTML:function(e,f){var d=this.labels[f];return this._positionPrefix+this._calcPosition(e)+this._positionSuffix+this.labelStyle+this._genDirectionHTML(d)+this._labelPrefix+
d+this._suffix},_genDirectionHTML:function(e){return""},getLabels:function(){var e=this.labels;!e.length&&this.srcNodeRef&&(e=h("\x3e li",this.srcNodeRef).map(function(b){return String(b.innerHTML)}));if(!e.length&&1<this.count)for(var f=this.minimum,d=(this.maximum-f)/(this.count-1),b=0;b<this.count;b++)e.push(b<this.numericMargin||b>=this.count-this.numericMargin?"":k.format(f,this.constraints)),f+=d;return e},postMixInProperties:function(){this.inherited(arguments);this.labels=this.getLabels();
this.count=this.labels.length}});g("dojo-bidi")&&p.extend({_setTextDirAttr:function(e){this.textDir!=e&&(this._set("textDir",e),h(".dijitRuleLabelContainer",this.domNode).forEach(f.hitch(this,function(e){e.style.direction=this.getTextDir(e.innerText||e.textContent||"")})))},_genDirectionHTML:function(e){return this.textDir?"direction:"+this.getTextDir(e)+";":""}});return p})},"dijit/form/HorizontalRule":function(){define(["dojo/_base/declare","../_Widget","../_TemplatedMixin"],function(p,g,k){return p("dijit.form.HorizontalRule",
[g,k],{templateString:'\x3cdiv class\x3d"dijitRuleContainer dijitRuleContainerH"\x3e\x3c/div\x3e',count:3,container:"containerNode",ruleStyle:"",_positionPrefix:'\x3cdiv class\x3d"dijitRuleMark dijitRuleMarkH" style\x3d"left:',_positionSuffix:"%;",_suffix:'"\x3e\x3c/div\x3e',_genHTML:function(g){return this._positionPrefix+g+this._positionSuffix+this.ruleStyle+this._suffix},_isHorizontal:!0,buildRendering:function(){this.inherited(arguments);var g;if(1==this.count)g=this._genHTML(50,0);else{var f,
k=100/(this.count-1);if(!this._isHorizontal||this.isLeftToRight()){g=this._genHTML(0,0);for(f=1;f<this.count-1;f++)g+=this._genHTML(k*f,f);g+=this._genHTML(100,this.count-1)}else{g=this._genHTML(100,0);for(f=1;f<this.count-1;f++)g+=this._genHTML(100-k*f,f);g+=this._genHTML(0,this.count-1)}}this.domNode.innerHTML=g}})})},"jimu/dijit/Search":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/string dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),
function(p,g,k,h,f,m,e,q){return p([e,q],{baseClass:"jimu-search",templateString:'\x3cdiv\x3e\x3cspan class\x3d"jimu-input-wrapper" style\x3d"left:0;right:0;"\x3e\x3cinput class\x3d"jimu-input" style\x3d"background:#fafafc;" data-dojo-attach-point\x3d"inputSearch" data-dojo-attach-event\x3d"onKeydown: _onKeyDown, onKeyUp: _onKeyUp"/\x3e\x3c/span\x3e\x3cdiv class\x3d"search-btn" data-dojo-attach-point\x3d"searchBtn" data-dojo-attach-event\x3d"onClick: _onBtnClick"\x3e\x3c/div\x3e\x3c/div\x3e',placeholder:"",
onSearch:null,searchWhenInput:!1,postCreate:function(){this.inherited(arguments);this.placeholder&&k.setAttr(this.inputSearch,"placeholder",this.placeholder)},doSearch:function(){if(this.onSearch)this.onSearch(m.trim(this.inputSearch.value))},_onKeyDown:function(d){13===(void 0!==d.keyCode?d.keyCode:d.which)&&this.doSearch();d.stopPropagation()},_onKeyUp:function(){this.searchWhenInput&&this.doSearch()},_onBtnClick:function(){this.doSearch()}})})},"jimu/dijit/Selectionbox":function(){define(["dojo/_base/declare",
"dijit/_WidgetBase","dojo/_base/lang","dojo/on","dojo/dom-class"],function(p,g,k,h,f){return p(g,{baseClass:"jimu-selection-box",selected:!1,postCreate:function(){this.selected&&f.add(this.domNode,"jimu-selection-box-selected");this.own(h(this.domNode,"click",k.hitch(this,function(){this.selected?this.unSelect():this.select()})))},select:function(){this.selected=!0;f.add(this.domNode,"jimu-selection-box-selected");this.onStateChange()},unSelect:function(){this.selected=!1;f.remove(this.domNode,"jimu-selection-box-selected");
this.onStateChange()},onStateChange:function(){}})})},"jimu/dijit/ServiceURLInput":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/on dojo/Evented dojo/Deferred dojo/aspect esri/request dijit/form/ValidationTextBox".split(" "),function(p,g,k,h,f,m,e,q,d){return p([d],{_validatingNode:null,_validNode:null,_inValidNode:null,_fetchHandle:null,_fetchErrHandle:null,verify:!0,postCreate:function(){this.inherited(arguments);this._validatingNode=g.create("div",{"class":"jimu-service-validating"},
this.domNode);this._validNode=g.create("div",{"class":"jimu-service-valid"},this.domNode);this._inValidNode=g.create("div",{"class":"jimu-service-invalid"},this.domNode);g.addClass(this.domNode,"jimu-serviceurl-input");this.verify&&this.own(h(this,"Change",k.hitch(this,"_onServiceUrlChange")))},setProcessFunction:function(b,d){this._fetchHandle&&this._fetchErrHandle&&this._removeProcessFunction();"function"===typeof b&&(this._fetchHandle=e.after(this,"onFetch",b),this.own(this._fetchHandle));"function"===
typeof d&&(this._fetchErrHandle=e.after(this,"onFetchError",d),this.own(this._fetchErrHandle))},_removeProcessFunction:function(){this._fetchHandle&&this._fetchHandle.remove&&(this._fetchHandle.remove(),this._fetchHandle=null);this._fetchErrHandle&&this._fetchErrHandle.remove&&(this._fetchErrHandle.remove(),this._fetchErrHandle=null)},onFetch:function(b){return b},onFetchError:function(b){},_onServiceUrlChange:function(b){var d=new m;d.then(k.hitch(this,function(){this._valid()}),k.hitch(this,function(){this._inValid();
this.onFetchError()}));this._validating();q({url:k.trim(b||""),handleAs:"json",content:{f:"json"},callbackParamName:"callback"}).then(k.hitch(this,function(b){this.onFetch({url:this.getValue(),data:b})?d.resolve("success"):d.reject("error")}),k.hitch(this,function(b){d.reject(b)}))},_hideStatus:function(){g.setStyle(this._validNode,{display:"none"});g.setStyle(this._inValidNode,{display:"none"});g.setStyle(this._validatingNode,{display:"none"})},_validating:function(){g.setStyle(this._validNode,{display:"none"});
g.setStyle(this._inValidNode,{display:"none"});g.setStyle(this._validatingNode,{display:"inline-block"});g.removeClass(this.domNode,"jimu-serviceurl-input-invalid")},_valid:function(){g.setStyle(this._validNode,{display:"inline-block"});g.setStyle(this._inValidNode,{display:"none"});g.setStyle(this._validatingNode,{display:"none"});g.removeClass(this.domNode,"jimu-serviceurl-input-invalid")},_inValid:function(){g.setStyle(this._validNode,{display:"none"});g.setStyle(this._inValidNode,{display:"inline-block"});
g.setStyle(this._validatingNode,{display:"none"});g.addClass(this.domNode,"jimu-serviceurl-input-invalid")}})})},"jimu/dijit/SimpleTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/mouse jimu/utils".split(" "),function(p,g,k,h,f,m,e,q,d,b,r){return p([g,k,h],{baseClass:"jimu-simple-table",declaredClass:"jimu.dijit.SimpleTable",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"head-section" data-dojo-attach-point\x3d"headDiv"\x3e\x3c/div\x3e\x3cdiv class\x3d"body-section" data-dojo-attach-point\x3d"bodyDiv"\x3e\x3cdiv class\x3d"table-div" data-dojo-attach-point\x3d"tableDiv"\x3e\x3ctable class\x3d"table" cellspacing\x3d"0" onselectstart\x3d"return false;"\x3e\x3ccolgroup\x3e\x3c/colgroup\x3e\x3cthead class\x3d"simple-table-thead"\x3e\x3c/thead\x3e\x3ctbody class\x3d"simple-table-tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
_name:null,_rowIndex:0,REPEATING_ERROR:"REPEATING_ERROR",autoHeight:!0,selectable:!1,fields:null,postMixInProperties:function(){this.nls=window.jimuNls.simpleTable},postCreate:function(){this.inherited(arguments);this._initSelf()},startup:function(){this.inherited(arguments);this._updateUI()},_updateUI:function(){if(this.autoHeight){var b=this.getRows();m.setStyle(this.domNode,"height",40*((0<b.length?b.length:1)+1)+1+"px")}this._updateHeadDiv()},_updateHeadDiv:function(){m.empty(this.headDiv);var b=
f.clone(this.tableDiv),g=d("input[type\x3dradio]",b);e.forEach(g,function(a){a.name="0"});m.place(b,this.headDiv)},_initSelf:function(){this._initAttachPoints();this.selectable&&this.own(r.bindClickAndDblclickEvents(this.table,f.hitch(this,function(a){if(a=r.getAncestorDom(a.target||a.srcElement,function(a){return m.hasClass(a,"simple-table-tr")&&m.hasClass(a,"not-empty")},this.tbody))this.selectRow(a),this._onClickRow(a)}),f.hitch(this,function(a){if(a=r.getAncestorDom(a.target||a.srcElement,function(a){return m.hasClass(a,
"simple-table-tr")&&m.hasClass(a,"not-empty")},this.tbody))this.selectRow(a),this._onDblClickRow(a)})));var b=Math.random().toString();this._name="jimu_table_"+b.slice(2,b.length);this.thead=d("thead",this.domNode)[0];this.tbody=d("tbody",this.domNode)[0];if(this.fields&&0<this.fields.length){var g=m.create("tr",{},this.thead);e.forEach(this.fields,f.hitch(this,function(a){var b="auto";"actions"===a.type&&(a.name="actions");a.hidden?b=1:void 0!==a.width&&null!==a.width?b=a.width:"actions"===a.type&&
!a.name&&(a.width=this._calculateActionsWidth(a)+20,b=a.width);m.create("col",{width:b},this.colgroup);b=m.create("th",{innerHTML:a.title,title:a.title},g);a.hidden&&m.addClass(b,"hidden-column");a["class"]&&m.addClass(b,a["class"]);m.addClass(b,a.name)}))}else this.fields=null},_initAttachPoints:function(){this.table=d("table",this.bodyDiv)[0];this.colgroup=d("colgroup",this.bodyDiv)[0];this.head=d("thead",this.bodyDiv)[0];this.tbody=d("tbody",this.bodyDiv)[0]},clear:function(){var b=this._getNotEmptyRows();
m.empty(this.tbody);e.forEach(b,f.hitch(this,function(b){this._onDeleteRow(b)}));this._updateUI();this._rowIndex=0;this._onClearRows(b)},addRows:function(b){var d=[];this.fields&&b instanceof Array&&e.forEach(b,f.hitch(this,function(a){d.push(this.addRow(a,!0))}));this._updateUI();return d},addRow:function(b,d){this._rowIndex++;var a={success:!1,tr:null,errorCode:null,errorMessage:null,repeatFields:null};if(!this.fields||"object"!==typeof b)return a;var c=e.filter(this.fields,f.hitch(this,function(a){return"text"===
a.type&&!0===a.unique})),c=e.filter(c,f.hitch(this,function(a){return 0<this.getRowDataArrayByFieldValue(a.name,b[a.name]).length}));if(0<c.length)return a.errorCode=this.REPEATING_ERROR,a.errorMessage="repeating data",a.repeatFields=c,a;var g=m.create("tr",{"class":"simple-table-tr not-empty"},this.tbody);m.setAttr(g,"rowId","row"+this._rowIndex);e.forEach(this.fields,f.hitch(this,function(a){var c=b[a.name],d=a.type,e=null;"actions"===d?this._createActionsTd(g,a):("text"===d?e=this._createTextTd(g,
a,c):"radio"===d?e=this._createRadioTd(g,a,c):"checkbox"===d?e=this._createCheckboxTd(g,a,c):"empty"===d?e=this._createEmptyTd(g,a):"extension"===d&&(e=this._createExtensionTd(g,a,c)),a.hidden&&m.addClass(e,"hidden-column"))}));d||(this._setRowOdevity(),this._updateUI());a.success=!0;a.tr=g;a.errorMessage=null;this._onAddRow(g);return a},deleteRow:function(b){b&&(m.destroy(b),this._setRowOdevity(),this._updateUI(),this._onDeleteRow(b))},selectRow:function(b){d(".simple-table-tr",this.tbody).removeClass("selected");
m.addClass(b,"selected");this._onSelectRow(b)},_setRowOdevity:function(){var b=d(".simple-table-tr",this.tbody);b.removeClass("odd");b.removeClass("even");e.forEach(b,f.hitch(this,function(b,a){0===a%2?m.addClass(b,"odd"):m.addClass(b,"even")}))},_createTextTd:function(b,d,a){var c=null;return c=d.editable?this._createEditableTextTd(b,d,a):this._createNormalTextTd(b,d,a)},_createNormalTextTd:function(b,e,a){var c=m.toDom('\x3ctd class\x3d"simple-table-td normal-text-td"\x3e\x3cdiv class\x3d"normal-text-div"\x3e\x3c/div\x3e\x3c/td\x3e');
m.addClass(c,e.name);d("div",c)[0].innerHTML=a||"";e["class"]&&m.addClass(c,e["class"]);m.place(c,b);return c},_createEditableTextTd:function(b,e,a){var c=m.toDom('\x3ctd class\x3d"editable-text-td '+e.name+'"\x3e\x3cdiv class\x3d"editable-div"\x3e\x3c/div\x3e\x3cinput class\x3d"editable-input" type\x3d"text" style\x3d"display:none;" /\x3e\x3c/td\x3e');m.addClass(c,"simple-table-td");m.place(c,b);e["class"]&&m.addClass(c,e["class"]);var g=d("div",c)[0],l=d("input",c)[0];g.innerHTML=a||"";""!==g.innerHTML&&
(g.title=g.innerHTML);l.value=g.innerHTML;this.own(q(g,"dblclick",f.hitch(this,function(a){a.stopPropagation();l.value=g.innerHTML;m.setStyle(g,"display","none");m.setStyle(l,"display","inline");l.focus();this._updateUI()})));this.own(q(l,"blur",f.hitch(this,function(){l.value=f.trim(l.value);var a=g.innerHTML,c=l.value;""!==c?e.unique?0<this.getRowDataArrayByFieldValue(e.name,c,b).length?l.value=a:g.innerHTML=c:g.innerHTML=c:l.value=a;m.setStyle(l,"display","none");m.setStyle(g,"display","block");
this._updateUI()})));return c},_createRadioTd:function(b,e,a){var c=m.toDom('\x3ctd class\x3d"radio-td '+e.name+'"\x3e\x3cinput type\x3d"radio" /\x3e\x3c/td\x3e');m.addClass(c,"simple-table-td");m.place(c,b);e["class"]&&m.addClass(c,e["class"]);b=d("input",c)[0];b.name=e.radio&&"row"===e.radio?this._name+this._rowIndex:this._name+e.name;b.checked=!0===a;return c},_createCheckboxTd:function(b,e,a){var c=m.toDom('\x3ctd class\x3d"checkbox-td '+e.name+'"\x3e\x3cinput type\x3d"checkbox" /\x3e\x3c/td\x3e');
m.addClass(c,"simple-table-td");m.place(c,b);e["class"]&&m.addClass(c,e["class"]);d("input",c)[0].checked=!0===a;return c},_createActionsTd:function(b,g){var a=m.toDom('\x3ctd class\x3d"actions-td"\x3e\x3cdiv class\x3d"action-item-parent"\x3e\x3c/div\x3e\x3c/td\x3e');m.addClass(a,"simple-table-td");var c=d(".action-item-parent",a)[0];m.place(a,b);g["class"]&&m.addClass(a,g["class"]);e.forEach(g.actions,f.hitch(this,function(a){"up"===a?(a=m.create("div",{"class":"action-item row-up-div"},c),a.title=
this.nls.moveUp,this.own(q(a,"click",f.hitch(this,function(a){a.stopPropagation();if(this.onBeforeRowUp(b)){a=d(".simple-table-tr",this.tbody);var c=e.indexOf(a,b);0<c&&(a=a[c-1])&&m.place(b,a,"before");this._setRowOdevity();this._updateUI()}})))):"down"===a?(a=m.create("div",{"class":"action-item row-down-div"},c),a.title=this.nls.moveDown,this.own(q(a,"click",f.hitch(this,function(a){a.stopPropagation();if(this.onBeforeRowDown(b)){a=d(".simple-table-tr",this.tbody);var c=e.indexOf(a,b);c<a.length-
1&&(a=a[c+1])&&m.place(b,a,"after");this._setRowOdevity();this._updateUI()}})))):"edit"===a?(a=m.create("div",{"class":"action-item row-edit-div"},c),a.title=this.nls.edit,this.own(q(a,"click",f.hitch(this,function(a){a.stopPropagation();this.onBeforeRowEdit(b)&&(this._updateUI(),this._onActionsEdit(b))})))):"delete"===a&&(a=m.create("div",{"class":"action-item row-delete-div"},c),a.title=this.nls.deleteRow,this.own(q(a,"click",f.hitch(this,function(a){a.stopPropagation();this.onBeforeRowDelete(b)&&
this.deleteRow(b)}))))}));var h=this._calculateActionsWidth(g)+"px";m.setStyle(c,"width",h);return a},_calculateActionsWidth:function(b){return 20*e.map(b.actions,function(b){return"up"===b||"down"===b||"edit"===b||"delete"===b}).length},_createEmptyTd:function(b,d){var a=m.create("td",{"class":d.name},b);m.addClass(a,"simple-table-td");m.addClass(a,"empty-text-td");d["class"]&&m.addClass(a,d["class"]);return a},_createExtensionTd:function(b,d,a){b=m.create("td",{"class":d.name},b);m.addClass(b,"simple-table-td");
m.addClass(b,"extension-td");d["class"]&&m.addClass(b,d["class"]);d.create&&"function"===typeof d.create&&d.create(b);d.setValue&&"function"===typeof d.setValue&&d.setValue(b,a);return b},editRow:function(b,g){var a={success:!1,tr:null,errorCode:null,errorMessage:null,repeatFields:null};if(!this.fields||"object"!==typeof g||!m.isDescendant(b,this.tbody))return a;var c=f.mixin([],this.fields),c=e.filter(c,f.hitch(this,function(a){return"text"===a.type&&!0===a.unique})),c=e.filter(c,f.hitch(this,function(a){return 0<
this.getRowDataArrayByFieldValue(a.name,g[a.name],b).length}));if(0<c.length)return a.errorCode=this.REPEATING_ERROR,a.errorMessage="repeating data",a.repeatFields=c,a;var h=d(".simple-table-td",b);e.forEach(this.fields,f.hitch(this,function(a,b){if(g.hasOwnProperty(a.name)){var c=h[b],d=g[a.name],e=a.type;"text"===e?a.editable?this._editEditableText(c,a,d):this._editNormalText(c,a,d):"radio"===e?this._editRadio(c,a,d):"checkbox"===e?this._editCheckbox(c,a,d):"extension"===e&&this._editExtension(c,
a,d)}}));a.success=!0;a.tr=b;a.errorMessage=null;this._onEditRow(b);return a},_editNormalText:function(b,e,a){b=d("div",b)[0];b.innerHTML=a||"";b.title=b.innerHTML},_editEditableText:function(b,e,a){e=d("div",b)[0];e.innerHTML=a||"";d("input",b)[0].value=e.innerHTML},_editRadio:function(b,e,a){d("input",b)[0].checked=!0===a},_editCheckbox:function(b,e,a){d("input",b)[0].checked=!0===a},_editExtension:function(b,d,a){d.setValue&&"function"===typeof d.setValue&&d.setValue(b,a)},_getAllRows:function(){return d(".simple-table-tr",
this.tbody)},_getNotEmptyRows:function(){var b=this._getAllRows();return e.filter(b,f.hitch(this,function(b){return!m.hasClass(b,"empty")}))},_getEmptyRows:function(){var b=this._getAllRows();return e.filter(b,f.hitch(this,function(b){return m.hasClass(b,"empty")}))},getRows:function(){return this._getNotEmptyRows()},getSelectedRow:function(){var b=null,g=d(".simple-table-tr",this.tbody),g=e.filter(g,f.hitch(this,function(a){return!m.hasClass(a,"empty")&&m.hasClass(a,"selected")}));0<g.length&&(b=
g[0]);return b},getSelectedRowData:function(){var b=null,d=this.getSelectedRow();d&&(b=this._getRowDataByTr(d));return b},getData:function(b){var d=this._getNotEmptyRows();b&&(d=e.filter(d,f.hitch(this,function(a){return a!==b})));return e.map(d,f.hitch(this,function(a){return this._getRowDataByTr(a)}))},getRowData:function(b){return this._getRowDataByTr(b)},_getRowDataByTr:function(b){var g=null;if(b)g={};else return null;e.forEach(this.fields,f.hitch(this,function(a){var c=a.type;if("actions"!==
c){var e=a.name;g[e]=null;var f=d("."+e,b)[0];f&&("text"===c?(a=d("div",f)[0],g[e]=a.innerHTML):"radio"===c?(a=d("input",f)[0],g[e]=a.checked):"checkbox"===c?(a=d("input",f)[0],g[e]=a.checked):"extension"===c&&a.getValue&&"function"===typeof a.getValue&&(g[e]=a.getValue(f,a)))}}));return g},getRowDataArrayByFieldValue:function(b,d,a){var c=[];if(!this.fields||!e.some(this.fields,f.hitch(this,function(a){return a.name===b})))return[];a=this.getData(a);return c=e.filter(a,f.hitch(this,function(a){return a[b]==
d}))},_onClickRow:function(b){this.emit("row-click",b)},_onDblClickRow:function(b){this.emit("row-dblclick",b)},_onSelectRow:function(b){this.emit("row-select",b)},_onAddRow:function(b){this.emit("row-add",b)},_onEditRow:function(b){this.emit("row-edit",b)},_onDeleteRow:function(b){this.emit("row-delete",b)},_onEnterRow:function(b){this.emit("row-enter",b)},_onClearRows:function(b){this.emit("rows-clear",b)},_onActionsEdit:function(b){this.emit("actions-edit",b)},onBeforeRowUp:function(b){return!0},
onBeforeRowDown:function(b){return!0},onBeforeRowEdit:function(b){return!0},onBeforeRowDelete:function(b){return!0}})})},"jimu/dijit/TabContainer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dojo/NodeList-manipulate dijit/_WidgetBase dijit/_TemplatedMixin ./ViewStack ../utils".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n){return p([d,b,m],{"class":"jimu-tab",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"control" data-dojo-attach-point\x3d"controlNode"\x3e\x3c/div\x3e\x3cdiv class\x3d"jimu-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\x3c/div\x3e',
postCreate:function(){this.inherited(arguments);if(0!==this.tabs.length){this.controlNodes=[];this.viewStack=new r(null,this.containerNode);var b=100*(1/this.tabs.length);this.isNested&&h.addClass(this.domNode,"nested");k.forEach(this.tabs,function(a){this._createTab(a,b)},this)}},startup:function(){this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title);n.setVerticalCenter(this.domNode)},_createTab:function(b,a){var c;c=h.create("div",{innerHTML:b.title,
"class":"tab jimu-vcenter-text",style:{width:this.isNested?"auto":a+"%"},label:b.title},this.controlNode);this.viewStack.viewType=b.content.domNode?"dijit":"dom";b.content.label=b.title;this.viewStack.addView(b.content);this.own(f(c,"click",g.hitch(this,this.onSelect,b.title)));c.label=b.title;this.controlNodes.push(c)},onSelect:function(b){this.selectTab(b)},selectTab:function(b){this._selectControl(b);this.viewStack.switchView(b);this.emit("tabChanged",b)},_selectControl:function(b){k.forEach(this.controlNodes,
function(a){h.removeClass(a,"jimu-state-selected");a.label===b&&h.addClass(a,"jimu-state-selected")})}})})},"dojo/NodeList-manipulate":function(){define("./query ./_base/lang ./_base/array ./dom-construct ./dom-attr ./NodeList-dom".split(" "),function(p,g,k,h,f){function m(d){for(;d.childNodes[0]&&1==d.childNodes[0].nodeType;)d=d.childNodes[0];return d}function e(d,b){"string"==typeof d?(d=h.toDom(d,b&&b.ownerDocument),11==d.nodeType&&(d=d.childNodes[0])):1==d.nodeType&&d.parentNode&&(d=d.cloneNode(!1));
return d}var q=p.NodeList;g.extend(q,{_placeMultiple:function(d,b){for(var e="string"==typeof d||d.nodeType?p(d):d,f=[],g=0;g<e.length;g++)for(var a=e[g],c=this.length,k=c-1,l;l=this[k];k--)0<g&&(l=this._cloneNode(l),f.unshift(l)),k==c-1?h.place(l,a,b):a.parentNode.insertBefore(l,a),a=l;f.length&&(f.unshift(0),f.unshift(this.length-1),Array.prototype.splice.apply(this,f));return this},innerHTML:function(d){return arguments.length?this.addContent(d,"only"):this[0].innerHTML},text:function(d){if(arguments.length){for(var b=
0,e;e=this[b];b++)1==e.nodeType&&f.set(e,"textContent",d);return this}for(var g="",b=0;e=this[b];b++)g+=f.get(e,"textContent");return g},val:function(d){if(arguments.length){for(var b=g.isArray(d),e=0,f;f=this[e];e++){var h=f.nodeName.toUpperCase(),a=f.type,c=b?d[e]:d;if("SELECT"==h){h=f.options;for(a=0;a<h.length;a++){var m=h[a];m.selected=f.multiple?-1!=k.indexOf(d,m.value):m.value==c}}else"checkbox"==a||"radio"==a?f.checked=f.value==c:f.value=c}return this}if((f=this[0])&&1==f.nodeType){d=f.value||
"";if("SELECT"==f.nodeName.toUpperCase()&&f.multiple){d=[];h=f.options;for(a=0;a<h.length;a++)m=h[a],m.selected&&d.push(m.value);d.length||(d=null)}return d}},append:function(d){return this.addContent(d,"last")},appendTo:function(d){return this._placeMultiple(d,"last")},prepend:function(d){return this.addContent(d,"first")},prependTo:function(d){return this._placeMultiple(d,"first")},after:function(d){return this.addContent(d,"after")},insertAfter:function(d){return this._placeMultiple(d,"after")},
before:function(d){return this.addContent(d,"before")},insertBefore:function(d){return this._placeMultiple(d,"before")},remove:q.prototype.orphan,wrap:function(d){if(this[0]){d=e(d,this[0]);for(var b=0,f;f=this[b];b++){var g=this._cloneNode(d);f.parentNode&&f.parentNode.replaceChild(g,f);m(g).appendChild(f)}}return this},wrapAll:function(d){if(this[0]){d=e(d,this[0]);this[0].parentNode.replaceChild(d,this[0]);d=m(d);for(var b=0,f;f=this[b];b++)d.appendChild(f)}return this},wrapInner:function(d){if(this[0]){d=
e(d,this[0]);for(var b=0;b<this.length;b++){var f=this._cloneNode(d);this._wrap(g._toArray(this[b].childNodes),null,this._NodeListCtor).wrapAll(f)}}return this},replaceWith:function(d){d=this._normalize(d,this[0]);for(var b=0,e;e=this[b];b++)this._place(d,e,"before",0<b),e.parentNode.removeChild(e);return this},replaceAll:function(d){d=p(d);for(var b=this._normalize(this,this[0]),e=0,f;f=d[e];e++)this._place(b,f,"before",0<e),f.parentNode.removeChild(f);return this},clone:function(){for(var d=[],
b=0;b<this.length;b++)d.push(this._cloneNode(this[b]));return this._wrap(d,this,this._NodeListCtor)}});q.prototype.html||(q.prototype.html=q.prototype.innerHTML);return q})},"jimu/dijit/ViewStack":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/html","dojo/_base/array","dijit/_WidgetBase"],function(p,g,k,h,f){return p(f,{baseClass:"jimu-viewstack",_currentView:null,postCreate:function(){this.inherited(arguments);this.views||(this.views=[]);h.forEach(this.views,g.hitch(this,function(f){1===
f.nodeType?(k.place(f,this.domNode),k.addClass(f,"view")):f.domNode&&(k.place(f.domNode,this.domNode),k.addClass(f.domNode,"view"))}))},startup:function(){this.inherited(arguments);0<this.views.length&&this.switchView(0)},getSelectedView:function(){return this._currentView},getSelectedLabel:function(){var f="",e=this.getSelectedView();e&&(f=e.label);return f},getViewByLabel:function(f){for(var e=0;e<this.views.length;e++)if(f===this.views[e].label)return this.views[e];return null},addView:function(f){this.views.push(f);
1===f.nodeType?(k.place(f,this.domNode),k.addClass(f,"view")):f.domNode&&(k.place(f.domNode,this.domNode),k.addClass(f.domNode,"view"))},removeView:function(f){var e=this.views.length;this.views=h.filter(this.views,function(e){return f!==e});e!==this.views.length&&(1===f.nodeType?k.destroy(f):f.domNode&&f.destroyRecursive())},switchView:function(f){var e,h;e="number"===typeof f?this.views[f]:"string"===typeof f?this.getViewByLabel(f):f;this.views.forEach(g.hitch(this,function(d){d&&(1===d.nodeType?
h=d:d.domNode&&(h=d.domNode),d===e?(k.setStyle(h,"display","block"),d.domNode&&!d._started&&(d.startup(),d._started=!0)):k.setStyle(h,"display","none"))}));this._currentView=e;this.onViewSwitch(e)},onViewSwitch:function(){}})})},"jimu/dijit/TabContainer3":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/html dojo/on dojo/Evented dojo/query dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/TabContainer3.html jimu/dijit/ViewStack".split(" "),function(p,g,
k,h,f,m,e,q,d,b,r){return p([q,d,m],{templateString:b,selected:"",tabs:null,average:!1,"class":"jimu-tab3",_currentIndex:-1,postCreate:function(){this.inherited(arguments);this._initSelf();this.selected?this.selectTab(this.selected):0<this.tabs.length&&this.selectTab(this.tabs[0].title)},selectTab:function(b){var d=e("td",this.tabTr);k.forEach(d,g.hitch(this,function(a,c){h.removeClass(a,"selected");a.label===b?(h.addClass(a,"selected"),a.style.borderLeft="1px solid #ccc",a.style.borderRight="1px solid #ccc",
a.style.borderTop="2px solid #15a4fa",a.style.borderBottom="0",this._currentIndex=c):(a.style.borderLeft="0",a.style.borderRight="0",a.style.borderTop="0",a.style.borderBottom="1px solid #ccc")}));this.controlNode.removeChild(this.controlTable);h.place(this.controlTable,this.controlNode);this.viewStack.switchView(b);this.emit("tabChanged",b)},showShelter:function(){h.setStyle(this.shelter,"display","block")},hideShelter:function(){h.setStyle(this.shelter,"display","none")},getSelectedIndex:function(){return this._currentIndex},
getSelectedTitle:function(){return this.viewStack.getSelectedLabel()},_initSelf:function(){this.viewStack=new r(null,this.containerNode);k.forEach(this.tabs,function(b){this._createTab(b)},this);if(this.average)this.controlTable.style.tableLayout="fixed";else{var b=h.toDom('\x3ctd nowrap class\x3d"tab-item-td" style\x3d"border-bottom:1px solid #ccc;"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');h.place(b,this.tabTr)}},startup:function(){this.inherited(arguments);this._started=!0},
_createTab:function(b){var d=h.toDom('\x3ctd nowrap class\x3d"tab-item-td"\x3e\x3cdiv class\x3d"tab-item-div"\x3e\x3c/div\x3e\x3c/td\x3e');d.label=b.title||"";h.place(d,this.tabTr);var a=e(".tab-item-div",d)[0];a.innerHTML=d.label;a.label=d.label;b.content.label=d.label;this.viewStack.addView(b.content);this.own(f(d,"click",g.hitch(this,this._onSelect,b.title)))},_onSelect:function(b){this.selectTab(b)}})})},"jimu/dijit/TileLayoutContainer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/dom-construct dojo/mouse dojo/query dijit/_WidgetBase".split(" "),
function(p,g,k,h,f,m,e,q){return p([q],{baseClass:"jimu-tile-container",constructor:function(){this.items=[];this.margin=15},startup:function(){this.inherited(arguments);this.items.forEach(g.hitch(this,function(d){this._placeItem(d)}));this.resize()},_placeItem:function(d){d.domNode?k.place(d.domNode,this.domNode):k.place(d,this.domNode)},addItem:function(d){this.items.push(d);this._placeItem(d);this.resize()},addItems:function(d){this.items=this.items.concat(d);this.items.forEach(g.hitch(this,function(b){this._placeItem(b)}));
this.resize()},removeItem:function(d){var b;for(b=0;b<this.items.length;b++)if(this.items[b].label===d){this.items[b].domNode?this.items[b].destroy():k.destroy(this.items[b]);this.items.splice(b,1);this.resize();break}},empty:function(){var d;for(d=0;d<this.items.length;d++)this.items[d].domNode?this.items[d].destroy():k.destroy(this.items[d]);this.items=[]},resize:function(){var d,b,e;d=k.getMarginBox(this.domNode);b=this.getItemSize(d);e=Math.floor((d.w+this.margin)/(b.width+this.margin));this.items.forEach(g.hitch(this,
function(d,f){this.setItemPosition(d,f,b,e)}))},getItemSize:function(d){var b={},e;if("fixWidth"===this.strategy)b.width=this.itemSize.width,b.height=this.itemSize.height;else if("breakWidth"===this.strategy)for(e=0;e<this.itemSize.length;e++){if(d.w<=this.itemSize[e].screenWidth){b.width=this.itemSize[e].width;b.height=this.itemSize[e].height;break}}else"fixCols"===this.strategy&&(b.width=(d.w-this.margin*(this.maxCols-1))/this.maxCols,b.height="number"===typeof this.itemSize.height?this.itemSize.height:
b.width*parseFloat(this.itemSize.height.substring(0,this.itemSize.height.length-1))/100);return b},setItemPosition:function(d,b,e,f){b++;b={marginLeft:1===b%f?0:this.margin+"px",marginTop:1===Math.ceil(b/f)?0:this.margin+"px"};0<=e.width&&(b.width=e.width+"px");0<=e.height&&(b.height=e.height+"px");k.setStyle(d.domNode?d.domNode:d,b)}})})},"jimu/dijit/DrawBox":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/DrawBox.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query esri/layers/GraphicsLayer esri/graphic esri/toolbars/draw esri/symbols/jsonUtils".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a){return p([g,k,h],{templateString:f,baseClass:"jimu-draw-box",nls:null,types:null,pointSymbol:null,lineSymbol:null,polygonSymbol:null,textSymbol:null,map:null,drawLayer:null,drawLayerId:null,drawToolBar:null,showClear:!1,keepOneGraphic:!1,postMixInProperties:function(){this.nls=window.jimuNls.drawBox},postCreate:function(){this.inherited(arguments);var a={};this.drawLayerId&&(a.id=this.drawLayerId);this.drawLayer=new r(a);this._initDefaultSymbols();this._initTypes();
a=b(".draw-item",this.domNode);this.own(a.on("click",m.hitch(this,this._onItemClick)));this.own(d(this.btnClear,"click",m.hitch(this,this.clear)));this.map&&this.setMap(this.map);e.setStyle(this.btnClear,"display",!0===this.showClear?"block":"none")},disableWebMapPopup:function(){if(this.map&&this.map.webMapResponse){var a=this.map.webMapResponse.clickEventHandle;a&&(a.remove(),this.map.webMapResponse.clickEventHandle=null)}},enableWebMapPopup:function(){if(this.map&&this.map.webMapResponse){var a=
this.map.webMapResponse.clickEventHandle,b=this.map.webMapResponse.clickEventListener;b&&!a&&(this.map.webMapResponse.clickEventHandle=d(this.map,"click",m.hitch(this.map,b)))}},destroy:function(){this.drawToolBar&&this.drawToolBar.deactivate();this.drawLayer&&this.map&&this.map.removeLayer(this.drawLayer);this.drawLayer=this.map=this.drawToolBar=null;this.inherited(arguments)},setMap:function(a){a&&(this.map=a,this.map.addLayer(this.drawLayer),this.drawToolBar=new t(this.map),this.drawToolBar.setMarkerSymbol(this.pointSymbol),
this.drawToolBar.setLineSymbol(this.lineSymbol),this.drawToolBar.setFillSymbol(this.polygonSymbol),this.own(d(this.drawToolBar,"draw-end",m.hitch(this,this._onDrawEnd))))},setPointSymbol:function(a){this.pointSymbol=a;this.drawToolBar.setMarkerSymbol(this.pointSymbol)},setLineSymbol:function(a){this.lineSymbol=a;this.drawToolBar.setLineSymbol(a)},setPolygonSymbol:function(a){this.polygonSymbol=a;this.drawToolBar.setFillSymbol(a)},setTextSymbol:function(a){this.textSymbol=a},clear:function(){this.drawLayer.clear();
this.onClear()},deactivate:function(){this.enableWebMapPopup();this.drawToolBar&&this.drawToolBar.deactivate();b(".draw-item",this.domNode).removeClass("selected")},onIconSelected:function(a,b,d){},onDrawEnd:function(a,b,d){},onClear:function(){},addGraphic:function(a){this.keepOneGraphic&&this.drawLayer.clear();this.drawLayer.add(a)},removeGraphic:function(a){this.drawLayer.remove(a)},_initDefaultSymbols:function(){var b={style:"esriSMSCircle",color:[0,0,128,128],name:"Circle",outline:{color:[0,
0,128,255],width:1},type:"esriSMS",size:18},d={style:"esriSLSSolid",color:[79,129,189,255],width:3,name:"Blue 1",type:"esriSLS"},e={style:"esriSFSSolid",color:[79,129,189,128],type:"esriSFS",outline:{style:"esriSLSSolid",color:[54,93,141,255],width:1.5,type:"esriSLS"}};this.pointSymbol||(this.pointSymbol=a.fromJson(b));this.lineSymbol||(this.lineSymbol=a.fromJson(d));this.polygonSymbol||(this.polygonSymbol=a.fromJson(e))},_initTypes:function(){this.types instanceof Array||(this.types=["point","polyline",
"polygon"]);var a=b(".draw-item",this.domNode);a.style("display","none");q.forEach(a,m.hitch(this,function(a){var b=a.getAttribute("data-commontype"),b=0<=q.indexOf(this.types,b)?"block":"none";e.setStyle(a,"display",b)}))},_onItemClick:function(a){a=a.target||a.srcElement;b(".draw-item",this.domNode).removeClass("selected");e.addClass(a,"selected");var d=a.getAttribute("data-geotype"),f=a.getAttribute("data-commontype"),g=t[d];this.disableWebMapPopup();this.drawToolBar.activate(g);this.onIconSelected(a,
d,f)},_onDrawEnd:function(a){var d=b(".draw-item.selected",this.domNode)[0],f=d.getAttribute("data-geotype"),d=d.getAttribute("data-commontype");a=a.geometry;var g=a.type,h=null,h="point"===g||"multipoint"===g?e.hasClass(this.textIcon,"selected")?this.textSymbol:this.pointSymbol:"line"===g||"polyline"===g?this.lineSymbol:this.polygonSymbol;a=new n(a,h,null,null);this.keepOneGraphic&&this.drawLayer.clear();this.drawLayer.add(a);this.deactivate();this.onDrawEnd(a,f,d)}})})},"esri/toolbars/draw":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/Color dojo/_base/window dojo/has dojo/sniff dojo/keys dojo/dom-construct dojo/dom-style dojo/dom-geometry ../kernel ../sniff ./_toolbar ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../graphic ../geometry/jsonUtils ../geometry/webMercatorUtils ../geometry/Polyline ../geometry/Polygon ../geometry/Multipoint ../geometry/Rect dojo/i18n!../nls/jsapi".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z,A,x,u,C,E,F,y){var v=p(c,{declaredClass:"esri.toolbars.Draw",_eventMap:{"draw-complete":!0,"draw-end":["geometry"]},constructor:function(a,b){this.markerSymbol=new s(s.STYLE_SOLID,10,new l(l.STYLE_SOLID,new f([255,0,0]),2),new f([0,0,0,0.25]));this.lineSymbol=new l(l.STYLE_SOLID,new f([255,0,0]),2);this.fillSymbol=new w(w.STYLE_SOLID,new l(l.STYLE_SOLID,new f([255,0,0]),2),new f([0,0,0,0.25]));this._points=[];this._mouse=!e("esri-touch")&&!e("esri-pointer");
this._defaultOptions={showTooltips:!0,drawTime:75,tolerance:8,tooltipOffset:15};this._options=g.mixin(g.mixin({},this._defaultOptions),b||{});if(q("ios")||q("android"))this._options.showTooltips=!1;this._onKeyDownHandler=g.hitch(this,this._onKeyDownHandler);this._onMouseDownHandler=g.hitch(this,this._onMouseDownHandler);this._onMouseUpHandler=g.hitch(this,this._onMouseUpHandler);this._onClickHandler=g.hitch(this,this._onClickHandler);this._onMouseMoveHandler=g.hitch(this,this._onMouseMoveHandler);
this._onMouseDragHandler=g.hitch(this,this._onMouseDragHandler);this._onDblClickHandler=g.hitch(this,this._onDblClickHandler);this._updateTooltip=g.hitch(this,this._updateTooltip);this._hideTooltip=g.hitch(this,this._hideTooltip);this._redrawGraphic=g.hitch(this,this._redrawGraphic)},_geometryType:null,respectDrawingVertexOrder:!1,setRespectDrawingVertexOrder:function(a){this.respectDrawingVertexOrder=a},setMarkerSymbol:function(a){this.markerSymbol=a},setLineSymbol:function(a){this.lineSymbol=a},
setFillSymbol:function(a){this.fillSymbol=a},activate:function(a,b){this._geometryType&&this.deactivate();var c=this.map,d=h.connect,f=v;this._options=g.mixin(g.mixin({},this._options),b||{});c.navigationManager.setImmediateClick(!1);switch(a){case f.ARROW:case f.LEFT_ARROW:case f.RIGHT_ARROW:case f.UP_ARROW:case f.DOWN_ARROW:case f.TRIANGLE:case f.CIRCLE:case f.ELLIPSE:case f.RECTANGLE:this._deactivateMapTools(!0,!1,!1,!0);this._onClickHandler_connect=d(c,"onClick",this._onClickHandler);this._onMouseDownHandler_connect=
d(c,this._mouse?"onMouseDown":"onSwipeStart",this._onMouseDownHandler);this._onMouseDragHandler_connect=d(c,this._mouse?"onMouseDrag":"onSwipeMove",this._onMouseDragHandler);this._onMouseUpHandler_connect=d(c,this._mouse?"onMouseUp":"onSwipeEnd",this._onMouseUpHandler);e("esri-touch")&&!e("esri-pointer")&&(this._onMouseDownHandler2_connect=d(c,"onMouseDown",this._onMouseDownHandler),this._onMouseDragHandler2_connect=d(c,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler2_connect=d(c,"onMouseUp",
this._onMouseUpHandler));break;case f.POINT:this._onClickHandler_connect=d(c,"onClick",this._onClickHandler);break;case f.LINE:case f.EXTENT:case f.FREEHAND_POLYLINE:case f.FREEHAND_POLYGON:this._deactivateMapTools(!0,!1,!1,!0);this._onMouseDownHandler_connect=d(c,this._mouse?"onMouseDown":"onSwipeStart",this._onMouseDownHandler);this._onMouseDragHandler_connect=d(c,this._mouse?"onMouseDrag":"onSwipeMove",this._onMouseDragHandler);this._onMouseUpHandler_connect=d(c,this._mouse?"onMouseUp":"onSwipeEnd",
this._onMouseUpHandler);e("esri-touch")&&!e("esri-pointer")&&(this._onMouseDownHandler2_connect=d(c,"onMouseDown",this._onMouseDownHandler),this._onMouseDragHandler2_connect=d(c,"onMouseDrag",this._onMouseDragHandler),this._onMouseUpHandler2_connect=d(c,"onMouseUp",this._onMouseUpHandler));break;case f.POLYLINE:case f.POLYGON:case f.MULTI_POINT:c.navigationManager.setImmediateClick(!0);this._onClickHandler_connect=d(c,"onClick",this._onClickHandler);this._onDblClickHandler_connect=d(c,"onDblClick",
this._onDblClickHandler);this._dblClickZoom=c.isDoubleClickZoom;c.disableDoubleClickZoom();break;default:console.error("Unsupported geometry type: "+a);return}this._onKeyDown_connect=d(c,"onKeyDown",this._onKeyDownHandler);this._redrawConnect=d(c,"onExtentChange",this._redrawGraphic);this._geometryType=a;this._toggleTooltip(!0);c.snappingManager&&("freehandpolyline"!==this._geometryType&&"freehandpolygon"!==this._geometryType)&&(c.snappingManager._startSelectionLayerQuery(),c.snappingManager._setUpSnapping());
this.onActivate(this._geometryType)},deactivate:function(){var a=this.map;this._clear();var b=h.disconnect;b(this._onMouseMoveHandler_connect);b(this._onMouseDownHandler_connect);b(this._onMouseDragHandler_connect);b(this._onMouseUpHandler_connect);b(this._onMouseDownHandler2_connect);b(this._onMouseDragHandler2_connect);b(this._onMouseUpHandler2_connect);b(this._onClickHandler_connect);b(this._onDblClickHandler_connect);b(this._onKeyDown_connect);b(this._redrawConnect);this._onMouseDownHandler_connect=
this._onMouseMoveHandler_connect=this._onMouseDragHandler_connect=this._onMouseUpHandler_connect=this._onMouseDownHandler2_connect=this._onMouseDragHandler2_connect=this._onMouseUpHandler2_connect=this._onClickHandler_connect=this._onDblClickHandler_connect=this._onKeyDown_connect=this._redrawConnect=null;a.snappingManager&&(a.snappingManager._stopSelectionLayerQuery(),a.snappingManager._killOffSnapping());switch(this._geometryType){case v.CIRCLE:case v.ELLIPSE:case v.TRIANGLE:case v.ARROW:case v.LEFT_ARROW:case v.RIGHT_ARROW:case v.UP_ARROW:case v.DOWN_ARROW:case v.RECTANGLE:case v.LINE:case v.EXTENT:case v.FREEHAND_POLYLINE:case v.FREEHAND_POLYGON:this._activateMapTools(!0,
!1,!1,!0);break;case v.POLYLINE:case v.POLYGON:case v.MULTI_POINT:this._dblClickZoom&&a.enableDoubleClickZoom()}b=this._geometryType;this._geometryType=null;a.navigationManager.setImmediateClick(!1);this._toggleTooltip(!1);this.onDeactivate(b)},_clear:function(){this._graphic&&this.map.graphics.remove(this._graphic,!0);this._tGraphic&&this.map.graphics.remove(this._tGraphic,!0);this._graphic=this._tGraphic=null;this.map.snappingManager&&this.map.snappingManager._setGraphic(null);this._points=[]},
finishDrawing:function(){var a,b=this._points,c=this.map.spatialReference,d=v,b=b.slice(0,b.length);switch(this._geometryType){case d.POLYLINE:if(!this._graphic||2>b.length)return;a=new u(c);a.addPath([].concat(b));break;case d.POLYGON:if(!this._graphic||3>b.length)return;a=new C(c);b=[].concat(b,[b[0].offset(0,0)]);!C.prototype.isClockwise(b)&&!this.respectDrawingVertexOrder&&(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),b.reverse());
a.addRing(b);break;case d.MULTI_POINT:a=new E(c),k.forEach(b,function(b){a.addPoint(b)})}h.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(a)},_drawEnd:function(a){if(a){var b=this.map.spatialReference,c;this.onDrawEnd(a);b&&(b.isWebMercator()?c=x.webMercatorToGeographic(a,!0):4326===b.wkid&&(c=A.fromJson(a.toJson())));this.onDrawComplete({geometry:a,geographicGeometry:c})}},_normalizeRect:function(a,b,c){var d=a.x;a=a.y;var e=b.x;b=b.y;var f=Math.abs(d-
e),g=Math.abs(a-b);return{x:Math.min(d,e),y:Math.max(a,b),width:f,height:g,spatialReference:c}},_onMouseDownHandler:function(a){this._dragged=!1;var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c=b||a.mapPoint,d=v;b=this.map;var f=b.spatialReference;this._points.push(c.offset(0,0));switch(this._geometryType){case d.LINE:this._graphic=b.graphics.add(new z(new u({paths:[[[c.x,c.y],[c.x,c.y]]],spatialReference:f}),this.lineSymbol),!0);b.snappingManager&&b.snappingManager._setGraphic(this._graphic);
break;case d.FREEHAND_POLYLINE:this._oldPoint=a.screenPoint;c=new u(f);c.addPath(this._points);this._graphic=b.graphics.add(new z(c,this.lineSymbol),!0);b.snappingManager&&b.snappingManager._setGraphic(this._graphic);break;case d.CIRCLE:case d.ELLIPSE:case d.TRIANGLE:case d.ARROW:case d.LEFT_ARROW:case d.RIGHT_ARROW:case d.UP_ARROW:case d.DOWN_ARROW:case d.RECTANGLE:case d.FREEHAND_POLYGON:this._oldPoint=a.screenPoint,c=new C(f),c.addRing(this._points),this._graphic=b.graphics.add(new z(c,this.fillSymbol),
!0),b.snappingManager&&b.snappingManager._setGraphic(this._graphic)}e("esri-touch")&&a.preventDefault()},_onMouseMoveHandler:function(a){var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c=this._points[this._points.length-1];a=b||a.mapPoint;b=this._tGraphic;var d=b.geometry;switch(this._geometryType){case v.POLYLINE:case v.POLYGON:d.setPoint(0,0,{x:c.x,y:c.y}),d.setPoint(0,1,{x:a.x,y:a.y}),b.setGeometry(d)}},_onMouseDragHandler:function(a){if(e("esri-touch")&&!this._points.length)a.preventDefault();
else{this._dragged=!0;var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c=this._points[0],d=b||a.mapPoint,f=this.map,h=f.spatialReference;b=this._graphic;var l=v,k=f.toScreen(c),n=f.toScreen(d),m=[],m=n.x-k.x,n=n.y-k.y,r=Math.sqrt(m*m+n*n);switch(this._geometryType){case l.CIRCLE:this._hideTooltip();b.geometry=C.createCircle({center:k,r:r,numberOfPoints:60,map:f});b.setGeometry(b.geometry);break;case l.ELLIPSE:this._hideTooltip();b.geometry=C.createEllipse({center:k,
longAxis:m,shortAxis:n,numberOfPoints:60,map:f});b.setGeometry(b.geometry);break;case l.TRIANGLE:this._hideTooltip();m=[[0,-r],[0.8660254037844386*r,0.5*r],[-0.8660254037844386*r,0.5*r],[0,-r]];b.geometry=this._toPolygon(m,k.x,k.y);b.setGeometry(b.geometry);break;case l.ARROW:this._hideTooltip();c=n/r;f=m/r;d=0.25*f*r;h=0.25*r/(n/m);r*=0.25*c;m=[[m,n],[m-d*(1+24/h),n+24*f-r],[m-d*(1+12/h),n+12*f-r],[-12*c,12*f],[12*c,-12*f],[m-d*(1-12/h),n-12*f-r],[m-d*(1-24/h),n-24*f-r],[m,n]];b.geometry=this._toPolygon(m,
k.x,k.y);b.setGeometry(b.geometry);break;case l.LEFT_ARROW:this._hideTooltip();m=0>=m?[[m,0],[0.75*m,n],[0.75*m,0.5*n],[0,0.5*n],[0,-0.5*n],[0.75*m,-0.5*n],[0.75*m,-n],[m,0]]:[[0,0],[0.25*m,n],[0.25*m,0.5*n],[m,0.5*n],[m,-0.5*n],[0.25*m,-0.5*n],[0.25*m,-n],[0,0]];b.geometry=this._toPolygon(m,k.x,k.y);b.setGeometry(b.geometry);break;case l.RIGHT_ARROW:this._hideTooltip();m=0<=m?[[m,0],[0.75*m,n],[0.75*m,0.5*n],[0,0.5*n],[0,-0.5*n],[0.75*m,-0.5*n],[0.75*m,-n],[m,0]]:[[0,0],[0.25*m,n],[0.25*m,0.5*n],
[m,0.5*n],[m,-0.5*n],[0.25*m,-0.5*n],[0.25*m,-n],[0,0]];b.geometry=this._toPolygon(m,k.x,k.y);b.setGeometry(b.geometry);break;case l.UP_ARROW:this._hideTooltip();m=0>=n?[[0,n],[-m,0.75*n],[-0.5*m,0.75*n],[-0.5*m,0],[0.5*m,0],[0.5*m,0.75*n],[m,0.75*n],[0,n]]:[[0,0],[-m,0.25*n],[-0.5*m,0.25*n],[-0.5*m,n],[0.5*m,n],[0.5*m,0.25*n],[m,0.25*n],[0,0]];b.geometry=this._toPolygon(m,k.x,k.y);b.setGeometry(b.geometry);break;case l.DOWN_ARROW:this._hideTooltip();m=0<=n?[[0,n],[-m,0.75*n],[-0.5*m,0.75*n],[-0.5*
m,0],[0.5*m,0],[0.5*m,0.75*n],[m,0.75*n],[0,n]]:[[0,0],[-m,0.25*n],[-0.5*m,0.25*n],[-0.5*m,n],[0.5*m,n],[0.5*m,0.25*n],[m,0.25*n],[0,0]];b.geometry=this._toPolygon(m,k.x,k.y);b.setGeometry(b.geometry);break;case l.RECTANGLE:this._hideTooltip();m=[[0,0],[m,0],[m,n],[0,n],[0,0]];b.geometry=this._toPolygon(m,k.x,k.y);b.setGeometry(b.geometry);break;case l.LINE:b.setGeometry(g.mixin(b.geometry,{paths:[[[c.x,c.y],[d.x,d.y]]]}));break;case l.EXTENT:b&&f.graphics.remove(b,!0);b=new F(this._normalizeRect(c,
d,h));b._originOnly=!0;this._graphic=f.graphics.add(new z(b,this.fillSymbol),!0);f.snappingManager&&f.snappingManager._setGraphic(this._graphic);break;case l.FREEHAND_POLYLINE:this._hideTooltip();if(!1===this._canDrawFreehandPoint(a)){e("esri-touch")&&a.preventDefault();return}this._points.push(a.mapPoint.offset(0,0));b.geometry._insertPoints([d.offset(0,0)],0);b.setGeometry(b.geometry);break;case l.FREEHAND_POLYGON:this._hideTooltip();if(!1===this._canDrawFreehandPoint(a)){e("esri-touch")&&a.preventDefault();
return}this._points.push(a.mapPoint.offset(0,0));b.geometry._insertPoints([d.offset(0,0)],0);b.setGeometry(b.geometry)}e("esri-touch")&&a.preventDefault()}},_canDrawFreehandPoint:function(a){if(!this._oldPoint)return!1;var b=this._oldPoint.x-a.screenPoint.x,c=this._oldPoint.y-a.screenPoint.y,d=this._options.tolerance;if((0>b?-1*b:b)<d&&(0>c?-1*c:c)<d)return!1;b=new Date;if(b-this._startTime<this._options.drawTime)return!1;this._startTime=b;this._oldPoint=a.screenPoint;return!0},_onMouseUpHandler:function(a){if(this._dragged){0===
this._points.length&&this._points.push(a.mapPoint.offset(0,0));var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);var c=this._points[0];b=b||a.mapPoint;var d=this.map.spatialReference,f=v,g;switch(this._geometryType){case f.CIRCLE:case f.ELLIPSE:case f.TRIANGLE:case f.ARROW:case f.LEFT_ARROW:case f.RIGHT_ARROW:case f.UP_ARROW:case f.DOWN_ARROW:case f.RECTANGLE:g=this._graphic.geometry;break;case f.LINE:g=new u({paths:[[[c.x,c.y],[b.x,b.y]]],spatialReference:d});break;case f.EXTENT:g=
(new F(this._normalizeRect(c,b,d))).getExtent();break;case f.FREEHAND_POLYLINE:g=new u(d);g.addPath([].concat(this._points,[b.offset(0,0)]));break;case f.FREEHAND_POLYGON:g=new C(d),c=[].concat(this._points,[b.offset(0,0),this._points[0].offset(0,0)]),!C.prototype.isClockwise(c)&&!this.respectDrawingVertexOrder&&(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),c.reverse()),g.addRing(c)}e("esri-touch")&&a.preventDefault();this._clear();
this._drawEnd(g)}else this._clear()},_onClickHandler:function(a){var b;this.map.snappingManager&&(b=this.map.snappingManager._snappingPoint);a=b||a.mapPoint;b=this.map;var c=b.toScreen(a),d=v;this._points.push(a.offset(0,0));switch(this._geometryType){case d.POINT:this._drawEnd(a.offset(0,0));this._setTooltipMessage(0);break;case d.POLYLINE:1===this._points.length?(c=new u(b.spatialReference),c.addPath(this._points),this._graphic=b.graphics.add(new z(c,this.lineSymbol),!0),b.snappingManager&&b.snappingManager._setGraphic(this._graphic),
this._onMouseMoveHandler_connect=h.connect(b,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=b.graphics.add(new z(new u({paths:[[[a.x,a.y],[a.x,a.y]]],spatialReference:b.spatialReference}),this.lineSymbol),!0)):(this._graphic.geometry._insertPoints([a.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.lineSymbol),b=this._tGraphic,c=b.geometry,c.setPoint(0,0,a.offset(0,0)),c.setPoint(0,1,a.offset(0,0)),b.setGeometry(c));break;case d.POLYGON:1===this._points.length?
(c=new C(b.spatialReference),c.addRing(this._points),this._graphic=b.graphics.add(new z(c,this.fillSymbol),!0),b.snappingManager&&b.snappingManager._setGraphic(this._graphic),this._onMouseMoveHandler_connect=h.connect(b,"onMouseMove",this._onMouseMoveHandler),this._tGraphic=b.graphics.add(new z(new u({paths:[[[a.x,a.y],[a.x,a.y]]],spatialReference:b.spatialReference}),this.fillSymbol),!0)):(this._graphic.geometry._insertPoints([a.offset(0,0)],0),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.fillSymbol),
b=this._tGraphic,c=b.geometry,c.setPoint(0,0,a.offset(0,0)),c.setPoint(0,1,a.offset(0,0)),b.setGeometry(c));break;case d.MULTI_POINT:a=this._points;1===a.length?(c=new E(b.spatialReference),c.addPoint(a[a.length-1]),this._graphic=b.graphics.add(new z(c,this.markerSymbol),!0),b.snappingManager&&b.snappingManager._setGraphic(this._graphic)):(this._graphic.geometry.addPoint(a[a.length-1]),this._graphic.setGeometry(this._graphic.geometry).setSymbol(this.markerSymbol));break;case d.ARROW:this._addShape([[0,
0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]],c.x,c.y);break;case d.LEFT_ARROW:this._addShape([[0,0],[24,24],[24,12],[96,12],[96,-12],[24,-12],[24,-24],[0,0]],c.x,c.y);break;case d.RIGHT_ARROW:this._addShape([[0,0],[-24,24],[-24,12],[-96,12],[-96,-12],[-24,-12],[-24,-24],[0,0]],c.x,c.y);break;case d.UP_ARROW:this._addShape([[0,0],[-24,24],[-12,24],[-12,96],[12,96],[12,24],[24,24],[0,0]],c.x,c.y);break;case d.DOWN_ARROW:this._addShape([[0,0],[-24,-24],[-12,-24],[-12,-96],[12,-96],
[12,-24],[24,-24],[0,0]],c.x,c.y);break;case d.TRIANGLE:this._addShape([[0,-48],[41.56921938165306,24],[-41.56921938165306,24],[0,-48]],c.x,c.y);break;case d.RECTANGLE:this._addShape([[0,-96],[96,-96],[96,0],[0,0],[0,-96]],c.x-48,c.y+48);break;case d.CIRCLE:this._clear();this._drawEnd(C.createCircle({center:c,r:48,numberOfPoints:60,map:b}));break;case d.ELLIPSE:this._clear(),this._drawEnd(C.createEllipse({center:c,longAxis:48,shortAxis:24,numberOfPoints:60,map:b}))}this._setTooltipMessage(this._points.length)},
_addShape:function(a,b,c){this._setTooltipMessage(0);this._clear();this._drawEnd(this._toPolygon(a,b,c))},_toPolygon:function(a,b,c){var d=this.map,e=new C(d.spatialReference);e.addRing(k.map(a,function(a){return d.toMap({x:a[0]+b,y:a[1]+c})}));return e},_onDblClickHandler:function(a){var b,c=this._points,d=this.map.spatialReference,f=v;e("esri-touch")&&c.push(a.mapPoint);c=c.slice(0,c.length);switch(this._geometryType){case f.POLYLINE:if(!this._graphic||2>c.length){h.disconnect(this._onMouseMoveHandler_connect);
this._clear();this._onClickHandler(a);return}b=new u(d);b.addPath([].concat(c));break;case f.POLYGON:if(!this._graphic||2>c.length){h.disconnect(this._onMouseMoveHandler_connect);this._clear();this._onClickHandler(a);return}b=new C(d);a=[].concat(c,[c[0].offset(0,0)]);!C.prototype.isClockwise(a)&&!this.respectDrawingVertexOrder&&(console.debug(this.declaredClass+" :  Polygons drawn in anti-clockwise direction will be reversed to be clockwise."),a.reverse());b.addRing(a);break;case f.MULTI_POINT:b=
new E(d),k.forEach(c,function(a){b.addPoint(a)})}h.disconnect(this._onMouseMoveHandler_connect);this._clear();this._setTooltipMessage(0);this._drawEnd(b)},_onKeyDownHandler:function(a){a.keyCode===d.ESCAPE&&(h.disconnect(this._onMouseMoveHandler_connect),this._clear(),this._setTooltipMessage(0))},_toggleTooltip:function(a){this._options.showTooltips&&(a?this._tooltip||(this._tooltip=b.create("div",{"class":"tooltip"},this.map.container),n.isBodyLtr()||r.set(this._tooltip,"direction","rtl"),this._tooltip.style.display=
"none",this._tooltip.style.position="fixed",this._setTooltipMessage(0),this._onTooltipMouseEnterHandler_connect=h.connect(this.map,"onMouseOver",this._updateTooltip),this._onTooltipMouseLeaveHandler_connect=h.connect(this.map,"onMouseOut",this._hideTooltip),this._onTooltipMouseMoveHandler_connect=h.connect(this.map,"onMouseMove",this._updateTooltip)):this._tooltip&&(h.disconnect(this._onTooltipMouseEnterHandler_connect),h.disconnect(this._onTooltipMouseLeaveHandler_connect),h.disconnect(this._onTooltipMouseMoveHandler_connect),
b.destroy(this._tooltip),this._tooltip=null))},_hideTooltip:function(){var a=this._tooltip;a&&(a.style.display="none")},_setTooltipMessage:function(a){var b=this._tooltip;if(b){var c="";switch(this._geometryType){case v.POINT:c=y.toolbars.draw.addPoint;break;case v.ARROW:case v.LEFT_ARROW:case v.RIGHT_ARROW:case v.UP_ARROW:case v.DOWN_ARROW:case v.TRIANGLE:case v.RECTANGLE:case v.CIRCLE:case v.ELLIPSE:c=y.toolbars.draw.addShape;break;case v.LINE:case v.EXTENT:case v.FREEHAND_POLYLINE:case v.FREEHAND_POLYGON:c=
y.toolbars.draw.freehand;break;case v.POLYLINE:case v.POLYGON:c=y.toolbars.draw.start;1===a?c=y.toolbars.draw.resume:2<=a&&(c=y.toolbars.draw.complete);break;case v.MULTI_POINT:c=y.toolbars.draw.addMultipoint,1<=a&&(c=y.toolbars.draw.finish)}b.innerHTML=c}},_updateTooltip:function(a){var b=this._tooltip;if(b){var c;a.clientX||a.pageY?(c=a.clientX,a=a.clientY):(c=a.clientX+m.body().scrollLeft-m.body().clientLeft,a=a.clientY+m.body().scrollTop-m.body().clientTop);b.style.display="none";r.set(b,{left:c+
this._options.tooltipOffset+"px",top:a+"px"});b.style.display=""}},_redrawGraphic:function(a,b,c,d){if(c||this.map.wrapAround180)(a=this._graphic)&&a.setGeometry(a.geometry),(a=this._tGraphic)&&a.setGeometry(a.geometry)},onActivate:function(){},onDeactivate:function(){},onDrawComplete:function(){},onDrawEnd:function(){}});g.mixin(v,{POINT:"point",MULTI_POINT:"multipoint",LINE:"line",EXTENT:"extent",POLYLINE:"polyline",POLYGON:"polygon",FREEHAND_POLYLINE:"freehandpolyline",FREEHAND_POLYGON:"freehandpolygon",
ARROW:"arrow",LEFT_ARROW:"leftarrow",RIGHT_ARROW:"rightarrow",UP_ARROW:"uparrow",DOWN_ARROW:"downarrow",TRIANGLE:"triangle",CIRCLE:"circle",ELLIPSE:"ellipse",RECTANGLE:"rectangle"});return v})},"esri/toolbars/_toolbar":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../Evented"],function(p,g,k,h,f){return p([f],{declaredClass:"esri.toolbars._Toolbar",constructor:function(f){this.map=f},_cursors:{move:"pointer","move-v":"pointer","move-gv":"pointer",box0:"nw-resize",
box1:"n-resize",box2:"ne-resize",box3:"e-resize",box4:"se-resize",box5:"s-resize",box6:"sw-resize",box7:"w-resize",box8:"pointer"},_deactivateMapTools:function(f,e,g,d){var b=this.map;f&&(this._mapNavState={isDoubleClickZoom:b.isDoubleClickZoom,isClickRecenter:b.isClickRecenter,isPan:b.isPan,isRubberBandZoom:b.isRubberBandZoom,isKeyboardNavigation:b.isKeyboardNavigation,isScrollWheelZoom:b.isScrollWheelZoom},b.disableDoubleClickZoom(),b.disableClickRecenter(),b.disablePan(),b.disableRubberBandZoom(),
b.disableKeyboardNavigation());e&&b.hideZoomSlider();g&&b.hidePanArrows();d&&b.graphics.disableMouseEvents()},_activateMapTools:function(f,e,g,d){var b=this.map,h=this._mapNavState;f&&h&&(h.isDoubleClickZoom&&b.enableDoubleClickZoom(),h.isClickRecenter&&b.enableClickRecenter(),h.isPan&&b.enablePan(),h.isRubberBandZoom&&b.enableRubberBandZoom(),h.isKeyboardNavigation&&b.enableKeyboardNavigation(),h.isScrollWheelZoom&&b.enableScrollWheelZoom());e&&b.showZoomSlider();g&&b.showPanArrows();d&&b.graphics.enableMouseEvents()}})})},
"jimu/dijit/URLInput":function(){define(["dojo/_base/declare","dijit/form/ValidationTextBox","dojox/validate/regexp"],function(p,g,k){return p([g],{required:!0,invalidMessage:"Invalid url.",trim:!0,rest:!0,allowNamed:!0,allLocal:!1,postMixInProperties:function(){this.inherited(arguments);this.nls=window.jimuNls.urlInput;this.invalidMessage=this.nls.invalidUrl},validator:function(g){var f="^"+k.url({allowNamed:this.allowNamed,allLocal:this.allLocal}),f=RegExp(f,"g").test(g);return this.rest?(g=/\/rest\/services/gi.test(g),
f&&g):f}})})},"dojox/validate/regexp":function(){define(["dojo/_base/lang","dojo/regexp","dojox/main"],function(p,g,k){var h=p.getObject("validate.regexp",!0,k);return h=k.validate.regexp={ipAddress:function(f){f="object"==typeof f?f:{};"boolean"!=typeof f.allowDottedDecimal&&(f.allowDottedDecimal=!0);"boolean"!=typeof f.allowDottedHex&&(f.allowDottedHex=!0);"boolean"!=typeof f.allowDottedOctal&&(f.allowDottedOctal=!0);"boolean"!=typeof f.allowDecimal&&(f.allowDecimal=!0);"boolean"!=typeof f.allowHex&&
(f.allowHex=!0);"boolean"!=typeof f.allowIPv6&&(f.allowIPv6=!0);"boolean"!=typeof f.allowHybrid&&(f.allowHybrid=!0);var g=[];f.allowDottedDecimal&&g.push("((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");f.allowDottedHex&&g.push("(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]");f.allowDottedOctal&&g.push("(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]");f.allowDecimal&&g.push("(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])");
f.allowHex&&g.push("0[xX]0*[\\da-fA-F]{1,8}");f.allowIPv6&&g.push("([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}");f.allowHybrid&&g.push("([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])");f="";0<g.length&&(f="("+g.join("|")+")");return f},host:function(f){f="object"==typeof f?f:{};"boolean"!=typeof f.allowIP&&(f.allowIP=!0);"boolean"!=typeof f.allowLocal&&(f.allowLocal=!1);"boolean"!=typeof f.allowPort&&(f.allowPort=!0);"boolean"!=typeof f.allowNamed&&
(f.allowNamed=!1);var g=f.allowPort?"(\\:\\d+)?":"",e="((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)";f.allowIP&&(e+="|"+h.ipAddress(f));f.allowLocal&&(e+="|localhost");f.allowNamed&&(e+="|^[^-][a-zA-Z0-9_-]*");return"("+e+")"+g},url:function(f){f="object"==typeof f?f:{};"scheme"in f||(f.scheme=[!0,!1]);return g.buildGroupRE(f.scheme,function(f){return f?"(https?|ftps?)\\://":""})+h.host(f)+"(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?"},
emailAddress:function(f){f="object"==typeof f?f:{};"boolean"!=typeof f.allowCruft&&(f.allowCruft=!1);f.allowPort=!1;var g="([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@"+h.host(f);f.allowCruft&&(g="\x3c?(mailto\\:)?"+g+"\x3e?");return g},emailAddressList:function(f){f="object"==typeof f?f:{};"string"!=typeof f.listSeparator&&(f.listSeparator="\\s;,");var g=h.emailAddress(f);return"("+g+"\\s*["+f.listSeparator+"]\\s*)*"+g+"\\s*["+f.listSeparator+"]?\\s*"},numberFormat:function(f){f=
"object"==typeof f?f:{};"undefined"==typeof f.format&&(f.format="###-###-####");return g.buildGroupRE(f.format,function(f){return g.escapeString(f,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d")})},ca:{postalCode:function(){return"([A-Z][0-9][A-Z] [0-9][A-Z][0-9])"},province:function(){return"(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)"}},us:{state:function(f){f="object"==typeof f?f:{};"boolean"!=typeof f.allowTerritories&&(f.allowTerritories=!0);"boolean"!=typeof f.allowMilitary&&(f.allowMilitary=!0);
var g="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";f.allowTerritories&&(g+="|AS|FM|GU|MH|MP|PW|PR|VI");f.allowMilitary&&(g+="|AA|AE|AP");return"("+g+")"}}}})},"dijit/layout/_LayoutWidget":function(){define("dojo/_base/lang ../_Widget ../_Container ../_Contained ../Viewport dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style".split(" "),function(p,g,k,h,f,m,e,q,d){return m("dijit.layout._LayoutWidget",
[g,k,h],{baseClass:"dijitLayoutContainer",isLayoutContainer:!0,_setTitleAttr:null,buildRendering:function(){this.inherited(arguments);e.add(this.domNode,"dijitContainer")},startup:function(){if(!this._started){this.inherited(arguments);var b=this.getParent&&this.getParent();if(!b||!b.isLayoutContainer)this.resize(),this.own(f.on("resize",p.hitch(this,"resize")))}},resize:function(b,e){var f=this.domNode;b&&q.setMarginBox(f,b);var g=e||{};p.mixin(g,b||{});if(!("h"in g)||!("w"in g))g=p.mixin(q.getMarginBox(f),
g);var a=d.getComputedStyle(f),c=q.getMarginExtents(f,a),h=q.getBorderExtents(f,a),g=this._borderBox={w:g.w-(c.w+h.w),h:g.h-(c.h+h.h)},c=q.getPadExtents(f,a);this._contentBox={l:d.toPixelValue(f,a.paddingLeft),t:d.toPixelValue(f,a.paddingTop),w:g.w-c.w,h:g.h-c.h};this.layout()},layout:function(){},_setupChild:function(b){e.add(b.domNode,this.baseClass+"-child "+(b.baseClass?this.baseClass+"-"+b.baseClass:""))},addChild:function(b,d){this.inherited(arguments);this._started&&this._setupChild(b)},removeChild:function(b){e.remove(b.domNode,
this.baseClass+"-child"+(b.baseClass?" "+this.baseClass+"-"+b.baseClass:""));this.inherited(arguments)}})})},"dijit/Menu":function(){define("require dojo/_base/array dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ./popup ./DropDownMenu dojo/ready".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s){r("dijit-legacy-requires")&&s(0,function(){p(["dijit/MenuItem","dijit/PopupMenuItem","dijit/CheckedMenuItem",
"dijit/MenuSeparator"])});return k("dijit.Menu",c,{constructor:function(){this._bindings=[]},targetNodeIds:[],selector:"",contextMenuForWindow:!1,leftClickToOpen:!1,refocus:!0,postCreate:function(){this.contextMenuForWindow?this.bindDomNode(this.ownerDocumentBody):g.forEach(this.targetNodeIds,this.bindDomNode,this);this.inherited(arguments)},_iframeContentWindow:function(a){return t.get(this._iframeContentDocument(a))||this._iframeContentDocument(a).__parent__||a.name&&document.frames[a.name]||null},
_iframeContentDocument:function(a){return a.contentDocument||a.contentWindow&&a.contentWindow.document||a.name&&document.frames[a.name]&&document.frames[a.name].document||null},bindDomNode:function(a){a=h.byId(a,this.ownerDocument);var c;if("iframe"==a.tagName.toLowerCase()){var e=a;c=this._iframeContentWindow(e);c=n.body(c.document)}else c=a==n.body(this.ownerDocument)?this.ownerDocument.documentElement:a;var g={node:a,iframe:e};f.set(a,"_dijitMenu"+this.id,this._bindings.push(g));var k=d.hitch(this,
function(a){var c=this.selector,d=c?function(a){return b.selector(c,a)}:function(a){return a},f=this;return[b(a,d(this.leftClickToOpen?"click":"contextmenu"),function(a){a.stopPropagation();a.preventDefault();(new Date).getTime()<this._lastKeyDown+500||f._scheduleOpen(this,e,{x:a.pageX,y:a.pageY},a.target)}),b(a,d("keydown"),function(a){if(93==a.keyCode||a.shiftKey&&a.keyCode==q.F10||this.leftClickToOpen&&a.keyCode==q.SPACE)a.stopPropagation(),a.preventDefault(),f._scheduleOpen(this,e,null,a.target),
this._lastKeyDown=(new Date).getTime()})]});g.connects=c?k(c):[];e&&(g.onloadHandler=d.hitch(this,function(){var a=this._iframeContentWindow(e),a=n.body(a.document);g.connects=k(a)}),e.addEventListener?e.addEventListener("load",g.onloadHandler,!1):e.attachEvent("onload",g.onloadHandler))},unBindDomNode:function(a){var b;try{b=h.byId(a,this.ownerDocument)}catch(c){return}a="_dijitMenu"+this.id;if(b&&f.has(b,a)){for(var d=f.get(b,a)-1,e=this._bindings[d],g;g=e.connects.pop();)g.remove();(g=e.iframe)&&
(g.removeEventListener?g.removeEventListener("load",e.onloadHandler,!1):g.detachEvent("onload",e.onloadHandler));f.remove(b,a);delete this._bindings[d]}},_scheduleOpen:function(a,b,c,d){this._openTimer||(this._openTimer=this.defer(function(){delete this._openTimer;this._openMyself({target:d,delegatedTarget:a,iframe:b,coords:c})},1))},_openMyself:function(b){function c(){q.refocus&&t&&t.focus();a.close(q)}var d=b.target,f=b.iframe,g=b.coords,k=!g;this.currentTarget=b.delegatedTarget;if(g){if(f){b=
m.position(f,!0);var d=this._iframeContentWindow(f),d=m.docScroll(d.document),n=e.getComputedStyle(f),p=e.toPixelValue,s=(r("ie")&&r("quirks")?0:p(f,n.paddingLeft))+(r("ie")&&r("quirks")?p(f,n.borderLeftWidth):0),f=(r("ie")&&r("quirks")?0:p(f,n.paddingTop))+(r("ie")&&r("quirks")?p(f,n.borderTopWidth):0);g.x+=b.x+s-d.x;g.y+=b.y+f-d.y}}else g=m.position(d,!0),g.x+=10,g.y+=10;var q=this,f=this._focusManager.get("prevNode");b=this._focusManager.get("curNode");var t=!b||h.isDescendant(b,this.domNode)?
f:b;a.open({popup:this,x:g.x,y:g.y,onExecute:c,onCancel:c,orient:this.isLeftToRight()?"L":"R"});this.focus();k||this.defer(function(){this._cleanUp(!0)});this._onBlur=function(){this.inherited("_onBlur",arguments);a.close(this)}},destroy:function(){g.forEach(this._bindings,function(a){a&&this.unBindDomNode(a.node)},this);this.inherited(arguments)}})})},"dgrid/main":function(){define([],1)},"dgrid/OnDemandGrid":function(){define(["dojo/_base/declare","./Grid","./OnDemandList"],function(p,g,k){return p("dgrid.OnDemandGrid",
[g,k],{})})},"dgrid/Grid":function(){define("dojo/_base/kernel dojo/_base/declare dojo/on dojo/has put-selector/put ./List ./util/misc dojo/_base/sniff".split(" "),function(p,g,k,h,f,m,e){function q(b,d){d&&d.nodeType&&b.appendChild(d)}function d(b,d,e,a){if(this.formatter){a=this.formatter;var c=this.grid.formatterScope;e.innerHTML="string"===typeof a&&c?c[a](d,b):this.formatter(d,b)}else null!=d&&e.appendChild(document.createTextNode(d))}var b=8>h("ie")&&!h("quirks");g=g("dgrid.Grid",m,{columns:null,
cellNavigation:!0,tabableHeader:!0,showHeader:!0,column:function(b){return"object"!=typeof b?this.columns[b]:this.cell(b).column},listType:"grid",cell:function(b,d){if(b.column&&b.element)return b;b.target&&b.target.nodeType&&(b=b.target);var e;if(b.nodeType){do{if(this._rowIdToObject[b.id])break;var a=b.columnId;if(a){d=a;e=b;break}b=b.parentNode}while(b&&b!=this.domNode)}if(!e&&"undefined"!=typeof d){var c=this.row(b);if(a=c&&c.element)for(var a=a.getElementsByTagName("td"),f=0;f<a.length;f++)if(a[f].columnId==
d){e=a[f];break}}if(null!=b)return{row:c||this.row(b),column:d&&this.column(d),element:e}},createRowCells:function(d,g,k,a){var c=f("table.dgrid-row-table[role\x3dpresentation]"),m=9>h("ie")||h("quirks")?f(c,"tbody"):c,l,p,q,A,x,u,C,E,F,y;k=k||this.subRows;p=0;for(q=k.length;p<q;p++){u=k[p];l=f(m,"tr");u.className&&f(l,"."+u.className);A=0;for(x=u.length;A<x;A++){C=u[A];E=C.id;F=C.field?".field-"+e.escapeCssIdentifier(C.field,"-"):"";(y="function"===typeof C.className?C.className(a):C.className)&&
(F+="."+y);F=f(d+(".dgrid-cell.dgrid-cell-padding"+(E?".dgrid-column-"+e.escapeCssIdentifier(E,"-"):"")+F.replace(/ +/g,"."))+"[role\x3d"+("th"===d?"columnheader":"gridcell")+"]");F.columnId=E;b?(E=f(F,"!dgrid-cell-padding div.dgrid-cell-padding"),F.contents=E):E=F;if(y=C.colSpan)F.colSpan=y;if(y=C.rowSpan)F.rowSpan=y;g(E,C);l.appendChild(F)}}return c},left:function(b,d){b.element||(b=this.cell(b));return this.cell(this._move(b,-(d||1),"dgrid-cell"))},right:function(b,d){b.element||(b=this.cell(b));
return this.cell(this._move(b,d||1,"dgrid-cell"))},renderRow:function(b,e){var g=this.createRowCells("td",function(a,c){var f=b;c.get?f=c.get(b):"field"in c&&"_item"!=c.field&&(f=f[c.field]);c.renderCell?q(a,c.renderCell(b,f,a,e)):d.call(c,b,f,a,e)},e&&e.subRows,b);return f("div[role\x3drow]\x3e",g)},renderHeader:function(){var d=this,e=this.headerNode,g=e.childNodes.length;for(e.setAttribute("role","row");g--;)f(e.childNodes[g],"!");g=this.createRowCells("th",function(a,c){var d=c.headerNode=a;b&&
(a=a.parentNode);var e=c.field;e&&(a.field=e);if(c.renderHeaderCell)q(d,c.renderHeaderCell(d));else if("label"in c||c.field)d.appendChild(document.createTextNode("label"in c?c.label:c.field));!1!==c.sortable&&(e&&"_item"!=e)&&(a.sortable=!0,a.className+=" dgrid-sortable")},this.subRows&&this.subRows.headerRows);this._rowIdToObject[g.id=this.id+"-header"]=this.columns;e.appendChild(g);this._sortListener&&this._sortListener.remove();this._sortListener=k(g,"click,keydown",function(a){if("click"==a.type||
32==a.keyCode||!h("opera")&&13==a.keyCode){var b=a.target,f,g,m;do if(b.sortable){m=[{attribute:f=b.field||b.columnId,descending:(g=d._sort[0])&&g.attribute==f&&!g.descending}];f={bubbles:!0,cancelable:!0,grid:d,parentType:a.type,sort:m};k.emit(a.target,"dgrid-sort",f)&&(d._sortNode=b,d.set("sort",m));break}while((b=b.parentNode)&&b!=e)}})},resize:function(){var b=this.headerNode.firstChild,d=this.contentNode,e;this.inherited(arguments);if(!h("ie")||7<h("ie")&&!h("quirks"))if(d.style.width="",d&&
b&&(e=b.offsetWidth)!=d.offsetWidth)d.style.width=e+"px"},destroy:function(){this._destroyColumns();this._sortListener&&this._sortListener.remove();this.inherited(arguments)},_setSort:function(b,d){this.inherited(arguments);this.updateSortArrow(this._sort)},_findSortArrowParent:function(b){var d=this.columns,e;for(e in d){var a=d[e];if(a.field==b)return a.headerNode}},updateSortArrow:function(b,d){this._lastSortedArrow&&(f(this._lastSortedArrow,"\x3c!dgrid-sort-up!dgrid-sort-down"),f(this._lastSortedArrow,
"!"),delete this._lastSortedArrow);d&&(this._sort=b);if(b[0]){var e=b[0].attribute,a=b[0].descending,e=this._sortNode||this._findSortArrowParent(e),c;delete this._sortNode;e&&(e=e.contents||e,c=this._lastSortedArrow=f("div.dgrid-sort-arrow.ui-icon[role\x3dpresentation]"),c.innerHTML="\x26nbsp;",e.insertBefore(c,e.firstChild),f(e,a?".dgrid-sort-down":".dgrid-sort-up"),this.resize())}},styleColumn:function(b,d){return this.addCssRule("#"+e.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+e.escapeCssIdentifier(b,
"-"),d)},_configColumns:function(b,d){var f=[],a=d instanceof Array;e.each(d,function(c,e){"string"==typeof c&&(d[e]=c={label:c});!a&&!c.field&&(c.field=e);e=c.id=c.id||(isNaN(e)?e:b+e);this._configColumn&&(this._configColumn(c,e,d,b),e=c.id);a&&(this.columns[e]=c);c.grid=this;"function"===typeof c.init&&c.init();f.push(c)},this);return a?d:f},_destroyColumns:function(){var b=this.subRows,d=b&&b.length,e,a,c,f;this.cleanup();for(e=0;e<d;e++){a=0;for(f=b[e].length;a<f;a++)c=b[e][a],"function"===typeof c.destroy&&
c.destroy()}},configStructure:function(){var b=this.subRows,d=this._columns=this.columns;this.columns=!d||d instanceof Array?{}:d;if(b)for(d=0;d<b.length;d++)b[d]=this._configColumns(d+"-",b[d]);else this.subRows=[this._configColumns("",d)]},_getColumns:function(){return this._columns||this.columns},_setColumns:function(b){this._destroyColumns();this.subRows=null;this.columns=b;this._updateColumns()},_setSubRows:function(b){this._destroyColumns();this.subRows=b;this._updateColumns()},setColumns:function(b){p.deprecated("setColumns(...)",
'use set("columns", ...) instead',"dgrid 0.4");this.set("columns",b)},setSubRows:function(b){p.deprecated("setSubRows(...)",'use set("subRows", ...) instead',"dgrid 0.4");this.set("subRows",b)},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this._started&&(this._sort&&this._sort.length?this.updateSortArrow(this._sort):this.resize())}});g.appendIfNode=q;g.defaultRenderCell=d;return g})},"put-selector/put":function(){(function(p){var g,
k=/[-+,> ]/;p([],g=function(h,f){function m(f){function g(){l&&(s&&l!=s)&&(s==f&&(t||(t=k.test(x)&&h.createDocumentFragment()))?t:s).insertBefore(l,c||null)}for(var t,a,c,s,l,w=arguments,z=w[0],A=0;A<w.length;A++){var x=w[A];if("object"==typeof x){a=!1;if(x instanceof Array){l=h.createDocumentFragment();for(var u=0;u<x.length;u++)l.appendChild(m(x[u]));x=l}if(x.nodeType)l=x,g(),s=x,c=0;else for(u in x)l[u]=x[u]}else if(a)a=!1,l.appendChild(h.createTextNode(x));else{1>A&&(f=null);a=!0;if(z=x.replace(e,
function(a,e,k,t,u,z){e&&(g(),"-"==e||"+"==e?(s=(c=l||s).parentNode,l=null,"+"==e&&(c=c.nextSibling)):("\x3c"==e?s=l=(l||s).parentNode:(","==e?s=f:l&&(s=l),l=null),c=0),l&&(s=l));if((a=!k&&t)||!l&&(k||u))"$"==a?(a=w[++A],s.appendChild(h.createTextNode(a))):(a=a||m.defaultTag,(e=b&&w[A+1]&&w[A+1].name)&&(a="\x3c"+a+' name\x3d"'+e+'"\x3e'),l=d&&~(p=a.indexOf("|"))?h.createElementNS(d[a.slice(0,p)],a.slice(p+1)):h.createElement(a));if(k)if("$"==t&&(t=w[++A]),"#"==k)l.id=t;else if(e=(a=l.className)&&
(" "+a+" ").replace(" "+t+" "," "),"."==k)l.className=a?(e+t).substring(1):t;else if("!"==x){var D;b?m("div",l,"\x3c").innerHTML="":(D=l.parentNode)&&D.removeChild(l)}else e=e.substring(1,e.length-1),e!=a&&(l.className=e);u&&("$"==z&&(z=w[++A]),"style"==u?l.style.cssText=z:(k="!"==u.charAt(0)?(u=u.substring(1))&&"removeAttribute":"setAttribute",z=""===z?u:z,d&&~(p=u.indexOf("|"))?l[k+"NS"](d[u.slice(0,p)],u.slice(p+1),z):l[k](u,z)));return""}))throw new SyntaxError("Unexpected char "+z+" in "+x);
g();s=z=l||s}}f&&t&&f.appendChild(t);return z}k=f||k;var e=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w\u00A0-\uFFFF%$|]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,p,d=!1;h=h||document;var b="object"==typeof h.createElement;m.addNamespace=function(b,e){h.createElementNS?(d||(d={}))[b]=e:h.namespaces.add(b,e)};m.defaultTag="div";m.forDocument=g;return m})})(function(p,g,k){k=k||g;"function"===typeof define?define([],function(){return k()}):"undefined"==typeof window?require("./node-html")(module,k):put=
k()})},"dgrid/List":function(){define("dojo/_base/kernel dojo/_base/declare dojo/dom dojo/on dojo/has ./util/misc dojo/has!touch?./TouchScroll xstyle/has-class put-selector/put dojo/_base/sniff xstyle/css!./css/dgrid.css".split(" "),function(p,g,k,h,f,m,e,q,d){function b(a,b){d(document.body,a,".dgrid-scrollbar-measure");var c=a["offset"+b]-a["client"+b];a.className="";document.body.removeChild(a);return c}function r(a){var b=a?"."+a.replace(w,"."):"";this._class&&(b="!"+this._class.replace(w,"!")+
b);d(this.domNode,b);this._class=a}function n(){return this._class}function t(){return{x:this.bodyNode.scrollLeft,y:this.bodyNode.scrollTop}}function a(a){"undefined"!==typeof a.x&&(this.bodyNode.scrollLeft=a.x);"undefined"!==typeof a.y&&(this.bodyNode.scrollTop=a.y)}q("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var c,s;f.add("dom-scrollbar-width",function(a,c,d){return b(d,"Width")});f.add("dom-scrollbar-height",function(a,c,d){return b(d,"Height")});f.add("dom-rtl-scrollbar-left",
function(a,b,c){a=d("div");d(document.body,c,".dgrid-scrollbar-measure[dir\x3drtl]");d(c,a);b=!!f("ie")||!!f("trident")||a.offsetLeft>=f("dom-scrollbar-width");c.className="";document.body.removeChild(c);d(a,"!");c.removeAttribute("dir");return b});var l=0,w=/ +/g,z=7>f("ie")&&!f("quirks")?function(){var a,b,c;if(this._started&&(a=document.documentElement,b=a.clientWidth,a=a.clientHeight,c=this._prevWinDims||[],c[0]!==b||c[1]!==a))this.resize(),this._prevWinDims=[b,a]}:function(){this._started&&this.resize()};
return g("dgrid.List",f("touch")?e:null,{tabableHeader:!1,showHeader:!1,showFooter:!1,maintainOddEven:!0,cleanAddedRules:!0,useTouchScroll:null,addUiClasses:!0,cleanEmptyObservers:!0,highlightDuration:250,postscript:function(a,b){var c=this;(this._Row=function(a,b,c){this.id=a;this.data=b;this.element=c}).prototype.remove=function(){c.removeRow(this.element)};b&&(this.srcNodeRef=b=b.nodeType?b:document.getElementById(b));this.create(a,b)},listType:"list",create:function(a,b){var c=this.domNode=b||
d("div"),e;a?(this.params=a,g.safeMixin(this,a),e=a["class"]||a.className||c.className,this._sort=a.sort||[],delete this.sort):this._sort=[];this.observers=[];this._numObservers=0;this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=c.id=c.id||this.id||"dgrid_"+l++;null===this.useTouchScroll&&(this.useTouchScroll=!f("dom-scrollbar-width"));this.buildRendering();e&&r.call(this,e);this.postCreate();delete this.srcNodeRef;this.domNode.offsetHeight&&this.startup()},
buildRendering:function(){var a=this.domNode,b=this.addUiClasses,c=this,e,g,l,k;k=this.isRTL="rtl"==(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase();a.className="";d(a,"[role\x3dgrid].dgrid.dgrid-"+this.listType+(b?".ui-widget":""));e=this.headerNode=d(a,"div.dgrid-header.dgrid-header-row"+(b?".ui-widget-header":"")+(this.showHeader?"":".dgrid-header-hidden"));(f("quirks")||8>f("ie"))&&d(a,"div.dgrid-spacer");g=this.bodyNode=d(a,"div.dgrid-scroller");
f("ff")&&(g.tabIndex=-1);this.headerScrollNode=d(a,"div.dgrid-header.dgrid-header-scroll.dgrid-scrollbar-width"+(b?".ui-widget-header":""));l=this.footerNode=d("div.dgrid-footer"+(this.showFooter?"":".dgrid-footer-hidden"));d(a,l);k&&(a.className+=" dgrid-rtl"+(f("dom-rtl-scrollbar-left")?" dgrid-rtl-swap":""));h(g,"scroll",function(b){c.showHeader&&(e.scrollLeft=b.scrollLeft||g.scrollLeft);b.stopPropagation();h.emit(a,"scroll",{scrollTarget:g})});this.configStructure();this.renderHeader();this.contentNode=
this.touchNode=d(this.bodyNode,"div.dgrid-content"+(b?".ui-widget-content":""));this._listeners.push(this._resizeHandle=h(window,"resize",m.throttleDelayed(z,this)))},postCreate:f("touch")?function(){this.useTouchScroll&&this.inherited(arguments)}:function(){},startup:function(){this._started||(this.inherited(arguments),this._started=!0,this.resize(),this.set("sort",this._sort))},configStructure:function(){},resize:function(){var a=this.bodyNode,b=this.headerNode,d=this.footerNode,e=b.offsetHeight,
g=this.showFooter?d.offsetHeight:0,h=f("quirks")||7>f("ie");this.headerScrollNode.style.height=a.style.marginTop=e+"px";a.style.marginBottom=g+"px";h&&(a.style.height="",a.style.height=Math.max(this.domNode.offsetHeight-e-g,0)+"px",g&&(d.style.bottom="1px",setTimeout(function(){d.style.bottom=""},0)));c||(c=f("dom-scrollbar-width"),s=f("dom-scrollbar-height"),f("ie")&&(c++,s++),m.addCssRule(".dgrid-scrollbar-width","width: "+c+"px"),m.addCssRule(".dgrid-scrollbar-height","height: "+s+"px"),17!=c&&
!h&&(m.addCssRule(".dgrid-header-row","right: "+c+"px"),m.addCssRule(".dgrid-rtl-swap .dgrid-header-row","left: "+c+"px")));h&&(b.style.width=a.clientWidth+"px",setTimeout(function(){b.scrollLeft=a.scrollLeft},0))},addCssRule:function(a,b){var c=m.addCssRule(a,b);this.cleanAddedRules&&this._listeners.push(c);return c},on:function(a,b){var c=h(this.domNode,a,b);f("dom-addeventlistener")||this._listeners.push(c);return c},cleanup:function(){var a=this.observers,b;for(b in this._rowIdToObject)if(this._rowIdToObject[b]!=
this.columns){var c=document.getElementById(b);c&&this.removeRow(c,!0)}for(b=0;b<a.length;b++)(c=a[b])&&c.cancel();this.observers=[];this._numObservers=0;this.preload=null},destroy:function(){if(this._listeners){for(var a=this._listeners.length;a--;)this._listeners[a].remove();delete this._listeners}this._started=!1;this.cleanup();d(this.domNode,"!");this.useTouchScroll&&this.inherited(arguments)},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";
this.scrollTo({x:0,y:0})},newRow:function(a,b,c,e,f){if(b){var g=this.insertRow(a,b,c,e,f);d(g,".dgrid-highlight"+(this.addUiClasses?".ui-state-highlight":""));setTimeout(function(){d(g,"!dgrid-highlight!ui-state-highlight")},this.highlightDuration);return g}},adjustRowIndices:function(a){var b=a.rowIndex;if(-1<b){do-1<a.rowIndex&&(this.maintainOddEven&&-1<(a.className+" ").indexOf("dgrid-row ")&&d(a,"."+(1==b%2?"dgrid-row-odd":"dgrid-row-even")+"!"+(0==b%2?"dgrid-row-odd":"dgrid-row-even")),a.rowIndex=
b++);while((a=a.nextSibling)&&a.rowIndex!=b)}},renderArray:function(a,b,c){function d(){var b=arguments;if(-1<r)for(var f=0;f<b.length;f++){var g=b[f],l=m[g?0:m.length-1];if(l=l&&e(l)){var k=l[g?"previousSibling":"nextSibling"];k&&(k=h.row(k));k&&k.element!=l&&(g=g?"unshift":"push",a[g](k.data),m[g](k.element),c.count++)}}}function e(a){return!k.isDescendant(a,h.domNode)&&document.getElementById(a.id)?h.row(a.id.slice(h.id.length+5)).element:a}function f(a){t=h.insertRow(a,s,null,l++,c);t.observerIndex=
r;return t}function g(a){w=a.slice(0);(p=b?b.parentNode:h.contentNode)&&p.parentNode&&(p!==h.contentNode||a.length)?(p.insertBefore(s,b||null),(t=a[a.length-1])&&h.adjustRowIndices(t)):n[r]&&h.cleanEmptyObservers&&"undefined"!==typeof r&&(n[r].cancel(),n[r]=0,h._numObservers--);m=a;q&&(q.rows=m)}c=c||{};var h=this,l=c.start||0,n=this.observers,m,p,r;b||(this._lastCollection=a);if(a.observe){h._numObservers++;var q=a.observe(function(f,g,l){var k,n,q;-1<g&&m[g]&&(k=m.splice(g,1)[0],k.parentNode==p&&
((n=k.nextSibling)&&g!=l&&n.rowIndex--,h.removeRow(k)),c.count--,h._processScroll&&h._processScroll());if(-1<l){if(m.length)if(0===l)q=(q=m[l])&&e(q);else{if(q=m[l-1])q=e(q),q=(q.connected||q).nextSibling}else q=h._getFirstRowSibling&&h._getFirstRowSibling(p);k&&(q&&k.id===q.id)&&(q=(q.connected||q).nextSibling);q&&!q.parentNode&&(q=document.getElementById(q.id));k=b&&b.parentNode||q&&q.parentNode||h.contentNode;if(k=h.newRow(f,k,q,c.start+l,c))if(k.observerIndex=r,m.splice(l,0,k),!n||l<g)n=k.previousSibling,
n=!n||n.rowIndex+1==k.rowIndex||0==k.rowIndex?k:n;c.count++}0===g?d(1,1):g===a.length-(-1===l?0:1)&&d(0,0);g!=l&&n&&h.adjustRowIndices(n);h._onNotification(m,f,g,l)},!0);r=n.push(q)-1}var s=document.createDocumentFragment(),t,w;if(a.map){if(m=a.map(f,console.error),m.then)return a.then(function(b){a=b;return m.then(function(a){g(a);d(1,1,0,0);return w})})}else{m=[];for(var z=0,L=a.length;z<L;z++)m[z]=f(a[z])}g(m);d(1,1,0,0);return w},_onNotification:function(a,b,c,d){},renderHeader:function(){},_autoId:0,
insertRow:function(a,b,c,d,e){var f=e.parentId,f=this.id+"-row-"+(f?f+"-":"")+(this.store&&this.store.getIdentity?this.store.getIdentity(a):this._autoId++),g=document.getElementById(f),h=g&&g.previousSibling;g&&(g===c&&(c=(c.connected||c).nextSibling),this.removeRow(g));g=this.renderRow(a,e);g.className=(g.className||"")+" dgrid-row "+(1==d%2?"dgrid-row-odd":"dgrid-row-even")+(this.addUiClasses?" ui-state-default":"");this._rowIdToObject[g.id=f]=a;b.insertBefore(g,c||null);h&&this.adjustRowIndices(h);
g.rowIndex=d;return g},renderRow:function(a,b){return d("div",""+a)},removeRow:function(a,b){a=a.element||a;delete this._rowIdToObject[a.id];b||d(a,"!")},row:function(a){var b;if(a instanceof this._Row)return a;a.target&&a.target.nodeType&&(a=a.target);if(a.nodeType){do{var c=a.id;if(b=this._rowIdToObject[c])return new this._Row(c.substring(this.id.length+5),b,a);a=a.parentNode}while(a&&a!=this.domNode)}else return"object"==typeof a?b=this.store.getIdentity(a):(b=a,a=this._rowIdToObject[this.id+"-row-"+
b]),new this._Row(b,a,document.getElementById(this.id+"-row-"+b))},cell:function(a){return{row:this.row(a)}},_move:function(a,b,c,d){var e,f;f=e=a.element;b=b||1;do if(a=e[0>b?"previousSibling":"nextSibling"]){do if((e=a)&&-1<(e.className+" ").indexOf(c+" ")){f=e;b+=0>b?1:-1;break}while(a=(!d||!e.hidden)&&e[0>b?"lastChild":"firstChild"])}else if(e=e.parentNode,!e||e===this.bodyNode||e===this.headerNode)break;while(b);return f},up:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,
-(b||1),"dgrid-row",c))},down:function(a,b,c){a.element||(a=this.row(a));return this.row(this._move(a,b||1,"dgrid-row",c))},scrollTo:f("touch")?function(b){return this.useTouchScroll?this.inherited(arguments):a.call(this,b)}:a,getScrollPosition:f("touch")?function(){return this.useTouchScroll?this.inherited(arguments):t.call(this)}:t,get:function(a){var b="_get"+a.charAt(0).toUpperCase()+a.slice(1);return"function"===typeof this[b]?this[b].apply(this,[].slice.call(arguments,1)):this[a]},set:function(a,
b){if("object"===typeof a)for(var c in a)this.set(c,a[c]);else c="_set"+a.charAt(0).toUpperCase()+a.slice(1),"function"===typeof this[c]?this[c].apply(this,[].slice.call(arguments,1)):this[a]=b;return this},_getClass:n,_setClass:r,_getClassName:n,_setClassName:r,_setSort:function(a,b){this._sort="string"!=typeof a?a:[{attribute:a,descending:b}];this.refresh();this._lastCollection&&(a.length&&("string"!=typeof a&&(b=a[0].descending,a=a[0].attribute),this._lastCollection.sort(function(c,d){var e=c[a],
f=d[a];void 0===e&&(e="");void 0===f&&(f="");return e==f?0:e>f==!b?1:-1})),this.renderArray(this._lastCollection))},sort:function(a,b){p.deprecated("sort(...)",'use set("sort", ...) instead',"dgrid 0.4");this.set("sort",a,b)},_getSort:function(){return this._sort},_setShowHeader:function(a){var b=this.headerNode;this.showHeader=a;d(b,(a?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();a&&(b.scrollLeft=this.getScrollPosition().x)},setShowHeader:function(a){p.deprecated("setShowHeader(...)",
'use set("showHeader", ...) instead',"dgrid 0.4");this.set("showHeader",a)},_setShowFooter:function(a){this.showFooter=a;d(this.footerNode,(a?"!":".")+"dgrid-footer-hidden");this.resize()}})})},"dgrid/util/misc":function(){define(["dojo/has","put-selector/put"],function(p,g){p.add("dom-contains",function(d,b,e){return!!e.contains});var k=[],h,f,m,e=/([^A-Za-z0-9_\u00A0-\uFFFF-])/g,q={defaultDelay:15,throttle:function(d,b,e){var f=!1;e=e||q.defaultDelay;return function(){f||(f=!0,d.apply(b,arguments),
setTimeout(function(){f=!1},e))}},throttleDelayed:function(d,b,e){var f=!1;e=e||q.defaultDelay;return function(){if(!f){f=!0;var g=arguments;setTimeout(function(){f=!1;d.apply(b,g)},e)}}},debounce:function(d,b,e){var f;e=e||q.defaultDelay;return function(){f&&(clearTimeout(f),f=null);var g=arguments;f=setTimeout(function(){d.apply(b,g)},e)}},each:function(d,b,e){var f,g;if(d)if("number"===typeof d.length){f=0;for(g=d.length;f<g;f++)b.call(e,d[f],f,d)}else for(f in d)b.call(e,d[f],f,d)},contains:function(d,
b){return p("dom-contains")?d.contains(b):d.compareDocumentPosition(b)&8},addCssRule:function(d,b){h||(h=g(document.getElementsByTagName("head")[0],"style"),h=h.sheet||h.styleSheet,f=h.deleteRule?"deleteRule":"removeRule",m=h.cssRules?"cssRules":"rules");var e=k.length;k[e]=(h.cssRules||h.rules).length;h.addRule?h.addRule(d,b):h.insertRule(d+"{"+b+"}",k[e]);return{get:function(b){return h[m][k[e]].style[b]},set:function(b,d){"undefined"!==typeof k[e]&&(h[m][k[e]].style[b]=d)},remove:function(){var b=
k[e],d,a;if(void 0!==b){h[f](b);k[e]=void 0;d=e+1;for(a=k.length;d<a;d++)k[d]>b&&k[d]--}}}},escapeCssIdentifier:function(d,b){return d.replace(e,b||"\\$1")}};return q})},"xstyle/has-class":function(){define(["dojo/has"],function(p){var g={};return function(){for(var k,h=arguments,f=0;f<h.length;f++)if(k=h[f],!g[k]){g[k]=!0;var m=k.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),e=p(m[2]),q=-m[4];if((0<q?q<=e&&(-m[5]||q)>=e:!!e)==!m[1])document.documentElement.className+=" has-"+k}}})},"xstyle/css":function(){define(["require"],
function(p){function g(g,h,f){var m=document.documentElement;g=m.insertBefore(document.createElement(g),m.firstChild);g.id=h;h=(g.currentStyle||getComputedStyle(g,null))[f];m.removeChild(g);return h}return{load:function(k,h,f,m){function e(){var b=g("x-parse",null,"content");b&&"none"!=b?h([eval(b)],f):f()}var q=h.toUrl(k),d=h.cache["url:"+q];if(d)return d.xCss&&(d=d.cssText),p(["./util/createStyleSheet"],function(b){b(d)}),e();if("none"==g("div",k.replace(/\//g,"-").replace(/\..*/,"")+"-loaded",
"display"))return e();p(["./load-css"],function(b){b(q,e)})}}})},"dgrid/OnDemandList":function(){define("./List ./_StoreMixin dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/dom dojo/on ./util/misc put-selector/put".split(" "),function(p,g,k,h,f,m,e,q,d){return k("dgrid.OnDemandList",[p,g],{minRowsPerPage:25,maxRowsPerPage:250,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:2E3,queryRowsOverlap:0,pagingMethod:"debounce",pagingDelay:q.defaultDelay,keepScrollPosition:!1,rowHeight:22,
postCreate:function(){this.inherited(arguments);var b=this;e(this.bodyNode,"scroll",q[this.pagingMethod](function(d){b._processScroll(d)},null,this.pagingDelay))},renderQuery:function(b,e,g){function k(b){d(q,"!");if(b)throw a._refreshDeferred&&(a._refreshDeferred.reject(b),delete a._refreshDeferred),b;}var a=this,c={query:b,count:0,node:e,options:g},m=this.preload,l;if(!e){var p={node:d(this.contentNode,"div.dgrid-preload",{rowIndex:0}),count:0,query:b,next:c,options:g};p.node.style.height="0";c.node=
e=d(this.contentNode,"div.dgrid-preload");c.previous=p}e.rowIndex=this.minRowsPerPage;m?((c.next=m.next)&&e.offsetTop>=m.node.offsetTop?c.previous=m:(c.next=m,c.previous=m.previous),c.previous.next=c,c.next.previous=c):this.preload=c;var q=d(e,"-div.dgrid-loading");d(q,"div.dgrid-below").innerHTML=this.loadingMessage;g=h.mixin(this.get("queryOptions"),g,{start:0,count:this.minRowsPerPage},"level"in b?{queryLevel:b.level}:null);this._trackError(function(){return l=b(g)});if("undefined"===typeof l)k();
else return f.when(a.renderArray(l,e,g),function(b){return f.when("undefined"===typeof l.total?l.length:l.total,function(f){var h=b.length,k=e.parentNode,m=a.noDataNode;d(q,"!");"queryLevel"in g||(a._total=f);0===f&&(m&&(d(m,"!"),delete a.noDataNode),a.noDataNode=m=d("div.dgrid-no-data"),k.insertBefore(m,a._getFirstRowSibling(k)),m.innerHTML=a.noDataMessage);for(m=k=0;m<h;m++)k+=a._calcRowHeight(b[m]);h&&k&&(a.rowHeight=k/h);f-=h;c.count=f;e.rowIndex=h;f?e.style.height=Math.min(f*a.rowHeight,a.maxEmptySpace)+
"px":(e.style.display="none",g.count++);a._previousScrollPosition&&(a.scrollTo(a._previousScrollPosition),delete a._previousScrollPosition);a._processScroll();a._refreshDeferred&&(a._refreshDeferred.resolve(l),delete a._refreshDeferred);return b},k)},k),l},refresh:function(b){var d=this,g=b&&b.keepScrollPosition,h;"undefined"===typeof g&&(g=this.keepScrollPosition);g&&(this._previousScrollPosition=this.getScrollPosition());this.inherited(arguments);if(this.store)return g=this._refreshDeferred=new f,
h=d.renderQuery(function(a){return d.store.query(d.query,a)}),"undefined"===typeof h&&g.reject(),g.then(function(a){setTimeout(function(){e.emit(d.domNode,"dgrid-refresh-complete",{bubbles:!0,cancelable:!1,grid:d,results:a})},0);delete d._refreshDeferred;return a},function(a){delete d._refreshDeferred;throw a;})},resize:function(){this.inherited(arguments);this._processScroll()},_getFirstRowSibling:function(b){return b.lastChild},_calcRowHeight:function(b){var d=b.previousSibling;return d&&!/\bdgrid-preload\b/.test(d.className)?
b.offsetTop-d.offsetTop:b.offsetHeight},lastScrollTop:0,_processScroll:function(b){function e(b,c,f,h){var l=a.farOffRemoval,k=b.node;if(c>2*l){for(var m,p=k[f],q=0,r=0,s=[];m=p;){var t=a._calcRowHeight(m);if(q+t+l>c||0>p.className.indexOf("dgrid-row")&&0>p.className.indexOf("dgrid-loading"))break;p=m[f];q+=t;r+=m.count||1;a.removeRow(m,!0);s.push(m)}b.count+=r;h?(k.rowIndex-=r,g(b)):k.style.height=k.offsetHeight+q+"px";var w=d("div",s);setTimeout(function(){d(w,"!")},1)}}function g(b,c){b.node.style.height=
Math.min(b.count*a.rowHeight,c?Infinity:a.maxEmptySpace)+"px"}function k(a,b){do a=b?a.next:a.previous;while(a&&!a.node.offsetWidth);return a}var a=this,c=a.bodyNode;b=b&&b.scrollTop||this.getScrollPosition().y;var c=c.offsetHeight+b,m,l,p=a.preload,q=a.lastScrollTop,A=a.bufferRows*a.rowHeight,x=A-a.rowHeight,u,C,E,F=!0;for(a.lastScrollTop=b;p&&!p.node.offsetWidth;)p=p.previous;for(;p&&p!=m;){m=a.preload;a.preload=p;l=p.node;var y=l.offsetTop;if(c+1+x<y)p=k(p,F=!1);else if(b-1-x>y+l.offsetHeight)p=
k(p,F=!0);else{var v=((l.rowIndex?b-A:c)-y)/a.rowHeight,y=(c-b+2*A)/a.rowHeight,I=Math.max(Math.min((b-q)*a.rowHeight,a.maxRowsPerPage/2),a.maxRowsPerPage/-2),y=y+Math.min(Math.abs(I),10);0==l.rowIndex&&(v-=y);v=Math.max(v,0);10>v&&(0<v&&y+v<a.maxRowsPerPage)&&(y+=Math.max(0,v),v=0);y=Math.min(Math.max(y,a.minRowsPerPage),a.maxRowsPerPage,p.count);if(0==y)p=k(p,F);else{var y=Math.ceil(y),v=Math.min(Math.floor(v),p.count-y),D=h.mixin(a.get("queryOptions"),p.options);p.count-=y;var K=l,B,M=a.queryRowsOverlap;
if(I=0<l.rowIndex&&p){var J=p.previous;J&&(e(J,b-(J.node.offsetTop+J.node.offsetHeight),"nextSibling"),0<v&&J.node==l.previousSibling?(v=Math.min(p.count,v),p.previous.count+=v,g(p.previous,!0),l.rowIndex+=v,M=0):y+=v,p.count-=v);D.start=l.rowIndex-M;D.count=Math.min(y+M,a.maxRowsPerPage);l.rowIndex=D.start+D.count}else p.next&&(e(p.next,p.next.node.offsetTop-c,"previousSibling",!0),K=l.nextSibling,K==p.next.node?(p.next.count+=p.count-v,p.next.node.rowIndex=v+y,g(p.next),p.count=v,M=0):B=!0),D.start=
p.count,D.count=Math.min(y+M,a.maxRowsPerPage);B&&(K&&K.offsetWidth)&&(B=K.offsetTop);g(p);"level"in p.query&&(D.queryLevel=p.query.level);if("queryLevel"in D||!(D.start>a._total||0>D.count)){l=d(K,"-div.dgrid-loading[style\x3dheight:"+y*a.rowHeight+"px]");d(l,"div.dgrid-"+(I?"below":"above")).innerHTML=a.loadingMessage;l.count=y;var N=p.query(D);if(void 0===a._trackError(function(){return N})){d(l,"!");return}(function(b,c,e,h){E=f.when(a.renderArray(h,b,D),function(l){C=h;K=b.nextSibling;d(b,"!");
if(e&&K&&K.offsetWidth){var k=a.getScrollPosition();a.scrollTo({x:k.x,y:k.y+K.offsetTop-e,preserveMomentum:!0})}f.when(h.total||h.length,function(b){"queryLevel"in D||(a._total=b);c&&(c.count=b-c.node.rowIndex,0===c.count&&D.count++,g(c))});a._processScroll();return l},function(a){d(b,"!");throw a;})}).call(this,l,I,B,N);p=p.previous}}}}if(E&&(u=this._refreshDeferred))delete this._refreshDeferred,f.when(E,function(){u.resolve(C)})},removeRow:function(b,d){if(b){var e=b.previousSibling,f=b.nextSibling,
e=e&&(null!=e.observerIndex?e.observerIndex:e.previousObserverIndex),a=f&&(null!=f.observerIndex?f.observerIndex:f.nextObserverIndex),f=b.observerIndex;b.observerIndex=void 0;d&&(b.nextObserverIndex=a,b.previousObserverIndex=e);if(this.cleanEmptyObservers&&(-1<f&&f!==e&&f!==a)&&(e=this.observers,a=e[f])){if(!d)for(var c=a.rows,g=0;g<c.length;g++)if(c[g]!=b&&m.isDescendant(c[g],this.domNode))return this.inherited(arguments);a.cancel();this._numObservers--;e[f]=0}}this.inherited(arguments)}})})},"dgrid/_StoreMixin":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/Deferred dojo/on dojo/aspect put-selector/put".split(" "),
function(p,g,k,h,f,m,e){function q(b){return b}function d(b){if("object"!==typeof b)b=Error(b);else if("cancel"===b.dojoType)return;b.grid=this;f.emit(this.domNode,"dgrid-error",{grid:this,error:b,cancelable:!0,bubbles:!0})&&console.error(b)}return g("dgrid._StoreMixin",null,{store:null,query:null,queryOptions:null,getBeforePut:!0,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};this._columnsWithSet={};m.before(this,"configStructure",
k.hitch(this,function(){this._columnsWithSet={}}))},postCreate:function(){this.inherited(arguments);this.store&&this._updateNotifyHandle(this.store)},destroy:function(){this.inherited(arguments);this._notifyHandle&&this._notifyHandle.remove()},_configColumn:function(b){b.set&&(this._columnsWithSet[b.field]=b);this.inherited(arguments)},_updateNotifyHandle:function(b){this._notifyHandle&&(this._notifyHandle.remove(),delete this._notifyHandle);b&&"function"===typeof b.notify&&(this._notifyHandle=m.after(b,
"notify",k.hitch(this,"_onNotify"),!0),b=this.get("sort"),(!b||!b.length)&&console.warn("Observable store detected, but no sort order specified. You may experience quirks when adding/updating items.  These can be resolved by setting a sort order on the list or grid."))},_setStore:function(b,d,e){this._updateNotifyHandle(b);this.store=b;this.dirty={};this.set("query",d,e)},_setQuery:function(b,d){var e=d&&d.sort;this.query=void 0!==b?b:this.query;this.queryOptions=d||this.queryOptions;e?this.set("sort",
e):this.refresh()},setStore:function(b,d,e){p.deprecated("setStore(...)",'use set("store", ...) instead',"dgrid 0.4");this.set("store",b,d,e)},setQuery:function(b,d){p.deprecated("setQuery(...)",'use set("query", ...) instead',"dgrid 0.4");this.set("query",b,d)},_getQueryOptions:function(){var b=k.delegate(this.queryOptions,{});if("function"===typeof this._sort||this._sort.length)b.sort=this._sort;return b},_getQuery:function(){var b=this.query;return"object"==typeof b&&null!=b?k.delegate(b,{}):b},
_setSort:function(b,d){this.store&&(this._lastCollection=null);this.inherited(arguments)},_onNotify:function(b,d){this.inherited(arguments);b&&1>this._numObservers&&this.refresh({keepScrollPosition:!0})},insertRow:function(b,d,e,f,a){var c=this.store,g=this.dirty,c=c&&c.getIdentity(b),h;c in g&&!(c in this._updating)&&(h=g[c]);h&&(b=k.delegate(b,h));return this.inherited(arguments)},updateDirty:function(b,d,e){var f=this.dirty,a=f[b];a||(a=f[b]={});a[d]=e},setDirty:function(b,d,e){p.deprecated("setDirty(...)",
"use updateDirty() instead","dgrid 0.4");this.updateDirty(b,d,e)},save:function(){function b(a,b){return function(c){var g=d._columnsWithSet,l=d._updating,k,m;if("function"===typeof c.set)c.set(b);else for(k in b)c[k]=b[k];for(k in g)m=g[k].set(c),void 0!==m&&(c[k]=m);l[a]=!0;return h.when(e.put(c),function(){delete f[a];delete l[a]})}}var d=this,e=this.store,f=this.dirty,a=new h,c=a.promise,g=function(a){var b;return d.getBeforePut||!(b=d.row(a).data)?function(){return e.get(a)}:function(){return b}},
l;for(l in f)var k=b(l,f[l]),c=c.then(g(l)).then(k);a.resolve();return c},revert:function(){this.dirty={};this.refresh()},_trackError:function(b){var e;"string"==typeof b&&(b=k.hitch(this,b));try{e=b()}catch(f){d.call(this,f)}return h.when(e,q,k.hitch(this,d))},newRow:function(){var b=this.inherited(arguments);this.noDataNode&&(e(this.noDataNode,"!"),delete this.noDataNode);return b},removeRow:function(b,d){var f={element:b};!d&&(this.noDataMessage&&this.up(f).element===b&&this.down(f).element===
b)&&(this.noDataNode=e(this.contentNode,"div.dgrid-no-data"),this.noDataNode.innerHTML=this.noDataMessage);return this.inherited(arguments)}})})},"dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect ./List dojo/has!touch?./util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),function(p,g,k,h,f,m,e,q,d){function b(a,b){for(var c=a.unselectable=b?"on":"",d=a.getElementsByTagName("*"),e=d.length;--e;)"INPUT"===d[e].tagName||
"TEXTAREA"===d[e].tagName||(d[e].unselectable=c)}function r(a,c){var d=a.bodyNode,e=c?"text":21>f("ff")?"-moz-none":"none";t&&"msUserSelect"!==t?d.style[t]=e:f("dom-selectstart")?!c&&!a._selectstartHandle?a._selectstartHandle=h(d,"selectstart",function(a){var b=a.target&&a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):c&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):(b(d,!c),!c&&!a._unselectableHandle?a._unselectableHandle=m.after(a,"renderRow",
function(a){b(a,!0);return a}):c&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle))}f.add("dom-comparedocumentposition",function(a,b,c){return!!c.compareDocumentPosition});f.add("pointer",function(a,b,c){return"onpointerdown"in c?"pointer":"onmspointerdown"in c?"MSPointer":!1});f.add("css-user-select",function(a,b,c){a=c.style;b=["Khtml","O","ms","Moz","Webkit"];c=b.length;var d="userSelect";do if("undefined"!==typeof a[d])return d;while(c--&&(d=b[c]+"UserSelect"));
return!1});f.add("dom-selectstart","undefined"!==typeof document.onselectstart);var n=f("mac")?"metaKey":"ctrlKey",t=f("css-user-select"),a=(e=f("pointer"))&&"MS"===e.slice(0,2),c=e?e+(a?"Down":"down"):"mousedown",s=e?e+(a?"Up":"up"):"mouseup";return g("dgrid.Selection",null,{selectionDelegate:".dgrid-row",selectionEvents:c+","+s+",dgrid-cellfocusin",selectionTouchEvents:f("touch")?q.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",
create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),
this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){p.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");this.set("selectionMode",a)},_setAllowTextSelection:function(a){"undefined"!==typeof a?r(this,a):r(this,"none"===this.selectionMode);this.allowTextSelection=a},_handleSelect:function(a,b){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(b))&&
!("dgrid-cellfocusin"===a.type&&"mousedown"===a.parentType||a.type===s&&b!=this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===c&&this.isSelected(b))this._waitForMouseUp=b;else this[this._selectionHandlerName](a,b);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(a,b){var c=a.keyCode?a.ctrlKey:a[n];this._lastSelected===b?this.select(b,null,!c||!this.isSelected(b)):(this.clearSelection(),
this.select(b),this._lastSelected=b)},_multipleSelectionHandler:function(a,b){var c=this._lastSelected,d=a.keyCode?a.ctrlKey:a[n],e;a.shiftKey||(e=d?null:!0,c=null);this.select(b,c,e);c||(this._lastSelected=b)},_extendedSelectionHandler:function(a,b){(2===a.button?!this.isSelected(b):!(a.keyCode?a.ctrlKey:a[n]))&&this.clearSelection(null,!0);this._multipleSelectionHandler(a,b)},_toggleSelectionHandler:function(a,b){this.select(b,null,null)},_initSelectionEvents:function(){var a=this,b=this.contentNode,
c=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};f("touch")&&!f("pointer")&&this.selectionTouchEvents?(h(b,q.selector(c,this.selectionTouchEvents),function(b){a._handleSelect(b,this);a._ignoreMouseSelect=this}),h(b,h.selector(c,this.selectionEvents),function(b){a._ignoreMouseSelect!==this?a._handleSelect(b,this):b.type===s&&(a._ignoreMouseSelect=null)})):h(b,h.selector(c,this.selectionEvents),function(b){a._handleSelect(b,this)});this.addKeyHandler&&this.addKeyHandler(32,
function(b){a._handleSelect(b,b.target)});if(this.allowSelectAll)this.on("keydown",function(b){b[n]&&(65==b.keyCode&&!/\bdgrid-input\b/.test(b.target.className))&&(b.preventDefault(),a[a.allSelected?"clearSelection":"selectAll"]())});this._setStore&&m.after(this,"_setStore",function(){a._updateDeselectionAspect()});this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(c,d,e){c=d||c&&c[b.idProperty||"id"];if(null!=c&&(d=(c=b.row(c))&&b.selection[c.id]))b[e](c,null,d)}var b=
this,c=this.store,d,e;this._removeDeselectSignals&&this._removeDeselectSignals();c&&c.notify?(d=m.before(c,"notify",function(b,c){b||a(b,c,"deselect")}),e=m.after(c,"notify",function(b,c){a(b,c,"select")},!0),this._removeDeselectSignals=function(){d.remove();e.remove()}):(d=m.before(this,"removeRow",function(a,b){var c;b||(c=this.row(a))&&c.id in this.selection&&this.deselect(c)}),this._removeDeselectSignals=function(){d.remove()})},allowSelect:function(a){return!0},_fireSelectionEvent:function(a){var b=
this._selectionEventQueues[a],c=this._selectionTriggerEvent,d;d={bubbles:!0,grid:this};c&&(d.parentType=c.type);d[this._selectionTargetType]=b;h.emit(this.contentNode,"dgrid-"+a,d);this._selectionEventQueues[a]=[]},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},_select:function(a,b,c){var e,f,g;"undefined"===typeof c&&(c=!0);a.element||(a=this.row(a));if(!1===c||this.allowSelect(a))if(e=this.selection,f=!!e[a.id],null===c&&(c=
!f),g=a.element,!c&&!this.allSelected?delete this.selection[a.id]:e[a.id]=c,g&&(c?d(g,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):d(g,"!dgrid-selected!ui-state-active")),c!==f&&g&&this._selectionEventQueues[(c?"":"de")+"select"].push(a),b)if(b.element||(b=this.row(b)),b){if(b=b.element){e=this._determineSelectionDirection(g,b);e||(b=document.getElementById(b.id),e=this._determineSelectionDirection(g,b));for(;a.element!=b&&(a=this[e](a));)this._select(a,null,c)}}else this._lastSelected=
g,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},_determineSelectionDirection:f("dom-comparedocumentposition")?function(a,b){var c=b.compareDocumentPosition(a);return c&1?!1:2===c?"down":"up"}:function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>a.sourceIndex?"down":"up"},select:function(a,
b,c){this._select(a,b,c);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var c in this.selection)a!==c&&this._select(c,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=this.row(this._rowIdToObject[a]);this._select(b.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===typeof a||
null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var a=this,b=this.inherited(arguments);k.when(b,function(b){var c=a.selection,d,e,f;for(d=0;d<b.length;d++)e=a.row(b[d]),(f=e.id in c?c[e.id]:a.allSelected)&&a._select(e,null,f);a._fireSelectionEvents()});return b}})})},
"xstyle/main":function(){define("xstyle/main",["require","put-selector/put"],function(p,g){function k(a,b){return a&&a.then?a.then(b):b(a)}function h(a,b,c){return k(a,function(a){var d=b[0];if(!a)return c(d||a);if(d&&a.get)return h(a.get(d),b.slice(1),c);if(a.receive)return a.receive(d?function(a){h(a,b,c)}:c);if(d)return h(a[d],b.slice(1),c);c(a)})}function f(a,b,c){h(a,b.slice(0,b.length-1),function(a){var d=b[b.length-1];a.set?a.set(d,c):a[d]=c})}function m(a){a=y.getElementsByTagName(a);for(var b=
0;b<a.length;b++)d(a[b])}function e(){return this.join("")}function q(a){this.value=a}function d(a,c,e){function f(){p(["xstyle/load-imports"],function(b){b(a,function(){d(a,c,!0)})})}var g=a.sheet||a.styleSheet||a,h=g.needsParsing,k=g.rules||g.cssRules;if(g.imports&&!e&&g.imports.length)return f();if(!h)for(var l=0;l<k.length;l++){var m=k[l];if(m.href&&!e)return f();m.selectorText&&"x-"==m.selectorText.substring(0,2)&&(h=!0,/^'/.test(m.style.content))}b(g.localSource||(g.ownerNode||g.ownerElement).innerHTML,
g,c)}function b(a,d,f){function g(a,b,c){(E[a]||(E[a]={}))[b]=c}function h(a){E[a]||(E[a]={});g("selector","x-"+a,{onRule:function(b){b.eachProperty(function(b,c){var d=c.toString();do{d=d.match(/([^, \(]+)(?:[, ]+(.+))?/);if(!d)break;var e=d[1];if("module"==e)return g(a,b,c[1].args[0]);if("default"==e){if("pseudo"==a)try{y.querySelectorAll("x:"+b);break}catch(f){}}else if("prefix"!=e)return g(a,b,function(){return c})}while(d=d[2])})}})}function m(){}function n(a){this.caller=a;this.args=[]}function r(a,
b){b.onRule();var c=E.selector[a];c&&t(c,"onRule",b)}function t(a,b,c,e){if(a){var g=H,h=function(a){"string"==typeof a&&d.addRule(g.fullSelector(),a);0==--D&&f&&f(d)};D++;var k=function(a){function f(a){console.error("Error occurred processing "+b.slice(2).toLowerCase()+" "+c+("{"==g.operator?' in rule "'+g.selector+'" {'+g.cssText:"")+". "+a.message);a&&console.error(a)}try{var k=a[b](c,e,g,d);g instanceof n&&(g.result=k);k&&k.then?k.then(h,f):h(k)}catch(l){f(l)}};"string"==typeof a?p([a],k):k(a)}}
function B(a,c){function d(a,b){b||(k+=a);if(G)if(G.push)"string"==typeof G[G.length-1]&&"string"==typeof a?G[G.length-1]+=a:a&&G.push(a);else if("string"==typeof G&&"string"==typeof a)G+=a;else{var c=[G,a];c.toString=e;G=c}else G=a}H=P;for(var g=z.lastIndex=0,h=!0,k="",m=!0;;){var n=z.exec(a),p=n[4],s=n[1],L=n[2],n=n[3],y,O,G,V,n=n&&v(n),s=v(s);if(m){if(L?(k=O=s,y=L.charAt(0),V="?"==L.charAt(1)):k=n=s,G=n,O||"/"!=p)m=!1}else n=n?s+L:s,d(n);switch(p){case "'":case '"':var R="'"==p?A:x;R.lastIndex=
z.lastIndex;(p=R.exec(a))||error("unterminated string");p=p[1];z.lastIndex=R.lastIndex;d(new q(p));continue;case "/":"*"==a[z.lastIndex]?(u.lastIndex=z.lastIndex+1,u.exec(a),z.lastIndex=u.lastIndex):d("/");continue;case "\\":p=R.lastIndex++;d(a.charAt(p));continue;case "(":case "{":case "[":var U=!1;if("{"==p){m=!0;d(s=H.newRule(k),!0);if(y){h=!1;if(!L||"\x3e"==L.charAt(1))G.creating=!0;"\x3d"==y&&n&&(U=!0)}H.root&&h&&(s.cssRule=c.cssRules[g++])}else L=n.match(/(.*?)([\w-]*)$/),d(s=H.newCall(L[2],
G,H)),s.ref=l(H,L[2]),(G.calls||(G.calls=[])).push(s);s.parent=H;s.selector=G.creating?".x-generated-"+C++:H.root?k:H.selector+" "+k;U&&(L=l(H,n.match(/[^\s]+$/)[0],!0))&&w(L,s);H.currentName=O;H.currentSequence=G;H.assignmentOperator=y;J.push(H=s);H.operator=p;H.start=z.lastIndex;k="";H.selector&&H.selector.replace(/:([-\w]+)/,function(a,b){var c=E.pseudo[b];c&&t(c,"onPseudo",b,H)});G=O=null;continue}if(G)if(s=G[0],s.charAt&&"@"==s.charAt(0))"import"==G[0].slice(1,7)&&(L=b.getStyleSheet(c.cssRules[g++],
G,c),D++,n=z.lastIndex,B(L.localSource,L),z.lastIndex=n);else try{H[":"==y?"setValue":"declareProperty"](O,G,V)}catch(W){console.error(W.stack||W)}switch(p){case ":":m=!0;y=":";break;case "}":case ")":case "]":F[H.operator]!=p&&console.error("Incorrect opening operator "+H.operator+" with closing operator "+p);O=null;H.cssText=a.slice(H.start,z.lastIndex-1);"}"==p&&(r(H.selector,H),h=!0,k="");J.pop();H=J[J.length-1];G=H.currentSequence;O=H.currentName;y=H.assignmentOperator;H.root&&"}"==p&&(m=!0,
y=!1);break;case "":f&&f();return;case ";":G=null,m=!0,y=h=!1,k=""}}}d.addRule||(d.addRule=function(a,b,c){return this.insertRule(a+"{"+b+"}",0<=c?c:this.cssRules.length)});d.deleteRule||(d.deleteRule=d.removeRule);var E={property:{}};h("property");h("function");h("pseudo");E["function"]["var"]=Q;E["function"]["extends"]=Q;var D=1;(d.href||location.href).replace(/[^\/]+$/,"");m.prototype={eachProperty:function(a){for(var b=this.values||0,c=0;c<b.length;c++){var d=b[c];a.call(this,d||"unnamed",b[d])}},
fullSelector:function(){return(this.parent?this.parent.fullSelector():"")+(this.selector||"")+" "},newRule:function(a){return(this.rules||(this.rules={}))[a]=new m},newCall:function(a,b,c){return new n(a)},addSheetRule:function(a,b){if(b&&"@"!=a.charAt(0)){var c=d.addRule(a,b);-1==c&&(c=d.cssRules.length-1);return d.cssRules[c]}},onRule:function(){this.getCssRule()},getCssRule:function(){this.cssRule||(this.cssRule=this.addSheetRule(this.selector,this.cssText));return this.cssRule},get:function(a){return this.values[a]},
declareProperty:function(a,b,d){if("\x3e"==b[0].toString().charAt(0))a||(this.generator=b,b=c(b,this),Q.addRenderer("",b,this,b));else{var e=a in I.style||l(this,a);if(!d||!e)(this.properties||(this.properties={}))[a]=b,e&&console.warn('Overriding existing property "'+a+'"')}},setValue:function(a,b){var c=this.values||(this.values=[]);c.push(a);c[a]=b;if(c=b.calls)for(var d=0;d<c.length;d++){var e=c[d],f=e.ref;f&&"function"==typeof f.call&&f.call(e,this,a,b)}if(a){do{if(c=l(this,a)){var g=this;k(s(g,
a,c),function(c){c=c.splice?c:[c];for(var d=0;d<c.length&&!c[d].put(b,g,a);d++);});break}a=a.substring(0,a.lastIndexOf("-"))}while(a)}},cssText:""};var G=n.prototype=new m;G.declareProperty=G.setValue=function(a,b){this.args.push(b)};G.toString=function(){var a=this.operator;return a+this.args+F[a]};var H,P=new m;P.root=!0;P.properties={Math:Math,module:function(a){return{then:function(b){p([a],b)}}},item:{forElement:function(a){for(;!a.item;)a=a.parentNode;return{element:a,receive:function(b){b(a.item)}}}},
prefix:{put:function(a,b,c){if("string"==typeof I.style[K+c])return b.addSheetRule(b.selector,K+c+":"+a)}},"var":{put:function(a,b,c){(b.variables||(b.variables={}))[c]=a;b=(b=b.variableListeners)&&b[c]||0;for(c=0;c<b.length;c++)b[c](a)},call:function(a,b,c,d){this.receive(function(a){b.addSheetRule(b.selector,c+": "+d.toString().replace(/var\([^)]+\)/g,a))},b,a.args[0])},receive:function(a,b,c){var d=b;do{if(b=d.variables&&d.variables[c])return d=d.variableListeners||(d.variableListeners={}),(d[c]||
(d[c]=[])).push(a),a(b);d=d.parent}while(d);a()}},on:{put:function(a,b,c){console.log("add event listener");s(b,c,a)}}};P.css=a;P.parse=B;var J=[P];B(a,d);0==--D&&f&&f(d);return P}function r(){m("link");m("style");if(!S)if(S=!0,B["dom-qsa2.1"]){for(var b=0,c=J.length;b<c;b++)n(J[b]);t()}else for(var d=y.all,b=0,c=d.length;b<c;b++)a(d[b])}function n(a){for(var b=y.querySelectorAll(a.selector),c=a.name,d=0,e=b.length;d<e;d++){var f=b[d],g=f.elementalStyle;g||(g=f.elementalStyle={},f.elementalSpecificities=
{});var h=f.renderings;h||(h=f.renderings=[],N.push(f));h.push({name:c,rendered:g[c]==a.propertyValue,renderer:a});g[c]=a.propertyValue}}function t(){for(var a=0;a<N.length;a++){var b=N[a],c=b.renderings,d=b.elementalStyle;delete b.renderings;for(var e=0;e<c.length;e++){var f=c[e],h=f.renderer,k=h.rendered;T=d[f.name]==h.propertyValue;if(!k&&T)try{h.render(b)}catch(l){console.error(l,l.stack),g(b,"div.error",l.toString())}k&&(!T&&h.unrender)&&(h.unrender(b),c.splice(e--,1))}}N=[]}function a(a,b){for(var c=
0,d=J.length;c<d;c++){var e=J[c];(!b||b==e.selector)&&(M?M.call(a,e.selector):a.currentStyle[e.name]==e.propertyValue)&&e.render(a)}}function c(a,b){C++;a=a.sort?a:[a];return function(d,e){for(var f=d,h=0,l=a.length;h<l;h++){var m=a[h];try{if(m.eachProperty)if(m.args)if("("==m.operator){var n=a[h+1];n&&n.eachProperty&&g(f,n.selector);var p=m.args.toString(),q=s(m,0,p);(function(a,d){k(q,function(e){e.forElement&&(e=e.forElement(d));var f=a.appendChild(y.createTextNode("Loading"));e.receive(function(b){if(b&&
b.sort){f&&(f.parentNode.removeChild(f),f=null);var d=n&&n.eachProperty&&n.get("each");d&&(d=c(d,n));b.forEach(d?function(b){d(a,b)}:function(b){g(a,E[a.tagName]||"div",b)})}else"value"in a?(a.value=b,a["-x-variable"]=e):f.nodeValue=b},b,p)})})(f,d)}else g(f,m.toString());else g(f,m.selector),Q.update(f,m.selector);else if("string"==typeof m){"\x3d"==m.charAt(0)&&(m=m.slice(1));for(var r=m.split(","),m=0,t=r.length;m<t;m++){var w=r[m].trim();if(w){var w=w.replace(/\([^)]*\)/,function(a){}),z=g(0==
m?f:d,w);e&&(z.item=e);n=a[h+1];z!=f&&(!n||!n.eachProperty)&&Q.update(z);f=z}}}else f.appendChild(y.createTextNode(m.value))}catch(x){console.error(x,x.stack),f.appendChild(y.createTextNode(x))}}return f}}function s(a,b,c){function d(){var a=g.length+1,b=[],c=[],e,l,m=function(d){return function(f){b[d]=f;a--;if(0>=a){l=!0;e=q?q.apply(this,b):b[0];for(f=0;f<c.length;f++)c[f](e)}}};if(q)for(var n=0;n<g.length;n++){var p=g[n];h(p[0],p.slice(1),m(n))}else{var p=g[0],s={then:function(a){c.push(a)}};k(p[0],
function(a){s=a;for(var b=1;b<p.length;b++)if(s&&s.get)s=s.get(p[b]);else{s={receive:function(b){h(a,p.slice(1),b)},put:function(a){f(resolve,p.slice(1),a)}};break}for(b=0;b<c.length;b++)c[b](s)});return s}m(-1)();return e&&e.then?e:{receive:function(a){c&&c.push(a);l&&a(e)}}}var e=a["var-expr-"+b];if(g)return e;var g=[],m;g.id=C++;var n=[],p;c=c.join?c.join(""):c.toString();e=c.match(/^[\w_$\/\.-]*$/);c=c.replace(/("[^\"]*")|([\w_$\.\/-]+)/g,function(b,c,d){if(d){p=d.split("/");b=p.join("_");n.push(b);
g.push(p);c=p[0];d=l(a,c);if("string"==typeof d||d instanceof Array)d=s(a,c,d);else if(!d)throw Error('Could not find reference "'+c+'"');d.forElement&&(m=!0);p[0]=d}return b});if(!e)var q=Function.apply(this,n.concat(["return xstyleReturn("+c+")"]));g.func=q;a["var-expr-"+b]=g;return a["var-expr-"+b]=m?{forElement:function(b){for(var c,e=b;!M.call(b,a.selector);)b=b.parentNode;for(b=0;b<g.length;b++){var f=g[b],h=f[0];h.forElement&&(h=f[0]=h.forElement(e));f=h.element;if(e!=c){for(;e!=f;){if(e==
c)return;e=e.parentNode}c=e}}e=c["expr-result-"+g.id];e||(c["expr-result-"+g.id]=e=d(),e.element=c);return e}}:d()}function l(a,b,c){do{var d=a.properties&&a.properties[b]||c&&a.rules&&a.rules[b];a=a.parent}while(!d&&a);return d}function w(a,b){b.cssText+=a.cssText;"values,properties,variables,calls".replace(/\w+/g,function(c){a[c]&&(b[c]=Object.create(a[c]))});var c=b.getCssRule();a.eachProperty(function(a,d){b.setValue(a,d);if(a){var e=c.style;e[a]||(e[a]=d)}});a.generator&&b.declareProperty(null,
a.generator)}var z=/\s*([^{\}\[\]\(\)\/\\'":=;]*)([=:]\??\s*([^{\}\[\]\(\)\/\\'":;]*))?([{\}\[\]\(\)\/\\'":;]|$)/g,A=/((?:\\.|[^'])*)'/g,x=/((?:\\.|[^"])*)"/g,u=/\*\//g,C=0,E={TABLE:"tr",TBODY:"tr",TR:"td",UL:"li",OL:"li",SELECT:"option"},F={"{":"}","[":"]","(":")"},y=document,v="".trim?function(a){return a.trim()}:function(a){return a.replace(/^\s+|\s+$/g,"")},I=y.createElement("div");q.prototype.toString=function(){return'"'+this.value.replace(/["\\\n\r]/g,"\\$\x26")+'"'};var D=navigator.userAgent,
K=-1<D.indexOf("WebKit")?"-webkit-":-1<D.indexOf("Firefox")?"-moz-":-1<D.indexOf("MSIE")?"-ms-":-1<D.indexOf("Opera")?"-o-":"";b.getStyleSheet=function(a,b){return a.styleSheet};y.addEventListener("change",function(a){a=a.target;var b=a["-x-variable"];b.put&&b.put(a.value)});var I=y.createElement("div"),B={"dom-qsa2.1":!!I.querySelectorAll},M=I.matches||I.matchesSelector||I.webkitMatchesSelector||I.mozMatchesSelector||I.msMatchesSelector||I.oMatchesSelector,J=[],N=[],S;/e/.test(y.readyState||"")?
setTimeout(r,200):y.addEventListener("DOMContentLoaded",r);var T,Q={process:d,vendorPrefix:K,applyProperty:function(a,b){return"opacity"==a&&"-ms-"==K?"filter: alpha(opacity\x3d"+100*b+"); zoom: 1;":K+a+":"+b+";"},onFunction:function(a,b,c){},onCall:function(a,b){function c(){var b=e,f="extends"==a?"rules":"variables";do{if(!b)throw Error('Could not find "'+d[0]+'" in the defined '+f);var g=b[f]&&b[f][d[0]],b=b.parent}while(!g);return g}var d=b.args,e=b.parent;if("extends"==a){var f=c();w(f,e)}else if("var"==
a)return function(a){a.addSheetRule(a.selector,a.currentName+": "+a.currentSequence.toString().replace(/var\([^)]+\)/g,c()))}},parse:b,addRenderer:function(a,b,c,d){a={selector:c.selector,propertyValue:b,name:a,render:d};J.push(a);S&&n(a);t()},update:a,clearRenderers:function(){J=[]},load:function(a,b,c,d){b(["xstyle/css"],function(e){e.load(a,b,c,d)})}};return Q});xstyleReturn=function(p){return 1==arguments.length?p:[].slice.call(arguments)}},"dojo/store/Memory":function(){define(["../_base/declare",
"./util/QueryResults","./util/SimpleQueryEngine"],function(p,g,k){return p("dojo.store.Memory",null,{constructor:function(g){for(var f in g)this[f]=g[f];this.setData(this.data||[])},data:null,idProperty:"id",index:null,queryEngine:k,get:function(g){return this.data[this.index[g]]},getIdentity:function(g){return g[this.idProperty]},put:function(g,f){var k=this.data,e=this.index,p=this.idProperty,p=g[p]=f&&"id"in f?f.id:p in g?g[p]:Math.random();if(p in e){if(f&&!1===f.overwrite)throw Error("Object already exists");
k[e[p]]=g}else e[p]=k.push(g)-1;return p},add:function(g,f){(f=f||{}).overwrite=!1;return this.put(g,f)},remove:function(g){var f=this.index,k=this.data;if(g in f)return k.splice(f[g],1),this.setData(k),!0},query:function(h,f){return g(this.queryEngine(h,f)(this.data))},setData:function(g){g.items?(this.idProperty=g.identifier||this.idProperty,g=this.data=g.items):this.data=g;this.index={};for(var f=0,k=g.length;f<k;f++)this.index[g[f][this.idProperty]]=f}})})},"dojo/store/util/SimpleQueryEngine":function(){define(["../../_base/array"],
function(p){return function(g,k){function h(f){f=p.filter(f,g);var e=k&&k.sort;e&&f.sort("function"==typeof e?e:function(d,b){for(var f,g=0;f=e[g];g++){var h=d[f.attribute],a=b[f.attribute],h=null!=h?h.valueOf():h,a=null!=a?a.valueOf():a;if(h!=a)return!!f.descending==(null==h||h>a)?-1:1}return 0});if(k&&(k.start||k.count)){var h=f.length;f=f.slice(k.start||0,(k.start||0)+(k.count||Infinity));f.total=h}return f}switch(typeof g){default:throw Error("Can not query with a "+typeof g);case "object":case "undefined":var f=
g;g=function(g){for(var e in f){var h=f[e];if(h&&h.test){if(!h.test(g[e],g))return!1}else if(h!=g[e])return!1}return!0};break;case "string":if(!this[g])throw Error("No filter function "+g+" was found in store");g=this[g];case "function":}h.matches=g;return h}})},"dojo/dnd/Source":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom-class ../dom-geometry ../mouse ../ready ../topic ./common ./Selector ./Manager".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n){k.isAsync||
q(0,function(){require(["dojo/dnd/AutoSource","dojo/dnd/Target"])});var t=g("dojo.dnd.Source",r,{isSource:!0,horizontal:!1,copyOnly:!1,selfCopy:!1,selfAccept:!0,skipForm:!1,withHandles:!1,autoSync:!1,delay:0,accept:["text"],generateText:!0,constructor:function(a,b){h.mixin(this,h.mixin({},b));var e=this.accept;if(e.length){this.accept={};for(var g=0;g<e.length;++g)this.accept[e[g]]=1}this.mouseDown=this.isDragging=!1;this.targetBox=this.targetAnchor=null;this.before=!0;this._lastY=this._lastX=0;this.sourceState=
"";this.isSource&&f.add(this.node,"dojoDndSource");this.targetState="";this.accept&&f.add(this.node,"dojoDndTarget");this.horizontal&&f.add(this.node,"dojoDndHorizontal");this.topics=[d.subscribe("/dnd/source/over",h.hitch(this,"onDndSourceOver")),d.subscribe("/dnd/start",h.hitch(this,"onDndStart")),d.subscribe("/dnd/drop",h.hitch(this,"onDndDrop")),d.subscribe("/dnd/cancel",h.hitch(this,"onDndCancel"))]},checkAcceptance:function(a,b){if(this==a)return!this.copyOnly||this.selfAccept;for(var d=0;d<
b.length;++d){for(var e=a.getItem(b[d].id).type,f=!1,g=0;g<e.length;++g)if(e[g]in this.accept){f=!0;break}if(!f)return!1}return!0},copyState:function(a,b){if(a)return!0;2>arguments.length&&(b=this==n.manager().target);if(b){if(this.copyOnly)return this.selfCopy}else return this.copyOnly;return!1},destroy:function(){t.superclass.destroy.call(this);p.forEach(this.topics,function(a){a.remove()});this.targetAnchor=null},onMouseMove:function(a){if(!(this.isDragging&&"Disabled"==this.targetState)){t.superclass.onMouseMove.call(this,
a);var c=n.manager();if(!this.isDragging&&this.mouseDown&&this.isSource&&(Math.abs(a.pageX-this._lastX)>this.delay||Math.abs(a.pageY-this._lastY)>this.delay)){var d=this.getSelectedNodes();d.length&&c.startDrag(this,d,this.copyState(b.getCopyKeyState(a),!0))}if(this.isDragging){d=!1;if(this.current){if(!this.targetBox||this.targetAnchor!=this.current)this.targetBox=m.position(this.current,!0);d=this.horizontal?a.pageX-this.targetBox.x<this.targetBox.w/2==m.isBodyLtr(this.current.ownerDocument):a.pageY-
this.targetBox.y<this.targetBox.h/2}if(this.current!=this.targetAnchor||d!=this.before)this._markTargetAnchor(d),c.canDrop(!this.current||c.source!=this||!(this.current.id in this.selection))}}},onMouseDown:function(a){if(!this.mouseDown&&this._legalMouseDown(a)&&(!this.skipForm||!b.isFormElement(a)))this.mouseDown=!0,this._lastX=a.pageX,this._lastY=a.pageY,t.superclass.onMouseDown.call(this,a)},onMouseUp:function(a){this.mouseDown&&(this.mouseDown=!1,t.superclass.onMouseUp.call(this,a))},onDndSourceOver:function(a){this!==
a?(this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor()):this.isDragging&&(a=n.manager(),a.canDrop("Disabled"!=this.targetState&&(!this.current||a.source!=this||!(this.current.id in this.selection))))},onDndStart:function(a,b,d){this.autoSync&&this.sync();this.isSource&&this._changeState("Source",this==a?d?"Copied":"Moved":"");b=this.accept&&this.checkAcceptance(a,b);this._changeState("Target",b?"":"Disabled");this==a&&n.manager().overSource(this);this.isDragging=!0},onDndDrop:function(a,
b,d,e){if(this==e)this.onDrop(a,b,d);this.onDndCancel()},onDndCancel:function(){this.targetAnchor&&(this._unmarkTargetAnchor(),this.targetAnchor=null);this.before=!0;this.mouseDown=this.isDragging=!1;this._changeState("Source","");this._changeState("Target","")},onDrop:function(a,b,d){if(this!=a)this.onDropExternal(a,b,d);else this.onDropInternal(b,d)},onDropExternal:function(a,c,d){var e=this._normalizedCreator;this._normalizedCreator=this.creator?function(b,c){return e.call(this,a.getItem(b.id).data,
c)}:d?function(c){var d=a.getItem(c.id);c=c.cloneNode(!0);c.id=b.getUniqueId();return{node:c,data:d.data,type:d.type}}:function(b){var c=a.getItem(b.id);a.delItem(b.id);return{node:b,data:c.data,type:c.type}};this.selectNone();!d&&!this.creator&&a.selectNone();this.insertNodes(!0,c,this.before,this.current);!d&&this.creator&&a.deleteSelectedNodes();this._normalizedCreator=e},onDropInternal:function(a,c){var d=this._normalizedCreator;if(!(this.current&&this.current.id in this.selection)){if(c)this._normalizedCreator=
this.creator?function(a,b){return d.call(this,this.getItem(a.id).data,b)}:function(a){var c=this.getItem(a.id);a=a.cloneNode(!0);a.id=b.getUniqueId();return{node:a,data:c.data,type:c.type}};else{if(!this.current)return;this._normalizedCreator=function(a){var b=this.getItem(a.id);return{node:a,data:b.data,type:b.type}}}this._removeSelection();this.insertNodes(!0,a,this.before,this.current);this._normalizedCreator=d}},onDraggingOver:function(){},onDraggingOut:function(){},onOverEvent:function(){t.superclass.onOverEvent.call(this);
n.manager().overSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOver()},onOutEvent:function(){t.superclass.onOutEvent.call(this);n.manager().outSource(this);if(this.isDragging&&"Disabled"!=this.targetState)this.onDraggingOut()},_markTargetAnchor:function(a){this.current==this.targetAnchor&&this.before==a||(this.targetAnchor&&this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=a,this.targetAnchor&&
this._addItemClass(this.targetAnchor,this.before?"Before":"After"))},_unmarkTargetAnchor:function(){this.targetAnchor&&(this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetBox=this.targetAnchor=null,this.before=!0)},_markDndStatus:function(a){this._changeState("Source",a?"Copied":"Moved")},_legalMouseDown:function(a){if("touchstart"!=a.type&&!e.isLeft(a))return!1;if(!this.withHandles)return!0;for(a=a.target;a&&a!==this.node;a=a.parentNode){if(f.contains(a,"dojoDndHandle"))return!0;
if(f.contains(a,"dojoDndItem")||f.contains(a,"dojoDndIgnore"))break}return!1}});return t})},"dojo/dnd/Selector":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../dom ../dom-construct ../mouse ../_base/NodeList ../on ../touch ./common ./Container".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n){var t=g("dojo.dnd.Selector",n,{constructor:function(a,c){c||(c={});this.singular=c.singular;this.autoSync=c.autoSync;this.selection={};this.anchor=null;this.simpleSelection=!1;
this.events.push(d(this.node,b.press,h.hitch(this,"onMouseDown")),d(this.node,b.release,h.hitch(this,"onMouseUp")))},singular:!1,getSelectedNodes:function(){var a=new q,b=r._empty,d;for(d in this.selection)d in b||a.push(f.byId(d));return a},selectNone:function(){return this._removeSelection()._removeAnchor()},selectAll:function(){this.forInItems(function(a,b){this._addItemClass(f.byId(b),"Selected");this.selection[b]=1},this);return this._removeAnchor()},deleteSelectedNodes:function(){var a=r._empty,
b;for(b in this.selection)if(!(b in a)){var d=f.byId(b);this.delItem(b);m.destroy(d)}this.anchor=null;this.selection={};return this},forInSelectedItems:function(a,b){b=b||k.global;var d=this.selection,e=r._empty,f;for(f in d)f in e||a.call(b,this.getItem(f),f,this)},sync:function(){t.superclass.sync.call(this);this.anchor&&!this.getItem(this.anchor.id)&&(this.anchor=null);var a=[],b=r._empty,d;for(d in this.selection)d in b||this.getItem(d)||a.push(d);p.forEach(a,function(a){delete this.selection[a]},
this);return this},insertNodes:function(a,b,d,e){var f=this._normalizedCreator;this._normalizedCreator=function(b,c){var d=f.call(this,b,c);a?(this.anchor?this.anchor!=d.node&&(this._removeItemClass(d.node,"Anchor"),this._addItemClass(d.node,"Selected")):(this.anchor=d.node,this._removeItemClass(d.node,"Selected"),this._addItemClass(this.anchor,"Anchor")),this.selection[d.node.id]=1):(this._removeItemClass(d.node,"Selected"),this._removeItemClass(d.node,"Anchor"));return d};t.superclass.insertNodes.call(this,
b,d,e);this._normalizedCreator=f;return this},destroy:function(){t.superclass.destroy.call(this);this.selection=this.anchor=null},onMouseDown:function(a){this.autoSync&&this.sync();if(this.current)if(!this.singular&&!r.getCopyKeyState(a)&&!a.shiftKey&&this.current.id in this.selection)this.simpleSelection=!0,e.isLeft(a)&&(a.stopPropagation(),a.preventDefault());else{if(!this.singular&&a.shiftKey){r.getCopyKeyState(a)||this._removeSelection();var b=this.getAllNodes();if(b.length&&(this.anchor||(this.anchor=
b[0],this._addItemClass(this.anchor,"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var d=0,f;d<b.length&&!(f=b[d],f==this.anchor||f==this.current);++d);for(++d;d<b.length;++d){f=b[d];if(f==this.anchor||f==this.current)break;this._addItemClass(f,"Selected");this.selection[f.id]=1}this._addItemClass(this.current,"Selected");this.selection[this.current.id]=1}}else this.singular?this.anchor==this.current?r.getCopyKeyState(a)&&this.selectNone():(this.selectNone(),this.anchor=
this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1):r.getCopyKeyState(a)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=
1):this.current.id in this.selection||(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);a.stopPropagation();a.preventDefault()}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=d(this.node,
b.move,h.hitch(this,"onMouseMove"))},onOutEvent:function(){this.onmousemoveEvent&&(this.onmousemoveEvent.remove(),delete this.onmousemoveEvent)},_removeSelection:function(){var a=r._empty,b;for(b in this.selection)if(!(b in a)){var d=f.byId(b);d&&this._removeItemClass(d,"Selected")}this.selection={};return this},_removeAnchor:function(){this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this.anchor=null);return this}});return t})},"dojo/dnd/Container":function(){define("../_base/array ../_base/declare ../_base/kernel ../_base/lang ../_base/window ../dom ../dom-class ../dom-construct ../Evented ../has ../on ../query ../touch ./common".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r,n,t,a){g=g("dojo.dnd.Container",d,{skipForm:!1,allowNested:!1,constructor:function(a,b){this.node=m.byId(a);b||(b={});this.creator=b.creator||null;this.skipForm=b.skipForm;this.parent=b.dropParent&&m.byId(b.dropParent);this.map={};this.current=null;this.containerState="";e.add(this.node,"dojoDndContainer");(!b||!b._skipStartup)&&this.startup();this.events=[r(this.node,t.over,h.hitch(this,"onMouseOver")),r(this.node,t.out,h.hitch(this,"onMouseOut")),r(this.node,"dragstart",
h.hitch(this,"onSelectStart")),r(this.node,"selectstart",h.hitch(this,"onSelectStart"))]},creator:function(){},getItem:function(a){return this.map[a]},setItem:function(a,b){this.map[a]=b},delItem:function(a){delete this.map[a]},forInItems:function(b,d){d=d||k.global;var e=this.map,f=a._empty,g;for(g in e)g in f||b.call(d,e[g],g,this);return d},clearItems:function(){this.map={}},getAllNodes:function(){return n((this.allowNested?"":"\x3e ")+".dojoDndItem",this.parent)},sync:function(){var b={};this.getAllNodes().forEach(function(d){if(d.id){var e=
this.getItem(d.id);if(e){b[d.id]=e;return}}else d.id=a.getUniqueId();var e=d.getAttribute("dndType"),f=d.getAttribute("dndData");b[d.id]={data:f||d.innerHTML,type:e?e.split(/\s*,\s*/):["text"]}},this);this.map=b;return this},insertNodes:function(a,b,d){this.parent.firstChild?b?d||(d=this.parent.firstChild):d&&(d=d.nextSibling):d=null;var e;if(d)for(b=0;b<a.length;++b)e=this._normalizedCreator(a[b]),this.setItem(e.node.id,{data:e.data,type:e.type}),d.parentNode.insertBefore(e.node,d);else for(b=0;b<
a.length;++b)e=this._normalizedCreator(a[b]),this.setItem(e.node.id,{data:e.data,type:e.type}),this.parent.appendChild(e.node);return this},destroy:function(){p.forEach(this.events,function(a){a.remove()});this.clearItems();this.node=this.parent=this.current=null},markupFactory:function(a,b,d){a._skipStartup=!0;return new d(b,a)},startup:function(){if(!this.parent&&(this.parent=this.node,"table"==this.parent.tagName.toLowerCase())){var b=this.parent.getElementsByTagName("tbody");b&&b.length&&(this.parent=
b[0])}this.defaultCreator=a._defaultCreator(this.parent);this.sync()},onMouseOver:function(a){for(var b=a.relatedTarget;b&&b!=this.node;)try{b=b.parentNode}catch(d){b=null}b||(this._changeState("Container","Over"),this.onOverEvent());b=this._getChildByEvent(a);this.current!=b&&(this.current&&this._removeItemClass(this.current,"Over"),b&&this._addItemClass(b,"Over"),this.current=b)},onMouseOut:function(a){for(a=a.relatedTarget;a;){if(a==this.node)return;try{a=a.parentNode}catch(b){a=null}}this.current&&
(this._removeItemClass(this.current,"Over"),this.current=null);this._changeState("Container","");this.onOutEvent()},onSelectStart:function(b){if(!this.skipForm||!a.isFormElement(b))b.stopPropagation(),b.preventDefault()},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(a,b){var d="dojoDnd"+a,f=a.toLowerCase()+"State";e.replace(this.node,d+b,d+this[f]);this[f]=b},_addItemClass:function(a,b){e.add(a,"dojoDndItem"+b)},_removeItemClass:function(a,b){e.remove(a,"dojoDndItem"+b)},
_getChildByEvent:function(a){if(a=a.target)for(var b=a.parentNode;b;a=b,b=a.parentNode)if((b==this.parent||this.allowNested)&&e.contains(a,"dojoDndItem"))return a;return null},_normalizedCreator:function(b,d){var f=(this.creator||this.defaultCreator).call(this,b,d);h.isArray(f.type)||(f.type=["text"]);f.node.id||(f.node.id=a.getUniqueId());e.add(f.node,"dojoDndItem");return f}});a._createNode=function(b){return!b?a._createSpan:function(a){return q.create(b,{innerHTML:a})}};a._createTrTd=function(a){var b=
q.create("tr");q.create("td",{innerHTML:a},b);return b};a._createSpan=function(a){return q.create("span",{innerHTML:a})};a._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"};a._defaultCreator=function(b){b=b.tagName.toLowerCase();var d="tbody"==b||"thead"==b?a._createTrTd:a._createNode(a._defaultCreatorNodes[b]);return function(b,c){var e=b&&h.isObject(b),f,g;e&&b.tagName&&b.nodeType&&b.getAttribute?(f=b.getAttribute("dndData")||b.innerHTML,e=(e=b.getAttribute("dndType"))?e.split(/\s*,\s*/):
["text"],g=b):(f=e&&b.data?b.data:b,e=e&&b.type?b.type:["text"],g=("avatar"==c?a._createSpan:d)(String(f)));g.id||(g.id=a.getUniqueId());return{node:g,data:f,type:e}}};return g})},"dojo/dnd/Manager":function(){define("../_base/array ../_base/declare ../_base/lang ../_base/window ../dom-class ../Evented ../has ../keys ../on ../topic ../touch ./common ./autoscroll ./Avatar".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n,t,a){var c=g("dojo.dnd.Manager",[m],{constructor:function(){this.source=this.avatar=
null;this.nodes=[];this.copy=!0;this.target=null;this.canDropFlag=!1;this.events=[]},OFFSET_X:e("touch")?0:16,OFFSET_Y:e("touch")?-64:16,overSource:function(a){this.avatar&&(this.target=a&&"Disabled"!=a.targetState?a:null,this.canDropFlag=Boolean(this.target),this.avatar.update());b.publish("/dnd/source/over",a)},outSource:function(a){this.avatar?this.target==a&&(this.target=null,this.canDropFlag=!1,this.avatar.update(),b.publish("/dnd/source/over",null)):b.publish("/dnd/source/over",null)},startDrag:function(a,
c,e){function g(a){a.preventDefault();a.stopPropagation()}t.autoScrollStart(h.doc);this.source=a;this.nodes=c;this.copy=Boolean(e);this.avatar=this.makeAvatar();h.body().appendChild(this.avatar.node);b.publish("/dnd/start",a,c,this.copy);this.events=[d(h.doc,r.move,k.hitch(this,"onMouseMove")),d(h.doc,r.release,k.hitch(this,"onMouseUp")),d(h.doc,"keydown",k.hitch(this,"onKeyDown")),d(h.doc,"keyup",k.hitch(this,"onKeyUp")),d(h.doc,"dragstart",g),d(h.body(),"selectstart",g)];f.add(h.body(),"dojoDnd"+
(e?"Copy":"Move"))},canDrop:function(a){a=Boolean(this.target&&a);this.canDropFlag!=a&&(this.canDropFlag=a,this.avatar.update())},stopDrag:function(){f.remove(h.body(),["dojoDndCopy","dojoDndMove"]);p.forEach(this.events,function(a){a.remove()});this.events=[];this.avatar.destroy();this.source=this.target=this.avatar=null;this.nodes=[]},makeAvatar:function(){return new a(this)},updateAvatar:function(){this.avatar.update()},onMouseMove:function(a){var b=this.avatar;b&&(t.autoScrollNodes(a),b=b.node.style,
b.left=a.pageX+this.OFFSET_X+"px",b.top=a.pageY+this.OFFSET_Y+"px",b=Boolean(this.source.copyState(n.getCopyKeyState(a))),this.copy!=b&&this._setCopyStatus(b));e("touch")&&a.preventDefault()},onMouseUp:function(a){if(this.avatar){if(this.target&&this.canDropFlag){var c=Boolean(this.source.copyState(n.getCopyKeyState(a)));b.publish("/dnd/drop/before",this.source,this.nodes,c,this.target,a);b.publish("/dnd/drop",this.source,this.nodes,c,this.target,a)}else b.publish("/dnd/cancel");this.stopDrag()}},
onKeyDown:function(a){if(this.avatar)switch(a.keyCode){case q.CTRL:a=Boolean(this.source.copyState(!0));this.copy!=a&&this._setCopyStatus(a);break;case q.ESCAPE:b.publish("/dnd/cancel"),this.stopDrag()}},onKeyUp:function(a){this.avatar&&a.keyCode==q.CTRL&&(a=Boolean(this.source.copyState(!1)),this.copy!=a&&this._setCopyStatus(a))},_setCopyStatus:function(a){this.copy=a;this.source._markDndStatus(this.copy);this.updateAvatar();f.replace(h.body(),"dojoDnd"+(this.copy?"Copy":"Move"),"dojoDnd"+(this.copy?
"Move":"Copy"))}});n._manager=null;c.manager=n.manager=function(){n._manager||(n._manager=new c);return n._manager};return c})},"dojo/dnd/Avatar":function(){define("../_base/declare ../_base/window ../dom ../dom-attr ../dom-class ../dom-construct ../hccss ../query".split(" "),function(p,g,k,h,f,m,e,q){return p("dojo.dnd.Avatar",null,{constructor:function(d){this.manager=d;this.construct()},construct:function(){var d=m.create("table",{"class":"dojoDndAvatar",style:{position:"absolute",zIndex:"1999",
margin:"0px"}}),b=this.manager.source,f,g=m.create("tbody",null,d),k=m.create("tr",null,g),a=m.create("td",null,k),c=Math.min(5,this.manager.nodes.length),p=0;e("highcontrast")&&m.create("span",{id:"a11yIcon",innerHTML:this.manager.copy?"+":"\x3c"},a);m.create("span",{innerHTML:b.generateText?this._generateText():""},a);for(h.set(k,{"class":"dojoDndAvatarHeader",style:{opacity:0.9}});p<c;++p)b.creator?f=b._normalizedCreator(b.getItem(this.manager.nodes[p].id).data,"avatar").node:(f=this.manager.nodes[p].cloneNode(!0),
"tr"==f.tagName.toLowerCase()&&(k=m.create("table"),m.create("tbody",null,k).appendChild(f),f=k)),f.id="",k=m.create("tr",null,g),a=m.create("td",null,k),a.appendChild(f),h.set(k,{"class":"dojoDndAvatarItem",style:{opacity:(9-p)/10}});this.node=d},destroy:function(){m.destroy(this.node);this.node=!1},update:function(){f.toggle(this.node,"dojoDndAvatarCanDrop",this.manager.canDropFlag);if(e("highcontrast")){var d=k.byId("a11yIcon"),b="+";this.manager.canDropFlag&&!this.manager.copy?b="\x3c ":!this.manager.canDropFlag&&
!this.manager.copy?b="o":this.manager.canDropFlag||(b="x");d.innerHTML=b}q("tr.dojoDndAvatarHeader td span"+(e("highcontrast")?" span":""),this.node).forEach(function(b){b.innerHTML=this.manager.source.generateText?this._generateText():""},this)},_generateText:function(){return this.manager.nodes.length.toString()}})})},"dijit/CheckedMenuItem":function(){define(["dojo/_base/declare","dojo/dom-class","./MenuItem","dojo/text!./templates/CheckedMenuItem.html","./hccss"],function(p,g,k,h){return p("dijit.CheckedMenuItem",
k,{baseClass:"dijitMenuItem dijitCheckedMenuItem",templateString:h,checked:!1,_setCheckedAttr:function(f){this.domNode.setAttribute("aria-checked",f?"true":"false");this._set("checked",f)},iconClass:"",role:"menuitemcheckbox",checkedChar:"\x26#10003;",onChange:function(){},_onClick:function(f){this.disabled||(this.set("checked",!this.checked),this.onChange(this.checked));this.onClick(f)}})})},"dojo/_base/query":function(){define(["../query","./NodeList"],function(p){return p})},"dijit/form/CheckBox":function(){define("require dojo/_base/declare dojo/dom-attr dojo/has dojo/query dojo/ready ./ToggleButton ./_CheckBoxMixin dojo/text!./templates/CheckBox.html dojo/NodeList-dom ../a11yclick".split(" "),
function(p,g,k,h,f,m,e,q,d){h("dijit-legacy-requires")&&m(0,function(){p(["dijit/form/RadioButton"])});return g("dijit.form.CheckBox",[e,q],{templateString:d,baseClass:"dijitCheckBox",_setValueAttr:function(b,d){"string"==typeof b&&(this.inherited(arguments),b=!0);this._created&&this.set("checked",b,d)},_getValueAttr:function(){return this.checked&&this._get("value")},_setIconClassAttr:null,_setNameAttr:"focusNode",postMixInProperties:function(){this.inherited(arguments);this.checkedAttrSetting=""},
_fillContent:function(){},_onFocus:function(){this.id&&f("label[for\x3d'"+this.id+"']").addClass("dijitFocusedLabel");this.inherited(arguments)},_onBlur:function(){this.id&&f("label[for\x3d'"+this.id+"']").removeClass("dijitFocusedLabel");this.inherited(arguments)}})})},"dijit/form/_CheckBoxMixin":function(){define(["dojo/_base/declare","dojo/dom-attr"],function(p,g){return p("dijit.form._CheckBoxMixin",null,{type:"checkbox",value:"on",readOnly:!1,_aria_attr:"aria-checked",_setReadOnlyAttr:function(k){this._set("readOnly",
k);g.set(this.focusNode,"readOnly",k)},_setLabelAttr:void 0,_getSubmitValue:function(g){return null==g||""===g?"on":g},_setValueAttr:function(k){k=this._getSubmitValue(k);this._set("value",k);g.set(this.focusNode,"value",k)},reset:function(){this.inherited(arguments);this._set("value",this._getSubmitValue(this.params.value));g.set(this.focusNode,"value",this.value)},_onClick:function(g){return this.readOnly?(g.stopPropagation(),g.preventDefault(),!1):this.inherited(arguments)}})})},"dijit/form/ComboBox":function(){define(["dojo/_base/declare",
"./ValidationTextBox","./ComboBoxMixin"],function(p,g,k){return p("dijit.form.ComboBox",[g,k],{})})},"dijit/form/ComboBoxMixin":function(){define("dojo/_base/declare dojo/Deferred dojo/_base/kernel dojo/_base/lang dojo/store/util/QueryResults ./_AutoCompleterMixin ./_ComboBoxMenu ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(p,g,k,h,f,m,e,q,d){return p("dijit.form.ComboBoxMixin",[q,m],{dropDownClass:e,hasDownArrow:!0,templateString:d,baseClass:"dijitTextBox dijitComboBox",
cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_setHasDownArrowAttr:function(b){this._set("hasDownArrow",b);this._buttonNode.style.display=b?"":"none"},_showResultList:function(){this.displayMessage("");this.inherited(arguments)},_setStoreAttr:function(b){b.get||h.mixin(b,{_oldAPI:!0,get:function(b){var d=new g;this.fetchItemByIdentity({identity:b,onItem:function(b){d.resolve(b)},onError:function(b){d.reject(b)}});return d.promise},query:function(b,d){var e=new g(function(){a.abort&&a.abort()});
e.total=new g;var a=this.fetch(h.mixin({query:b,onBegin:function(a){e.total.resolve(a)},onComplete:function(a){e.resolve(a)},onError:function(a){e.reject(a)}},d));return f(e)}});this._set("store",b)},postMixInProperties:function(){var b=this.params.store||this.store;b&&this._setStoreAttr(b);this.inherited(arguments);if(!this.params.store&&this.store&&!this.store._oldAPI){var d=this.declaredClass;h.mixin(this.store,{getValue:function(b,e){k.deprecated(d+".store.getValue(item, attr) is deprecated for builtin store.  Use item.attr directly",
"","2.0");return b[e]},getLabel:function(b){k.deprecated(d+".store.getLabel(item) is deprecated for builtin store.  Use item.label directly","","2.0");return b.name},fetch:function(b){k.deprecated(d+".store.fetch() is deprecated for builtin store.","Use store.query()","2.0");require(["dojo/data/ObjectStore"],h.hitch(this,function(d){(new d({objectStore:this})).fetch(b)}))}})}}})})},"dijit/form/_AutoCompleterMixin":function(){define("dojo/aspect dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/query dojo/regexp dojo/sniff ./DataList ./_TextBoxMixin ./_SearchMixin".split(" "),
function(p,g,k,h,f,m,e,q,d,b,r){g=g("dijit.form._AutoCompleterMixin",r,{item:null,autoComplete:!0,highlightMatch:"first",labelAttr:"",labelType:"text",maxHeight:-1,_stopClickEvents:!1,_getCaretPos:function(b){var d=0;if("number"==typeof b.selectionStart)d=b.selectionStart;else if(q("ie")){var a=b.ownerDocument.selection.createRange().duplicate();b=b.createTextRange();a.move("character",0);b.move("character",0);try{b.setEndPoint("EndToEnd",a),d=String(b.text).replace(/\r/g,"").length}catch(c){}}return d},
_setCaretPos:function(d,e){e=parseInt(e);b.selectInputText(d,e,e)},_setDisabledAttr:function(b){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",b?"true":"false")},_onKey:function(b){if(!(32<=b.charCode)){var d=b.charCode||b.keyCode;if(!(d==h.ALT||d==h.CTRL||d==h.META||d==h.SHIFT)){var a=this.dropDown,c=null;this._abortQuery();this.inherited(arguments);if(!b.altKey&&!b.ctrlKey&&!b.metaKey)switch(this._opened&&(c=a.getHighlightedOption()),d){case h.PAGE_DOWN:case h.DOWN_ARROW:case h.PAGE_UP:case h.UP_ARROW:this._opened&&
this._announceOption(c);b.stopPropagation();b.preventDefault();break;case h.ENTER:if(c){if(c==a.nextButton){this._nextSearch(1);b.stopPropagation();b.preventDefault();break}else if(c==a.previousButton){this._nextSearch(-1);b.stopPropagation();b.preventDefault();break}b.stopPropagation();b.preventDefault()}else this._setBlurValue(),this._setCaretPos(this.focusNode,this.focusNode.value.length);case h.TAB:d=this.get("displayedValue");if(a&&(d==a._messages.previousMessage||d==a._messages.nextMessage))break;
c&&this._selectOption(c);case h.ESCAPE:this._opened&&(this._lastQuery=null,this.closeDropDown())}}}},_autoCompleteText:function(d){var e=this.focusNode;b.selectInputText(e,e.value.length);var a=this.ignoreCase?"toLowerCase":"substr";0==d[a](0).indexOf(this.focusNode.value[a](0))?(a=this.autoComplete?this._getCaretPos(e):e.value.length,a+1>e.value.length&&(e.value=d,b.selectInputText(e,a))):(e.value=d,b.selectInputText(e))},_openResultList:function(b,d,a){var c=this.dropDown.getHighlightedOption();
this.dropDown.clearResultList();!b.length&&0==a.start?this.closeDropDown():(this._nextSearch=this.dropDown.onPage=f.hitch(this,function(a){b.nextPage(-1!==a);this.focus()}),this.dropDown.createOptions(b,a,f.hitch(this,"_getMenuLabelFromItem")),this._showResultList(),"direction"in a?(a.direction?this.dropDown.highlightFirstOption():a.direction||this.dropDown.highlightLastOption(),c&&this._announceOption(this.dropDown.getHighlightedOption())):this.autoComplete&&(!this._prev_key_backspace&&!/^[*]+$/.test(d[this.searchAttr].toString()))&&
this._announceOption(this.dropDown.containerNode.firstChild.nextSibling))},_showResultList:function(){this.closeDropDown(!0);this.openDropDown();this.domNode.setAttribute("aria-expanded","true")},loadDropDown:function(){this._startSearchAll()},isLoaded:function(){return!1},closeDropDown:function(){this._abortQuery();this._opened&&(this.inherited(arguments),this.domNode.setAttribute("aria-expanded","false"))},_setBlurValue:function(){var b=this.get("displayedValue"),d=this.dropDown;d&&(b==d._messages.previousMessage||
b==d._messages.nextMessage)?this._setValueAttr(this._lastValueReported,!0):"undefined"==typeof this.item?(this.item=null,this.set("displayedValue",b)):(this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0),this._refreshState());this.focusNode.removeAttribute("aria-activedescendant")},_setItemAttr:function(b,d,a){var c="";b&&(a||(a=this.store._oldAPI?this.store.getValue(b,this.searchAttr):b[this.searchAttr]),c=this._getValueField()!=this.searchAttr?this.store.getIdentity(b):a);this.set("value",
c,d,a,b)},_announceOption:function(b){if(b){var d;if(b==this.dropDown.nextButton||b==this.dropDown.previousButton)d=b.innerHTML,this.item=void 0,this.value="";else{var a=this.dropDown.items[b.getAttribute("item")];d=(this.store._oldAPI?this.store.getValue(a,this.searchAttr):a[this.searchAttr]).toString();this.set("item",a,!1,d)}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",k.get(b,"id"));this._autoCompleteText(d)}},
_selectOption:function(b){this.closeDropDown();b&&this._announceOption(b);this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,!0);this.focusNode.removeAttribute("aria-activedescendant")},_startSearchAll:function(){this._startSearch("")},_startSearchFromInput:function(){this.item=void 0;this.inherited(arguments)},_startSearch:function(b){if(!this.dropDown){var d=this.id+"_popup";this.dropDown=new (f.isString(this.dropDownClass)?f.getObject(this.dropDownClass,
!1):this.dropDownClass)({onChange:f.hitch(this,this._selectOption),id:d,dir:this.dir,textDir:this.textDir})}this._lastInput=b;this.inherited(arguments)},_getValueField:function(){return this.searchAttr},postMixInProperties:function(){this.inherited(arguments);if(!this.store&&this.srcNodeRef&&(this.store=new d({},this.srcNodeRef),!("value"in this.params))){var b=this.item=this.store.fetchSelectedItem();if(b){var e=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(b,e):b[e]}}},
postCreate:function(){var b=m('label[for\x3d"'+this.id+'"]');b.length&&(b[0].id||(b[0].id=this.id+"_label"),this.domNode.setAttribute("aria-labelledby",b[0].id));this.inherited(arguments);p.after(this,"onSearch",f.hitch(this,"_openResultList"),!0)},_getMenuLabelFromItem:function(b){b=this.labelFunc(b,this.store);var d=this.labelType;"none"!=this.highlightMatch&&("text"==this.labelType&&this._lastInput)&&(b=this.doHighlight(b,this._lastInput),d="html");return{html:"html"==d,label:b}},doHighlight:function(b,
d){var a=(this.ignoreCase?"i":"")+("all"==this.highlightMatch?"g":""),c=this.queryExpr.indexOf("${0}");d=e.escapeString(d);return this._escapeHtml(b.replace(RegExp((0==c?"^":"")+"("+d+")"+(c==this.queryExpr.length-4?"$":""),a),"\uffff$1\uffff")).replace(/\uFFFF([^\uFFFF]+)\uFFFF/g,'\x3cspan class\x3d"dijitComboBoxHighlightMatch"\x3e$1\x3c/span\x3e')},_escapeHtml:function(b){return b=String(b).replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;")},reset:function(){this.item=
null;this.inherited(arguments)},labelFunc:function(b,d){return(d._oldAPI?d.getValue(b,this.labelAttr||this.searchAttr):b[this.labelAttr||this.searchAttr]).toString()},_setValueAttr:function(b,d,a,c){this._set("item",c||null);null==b&&(b="");this.inherited(arguments)}});q("dojo-bidi")&&g.extend({_setTextDirAttr:function(b){this.inherited(arguments);this.dropDown&&this.dropDown._set("textDir",b)}});return g})},"dijit/form/DataList":function(){define("dojo/_base/declare dojo/dom dojo/_base/lang dojo/query dojo/store/Memory ../registry".split(" "),
function(p,g,k,h,f,m){function e(e){return{id:e.value,value:e.value,name:k.trim(e.innerText||e.textContent||"")}}return p("dijit.form.DataList",f,{constructor:function(f,d){this.domNode=g.byId(d);k.mixin(this,f);this.id&&m.add(this);this.domNode.style.display="none";this.inherited(arguments,[{data:h("option",this.domNode).map(e)}])},destroy:function(){m.remove(this.id)},fetchSelectedItem:function(){var f=h("\x3e option[selected]",this.domNode)[0]||h("\x3e option",this.domNode)[0];return f&&e(f)}})})},
"dijit/form/_SearchMixin":function(){define("dojo/_base/declare dojo/keys dojo/_base/lang dojo/query dojo/string dojo/when ../registry".split(" "),function(p,g,k,h,f,m,e){return p("dijit.form._SearchMixin",null,{pageSize:Infinity,store:null,fetchProperties:{},query:{},list:"",_setListAttr:function(e){this._set("list",e)},searchDelay:200,searchAttr:"name",queryExpr:"${0}*",ignoreCase:!0,_patternToRegExp:function(e){return RegExp("^"+e.replace(/(\\.)|(\*)|(\?)|\W/g,function(d,b,e,f){return e?".*":f?
".":b?b:"\\"+d})+"$",this.ignoreCase?"mi":"m")},_abortQuery:function(){this.searchTimer&&(this.searchTimer=this.searchTimer.remove());this._queryDeferHandle&&(this._queryDeferHandle=this._queryDeferHandle.remove());this._fetchHandle&&(this._fetchHandle.abort&&(this._cancelingQuery=!0,this._fetchHandle.abort(),this._cancelingQuery=!1),this._fetchHandle.cancel&&(this._cancelingQuery=!0,this._fetchHandle.cancel(),this._cancelingQuery=!1),this._fetchHandle=null)},_processInput:function(e){if(!this.disabled&&
!this.readOnly){var d=e.charOrCode;if(!("type"in e&&"key"==e.type.substring(0,3)&&(e.altKey||(e.ctrlKey||e.metaKey)&&"x"!=d&&"v"!=d||d==g.SHIFT))){this._prev_key_backspace=e=!1;switch(d){case g.DELETE:case g.BACKSPACE:e=this._maskValidSubsetError=this._prev_key_backspace=!0;break;default:e="string"==typeof d||229==d}if(e)if(this.store)this.searchTimer=this.defer("_startSearchFromInput",1);else this.onSearch()}}},onSearch:function(){},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},
_startSearch:function(e){this._abortQuery();var d=this,b=k.clone(this.query),g={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:!0}},h=f.substitute(this.queryExpr,[e.replace(/([\\\*\?])/g,"\\$1")]),p,a=function(){var c=d._fetchHandle=d.store.query(b,g);!d.disabled&&!(d.readOnly||p!==d._lastQuery)&&m(c,function(e){d._fetchHandle=null;!d.disabled&&(!d.readOnly&&p===d._lastQuery)&&m(c.total,function(c){e.total=c;var f=d.pageSize;if(isNaN(f)||f>e.total)f=e.total;e.nextPage=function(c){g.direction=
c=!1!==c;g.count=f;c?(g.start+=e.length,g.start>=e.total&&(g.count=0)):(g.start-=f,0>g.start&&(g.count=Math.max(f+g.start,0),g.start=0));0>=g.count?(e.length=0,d.onSearch(e,b,g)):a()};d.onSearch(e,b,g)})},function(a){d._fetchHandle=null;d._cancelingQuery||console.error(d.declaredClass+" "+a.toString())})};k.mixin(g,this.fetchProperties);this.store._oldAPI?p=h:(p=this._patternToRegExp(h),p.toString=function(){return h});this._lastQuery=b[this.searchAttr]=p;this._queryDeferHandle=this.defer(a,this.searchDelay)},
constructor:function(){this.query={};this.fetchProperties={}},postMixInProperties:function(){if(!this.store){var f=this.list;f&&(this.store=e.byId(f))}this.inherited(arguments)}})})},"dijit/form/_ComboBoxMenu":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-style dojo/keys ../_WidgetBase ../_TemplatedMixin ./_ComboBoxMenuMixin ./_ListMouseMixin".split(" "),function(p,g,k,h,f,m,e,q){return p("dijit.form._ComboBoxMenu",[f,m,q,e],{templateString:"\x3cdiv class\x3d'dijitReset dijitMenu' data-dojo-attach-point\x3d'containerNode' style\x3d'overflow: auto; overflow-x: hidden;' role\x3d'listbox'\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point\x3d'previousButton' role\x3d'option'\x3e\x3c/div\x3e\x3cdiv class\x3d'dijitMenuItem dijitMenuNextButton' data-dojo-attach-point\x3d'nextButton' role\x3d'option'\x3e\x3c/div\x3e\x3c/div\x3e",
baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);this.isLeftToRight()||(g.add(this.previousButton,"dijitMenuItemRtl"),g.add(this.nextButton,"dijitMenuItemRtl"));this.containerNode.setAttribute("role","listbox")},_createMenuItem:function(){var d=this.ownerDocument.createElement("div");d.className="dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl");d.setAttribute("role","option");return d},onHover:function(d){g.add(d,"dijitMenuItemHover")},onUnhover:function(d){g.remove(d,
"dijitMenuItemHover")},onSelect:function(d){g.add(d,"dijitMenuItemSelected")},onDeselect:function(d){g.remove(d,"dijitMenuItemSelected")},_page:function(d){var b=0,e=this.domNode.scrollTop,f=k.get(this.domNode,"height");for(this.getHighlightedOption()||this.selectNextNode();b<f;){var g=this.getHighlightedOption();if(d){if(!g.previousSibling||"none"==g.previousSibling.style.display)break;this.selectPreviousNode()}else{if(!g.nextSibling||"none"==g.nextSibling.style.display)break;this.selectNextNode()}g=
this.domNode.scrollTop;b+=(g-e)*(d?-1:1);e=g}},handleKey:function(d){switch(d.keyCode){case h.DOWN_ARROW:return this.selectNextNode(),!1;case h.PAGE_DOWN:return this._page(!1),!1;case h.UP_ARROW:return this.selectPreviousNode(),!1;case h.PAGE_UP:return this._page(!0),!1;default:return!0}}})})},"dijit/form/_ComboBoxMenuMixin":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-attr dojo/has dojo/i18n dojo/i18n!./nls/ComboBox".split(" "),function(p,g,k,h,f){var m=g("dijit.form._ComboBoxMenuMixin"+
(h("dojo-bidi")?"_NoBidi":""),null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=f.getLocalization("dijit.form","ComboBox",this.lang)},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages.previousMessage;this.nextButton.innerHTML=this._messages.nextMessage},_setValueAttr:function(e){this._set("value",e);this.onChange(e)},onClick:function(e){if(e==this.previousButton)this._setSelectedAttr(null),this.onPage(-1);else if(e==
this.nextButton)this._setSelectedAttr(null),this.onPage(1);else this.onChange(e)},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null)},_createOption:function(e,f){var d=this._createMenuItem(),b=f(e);b.html?d.innerHTML=b.label:d.appendChild(d.ownerDocument.createTextNode(b.label));""==d.innerHTML&&(d.innerHTML="\x26#160;");return d},createOptions:function(e,f,d){this.items=e;this.previousButton.style.display=0==f.start?"none":"";k.set(this.previousButton,"id",this.id+
"_prev");p.forEach(e,function(b,e){var f=this._createOption(b,d);f.setAttribute("item",e);k.set(f,"id",this.id+e);this.nextButton.parentNode.insertBefore(f,this.nextButton)},this);var b=!1;e.total&&!e.total.then&&-1!=e.total?f.start+f.count<e.total?b=!0:f.start+f.count>e.total&&f.count==e.length&&(b=!0):f.count==e.length&&(b=!0);this.nextButton.style.display=b?"":"none";k.set(this.nextButton,"id",this.id+"_next")},clearResultList:function(){for(var e=this.containerNode;2<e.childNodes.length;)e.removeChild(e.childNodes[e.childNodes.length-
2]);this._setSelectedAttr(null)},highlightFirstOption:function(){this.selectFirstNode()},highlightLastOption:function(){this.selectLastNode()},selectFirstNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.previousButton&&this.selectNextNode()},selectLastNode:function(){this.inherited(arguments);this.getHighlightedOption()==this.nextButton&&this.selectPreviousNode()},getHighlightedOption:function(){return this.selected}});h("dojo-bidi")&&(m=g("dijit.form._ComboBoxMenuMixin",
m,{_createOption:function(){var e=this.inherited(arguments);this.applyTextDir(e);return e}}));return m})},"dijit/form/_ListMouseMixin":function(){define(["dojo/_base/declare","dojo/on","dojo/touch","./_ListBase"],function(p,g,k,h){return p("dijit.form._ListMouseMixin",h,{postCreate:function(){this.inherited(arguments);this.domNode.dojoClick=!0;this._listConnect("click","_onClick");this._listConnect("mousedown","_onMouseDown");this._listConnect("mouseup","_onMouseUp");this._listConnect("mouseover",
"_onMouseOver");this._listConnect("mouseout","_onMouseOut")},_onClick:function(f,g){this._setSelectedAttr(g,!1);this._deferredClick&&this._deferredClick.remove();this._deferredClick=this.defer(function(){this._deferredClick=null;this.onClick(g)})},_onMouseDown:function(f,g){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging=!0;this._setSelectedAttr(g,!1)},_onMouseUp:function(f,g){this._isDragging=!1;var e=this.selected,h=this._hoveredNode;e&&g==e?this.defer(function(){this._onClick(f,
e)}):h&&this.defer(function(){this._onClick(f,h)})},_onMouseOut:function(f,g){this._hoveredNode&&(this.onUnhover(this._hoveredNode),this._hoveredNode=null);this._isDragging&&(this._cancelDrag=(new Date).getTime()+1E3)},_onMouseOver:function(f,g){this._cancelDrag&&((new Date).getTime()>this._cancelDrag&&(this._isDragging=!1),this._cancelDrag=null);this._hoveredNode=g;this.onHover(g);this._isDragging&&this._setSelectedAttr(g,!1)}})})},"dijit/form/_ListBase":function(){define(["dojo/_base/declare","dojo/on",
"dojo/window"],function(p,g,k){return p("dijit.form._ListBase",null,{selected:null,_listConnect:function(h,f){var k=this;return k.own(g(k.containerNode,g.selector(function(e,f,d){return e.parentNode==d},h),function(e){k[f](e,this)}))},selectFirstNode:function(){for(var g=this.containerNode.firstChild;g&&"none"==g.style.display;)g=g.nextSibling;this._setSelectedAttr(g,!0)},selectLastNode:function(){for(var g=this.containerNode.lastChild;g&&"none"==g.style.display;)g=g.previousSibling;this._setSelectedAttr(g,
!0)},selectNextNode:function(){var g=this.selected;if(g){for(g=g.nextSibling;g&&"none"==g.style.display;)g=g.nextSibling;g?this._setSelectedAttr(g,!0):this.selectFirstNode()}else this.selectFirstNode()},selectPreviousNode:function(){var g=this.selected;if(g){for(g=g.previousSibling;g&&"none"==g.style.display;)g=g.previousSibling;g?this._setSelectedAttr(g,!0):this.selectLastNode()}else this.selectLastNode()},_setSelectedAttr:function(g,f){if(this.selected!=g){var m=this.selected;if(m)this.onDeselect(m);
g&&(f&&k.scrollIntoView(g),this.onSelect(g));this._set("selected",g)}else if(g)this.onSelect(g)}})})},"url:esri/dijit/templates/InfoWindow.html":'\x3cdiv id\x3d"${id}.infowindow" class\x3d"infowindow" dojoAttachPoint\x3d"_infowindow"\n  \x3e\x3cdiv style\x3d"position:relative;"\n    \x3e\x3cdiv class\x3d"window" dojoAttachPoint\x3d"_window"\n      \x3e\x3cdiv class\x3d"top"\n        \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_topleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\n    \t\t\x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_topright"\n    \t\t\t\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\n    \t\t\t\x3e\x3cdiv class\x3d"user" dojoAttachPoint\x3d"_user"\n    \t\t\t  \x3e\x3cdiv class\x3d"titlebar" dojoAttachPoint\x3d"_titlebar"\n    \t\t\t    \x3e\x3ca class\x3d"hide" dojoAttachPoint\x3d"_hide" dojoAttachEvent\x3d"onclick:hide"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/a\n              \x3e\x3cdiv class\x3d"title" dojoAttachPoint\x3d"_title"\x3e${title}\x3c/div\n    \t\t\t  \x3e\x3c/div\n            \x3e\x3cdiv class\x3d"border" dojoAttachPoint\x3d"_border"\x3e\x3c/div\n    \t\t\t  \x3e\x3cdiv class\x3d"layout content" dojoAttachPoint\x3d"_content, containerNode"\n    \t\t\t  \x3e\x3c/div\n    \t\t\t\x3e\x3c/div\n    \t\t\x3e\x3c/div\n        \x3e\x3cdiv class\x3d"bottom"\n          \x3e\x3cdiv class\x3d"left" dojoAttachPoint\x3d"_bottomleft"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\n\t\t      \x3e\x3cdiv class\x3d"right" dojoAttachPoint\x3d"_bottomright"\x3e\x3cdiv class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\n        \x3e\x3c/div\n      \x3e\x3c/div\n    \x3e\x3c/div\n    \x3e\x3cdiv class\x3d"pointer" dojoAttachPoint\x3d"_pointer"\x3e\x3cdiv dojoAttachPoint\x3d"_sprite" class\x3d"sprite"\x3e\x3c/div\x3e\x3c/div\n  \x3e\x3c/div\n\x3e\x3c/div\x3e',
"url:jimu/dijit/templates/LoadingShelter.html":'\x3cdiv style\x3d"position:absolute;top:0;left:0;right:0;bottom:0;height:100%; width:100%; z-index:99999; background: no-repeat center center; opacity:0.6; filter:alpha(opacity\x3d60);font-size:14px;line-height:20px;z-index:510;"\x3e\n  \x3cdiv style\x3d"color:#000000;position:absolute; top:50%; left:50%; margin-left:-50px;margin-top:-20px; font-weight:bold; width:250px;height:40px;"\x3e\n      \x3cimg data-dojo-attach-point\x3d"loadingImg" style\x3d"position:absolute;width:40px;height:40px;left:0;top:0;"/\x3e\n      \x3cp data-dojo-attach-point\x3d"textNode" style\x3d"position:absolute;left:60px;top:0;display:inline-block;height:40px;line-height:40px;white-space:nowrap;margin:0 0 0 20px;"\x3e${nls.loading}...\x3c/p\x3e\n  \x3c/div\x3e\n\x3c/div\x3e',
"url:jimu/dijit/templates/SymbolChooser.html":'\x3cdiv style\x3d"width:320px;"\x3e\n\t\x3cdiv class\x3d"symbol-section point-symbol-section" data-dojo-attach-point\x3d"pointSection"\x3e\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\n\t\t\t\x3ccolgroup\x3e\n\t\t\t\t\x3ccol width\x3d130\x3e\x3c/col\x3e\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\n\t\t\t\x3c/colgroup\x3e\n\t\t\t\x3ctbody\x3e\n\t\t\t\t\x3ctr\x3e\n\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\x3cspan\x3e${nls.preview}:\x3c/span\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\x3ctr class\x3d"point-sym-class-select-tr"\x3e\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"pointSymClassSelect" data-dojo-type\x3d"dijit/form/Select"\n\t\t\t\t\t\t style\x3d"width:100%;height:30px;"\x3e\n\t\t\t\t\t\t\t \x3coption value\x3d\'0\' selected\x3d"selected"\x3e${nls.basic}\x3c/option\x3e\n\t\t\t\t\t\t\t \x3coption value\x3d\'1\'\x3eA-Z\x3c/option\x3e\n\t\t\t\t\t\t\t \x3coption value\x3d\'2\'\x3e${nls.arrows}\x3c/option\x3e\n\t\t\t\t\t\t\t \x3coption value\x3d\'3\'\x3e${nls.business}\x3c/option\x3e\n\t\t\t\t\t\t\t \x3coption value\x3d\'4\'\x3e${nls.cartographic}\x3c/option\x3e\n\t\t\t\t\t\t\t \x3coption value\x3d\'5\'\x3e${nls.nationalParkService}\x3c/option\x3e\n\t\t\t\t\t\t\t \x3coption value\x3d\'6\'\x3e${nls.outdoorRecreation}\x3c/option\x3e\n\t\t\t\t\t\t\t \x3coption value\x3d\'7\'\x3e${nls.peoplePlaces}\x3c/option\x3e\n\t\t\t\t\t\t\t \x3coption value\x3d\'8\'\x3e${nls.safetyHealth}\x3c/option\x3e\n\t\t\t\t\t\t\t \x3coption value\x3d\'9\'\x3e${nls.shapes}\x3c/option\x3e\n\t\t\t\t\t\t\t \x3coption value\x3d\'10\'\x3e${nls.transportation}\x3c/option\x3e\n\t\t\t\t\t\t\x3c/select\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\x3ctr class\x3d"point-icon-tables-tr"\x3e\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\n\t\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"pointIconTables"\x3e\n\t\t\t\t\t\t\x3c/div\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\x3ctr\x3e\n\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\x3cspan\x3e${nls.symbolSize}:\x3c/span\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"pointSize" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;"\n                        data-dojo-props\x3d\'value:18,smallDelta:1,largeDelta:10,constraints:{min:1,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointColorTr"\x3e\n\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\x3cspan\x3e${nls.color}:\x3c/span\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:[0,0,128,128]\'\x3e\x3c/div\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOpacityTr"\x3e\n\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t${nls.transparency}\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:0.5\'\x3e\x3c/div\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOutlineColorTr"\x3e\n\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\x3cspan\x3e${nls.outlineColor}:\x3c/span\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"pointOutlineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:[0,0,128,255]\'\x3e\x3c/div\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"pointOulineWidthTr"\x3e\n\t\t\t\t\t\x3ctd\x3e${nls.outlineWidth}:\x3c/td\x3e\n\t\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"pointOutlineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" \n                        data-dojo-props\x3d\'value:1,smallDelta:1,constraints:{min:0,max:5},intermediateChanges:true\'\x3e\x3c/input\x3e\n\t\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3c/tr\x3e\n\t\t\t\x3c/tbody\x3e\n\t\t\x3c/table\x3e\n\t\x3c/div\x3e\n\t\x3cdiv class\x3d"symbol-section line-symbol-section" data-dojo-attach-point\x3d"lineSection"\x3e\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd style\x3d"width:auto;height:0px;"\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.preview}:\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd colspan\x3d"2"\x3e\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd colspan\x3d"3"\x3e\n\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"lineIconTables"\x3e\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.color}\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#9bbb59"\'\x3e\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.style}\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"lineStylesSelect" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:100%;height:30px;"\x3e\n\t\t\t\t\t\t\x3coption value\x3d"solid"\x3e${nls.solid}\x3c/option\x3e\n\t\t\t\t\t\t\x3coption value\x3d"dash"\x3e${nls.dash}\x3c/option\x3e\n\t\t\t\t\t\t\x3coption value\x3d"dot"\x3e${nls.dot}\x3c/option\x3e\n\t\t\t\t\t\t\x3coption value\x3d"dashdot"\x3e${nls.dashDot}\x3c/option\x3e\n\t\t\t\t\t\t\x3coption value\x3d"longdashdotdot"\x3e${nls.dashDotDot}\x3c/option\x3e\n\t\t\t\t\t\x3c/select\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e${nls.transparency}\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"lineAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:1\'\x3e\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.width}\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"lineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" \n                        data-dojo-props\x3d\'value:3,smallDelta:1,constraints:{min:1,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\x3c/table\x3e\n\t\x3c/div\x3e\n\t\x3cdiv class\x3d"symbol-section fill-symbol-section" data-dojo-attach-point\x3d"fillSection"\x3e\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd style\x3d"width:auto;height:0px;"\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.preview}:\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd colspan\x3d"2"\x3e\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillSymPreview" style\x3d"width:100%;"\x3e\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd colspan\x3d"3"\x3e\n\t\t\t\t\t\x3cdiv class\x3d"icon-tables" data-dojo-attach-point\x3d"fillIconTables"\x3e\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.color}\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#9bbb59"\'\x3e\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t${nls.transparency}\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillAlpha" data-dojo-type\x3d"jimu/dijit/_Transparency" data-dojo-props\x3d\'alpha:0.5\'\x3e\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.outlineColor}\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fillOutlineColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#738c3d"\'\x3e\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.outlineWidth}\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"fillOutlineWidth" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" \n                        data-dojo-props\x3d\'value:2,smallDelta:1,constraints:{min:0,max:50},intermediateChanges:true\'\x3e\x3c/input\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\x3c/table\x3e\n\t\x3c/div\x3e\n\t\x3cdiv class\x3d"symbol-section text-symbol-section" data-dojo-attach-point\x3d"textSection"\x3e\n\t\t\x3ctable class\x3d"symbol-set-table" cellspacing\x3d"0"\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd style\x3d"width:130px;height:0px;"\x3e\x3c/td\x3e\n\t\t\t\t\x3ctd style\x3d"width:auto;height:0px;"\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.preview}\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd colspan\x3d"2"\x3e\n\t\t\t\t\t\x3cspan data-dojo-attach-point\x3d"textPreview"\x3e\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.text}\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"inputText" type\x3d"text" style\x3d"width:100%;" /\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.fontColor}\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"textColor" data-dojo-type\x3d"jimu/dijit/ColorPicker" style\x3d"width:100%;height:30px;" data-dojo-props\x3d\'color:"#000"\'\x3e\x3c/div\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\t\x3ctr\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cspan\x3e${nls.fontSize}\x3c/span\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"textFontSize" data-dojo-type\x3d"dijit/form/NumberSpinner" style\x3d"width:100%;" data-dojo-props\x3d\'value:20,smallDelta:1,constraints:{min:1,max:100},intermediateChanges:true\'\x3e\x3c/input\x3e\n\t\t\t\t\x3c/td\x3e\n\t\t\t\t\x3ctd\x3e\x3c/td\x3e\n\t\t\t\x3c/tr\x3e\n\t\t\x3c/table\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e',
"url:dijit/templates/Menu.html":'\x3ctable class\x3d"dijit dijitMenu dijitMenuPassive dijitReset dijitMenuTable" role\x3d"menu" tabIndex\x3d"${tabIndex}"\n\t   cellspacing\x3d"0"\x3e\n\t\x3ctbody class\x3d"dijitReset" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/tbody\x3e\n\x3c/table\x3e\n',"url:dijit/templates/MenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"menuitem" tabIndex\x3d"-1"\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\n\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,textDirNode"\n\t\trole\x3d"presentation"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\n\t\t\x3cspan data-dojo-attach-point\x3d"arrowWrapper" style\x3d"visibility: hidden"\x3e\n\t\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuExpand"\x3e\x3c/span\x3e\n\t\t\t\x3cspan class\x3d"dijitMenuExpandA11y"\x3e+\x3c/span\x3e\n\t\t\x3c/span\x3e\n\t\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:dijit/templates/MenuSeparator.html":'\x3ctr class\x3d"dijitMenuSeparator" role\x3d"separator"\x3e\n\t\x3ctd class\x3d"dijitMenuSeparatorIconCell"\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop"\x3e\x3c/div\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\n\t\x3c/td\x3e\n\t\x3ctd colspan\x3d"3" class\x3d"dijitMenuSeparatorLabelCell"\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorTop dijitMenuSeparatorLabel"\x3e\x3c/div\x3e\n\t\t\x3cdiv class\x3d"dijitMenuSeparatorBottom"\x3e\x3c/div\x3e\n\t\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:dijit/form/templates/Select.html":'\x3ctable class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tdata-dojo-attach-point\x3d"_buttonNode,tableNode,focusNode,_popupStateNode" cellspacing\x3d\'0\' cellpadding\x3d\'0\'\n\trole\x3d"listbox" aria-haspopup\x3d"true"\n\t\x3e\x3ctbody role\x3d"presentation"\x3e\x3ctr role\x3d"presentation"\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitStretch dijitButtonContents" role\x3d"presentation"\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitButtonText"  data-dojo-attach-point\x3d"containerNode,textDirNode" role\x3d"presentation"\x3e\x3c/div\n\t\t\t\x3e\x3cdiv class\x3d"dijitReset dijitValidationContainer"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t/\x3e\x3c/div\n\t\t\t\x3e\x3cinput type\x3d"hidden" ${!nameAttrSetting} data-dojo-attach-point\x3d"valueNode" value\x3d"${value}" aria-hidden\x3d"true"\n\t\t/\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer"\n\t\t\tdata-dojo-attach-point\x3d"titleNode" role\x3d"presentation"\n\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t${_buttonInputDisabled}\n\t\t/\x3e\x3c/td\n\t\x3e\x3c/tr\x3e\x3c/tbody\n\x3e\x3c/table\x3e\n',
"url:dijit/form/templates/Spinner.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tid\x3d"widget_${id}" role\x3d"presentation"\n\t\x3e\x3cdiv class\x3d"dijitReset dijitButtonNode dijitSpinnerButtonContainer"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitSpinnerButtonInner" type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitUpArrowButton"\n\t\t\tdata-dojo-attach-point\x3d"upArrowNode"\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9650; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/\x3e\x3c/div\n\t\t\x3e\x3c/div\n\t\t\x3e\x3cdiv class\x3d"dijitReset dijitLeft dijitButtonNode dijitArrowButton dijitDownArrowButton"\n\t\t\tdata-dojo-attach-point\x3d"downArrowNode"\n\t\t\t\x3e\x3cdiv class\x3d"dijitArrowButtonInner"\n\t\t\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t\t\t\t\t${_buttonInputDisabled}\n\t\t\t/\x3e\x3c/div\n\t\t\x3e\x3c/div\n\t\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' data-dojo-attach-point\x3d"textbox,focusNode" type\x3d"${type}" data-dojo-attach-event\x3d"onkeydown:_onKeyDown"\n\t\t\trole\x3d"spinbutton" autocomplete\x3d"off" ${!nameAttrSetting}\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"url:dijit/templates/ColorPalette.html":'\x3cdiv class\x3d"dijitInline dijitColorPalette" role\x3d"grid"\x3e\n\t\x3ctable data-dojo-attach-point\x3d"paletteTableNode" class\x3d"dijitPaletteTable" cellSpacing\x3d"0" cellPadding\x3d"0" role\x3d"presentation"\x3e\n\t\t\x3ctbody data-dojo-attach-point\x3d"gridNode"\x3e\x3c/tbody\x3e\n\t\x3c/table\x3e\n\x3c/div\x3e\n',"url:jimu/dijit/templates/_Transparency.html":'\x3cdiv style\x3d"min-width: 170px;"\x3e\n  \x3cdiv data-dojo-attach-point\x3d"opacitySlider" data-dojo-type\x3d"dijit/form/HorizontalSlider" showbuttons\x3d"true" value\x3d"0" minimum\x3d"0" maximum\x3d"100" discretevalues\x3d"101" intermediatechanges\x3d"true" style\x3d"width:100%;" data-dojo-attach-event\x3d"change: _onAlphaChanged"\x3e\n    \x3cdiv data-dojo-type\x3d"dijit/form/HorizontalRuleLabels" container\x3d"topDecoration" labels\x3d"${nls.opaque},${nls.transparent}" style\x3d"height: 1.5em; font-size: 0.8em; color: #666"\x3e\n    \x3c/div\x3e\n    \x3cdiv data-dojo-type\x3d"dijit/form/HorizontalRule" container\x3d"bottomDecoration" count\x3d"5" style\x3d"height: 5px;"\x3e\n    \x3c/div\x3e\n    \x3col data-dojo-type\x3d"dijit/form/HorizontalRuleLabels" container\x3d"bottomDecoration" style\x3d"height: 1em; font-size: 0.75em; color: darkblue;"\x3e\n      \x3cli\x3e0%\x3c/li\x3e\n      \x3cli\x3e50%\x3c/li\x3e\n      \x3cli\x3e100%\x3c/li\x3e\n    \x3c/ol\x3e\n  \x3c/div\x3e\n\x3c/div\x3e',
"url:dijit/form/templates/HorizontalSlider.html":'\x3ctable class\x3d"dijit dijitReset dijitSlider dijitSliderH" cellspacing\x3d"0" cellpadding\x3d"0" border\x3d"0" rules\x3d"none" data-dojo-attach-event\x3d"onkeydown:_onKeyDown, onkeyup:_onKeyUp"\n\trole\x3d"presentation"\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"topDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationT dijitSliderDecorationH"\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\x3e\x3c/tr\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderDecrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"decrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e-\x3c/span\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderLeftBumper" data-dojo-attach-event\x3d"press:_onClkDecBumper"\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cinput data-dojo-attach-point\x3d"valueNode" type\x3d"hidden" ${!nameAttrSetting}\n\t\t\t/\x3e\x3cdiv class\x3d"dijitReset dijitSliderBarContainerH" role\x3d"presentation" data-dojo-attach-point\x3d"sliderBarContainer"\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"progressBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderProgressBar dijitSliderProgressBarH" data-dojo-attach-event\x3d"press:_onBarClick"\n\t\t\t\t\t\x3e\x3cdiv class\x3d"dijitSliderMoveable dijitSliderMoveableH"\n\t\t\t\t\t\t\x3e\x3cdiv data-dojo-attach-point\x3d"sliderHandle,focusNode" class\x3d"dijitSliderImageHandle dijitSliderImageHandleH" data-dojo-attach-event\x3d"press:_onHandleClick" role\x3d"slider"\x3e\x3c/div\n\t\t\t\t\t\x3e\x3c/div\n\t\t\t\t\x3e\x3c/div\n\t\t\t\t\x3e\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"remainingBar" class\x3d"dijitSliderBar dijitSliderBarH dijitSliderRemainingBar dijitSliderRemainingBarH" data-dojo-attach-event\x3d"press:_onBarClick"\x3e\x3c/div\n\t\t\t\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderBar dijitSliderBumper dijitSliderBumperH dijitSliderRightBumper" data-dojo-attach-event\x3d"press:_onClkIncBumper"\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset dijitSliderButtonContainer dijitSliderButtonContainerH"\n\t\t\t\x3e\x3cdiv class\x3d"dijitSliderIncrementIconH" style\x3d"display:none" data-dojo-attach-point\x3d"incrementButton"\x3e\x3cspan class\x3d"dijitSliderButtonInner"\x3e+\x3c/span\x3e\x3c/div\n\t\t\x3e\x3c/td\n\t\x3e\x3c/tr\n\t\x3e\x3ctr class\x3d"dijitReset"\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\t\x3e\x3ctd data-dojo-attach-point\x3d"containerNode,bottomDecoration" class\x3d"dijitReset dijitSliderDecoration dijitSliderDecorationB dijitSliderDecorationH"\x3e\x3c/td\n\t\t\x3e\x3ctd class\x3d"dijitReset" colspan\x3d"2"\x3e\x3c/td\n\t\x3e\x3c/tr\n\x3e\x3c/table\x3e\n',
"url:jimu/dijit/templates/TabContainer3.html":'\x3cdiv\x3e\n  \x3cdiv class\x3d"control-node" data-dojo-attach-point\x3d"controlNode"\x3e\n    \x3ctable data-dojo-attach-point\x3d"controlTable" class\x3d"control-table" cellpading\x3d"0"\x3e\n      \x3ctbody\x3e\n        \x3ctr data-dojo-attach-point\x3d"tabTr"\x3e\n        \x3c/tr\x3e\n      \x3c/tbody\x3e\n    \x3c/table\x3e\n  \x3c/div\x3e\n  \x3cdiv class\x3d"container-node" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\n  \x3cdiv class\x3d"tab-shelter" data-dojo-attach-point\x3d"shelter"\x3e\x3c/div\x3e\n\x3c/div\x3e',
"url:jimu/dijit/templates/DrawBox.html":'\x3cdiv style\x3d"position:relative;width:100%;"\x3e\n\t\x3cdiv class\x3d"draw-items"\x3e\n\t\t\x3cdiv title\x3d"${nls.point}" data-geotype\x3d"POINT" data-commontype\x3d"point" class\x3d"draw-item point-icon"\x3e\x3c/div\x3e\n\t\t\x3cdiv title\x3d"${nls.line}" data-geotype\x3d"LINE" data-commontype\x3d"polyline" class\x3d"draw-item line-icon"\x3e\x3c/div\x3e\n\t\t\x3cdiv title\x3d"${nls.polyline}" data-geotype\x3d"POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item polyline-icon"\x3e\x3c/div\x3e\n\t\t\x3cdiv title\x3d"${nls.freehandPolyline}" data-geotype\x3d"FREEHAND_POLYLINE" data-commontype\x3d"polyline" class\x3d"draw-item freehand-polyline-icon"\x3e\x3c/div\x3e\n\t\t\x3cdiv title\x3d"${nls.triangle}" data-geotype\x3d"TRIANGLE" data-commontype\x3d"polygon" class\x3d"draw-item triangle-icon"\x3e\x3c/div\x3e\n\t\t\x3cdiv title\x3d"${nls.extent}" data-geotype\x3d"EXTENT" data-commontype\x3d"polygon" class\x3d"draw-item extent-icon"\x3e\x3c/div\x3e\n\t\t\x3cdiv title\x3d"${nls.circle}" data-geotype\x3d"CIRCLE" data-commontype\x3d"polygon" class\x3d"draw-item circle-icon"\x3e\x3c/div\x3e\n\t\t\x3cdiv title\x3d"${nls.ellipse}" data-geotype\x3d"ELLIPSE" data-commontype\x3d"polygon" class\x3d"draw-item ellipse-icon"\x3e\x3c/div\x3e\n\t\t\x3cdiv title\x3d"${nls.polygon}" data-geotype\x3d"POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item polygon-icon"\x3e\x3c/div\x3e\n\t\t\x3cdiv title\x3d"${nls.freehandPolygon}" data-geotype\x3d"FREEHAND_POLYGON" data-commontype\x3d"polygon" class\x3d"draw-item freehand-polygon-icon"\x3e\x3c/div\x3e\n\t\t\x3cdiv title\x3d"${nls.text}" data-geotype\x3d"POINT" data-commontype\x3d"text" class\x3d"draw-item text-icon" data-dojo-attach-point\x3d"textIcon"\x3e\x3c/div\x3e\n\t\x3c/div\x3e\n\t\x3cspan class\x3d"drawings-clear" data-dojo-attach-point\x3d"btnClear"\x3e${nls.clear}\x3c/span\x3e\n\x3c/div\x3e',
"url:dijit/templates/CheckedMenuItem.html":'\x3ctr class\x3d"dijitReset" data-dojo-attach-point\x3d"focusNode" role\x3d"${role}" tabIndex\x3d"-1" aria-checked\x3d"${checked}"\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemIconCell" role\x3d"presentation"\x3e\n\t\t\x3cspan class\x3d"dijitInline dijitIcon dijitMenuItemIcon dijitCheckedMenuItemIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\n\t\t\x3cspan class\x3d"dijitMenuItemIconChar dijitCheckedMenuItemIconChar"\x3e${checkedChar}\x3c/span\x3e\n\t\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemLabel" colspan\x3d"2" data-dojo-attach-point\x3d"containerNode,labelNode,textDirNode"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuItemAccelKey" style\x3d"display: none" data-dojo-attach-point\x3d"accelKeyNode"\x3e\x3c/td\x3e\n\t\x3ctd class\x3d"dijitReset dijitMenuArrowCell" role\x3d"presentation"\x3e\x26#160;\x3c/td\x3e\n\x3c/tr\x3e\n',
"url:dijit/form/templates/CheckBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline" role\x3d"presentation"\n\t\x3e\x3cinput\n\t \t${!nameAttrSetting} type\x3d"${type}" role\x3d"${type}" aria-checked\x3d"false" ${checkedAttrSetting}\n\t\tclass\x3d"dijitReset dijitCheckBoxInput"\n\t\tdata-dojo-attach-point\x3d"focusNode"\n\t \tdata-dojo-attach-event\x3d"ondijitclick:_onClick"\n/\x3e\x3c/div\x3e\n',"url:dijit/form/templates/DropDownBox.html":'\x3cdiv class\x3d"dijit dijitReset dijitInline dijitLeft"\n\tid\x3d"widget_${id}"\n\trole\x3d"combobox"\n\taria-haspopup\x3d"true"\n\tdata-dojo-attach-point\x3d"_popupStateNode"\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton dijitArrowButtonContainer\'\n\t\tdata-dojo-attach-point\x3d"_buttonNode" role\x3d"presentation"\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitArrowButtonInner" value\x3d"\x26#9660; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"button presentation" aria-hidden\x3d"true"\n\t\t\t${_buttonInputDisabled}\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d\'dijitReset dijitValidationContainer\'\n\t\t\x3e\x3cinput class\x3d"dijitReset dijitInputField dijitValidationIcon dijitValidationInner" value\x3d"\x26#935; " type\x3d"text" tabIndex\x3d"-1" readonly\x3d"readonly" role\x3d"presentation"\n\t/\x3e\x3c/div\n\t\x3e\x3cdiv class\x3d"dijitReset dijitInputField dijitInputContainer"\n\t\t\x3e\x3cinput class\x3d\'dijitReset dijitInputInner\' ${!nameAttrSetting} type\x3d"text" autocomplete\x3d"off"\n\t\t\tdata-dojo-attach-point\x3d"textbox,focusNode" role\x3d"textbox"\n\t/\x3e\x3c/div\n\x3e\x3c/div\x3e\n',
"*now":function(p){p(['dojo/i18n!*preload*jimu/nls/main*["ar","cs","da","de","en","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","ROOT"]'])}}});
define("./ConfigManager ./LayoutManager dojo/_base/html dojo/_base/lang dojo/_base/array dojo/on dojo/mouse dojo/topic dojo/cookie dojo/Deferred dojo/promise/all dojo/io-query dojo/domReady! esri/request esri/urlUtils esri/IdentityManager jimu/portalUrlUtils ./utils require dojo/i18n dojo/i18n!./nls/main".split(" "),function(p,g,k,h,f,m,e,q,d,b,r,n,t,a,c,s,l,w,z,A,x){f={};"function"!==typeof d.getAll&&(d.getAll=function(a){var b=[];(a=d(a))&&b.push(a);return b});window.jimuNls=x;s.setProtocolErrorHandler(function(){return!0});
s=w.getAncestorWindow();var u=!1;try{u=0===s.location.href.indexOf("https://")}catch(C){console.log(C),u=!1}a.setRequestPreCallback(function(a){a.content&&a.content.printFlag&&(a.timeout=3E5);u&&(a.url=a.url.replace(/^http(s?):\/\//gi,"//"));return a});m(window,"mousedown",function(a){if(e.isMiddle(a))return a.preventDefault(),a.stopPropagation(),a.returnValue=!1});String.prototype.startWith=function(a){return this.substr(0,a.length)===a?!0:!1};String.prototype.endWith=function(a){return this.substr(this.length-
a.length,a.length)===a?!0:!1};"undefined"===typeof jimuConfig&&(jimuConfig={});jimuConfig=h.mixin({loadingId:"main-loading",layoutId:"jimu-layout-manager",mapId:"map",mainPageId:"main-page",timeout:5E3,widthBreaks:[600,1280]},jimuConfig);window.wabVersion="1.0";window.productVersion="Portal for ArcGIS 10.3";f.initApp=function(){var a,b;console.log("jimu.js init...");b=window.location.search;a=""===b?{}:b=n.queryToObject(b.substr(1));k.setStyle(jimuConfig.loadingId,"display","none");k.setStyle(jimuConfig.mainPageId,
"display","block");b=g.getInstance({mapId:jimuConfig.mapId},jimuConfig.layoutId);a=p.getInstance(a);b.startup();a.loadConfig()};return f});